(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{2:function(t,e,n){t.exports=n("zUnb")},"9ZTT":function(t,e,n){var r;t.exports=function t(e,n,i){function o(a,l){if(!n[a]){if(!e[a]){if(!l&&"function"==typeof r&&r)return r(a,!0);if(s)return s(a,!0);throw new Error("Cannot find module '"+a+"'")}var u=n[a]={exports:{}};e[a][0].call(u.exports,function(t){return o(e[a][1][t]||t)},u,u.exports,t,e,n,i)}return n[a].exports}for(var s="function"==typeof r&&r,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(t,e,n){e.exports={name:"cannon",version:"0.6.1",description:"A lightweight 3D physics engine written in JavaScript.",homepage:"https://github.com/schteppe/cannon.js",author:"Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",keywords:["cannon.js","cannon","physics","engine","3d"],main:"./build/cannon.js",engines:{node:"*"},repository:{type:"git",url:"https://github.com/schteppe/cannon.js.git"},bugs:{url:"https://github.com/schteppe/cannon.js/issues"},licenses:[{type:"MIT"}],devDependencies:{jshint:"latest","uglify-js":"latest",nodeunit:"^0.9.0",grunt:"~0.4.0","grunt-contrib-jshint":"~0.1.1","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-concat":"~0.1.3","grunt-contrib-uglify":"^0.5.1","grunt-browserify":"^2.1.4","grunt-contrib-yuidoc":"^0.5.2",browserify:"*"},dependencies:{}}},{}],2:[function(t,e,n){e.exports={version:t("../package.json").version,ArrayCollisionMatrix:t("./collision/ArrayCollisionMatrix"),Body:t("./objects/Body"),Box:t("./shapes/Box"),Broadphase:t("./collision/Broadphase"),Constraint:t("./constraints/Constraint"),ContactEquation:t("./equations/ContactEquation"),Narrowphase:t("./world/Narrowphase"),ContactMaterial:t("./material/ContactMaterial"),ConvexPolyhedron:t("./shapes/ConvexPolyhedron"),Cylinder:t("./shapes/Cylinder"),DistanceConstraint:t("./constraints/DistanceConstraint"),Equation:t("./equations/Equation"),EventTarget:t("./utils/EventTarget"),FrictionEquation:t("./equations/FrictionEquation"),GSSolver:t("./solver/GSSolver"),GridBroadphase:t("./collision/GridBroadphase"),Heightfield:t("./shapes/Heightfield"),HingeConstraint:t("./constraints/HingeConstraint"),Mat3:t("./math/Mat3"),Material:t("./material/Material"),NaiveBroadphase:t("./collision/NaiveBroadphase"),ObjectCollisionMatrix:t("./collision/ObjectCollisionMatrix"),Pool:t("./utils/Pool"),Particle:t("./shapes/Particle"),Plane:t("./shapes/Plane"),PointToPointConstraint:t("./constraints/PointToPointConstraint"),Quaternion:t("./math/Quaternion"),Ray:t("./collision/Ray"),RaycastVehicle:t("./objects/RaycastVehicle"),RaycastResult:t("./collision/RaycastResult"),RigidVehicle:t("./objects/RigidVehicle"),RotationalEquation:t("./equations/RotationalEquation"),RotationalMotorEquation:t("./equations/RotationalMotorEquation"),SAPBroadphase:t("./collision/SAPBroadphase"),SPHSystem:t("./objects/SPHSystem"),Shape:t("./shapes/Shape"),Solver:t("./solver/Solver"),Sphere:t("./shapes/Sphere"),SplitSolver:t("./solver/SplitSolver"),Spring:t("./objects/Spring"),Vec3:t("./math/Vec3"),Vec3Pool:t("./utils/Vec3Pool"),World:t("./world/World")}},{"../package.json":1,"./collision/ArrayCollisionMatrix":4,"./collision/Broadphase":5,"./collision/GridBroadphase":6,"./collision/NaiveBroadphase":7,"./collision/ObjectCollisionMatrix":8,"./collision/Ray":9,"./collision/RaycastResult":10,"./collision/SAPBroadphase":11,"./constraints/Constraint":12,"./constraints/DistanceConstraint":13,"./constraints/HingeConstraint":14,"./constraints/PointToPointConstraint":15,"./equations/ContactEquation":16,"./equations/Equation":17,"./equations/FrictionEquation":18,"./equations/RotationalEquation":19,"./equations/RotationalMotorEquation":20,"./material/ContactMaterial":21,"./material/Material":22,"./math/Mat3":24,"./math/Quaternion":25,"./math/Vec3":27,"./objects/Body":28,"./objects/RaycastVehicle":29,"./objects/RigidVehicle":30,"./objects/SPHSystem":31,"./objects/Spring":32,"./shapes/Box":34,"./shapes/ConvexPolyhedron":35,"./shapes/Cylinder":36,"./shapes/Heightfield":37,"./shapes/Particle":38,"./shapes/Plane":39,"./shapes/Shape":40,"./shapes/Sphere":41,"./solver/GSSolver":42,"./solver/Solver":43,"./solver/SplitSolver":44,"./utils/EventTarget":45,"./utils/Pool":46,"./utils/Vec3Pool":49,"./world/Narrowphase":50,"./world/World":51}],3:[function(t,e,n){var r=t("../math/Vec3");function i(t){t=t||{},this.lowerBound=new r,t.lowerBound&&this.lowerBound.copy(t.lowerBound),this.upperBound=new r,t.upperBound&&this.upperBound.copy(t.upperBound)}t("../utils/Utils"),e.exports=i;var o=new r;i.prototype.setFromPoints=function(t,e,n,r){var i=this.lowerBound,s=this.upperBound,a=n;i.copy(t[0]),a&&a.vmult(i,i),s.copy(i);for(var l=1;l<t.length;l++){var u=t[l];a&&(a.vmult(u,o),u=o),u.x>s.x&&(s.x=u.x),u.x<i.x&&(i.x=u.x),u.y>s.y&&(s.y=u.y),u.y<i.y&&(i.y=u.y),u.z>s.z&&(s.z=u.z),u.z<i.z&&(i.z=u.z)}e&&(e.vadd(i,i),e.vadd(s,s)),r&&(i.x-=r,i.y-=r,i.z-=r,s.x+=r,s.y+=r,s.z+=r)},i.prototype.copy=function(t){this.lowerBound.copy(t.lowerBound),this.upperBound.copy(t.upperBound)},i.prototype.extend=function(t){var e,n;this.lowerBound.x>(e=t.lowerBound.x)&&(this.lowerBound.x=e),this.upperBound.x<(n=t.upperBound.x)&&(this.upperBound.x=n),this.lowerBound.y>(e=t.lowerBound.y)&&(this.lowerBound.y=e),this.upperBound.y<(n=t.upperBound.y)&&(this.upperBound.y=n),this.lowerBound.z>(e=t.lowerBound.z)&&(this.lowerBound.z=e),this.upperBound.z<(n=t.upperBound.z)&&(this.upperBound.z=n)},i.prototype.overlaps=function(t){var e=this.lowerBound,n=this.upperBound,r=t.lowerBound,i=t.upperBound;return(r.x<=n.x&&n.x<=i.x||e.x<=i.x&&i.x<=n.x)&&(r.y<=n.y&&n.y<=i.y||e.y<=i.y&&i.y<=n.y)&&(r.z<=n.z&&n.z<=i.z||e.z<=i.z&&i.z<=n.z)}},{"../math/Vec3":27,"../utils/Utils":48}],4:[function(t,e,n){function r(){this.matrix=[]}e.exports=r,r.prototype.get=function(t,e){if((e=e.index)>(t=t.index)){var n=e;e=t,t=n}return this.matrix[(t*(t+1)>>1)+e-1]},r.prototype.set=function(t,e,n){if((e=e.index)>(t=t.index)){var r=e;e=t,t=r}this.matrix[(t*(t+1)>>1)+e-1]=n?1:0},r.prototype.reset=function(){for(var t=0,e=this.matrix.length;t!==e;t++)this.matrix[t]=0},r.prototype.setNumObjects=function(t){this.matrix.length=t*(t-1)>>1}},{}],5:[function(t,e,n){var r=t("../objects/Body"),i=t("../math/Vec3"),o=t("../math/Quaternion");function s(){this.world=null,this.useBoundingBoxes=!1,this.dirty=!0}t("../shapes/Shape"),t("../shapes/Plane"),e.exports=s,s.prototype.collisionPairs=function(t,e,n){throw new Error("collisionPairs not implemented for this BroadPhase class!")};var a=r.STATIC|r.KINEMATIC;s.prototype.needBroadphaseCollision=function(t,e){return 0!=(t.collisionFilterGroup&e.collisionFilterMask)&&0!=(e.collisionFilterGroup&t.collisionFilterMask)&&(0==(t.type&a)&&t.sleepState!==r.SLEEPING||0==(e.type&a)&&e.sleepState!==r.SLEEPING)},s.prototype.intersectionTest=function(t,e,n,r){this.useBoundingBoxes?this.doBoundingBoxBroadphase(t,e,n,r):this.doBoundingSphereBroadphase(t,e,n,r)};var l=new i;new i,new o,new i,s.prototype.doBoundingSphereBroadphase=function(t,e,n,r){var i=l;e.position.vsub(t.position,i);var o=Math.pow(t.boundingRadius+e.boundingRadius,2);i.norm2()<o&&(n.push(t),r.push(e))},s.prototype.doBoundingBoxBroadphase=function(t,e,n,r){t.aabbNeedsUpdate&&t.computeAABB(),e.aabbNeedsUpdate&&e.computeAABB(),t.aabb.overlaps(e.aabb)&&(n.push(t),r.push(e))};var u={keys:[]},c=[],h=[];s.prototype.makePairsUnique=function(t,e){for(var n=u,r=c,i=h,o=t.length,s=0;s!==o;s++)r[s]=t[s],i[s]=e[s];for(t.length=0,e.length=0,s=0;s!==o;s++){var a=r[s].id,l=i[s].id;n[d=a<l?a+","+l:l+","+a]=s,n.keys.push(d)}for(s=0;s!==n.keys.length;s++){var d,p=n[d=n.keys.pop()];t.push(r[p]),e.push(i[p]),delete n[d]}},s.prototype.setWorld=function(t){};var d=new i;s.boundingSphereCheck=function(t,e){var n=d;return t.position.vsub(e.position,n),Math.pow(t.shape.boundingSphereRadius+e.shape.boundingSphereRadius,2)>n.norm2()},s.prototype.aabbQuery=function(t,e){return console.warn(".aabbQuery is not implemented in this Broadphase subclass."),[]}},{"../math/Quaternion":25,"../math/Vec3":27,"../objects/Body":28,"../shapes/Plane":39,"../shapes/Shape":40}],6:[function(t,e,n){e.exports=s;var r=t("./Broadphase"),i=t("../math/Vec3"),o=t("../shapes/Shape");function s(t,e,n,o,s){r.apply(this),this.nx=n||10,this.ny=o||10,this.nz=s||10,this.aabbMin=t||new i(100,100,100),this.aabbMax=e||new i(-100,-100,-100);var a=this.nx*this.ny*this.nz;if(a<=0)throw"GridBroadphase: Each dimension's n must be >0";this.bins=[],this.binLengths=[],this.bins.length=a,this.binLengths.length=a;for(var l=0;l<a;l++)this.bins[l]=[],this.binLengths[l]=0}(s.prototype=new r).constructor=s;var a=new i;new i,s.prototype.collisionPairs=function(t,e,n){for(var r=t.numObjects(),i=t.bodies,s=this.nx,l=this.ny,u=this.nz,c=l*u,h=u,d=1,p=(D=this.aabbMax).x,f=D.y,m=D.z,g=(O=this.aabbMin).x,v=O.y,y=O.z,w=s/(p-g),b=l/(f-v),x=u/(m-y),_=(p-g)/s,E=(f-v)/l,S=(m-y)/u,M=.5*Math.sqrt(_*_+E*E+S*S),T=o.types,C=T.SPHERE,A=T.PLANE,R=this.bins,P=this.binLengths,L=this.bins.length,I=0;I!==L;I++)P[I]=0;var N=Math.ceil,O=Math.min,D=Math.max;function B(t,e,n,r,i,o,a){var p=(t-g)*w|0,f=(e-v)*b|0,m=(n-y)*x|0,_=N((r-g)*w),E=N((i-v)*b),S=N((o-y)*x);p<0?p=0:p>=s&&(p=s-1),f<0?f=0:f>=l&&(f=l-1),m<0?m=0:m>=u&&(m=u-1),_<0?_=0:_>=s&&(_=s-1),E<0?E=0:E>=l&&(E=l-1),S<0?S=0:S>=u&&(S=u-1),f*=h,m*=d,_*=c,E*=h,S*=d;for(var M=p*=c;M<=_;M+=c)for(var T=f;T<=E;T+=h)for(var C=m;C<=S;C+=d){var A=M+T+C;R[A][P[A]++]=a}}for(I=0;I!==r;I++){var U=(et=i[I]).shape;switch(U.type){case C:var z=et.position.x,F=et.position.y,k=et.position.z,V=U.radius;B(z-V,F-V,k-V,z+V,F+V,k+V,et);break;case A:U.worldNormalNeedsUpdate&&U.computeWorldNormal(et.quaternion);var G=U.worldNormal,j=v+.5*E-et.position.y,H=y+.5*S-et.position.z,W=a;W.set(g+.5*_-et.position.x,j,H);for(var q=0,X=0;q!==s;q++,X+=c,W.y=j,W.x+=_)for(var Y=0,Z=0;Y!==l;Y++,Z+=h,W.z=H,W.y+=E)for(var $=0,Q=0;$!==u;$++,Q+=d,W.z+=S)if(W.dot(G)<M){var J=X+Z+Q;R[J][P[J]++]=et}break;default:et.aabbNeedsUpdate&&et.computeAABB(),B(et.aabb.lowerBound.x,et.aabb.lowerBound.y,et.aabb.lowerBound.z,et.aabb.upperBound.x,et.aabb.upperBound.y,et.aabb.upperBound.z,et)}}for(I=0;I!==L;I++){var K=P[I];if(K>1){var tt=R[I];for(q=0;q!==K;q++){var et=tt[q];for(Y=0;Y!==q;Y++){var nt=tt[Y];this.needBroadphaseCollision(et,nt)&&this.intersectionTest(et,nt,e,n)}}}}this.makePairsUnique(e,n)}},{"../math/Vec3":27,"../shapes/Shape":40,"./Broadphase":5}],7:[function(t,e,n){e.exports=o;var r=t("./Broadphase"),i=t("./AABB");function o(){r.apply(this)}(o.prototype=new r).constructor=o,o.prototype.collisionPairs=function(t,e,n){var r,i,o,s,a=t.bodies,l=a.length;for(r=0;r!==l;r++)for(i=0;i!==r;i++)this.needBroadphaseCollision(o=a[r],s=a[i])&&this.intersectionTest(o,s,e,n)},new i,o.prototype.aabbQuery=function(t,e,n){n=n||[];for(var r=0;r<t.bodies.length;r++){var i=t.bodies[r];i.aabbNeedsUpdate&&i.computeAABB(),i.aabb.overlaps(e)&&n.push(i)}return n}},{"./AABB":3,"./Broadphase":5}],8:[function(t,e,n){function r(){this.matrix={}}e.exports=r,r.prototype.get=function(t,e){if((e=e.id)>(t=t.id)){var n=e;e=t,t=n}return t+"-"+e in this.matrix},r.prototype.set=function(t,e,n){if((e=e.id)>(t=t.id)){var r=e;e=t,t=r}n?this.matrix[t+"-"+e]=!0:delete this.matrix[t+"-"+e]},r.prototype.reset=function(){this.matrix={}},r.prototype.setNumObjects=function(t){}},{}],9:[function(t,e,n){e.exports=l;var r=t("../math/Vec3"),i=t("../math/Quaternion"),o=t("../math/Transform"),s=(t("../shapes/ConvexPolyhedron"),t("../shapes/Box"),t("../collision/RaycastResult")),a=t("../shapes/Shape");function l(t,e){this.from=t?t.clone():new r,this.to=e?e.clone():new r,this._direction=new r,this.precision=1e-4,this.checkCollisionResponse=!0}t("../collision/AABB"),l.prototype.constructor=l;var u=new r,c=new r;function h(t,e,n,r){r.vsub(e,_),n.vsub(e,u),t.vsub(e,c);var i,o,s=_.dot(_),a=_.dot(u),l=_.dot(c),h=u.dot(u),d=u.dot(c);return(i=h*l-a*d)>=0&&(o=s*d-a*l)>=0&&i+o<s*h-a*a}l.prototype.intersectBody=function(t,e,n){var o=this.checkCollisionResponse;if(o&&!t.collisionResponse)return e;n||(this._updateDirection(),n=this._direction);for(var s=new r,a=new i,l=0;l<t.shapes.length;l++){var u=t.shapes[l];o&&!u.collisionResponse||(t.quaternion.mult(t.shapeOrientations[l],a),t.quaternion.vmult(t.shapeOffsets[l],s),s.vadd(t.position,s),this.intersectShape(u,a,s,t,n,e))}return e},l.prototype.intersectBodies=function(t,e){this._updateDirection();var n=this._direction;e instanceof s&&e.reset();for(var r=0,i=t.length;r<i;r++)this.intersectBody(t[r],e,n)},l.prototype._updateDirection=function(){this.to.vsub(this.from,this._direction),this._direction.normalize()},l.prototype.intersectShape=function(t,e,n,r,i,o){return function(t,e,n){n.vsub(t,_);var r=_.dot(e);return e.mult(r,E),E.vadd(t,E),n.distanceTo(E)}(this.from,i,n)>t.boundingSphereRadius?o:(this[t.type](t,e,n,r,i,o),o)},new r,new r;var d=new r,p=new r,f=new r,m=new r,g=(new r,new s);l.prototype[a.types.BOX]=l.prototype.intersectBox=function(t,e,n,r,i,o){return this.intersectConvex(t.convexPolyhedronRepresentation,e,n,r,i,o)},l.prototype[a.types.PLANE]=l.prototype.intersectPlane=function(t,e,n,i,o,s){var a=this.from,l=this.to,u=new r(0,0,1);e.vmult(u,u);var c=new r;a.vsub(n,c);var h=c.dot(u);if(l.vsub(n,c),h*c.dot(u)>0)return s;if(a.distanceTo(l)<h)return s;var d=u.dot(o);if(Math.abs(d)<this.precision)return s;var p=new r,f=new r,m=new r;a.vsub(n,p);var g=-u.dot(p)/d;return o.scale(g,f),a.vadd(f,m),this.reportIntersection(u,m,t,i,s),s},l.prototype.getAABB=function(t){var e=this.to,n=this.from;t.lowerBound.x=Math.min(e.x,n.x),t.lowerBound.y=Math.min(e.y,n.y),t.lowerBound.z=Math.min(e.z,n.z),t.upperBound.x=Math.max(e.x,n.x),t.upperBound.y=Math.max(e.y,n.y),t.upperBound.z=Math.max(e.z,n.z)};var v={faceList:[0]};l.prototype[a.types.HEIGHTFIELD]=l.prototype.intersectHeightfield=function(t,e,n,i,s,a){var u=new r,c=new l(this.from,this.to);o.pointToLocalFrame(n,e,c.from,c.from),o.pointToLocalFrame(n,e,c.to,c.to);var h=[],d=null,p=null,f=null,m=null,g=t.getIndexOfPosition(c.from.x,c.from.y,h,!1);if(g&&(d=h[0],p=h[1],f=h[0],m=h[1]),(g=t.getIndexOfPosition(c.to.x,c.to.y,h,!1))&&((null===d||h[0]<d)&&(d=h[0]),(null===f||h[0]>f)&&(f=h[0]),(null===p||h[1]<p)&&(p=h[1]),(null===m||h[1]>m)&&(m=h[1])),null===d)return a;t.getRectMinMax(d,p,f,m,[]);for(var y=d;y<=f;y++)for(var w=p;w<=m;w++)t.getConvexTrianglePillar(y,w,!1),o.pointToWorldFrame(n,e,t.pillarOffset,u),this.intersectConvex(t.pillarConvex,e,u,i,s,a,v),t.getConvexTrianglePillar(y,w,!0),o.pointToWorldFrame(n,e,t.pillarOffset,u),this.intersectConvex(t.pillarConvex,e,u,i,s,a,v);return a},l.prototype[a.types.SPHERE]=l.prototype.intersectSphere=function(t,e,n,i,o,s){var a=this.from,l=this.to,u=t.radius,c=Math.pow(l.x-a.x,2)+Math.pow(l.y-a.y,2)+Math.pow(l.z-a.z,2),h=2*((l.x-a.x)*(a.x-n.x)+(l.y-a.y)*(a.y-n.y)+(l.z-a.z)*(a.z-n.z)),d=Math.pow(a.x-n.x,2)+Math.pow(a.y-n.y,2)+Math.pow(a.z-n.z,2)-Math.pow(u,2),p=Math.pow(h,2)-4*c*d;if(p<0)return s;if(0===p){var f=new r;a.lerp(l,p,f);var m=new r;if(f.vsub(n,m),m.normalize(),this.reportIntersection(m,f,t,i,s))return s}else{var g=(-h-Math.sqrt(p))/(2*c),v=(-h+Math.sqrt(p))/(2*c);if(f=new r,a.lerp(l,g,f),m=new r,f.vsub(n,m),m.normalize(),this.reportIntersection(m,f,t,i,s))return s;if(a.lerp(l,v,f),m=new r,f.vsub(n,m),m.normalize(),this.reportIntersection(m,f,t,i,s))return s}return s};var y=new r,w=new r,b=new r,x=new r;l.prototype[a.types.CONVEXPOLYHEDRON]=l.prototype.intersectConvex=function(t,e,n,r,i,o,s){for(var a=w,l=y,u=x,c=b,g=s&&s.faceList||null,v=t.faces,_=t.vertices,E=t.faceNormals,S=this.from,M=S.distanceTo(this.to),T=-1,C=g?g.length:v.length,A=0;A<C;A++){var R=g?g[A]:A,P=v[R],L=E[R],I=e,N=n;u.copy(_[P[0]]),I.vmult(u,u),u.vadd(N,u),u.vsub(S,u),I.vmult(L,l);var O=i.dot(l);if(!(Math.abs(O)<this.precision)){var D=l.dot(u)/O;if(!(D<0)&&O<0){i.mult(D,d),d.vadd(S,d),p.copy(_[P[0]]),I.vmult(p,p),N.vadd(p,p);for(var B=1;B<P.length-1;B++){f.copy(_[P[B]]),m.copy(_[P[B+1]]),I.vmult(f,f),I.vmult(m,m),N.vadd(f,f),N.vadd(m,m);var U=d.distanceTo(S);!h(d,p,f,m)||U>M||(-1===T||U<T)&&(T=U,a.copy(l),c.copy(d))}}}}return-1!==T&&this.reportIntersection(a,c,t,r,o),o},l.prototype.reportIntersection=function(t,e,n,r,i){var o=this.from,a=this.to,l=o.distanceTo(e);return i instanceof s?((l<i.distance||!i.hasHit)&&(i.hasHit=!0,i.set(o,a,t,e,n,r,l)),!1):(g.set(o,a,t,e,n,r,l),g.hasHit=!0,i(g),!0)};var _=new r,E=new r},{"../collision/AABB":3,"../collision/RaycastResult":10,"../math/Quaternion":25,"../math/Transform":26,"../math/Vec3":27,"../shapes/Box":34,"../shapes/ConvexPolyhedron":35,"../shapes/Shape":40}],10:[function(t,e,n){var r=t("../math/Vec3");function i(){this.rayFromWorld=new r,this.rayToWorld=new r,this.hitNormalWorld=new r,this.hitPointWorld=new r,this.hasHit=!1,this.shape=null,this.body=null,this.distance=-1}e.exports=i,i.prototype.reset=function(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.distance=-1},i.prototype.set=function(t,e,n,r,i,o,s){this.rayFromWorld.copy(t),this.rayToWorld.copy(e),this.hitNormalWorld.copy(n),this.hitPointWorld.copy(r),this.shape=i,this.body=o,this.distance=s}},{"../math/Vec3":27}],11:[function(t,e,n){t("../shapes/Shape");var r=t("../collision/Broadphase");function i(t){r.apply(this),this.axisList=[],this.world=null,this.axisIndex=0;var e=this.axisList;this._addBodyHandler=function(t){e.push(t.body)},this._removeBodyHandler=function(t){var n=e.indexOf(t.body);-1!==n&&e.splice(n,1)},t&&this.setWorld(t)}e.exports=i,(i.prototype=new r).setWorld=function(t){this.axisList.length=0;for(var e=0;e<t.bodies.length;e++)this.axisList.push(t.bodies[e]);t.removeEventListener("addBody",this._addBodyHandler),t.removeEventListener("removeBody",this._removeBodyHandler),t.addEventListener("addBody",this._addBodyHandler),t.addEventListener("removeBody",this._removeBodyHandler),this.world=t,this.dirty=!0},i.insertionSortX=function(t){for(var e=1,n=t.length;e<n;e++){for(var r=t[e],i=e-1;i>=0&&!(t[i].aabb.lowerBound.x<=r.aabb.lowerBound.x);i--)t[i+1]=t[i];t[i+1]=r}return t},i.insertionSortY=function(t){for(var e=1,n=t.length;e<n;e++){for(var r=t[e],i=e-1;i>=0&&!(t[i].aabb.lowerBound.y<=r.aabb.lowerBound.y);i--)t[i+1]=t[i];t[i+1]=r}return t},i.insertionSortZ=function(t){for(var e=1,n=t.length;e<n;e++){for(var r=t[e],i=e-1;i>=0&&!(t[i].aabb.lowerBound.z<=r.aabb.lowerBound.z);i--)t[i+1]=t[i];t[i+1]=r}return t},i.prototype.collisionPairs=function(t,e,n){var r,o,s=this.axisList,a=s.length,l=this.axisIndex;for(this.dirty&&(this.sortList(),this.dirty=!1),r=0;r!==a;r++){var u=s[r];for(o=r+1;o<a;o++){var c=s[o];if(this.needBroadphaseCollision(u,c)){if(!i.checkBounds(u,c,l))break;this.intersectionTest(u,c,e,n)}}}},i.prototype.sortList=function(){for(var t=this.axisList,e=this.axisIndex,n=t.length,r=0;r!==n;r++){var o=t[r];o.aabbNeedsUpdate&&o.computeAABB()}0===e?i.insertionSortX(t):1===e?i.insertionSortY(t):2===e&&i.insertionSortZ(t)},i.checkBounds=function(t,e,n){var r;return 0===n&&(r="x"),1===n&&(r="y"),2===n&&(r="z"),e.position[r]-e.boundingRadius<t.position[r]+t.boundingRadius},i.prototype.autoDetectAxis=function(){for(var t=0,e=0,n=0,r=0,i=0,o=0,s=this.axisList,a=s.length,l=1/a,u=0;u!==a;u++){var c=s[u],h=c.position.x;t+=h,e+=h*h;var d=c.position.y;n+=d,r+=d*d;var p=c.position.z;i+=p,o+=p*p}var f=e-t*t*l,m=r-n*n*l,g=o-i*i*l;this.axisIndex=f>m?f>g?0:2:m>g?1:2},i.prototype.aabbQuery=function(t,e,n){n=n||[],this.dirty&&(this.sortList(),this.dirty=!1);for(var r=this.axisList,i=0;i<r.length;i++){var o=r[i];o.aabbNeedsUpdate&&o.computeAABB(),o.aabb.overlaps(e)&&n.push(o)}return n}},{"../collision/Broadphase":5,"../shapes/Shape":40}],12:[function(t,e,n){e.exports=i;var r=t("../utils/Utils");function i(t,e,n){n=r.defaults(n,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=t,this.bodyB=e,this.id=i.idCounter++,this.collideConnected=n.collideConnected,n.wakeUpBodies&&(t&&t.wakeUp(),e&&e.wakeUp())}i.prototype.update=function(){throw new Error("method update() not implmemented in this Constraint subclass!")},i.idCounter=0},{"../utils/Utils":48}],13:[function(t,e,n){e.exports=o;var r=t("./Constraint"),i=t("../equations/ContactEquation");function o(t,e,n,o){r.call(this,t,e),void 0===o&&(o=1e6);var s=(this.equations=[new i(t,e)])[0];s.minForce=-o,s.maxForce=o,this.update=function(){e.position.vsub(t.position,s.ni),s.ni.normalize(),s.ni.mult(.5*n,s.ri),s.ni.mult(.5*-n,s.rj)}}o.prototype=new r},{"../equations/ContactEquation":16,"./Constraint":12}],14:[function(t,e,n){e.exports=l;var r=t("./Constraint"),i=t("../equations/RotationalEquation"),o=t("../equations/RotationalMotorEquation"),s=t("../equations/ContactEquation"),a=t("../math/Vec3");function l(t,e,n){r.call(this,t,e,n);var l=void 0!==n.maxForce?n.maxForce:1e6,u=this.pivotA=void 0!==n.pivotA?n.pivotA.clone():new a,c=this.pivotB=void 0!==n.pivotB?n.pivotB.clone():new a,h=this.axisA=void 0!==n.axisA?n.axisA.clone():new a(1,0,0),d=this.axisB=void 0!==n.axisB?n.axisB.clone():new a(1,0,0),p=(this.equations=[new i(t,e),new i(t,e),new s(t,e),new s(t,e),new s(t,e)],this.getRotationalEquation1(),this.getRotationalEquation2(),this.getPointToPointEquation1()),f=this.getPointToPointEquation2(),m=this.getPointToPointEquation3();f.minForce=m.minForce=p.minForce=-l,f.maxForce=m.maxForce=p.maxForce=l;var g=u.unit(),v=c.unit(),y=this.axisA_x_pivotA=new a,w=this.axisA_x_axisA_x_pivotA=new a,b=this.axisB_x_pivotB=new a;h.cross(g,y),y.norm2()<.001&&g.tangents(y,y),h.cross(y,w),d.cross(v,b),b.norm2()<.001&&d.tangents(b,b),y.normalize(),b.normalize(),this.motorEnabled=!1,this.motorTargetVelocity=0,this.motorMinForce=-l,this.motorMaxForce=l,this.motorEquation=new o(t,e,l)}(l.prototype=new r).enableMotor=function(){this.motorEnabled||(this.equations.push(this.motorEquation),this.motorEnabled=!0)},l.prototype.disableMotor=function(){this.motorEnabled&&(this.motorEnabled=!1,this.equations.pop())},l.prototype.update=function(){var t=this.bodyA,e=this.bodyB,n=this.equations,r=this.motorEquation,i=n[0],o=n[1],s=n[2],a=n[3],l=n[4],u=this.axisA_x_pivotA,c=this.axisA,h=this.axisB,d=this.pivotA,p=this.pivotB,f=this.axisA_x_axisA_x_pivotA,m=this.axisB_x_pivotB;s.ni.set(1,0,0),a.ni.set(0,1,0),l.ni.set(0,0,1),t.quaternion.vmult(this.pivotA,s.ri),e.quaternion.vmult(this.pivotB,s.rj),a.ri.copy(s.ri),a.rj.copy(s.rj),l.ri.copy(s.ri),l.rj.copy(s.rj),c.cross(d,u),u.norm2()<.001&&d.tangents(u,u),c.cross(u,f),h.cross(p,m),m.norm2()<.001&&h.tangents(m,m),u.normalize(),m.normalize(),t.quaternion.vmult(u,i.ni),e.quaternion.vmult(h,i.nj),t.quaternion.vmult(f,o.ni),e.quaternion.vmult(h,o.nj),this.motorEnabled&&(t.quaternion.vmult(this.axisA,r.axisA),e.quaternion.vmult(this.axisB,r.axisB),r.targetVelocity=this.motorTargetVelocity,r.maxForce=this.motorMaxForce,r.minForce=this.motorMinForce)},l.prototype.getRotationalEquation1=function(){return this.equations[0]},l.prototype.getRotationalEquation2=function(){return this.equations[1]},l.prototype.getPointToPointEquation1=function(){return this.equations[2]},l.prototype.getPointToPointEquation2=function(){return this.equations[3]},l.prototype.getPointToPointEquation3=function(){return this.equations[4]}},{"../equations/ContactEquation":16,"../equations/RotationalEquation":19,"../equations/RotationalMotorEquation":20,"../math/Vec3":27,"./Constraint":12}],15:[function(t,e,n){e.exports=o;var r=t("./Constraint"),i=t("../equations/ContactEquation");function o(t,e,n,o,s){r.call(this,t,n);var a=this.equations=[new i(t,n),new i(t,n),new i(t,n)],l=a[0],u=a[1],c=a[2];u.minForce=c.minForce=l.minForce=-s,u.maxForce=c.maxForce=l.maxForce=s,this.update=function(){n.position.vsub(t.position,l.ni),l.ni.normalize(),t.quaternion.vmult(e,l.ri),n.quaternion.vmult(o,l.rj),l.ni.tangents(u.ni,c.ni),u.ri.copy(l.ri),u.rj.copy(l.rj),c.ri.copy(l.ri),c.rj.copy(l.rj)}}o.prototype=new r},{"../equations/ContactEquation":16,"./Constraint":12}],16:[function(t,e,n){e.exports=s;var r=t("./Equation"),i=t("../math/Vec3"),o=t("../math/Mat3");function s(t,e){r.call(this,t,e,0,1e6),this.restitution=0,this.ri=new i,this.rj=new i,this.penetrationVec=new i,this.ni=new i,this.rixn=new i,this.rjxn=new i,this.invIi=new o,this.invIj=new o,this.biInvInertiaTimesRixn=new i,this.bjInvInertiaTimesRjxn=new i}(s.prototype=new r).constructor=s;var a=new i,l=new i,u=new i;s.prototype.computeB=function(t){var e=this.a,n=this.b,r=this.bi,i=this.bj,o=this.ri,s=this.rj,c=this.rixn,h=this.rjxn,d=r.velocity,p=r.angularVelocity?r.angularVelocity:u,f=r.torque?r.torque:u,m=i.velocity,g=i.angularVelocity?i.angularVelocity:u,v=i.torque?i.torque:u,y=this.penetrationVec,w=this.jacobianElementA,b=this.jacobianElementB,x=this.ni;o.cross(x,c),s.cross(x,h),x.negate(w.spatial),c.negate(w.rotational),b.spatial.copy(x),b.rotational.copy(h),(y=this.penetrationVec).set(0,0,0),y.vadd(i.position,y),y.vadd(s,y),y.vsub(r.position,y),y.vsub(o,y);var _=x.dot(y),E=a,S=l;r.invInertiaWorld?r.invInertiaWorld.vmult(f,E):E.set(0,0,0),i.invInertiaWorld?i.invInertiaWorld.vmult(v,S):S.set(0,0,0);var M=this.restitution+1;return-_*e-(M*m.dot(x)-M*d.dot(x)+g.dot(h)-p.dot(c))*n-t*this.computeGiMf()}},{"../math/Mat3":24,"../math/Vec3":27,"./Equation":17}],17:[function(t,e,n){e.exports=o;var r=t("../math/JacobianElement"),i=t("../math/Vec3");function o(t,e,n,i){this.id=-1,this.minForce=void 0===n?-1e6:n,this.maxForce=void 0===i?1e6:i,this.bi=t,this.bj=e,this.a=0,this.b=0,this.eps=0,this.jacobianElementA=new r,this.jacobianElementB=new r,this.setSpookParams(1e7,4,1/60),this.enabled=!0}o.prototype.constructor=o,o.prototype.setSpookParams=function(t,e,n){var r=e,i=t,o=n;this.a=4/(o*(1+4*r)),this.b=4*r/(1+4*r),this.eps=4/(o*o*i*(1+4*r))},o.prototype.computeB=function(t,e,n){var r=this.computeGW();return-this.computeGq()*t-r*e-this.computeGiMf()*n},o.prototype.computeGq=function(){var t=this.jacobianElementB,e=this.bj.position;return this.jacobianElementA.spatial.dot(this.bi.position)+t.spatial.dot(e)};var s=new i;o.prototype.computeGW=function(){var t=this.jacobianElementB,e=this.bi,n=this.bj,r=n.velocity,i=n.angularVelocity||s;return this.jacobianElementA.multiplyVectors(e.velocity,e.angularVelocity||s)+t.multiplyVectors(r,i)},o.prototype.computeGWlambda=function(){var t=this.jacobianElementB,e=this.bi,n=this.bj,r=n.vlambda,i=n.wlambda||s;return this.jacobianElementA.multiplyVectors(e.vlambda,e.wlambda||s)+t.multiplyVectors(r,i)};var a=new i,l=new i,u=new i,c=new i;o.prototype.computeGiMf=function(){var t=this.jacobianElementA,e=this.jacobianElementB,n=this.bi,r=this.bj,i=n.force,o=r.force,s=r.torque,h=n.invMassSolve,d=r.invMassSolve;return n.invInertiaWorldSolve?n.invInertiaWorldSolve.vmult(n.torque,u):u.set(0,0,0),r.invInertiaWorldSolve?r.invInertiaWorldSolve.vmult(s,c):c.set(0,0,0),i.mult(h,a),o.mult(d,l),t.multiplyVectors(a,u)+e.multiplyVectors(l,c)};var h=new i;o.prototype.computeGiMGt=function(){var t=this.jacobianElementA,e=this.jacobianElementB,n=this.bi,r=this.bj,i=n.invInertiaWorldSolve,o=r.invInertiaWorldSolve,s=n.invMassSolve+r.invMassSolve;return i&&(i.vmult(t.rotational,h),s+=h.dot(t.rotational)),o&&(o.vmult(e.rotational,h),s+=h.dot(e.rotational)),s};var d=new i;new i,new i,new i,new i,new i,o.prototype.addToWlambda=function(t){var e=this.jacobianElementA,n=this.jacobianElementB,r=this.bi,i=this.bj,o=d;e.spatial.mult(r.invMassSolve*t,o),r.vlambda.vadd(o,r.vlambda),n.spatial.mult(i.invMassSolve*t,o),i.vlambda.vadd(o,i.vlambda),r.invInertiaWorldSolve&&(r.invInertiaWorldSolve.vmult(e.rotational,o),o.mult(t,o),r.wlambda.vadd(o,r.wlambda)),i.invInertiaWorldSolve&&(i.invInertiaWorldSolve.vmult(n.rotational,o),o.mult(t,o),i.wlambda.vadd(o,i.wlambda))},o.prototype.computeC=function(){return this.computeGiMGt()+this.eps}},{"../math/JacobianElement":23,"../math/Vec3":27}],18:[function(t,e,n){e.exports=s;var r=t("./Equation"),i=t("../math/Vec3"),o=t("../math/Mat3");function s(t,e,n){r.call(this,t,e,-n,n),this.ri=new i,this.rj=new i,this.t=new i,this.rixt=new i,this.rjxt=new i,this.wixri=new i,this.wjxrj=new i,this.invIi=new o,this.invIj=new o,this.relVel=new i,this.relForce=new i,this.biInvInertiaTimesRixt=new i,this.bjInvInertiaTimesRjxt=new i}(s.prototype=new r).constructor=s;var a=new i,l=new i,u=new i;s.prototype.computeB=function(t){var e=this.b,n=this.bi,r=this.bj,i=this.ri,o=this.rj,s=this.rixt,c=this.rjxt,h=this.wixri,d=this.wjxrj,p=n.angularVelocity?n.angularVelocity:u,f=n.torque?n.torque:u,m=r.angularVelocity?r.angularVelocity:u,g=r.torque?r.torque:u,v=this.t,y=a,w=l;i.cross(v,s),o.cross(v,c),p.cross(i,h),m.cross(o,d);var b=this.jacobianElementA,x=this.jacobianElementB;return v.negate(b.spatial),s.negate(b.rotational),x.spatial.copy(v),x.rotational.copy(c),n.invInertiaWorld?n.invInertiaWorld.vmult(f,y):y.set(0,0,0),r.invInertiaWorld?r.invInertiaWorld.vmult(g,w):w.set(0,0,0),-this.computeGW()*e-t*this.computeGiMf()}},{"../math/Mat3":24,"../math/Vec3":27,"./Equation":17}],19:[function(t,e,n){e.exports=s;var r=t("../math/Vec3"),i=t("../math/Mat3"),o=t("./Equation");function s(t,e){o.call(this,t,e,-1e6,1e6),this.ni=new r,this.nj=new r,this.nixnj=new r,this.njxni=new r,this.invIi=new i,this.invIj=new i,this.relVel=new r,this.relForce=new r}(s.prototype=new o).constructor=s,new r,s.prototype.computeB=function(t){var e=this.a,n=this.b,r=this.ni,i=this.nj,o=this.nixnj,s=this.njxni,a=this.jacobianElementA,l=this.jacobianElementB;return r.cross(i,o),i.cross(r,s),a.rotational.copy(s),l.rotational.copy(o),- -r.dot(i)*e-this.computeGW()*n-t*this.computeGiMf()}},{"../math/Mat3":24,"../math/Vec3":27,"./Equation":17}],20:[function(t,e,n){e.exports=s;var r=t("../math/Vec3"),i=t("../math/Mat3"),o=t("./Equation");function s(t,e,n){o.call(this,t,e,-(n=n||1e6),n),this.axisA=new r,this.axisB=new r,this.invIi=new i,this.invIj=new i,this.targetVelocity=0}(s.prototype=new o).constructor=s,new r,s.prototype.computeB=function(t){var e=this.b,n=this.axisB,r=this.jacobianElementB;return this.jacobianElementA.rotational.copy(this.axisA),n.negate(r.rotational),-(this.computeGW()-this.targetVelocity)*e-t*this.computeGiMf()}},{"../math/Mat3":24,"../math/Vec3":27,"./Equation":17}],21:[function(t,e,n){var r=t("../utils/Utils");function i(t,e,n){n=r.defaults(n,{friction:.3,restitution:.3,contactEquationStiffness:1e7,contactEquationRelaxation:3,frictionEquationStiffness:1e7,frictionEquationRelaxation:3}),this.id=i.idCounter++,this.materials=[t,e],this.friction=n.friction,this.restitution=n.restitution,this.contactEquationStiffness=n.contactEquationStiffness,this.contactEquationRelaxation=n.contactEquationRelaxation,this.frictionEquationStiffness=n.frictionEquationStiffness,this.frictionEquationRelaxation=n.frictionEquationRelaxation}e.exports=i,i.idCounter=0},{"../utils/Utils":48}],22:[function(t,e,n){function r(t){this.name=t,this.id=r.idCounter++}e.exports=r,r.idCounter=0},{}],23:[function(t,e,n){e.exports=i;var r=t("./Vec3");function i(){this.spatial=new r,this.rotational=new r}i.prototype.multiplyElement=function(t){return t.spatial.dot(this.spatial)+t.rotational.dot(this.rotational)},i.prototype.multiplyVectors=function(t,e){return t.dot(this.spatial)+e.dot(this.rotational)}},{"./Vec3":27}],24:[function(t,e,n){e.exports=i;var r=t("./Vec3");function i(t){this.elements=t||[0,0,0,0,0,0,0,0,0]}i.prototype.identity=function(){this.elements[0]=1,this.elements[1]=0,this.elements[2]=0,this.elements[3]=0,this.elements[4]=1,this.elements[5]=0,this.elements[6]=0,this.elements[7]=0,this.elements[8]=1},i.prototype.setZero=function(){var t=this.elements;t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t[8]=0},i.prototype.setTrace=function(t){var e=this.elements;e[0]=t.x,e[4]=t.y,e[8]=t.z},i.prototype.getTrace=function(t){t=t||new r;var e=this.elements;t.x=e[0],t.y=e[4],t.z=e[8]},i.prototype.vmult=function(t,e){e=e||new r;var n=this.elements,i=t.x,o=t.y,s=t.z;return e.x=n[0]*i+n[1]*o+n[2]*s,e.y=n[3]*i+n[4]*o+n[5]*s,e.z=n[6]*i+n[7]*o+n[8]*s,e},i.prototype.smult=function(t){for(var e=0;e<this.elements.length;e++)this.elements[e]*=t},i.prototype.mmult=function(t,e){for(var n=e||new i,r=0;r<3;r++)for(var o=0;o<3;o++){for(var s=0,a=0;a<3;a++)s+=t.elements[r+3*a]*this.elements[a+3*o];n.elements[r+3*o]=s}return n},i.prototype.scale=function(t,e){e=e||new i;for(var n=this.elements,r=e.elements,o=0;3!==o;o++)r[3*o+0]=t.x*n[3*o+0],r[3*o+1]=t.y*n[3*o+1],r[3*o+2]=t.z*n[3*o+2];return e},i.prototype.solve=function(t,e){e=e||new r;for(var n,i=[],o=0;o<12;o++)i.push(0);for(o=0;o<3;o++)for(n=0;n<3;n++)i[o+4*n]=this.elements[o+3*n];i[3]=t.x,i[7]=t.y,i[11]=t.z;var s,a,l=3,u=l;do{if(0===i[(o=u-l)+4*o])for(n=o+1;n<u;n++)if(0!==i[o+4*n]){s=4;do{i[(a=4-s)+4*o]+=i[a+4*n]}while(--s);break}if(0!==i[o+4*o])for(n=o+1;n<u;n++){var c=i[o+4*n]/i[o+4*o];s=4;do{i[(a=4-s)+4*n]=a<=o?0:i[a+4*n]-i[a+4*o]*c}while(--s)}}while(--l);if(e.z=i[11]/i[10],e.y=(i[7]-i[6]*e.z)/i[5],e.x=(i[3]-i[2]*e.z-i[1]*e.y)/i[0],isNaN(e.x)||isNaN(e.y)||isNaN(e.z)||e.x===1/0||e.y===1/0||e.z===1/0)throw"Could not solve equation! Got x=["+e.toString()+"], b=["+t.toString()+"], A=["+this.toString()+"]";return e},i.prototype.e=function(t,e,n){if(void 0===n)return this.elements[e+3*t];this.elements[e+3*t]=n},i.prototype.copy=function(t){for(var e=0;e<t.elements.length;e++)this.elements[e]=t.elements[e];return this},i.prototype.toString=function(){for(var t="",e=0;e<9;e++)t+=this.elements[e]+",";return t},i.prototype.reverse=function(t){t=t||new i;for(var e,n=[],r=0;r<18;r++)n.push(0);for(r=0;r<3;r++)for(e=0;e<3;e++)n[r+6*e]=this.elements[r+3*e];n[3]=1,n[9]=0,n[15]=0,n[4]=0,n[10]=1,n[16]=0,n[5]=0,n[11]=0,n[17]=1;var o,s,a=3,l=a;do{if(0===n[(r=l-a)+6*r])for(e=r+1;e<l;e++)if(0!==n[r+6*e]){o=6;do{n[(s=6-o)+6*r]+=n[s+6*e]}while(--o);break}if(0!==n[r+6*r])for(e=r+1;e<l;e++){var u=n[r+6*e]/n[r+6*r];o=6;do{n[(s=6-o)+6*e]=s<=r?0:n[s+6*e]-n[s+6*r]*u}while(--o)}}while(--a);r=2;do{e=r-1;do{u=n[r+6*e]/n[r+6*r],o=6;do{n[(s=6-o)+6*e]=n[s+6*e]-n[s+6*r]*u}while(--o)}while(e--)}while(--r);r=2;do{u=1/n[r+6*r],o=6;do{n[(s=6-o)+6*r]=n[s+6*r]*u}while(--o)}while(r--);r=2;do{e=2;do{if(s=n[3+e+6*r],isNaN(s)||s===1/0)throw"Could not reverse! A=["+this.toString()+"]";t.e(r,e,s)}while(e--)}while(r--);return t},i.prototype.setRotationFromQuaternion=function(t){var e=t.x,n=t.y,r=t.z,i=t.w,o=e+e,s=n+n,a=r+r,l=e*o,u=e*s,c=e*a,h=n*s,d=n*a,p=r*a,f=i*o,m=i*s,g=i*a,v=this.elements;return v[0]=1-(h+p),v[1]=u-g,v[2]=c+m,v[3]=u+g,v[4]=1-(l+p),v[5]=d-f,v[6]=c-m,v[7]=d+f,v[8]=1-(l+h),this},i.prototype.transpose=function(t){for(var e=(t=t||new i).elements,n=this.elements,r=0;3!==r;r++)for(var o=0;3!==o;o++)e[3*r+o]=n[3*o+r];return t}},{"./Vec3":27}],25:[function(t,e,n){e.exports=i;var r=t("./Vec3");function i(t,e,n,r){this.x=void 0!==t?t:0,this.y=void 0!==e?e:0,this.z=void 0!==n?n:0,this.w=void 0!==r?r:1}i.prototype.set=function(t,e,n,r){this.x=t,this.y=e,this.z=n,this.w=r},i.prototype.toString=function(){return this.x+","+this.y+","+this.z+","+this.w},i.prototype.toArray=function(){return[this.x,this.y,this.z,this.w]},i.prototype.setFromAxisAngle=function(t,e){var n=Math.sin(.5*e);this.x=t.x*n,this.y=t.y*n,this.z=t.z*n,this.w=Math.cos(.5*e)},i.prototype.toAxisAngle=function(t){t=t||new r,this.normalize();var e=2*Math.acos(this.w),n=Math.sqrt(1-this.w*this.w);return n<.001?(t.x=this.x,t.y=this.y,t.z=this.z):(t.x=this.x/n,t.y=this.y/n,t.z=this.z/n),[t,e]};var o=new r,s=new r;i.prototype.setFromVectors=function(t,e){if(t.isAntiparallelTo(e)){var n=o;t.tangents(n,s),this.setFromAxisAngle(n,Math.PI)}else{var r=t.cross(e);this.x=r.x,this.y=r.y,this.z=r.z,this.w=Math.sqrt(Math.pow(t.norm(),2)*Math.pow(e.norm(),2))+t.dot(e),this.normalize()}};var a=new r,l=new r,u=new r;i.prototype.mult=function(t,e){e=e||new i;var n=this.w,r=a,o=l,s=u;return r.set(this.x,this.y,this.z),o.set(t.x,t.y,t.z),e.w=n*t.w-r.dot(o),r.cross(o,s),e.x=n*o.x+t.w*r.x+s.x,e.y=n*o.y+t.w*r.y+s.y,e.z=n*o.z+t.w*r.z+s.z,e},i.prototype.inverse=function(t){var e=this.x,n=this.y,r=this.z,o=this.w;t=t||new i,this.conjugate(t);var s=1/(e*e+n*n+r*r+o*o);return t.x*=s,t.y*=s,t.z*=s,t.w*=s,t},i.prototype.conjugate=function(t){return(t=t||new i).x=-this.x,t.y=-this.y,t.z=-this.z,t.w=this.w,t},i.prototype.normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);0===t?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=t=1/t,this.y*=t,this.z*=t,this.w*=t)},i.prototype.normalizeFast=function(){var t=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;0===t?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=t,this.y*=t,this.z*=t,this.w*=t)},i.prototype.vmult=function(t,e){e=e||new r;var n=t.x,i=t.y,o=t.z,s=this.x,a=this.y,l=this.z,u=this.w,c=u*n+a*o-l*i,h=u*i+l*n-s*o,d=u*o+s*i-a*n,p=-s*n-a*i-l*o;return e.x=c*u+p*-s+h*-l-d*-a,e.y=h*u+p*-a+d*-s-c*-l,e.z=d*u+p*-l+c*-a-h*-s,e},i.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},i.prototype.toEuler=function(t,e){var n,r,i,o=this.x,s=this.y,a=this.z,l=this.w;switch(e=e||"YZX"){case"YZX":var u=o*s+a*l;if(u>.499&&(n=2*Math.atan2(o,l),r=Math.PI/2,i=0),u<-.499&&(n=-2*Math.atan2(o,l),r=-Math.PI/2,i=0),isNaN(n)){var c=o*o,h=a*a;n=Math.atan2(2*s*l-2*o*a,1-s*s*2-2*h),r=Math.asin(2*u),i=Math.atan2(2*o*l-2*s*a,1-2*c-2*h)}break;default:throw new Error("Euler order "+e+" not supported yet.")}t.y=n,t.z=r,t.x=i},i.prototype.setFromEuler=function(t,e,n,r){r=r||"XYZ";var i=Math.cos(t/2),o=Math.cos(e/2),s=Math.cos(n/2),a=Math.sin(t/2),l=Math.sin(e/2),u=Math.sin(n/2);return"XYZ"===r?(this.x=a*o*s+i*l*u,this.y=i*l*s-a*o*u,this.z=i*o*u+a*l*s,this.w=i*o*s-a*l*u):"YXZ"===r?(this.x=a*o*s+i*l*u,this.y=i*l*s-a*o*u,this.z=i*o*u-a*l*s,this.w=i*o*s+a*l*u):"ZXY"===r?(this.x=a*o*s-i*l*u,this.y=i*l*s+a*o*u,this.z=i*o*u+a*l*s,this.w=i*o*s-a*l*u):"ZYX"===r?(this.x=a*o*s-i*l*u,this.y=i*l*s+a*o*u,this.z=i*o*u-a*l*s,this.w=i*o*s+a*l*u):"YZX"===r?(this.x=a*o*s+i*l*u,this.y=i*l*s+a*o*u,this.z=i*o*u-a*l*s,this.w=i*o*s-a*l*u):"XZY"===r&&(this.x=a*o*s-i*l*u,this.y=i*l*s-a*o*u,this.z=i*o*u+a*l*s,this.w=i*o*s+a*l*u),this},i.prototype.clone=function(){return new i(this.x,this.y,this.z,this.w)}},{"./Vec3":27}],26:[function(t,e,n){var r=t("./Vec3"),i=t("./Quaternion");function o(){this.position=new r,this.quaternion=new i}e.exports=o;var s=new i;o.pointToLocalFrame=function(t,e,n,i){return i=i||new r,n.vsub(t,i),e.conjugate(s),s.vmult(i,i),i},o.pointToWorldFrame=function(t,e,n,i){return i=i||new r,e.vmult(n,i),i.vadd(t,i),i},o.prototype.vectorToWorldFrame=function(t,e){return e=e||new r,this.quaternion.vmult(t,e),e},o.vectorToLocalFrame=function(t,e,n,i){return i=i||new r,e.w*=-1,e.vmult(n,i),e.w*=-1,i}},{"./Quaternion":25,"./Vec3":27}],27:[function(t,e,n){e.exports=i;var r=t("./Mat3");function i(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}i.ZERO=new i(0,0,0),i.prototype.cross=function(t,e){var n=t.x,r=t.y,o=t.z,s=this.x,a=this.y,l=this.z;return(e=e||new i).x=a*o-l*r,e.y=l*n-s*o,e.z=s*r-a*n,e},i.prototype.set=function(t,e,n){return this.x=t,this.y=e,this.z=n,this},i.prototype.setZero=function(){this.x=this.y=this.z=0},i.prototype.vadd=function(t,e){if(!e)return new i(this.x+t.x,this.y+t.y,this.z+t.z);e.x=t.x+this.x,e.y=t.y+this.y,e.z=t.z+this.z},i.prototype.vsub=function(t,e){if(!e)return new i(this.x-t.x,this.y-t.y,this.z-t.z);e.x=this.x-t.x,e.y=this.y-t.y,e.z=this.z-t.z},i.prototype.crossmat=function(){return new r([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])},i.prototype.normalize=function(){var t=this.x,e=this.y,n=this.z,r=Math.sqrt(t*t+e*e+n*n);if(r>0){var i=1/r;this.x*=i,this.y*=i,this.z*=i}else this.x=0,this.y=0,this.z=0;return r},i.prototype.unit=function(t){t=t||new i;var e=this.x,n=this.y,r=this.z,o=Math.sqrt(e*e+n*n+r*r);return o>0?(t.x=e*(o=1/o),t.y=n*o,t.z=r*o):(t.x=1,t.y=0,t.z=0),t},i.prototype.norm=function(){var t=this.x,e=this.y,n=this.z;return Math.sqrt(t*t+e*e+n*n)},i.prototype.norm2=function(){return this.dot(this)},i.prototype.distanceTo=function(t){var e=this.x,n=this.y,r=this.z,i=t.x,o=t.y,s=t.z;return Math.sqrt((i-e)*(i-e)+(o-n)*(o-n)+(s-r)*(s-r))},i.prototype.scale=i.prototype.mult=function(t,e){e=e||new i;var n=this.y,r=this.z;return e.x=t*this.x,e.y=t*n,e.z=t*r,e},i.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},i.prototype.isZero=function(){return 0===this.x&&0===this.y&&0===this.z},i.prototype.negate=function(t){return(t=t||new i).x=-this.x,t.y=-this.y,t.z=-this.z,t};var o=new i,s=new i;i.prototype.tangents=function(t,e){var n=this.norm();if(n>0){var r=o,i=1/n;r.set(this.x*i,this.y*i,this.z*i);var a=s;Math.abs(r.x)<.9?(a.set(1,0,0),r.cross(a,t)):(a.set(0,1,0),r.cross(a,t)),r.cross(t,e)}else t.set(1,0,0).normalize(),e.set(0,1,0).normalize()},i.prototype.toString=function(){return this.x+","+this.y+","+this.z},i.prototype.toArray=function(){return[this.x,this.y,this.z]},i.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},i.prototype.lerp=function(t,e,n){var r=this.x,i=this.y,o=this.z;n.x=r+(t.x-r)*e,n.y=i+(t.y-i)*e,n.z=o+(t.z-o)*e},i.prototype.almostEquals=function(t,e){return void 0===e&&(e=1e-6),!(Math.abs(this.x-t.x)>e||Math.abs(this.y-t.y)>e||Math.abs(this.z-t.z)>e)},i.prototype.almostZero=function(t){return void 0===t&&(t=1e-6),!(Math.abs(this.x)>t||Math.abs(this.y)>t||Math.abs(this.z)>t)};var a=new i;i.prototype.isAntiparallelTo=function(t,e){return this.negate(a),a.almostEquals(t,e)},i.prototype.clone=function(){return new i(this.x,this.y,this.z)}},{"./Mat3":24}],28:[function(t,e,n){e.exports=u;var r=t("../utils/EventTarget"),i=(t("../shapes/Shape"),t("../math/Vec3")),o=t("../math/Mat3"),s=t("../math/Quaternion"),a=(t("../material/Material"),t("../collision/AABB")),l=t("../shapes/Box");function u(t){t=t||{},r.apply(this),this.id=u.idCounter++,this.world=null,this.preStep=null,this.postStep=null,this.vlambda=new i,this.collisionFilterGroup=1,this.collisionFilterMask=1,this.collisionResponse=!0,this.position=new i,t.position&&this.position.copy(t.position),this.previousPosition=new i,this.initPosition=new i,this.velocity=new i,t.velocity&&this.velocity.copy(t.velocity),this.initVelocity=new i,this.force=new i;var e="number"==typeof t.mass?t.mass:0;this.mass=e,this.invMass=e>0?1/e:0,this.material=t.material||null,this.linearDamping="number"==typeof t.linearDamping?t.linearDamping:.01,this.type=e<=0?u.STATIC:u.DYNAMIC,typeof t.type==typeof u.STATIC&&(this.type=t.type),this.allowSleep=!0,this.sleepState=0,this.sleepSpeedLimit=.1,this.sleepTimeLimit=1,this.timeLastSleepy=0,this._wakeUpAfterNarrowphase=!1,this.torque=new i,this.quaternion=new s,t.quaternion&&this.quaternion.copy(t.quaternion),this.initQuaternion=new s,this.angularVelocity=new i,t.angularVelocity&&this.angularVelocity.copy(t.angularVelocity),this.initAngularVelocity=new i,this.interpolatedPosition=new i,this.interpolatedQuaternion=new s,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new i,this.invInertia=new i,this.invInertiaWorld=new o,this.invMassSolve=0,this.invInertiaSolve=new i,this.invInertiaWorldSolve=new o,this.fixedRotation=!1,this.angularDamping=.01,this.aabb=new a,this.aabbNeedsUpdate=!0,this.wlambda=new i,this.updateMassProperties()}(u.prototype=new r).constructor=u,u.DYNAMIC=1,u.STATIC=2,u.KINEMATIC=4,u.AWAKE=0,u.SLEEPY=1,u.SLEEPING=2,u.idCounter=0,u.prototype.wakeUp=function(){var t=this.sleepState;this.sleepState=0,t===u.SLEEPING&&this.dispatchEvent({type:"wakeup"})},u.prototype.sleep=function(){this.sleepState=u.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0)},u.sleepyEvent={type:"sleepy"},u.sleepEvent={type:"sleep"},u.prototype.sleepTick=function(t){if(this.allowSleep){var e=this.sleepState,n=this.velocity.norm2()+this.angularVelocity.norm2(),r=Math.pow(this.sleepSpeedLimit,2);e===u.AWAKE&&n<r?(this.sleepState=u.SLEEPY,this.timeLastSleepy=t,this.dispatchEvent(u.sleepyEvent)):e===u.SLEEPY&&n>r?this.wakeUp():e===u.SLEEPY&&t-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(u.sleepEvent))}},u.prototype.updateSolveMassProperties=function(){this.sleepState===u.SLEEPING||this.type===u.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))},u.prototype.pointToLocalFrame=function(t,e){return e=e||new i,t.vsub(this.position,e),this.quaternion.conjugate().vmult(e,e),e},u.prototype.pointToWorldFrame=function(t,e){return e=e||new i,this.quaternion.vmult(t,e),e.vadd(this.position,e),e},u.prototype.vectorToWorldFrame=function(t,e){return e=e||new i,this.quaternion.vmult(t,e),e};var c=new i,h=new s;u.prototype.addShape=function(t,e,n){var r=new i,o=new s;e&&r.copy(e),n&&o.copy(n),this.shapes.push(t),this.shapeOffsets.push(r),this.shapeOrientations.push(o),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0},u.prototype.updateBoundingRadius=function(){for(var t=this.shapes,e=this.shapeOffsets,n=t.length,r=0,i=0;i!==n;i++){var o=t[i];o.updateBoundingSphereRadius();var s=e[i].norm(),a=o.boundingSphereRadius;s+a>r&&(r=s+a)}this.boundingRadius=r};var d=new a;u.prototype.computeAABB=function(){for(var t=this.shapes,e=this.shapeOffsets,n=this.shapeOrientations,r=t.length,i=c,o=h,s=this.quaternion,a=this.aabb,l=d,u=0;u!==r;u++){var p=t[u];n[u].mult(s,o),o.vmult(e[u],i),i.vadd(this.position,i),p.calculateWorldAABB(i,o,l.lowerBound,l.upperBound),0===u?a.copy(l):a.extend(l)}this.aabbNeedsUpdate=!1};var p=new o,f=new o;new o,u.prototype.updateInertiaWorld=function(t){var e=this.invInertia;if(e.x!==e.y||e.y!==e.z||t){var n=p,r=f;n.setRotationFromQuaternion(this.quaternion),n.transpose(r),n.scale(e,n),n.mmult(r,this.invInertiaWorld)}};var m=new i,g=new i;u.prototype.applyForce=function(t,e){if(this.type===u.DYNAMIC){var n=m;e.vsub(this.position,n);var r=g;n.cross(t,r),this.force.vadd(t,this.force),this.torque.vadd(r,this.torque)}};var v=new i,y=new i,w=new i;u.prototype.applyImpulse=function(t,e){if(this.type===u.DYNAMIC){var n=v;e.vsub(this.position,n);var r=y;r.copy(t),r.mult(this.invMass,r),this.velocity.vadd(r,this.velocity);var i=w;n.cross(t,i),this.invInertiaWorld.vmult(i,i),this.angularVelocity.vadd(i,this.angularVelocity)}},u.prototype.updateMassProperties=function(){new i,this.invMass=this.mass>0?1/this.mass:0;var t=this.inertia,e=this.fixedRotation;this.computeAABB(),l.calculateInertia(new i((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),this.mass,t),this.invInertia.set(t.x>0&&!e?1/t.x:0,t.y>0&&!e?1/t.y:0,t.z>0&&!e?1/t.z:0),this.updateInertiaWorld(!0)},u.prototype.getVelocityAtWorldPoint=function(t,e){var n=new i;return t.vsub(this.position,n),this.angularVelocity.cross(n,e),this.velocity.vadd(e,e),e}},{"../collision/AABB":3,"../material/Material":22,"../math/Mat3":24,"../math/Quaternion":25,"../math/Vec3":27,"../shapes/Box":34,"../shapes/Shape":40,"../utils/EventTarget":45}],29:[function(t,e,n){t("./Body");var r=t("../math/Vec3"),i=t("../math/Quaternion"),o=(t("../collision/RaycastResult"),t("../collision/Ray")),s=t("../objects/WheelInfo");function a(t){this.chassisBody=t.chassisBody,this.wheelInfos=[],this.sliding=!1,this.world=null,this.indexRightAxis=void 0!==t.indexRightAxis?t.indexRightAxis:1,this.indexForwardAxis=void 0!==t.indexForwardAxis?t.indexForwardAxis:0,this.indexUpAxis=void 0!==t.indexUpAxis?t.indexUpAxis:2}e.exports=a,new r,new r,new r;var l=new r,u=new r,c=new r;new o,a.prototype.addWheel=function(t){var e=new s(t=t||{}),n=this.wheelInfos.length;return this.wheelInfos.push(e),n},a.prototype.setSteeringValue=function(t,e){this.wheelInfos[e].steering=t},new r,a.prototype.applyEngineForce=function(t,e){this.wheelInfos[e].engineForce=t},a.prototype.setBrake=function(t,e){this.wheelInfos[e].brake=t},a.prototype.addToWorld=function(t){t.add(this.chassisBody);var e=this;t.addEventListener("preStep",function(){e.updateVehicle(t.dt)}),this.world=t},a.prototype.getVehicleAxisWorld=function(t,e){e.set(0===t?1:0,1===t?1:0,2===t?1:0),this.chassisBody.vectorToWorldFrame(e,e)},a.prototype.updateVehicle=function(t){for(var e=this.wheelInfos,n=e.length,i=this.chassisBody,o=0;o<n;o++)this.updateWheelTransform(o,!1);this.currentVehicleSpeedKmHour=3.6*i.velocity.norm();var s=new r;for(this.getVehicleAxisWorld(this.indexForwardAxis,s),s.dot(i.velocity)<0&&(this.currentVehicleSpeedKmHour*=-1),o=0;o<n;o++)this.castRay(e[o]);this.updateSuspension(t);var a=new r,l=new r;for(o=0;o<n;o++){var u=(p=e[o]).suspensionForce;u>p.maxSuspensionForce&&(u=p.maxSuspensionForce),p.raycastResult.hitNormalWorld.scale(u*t,a),p.raycastResult.hitPointWorld.vsub(i.position,l),i.applyImpulse(a,p.raycastResult.hitPointWorld)}this.updateFriction(t);var c=new r,h=new r,d=new r;for(o=0;o<n;o++){var p;i.getVelocityAtWorldPoint((p=e[o]).chassisConnectionPointWorld,d);var f=1;switch(this.indexUpAxis){case 1:f=-1}if(p.isInContact){this.getVehicleAxisWorld(this.indexForwardAxis,h);var m=h.dot(p.raycastResult.hitNormalWorld);p.raycastResult.hitNormalWorld.scale(m,c),h.vsub(c,h);var g=h.dot(d);p.deltaRotation=f*g*t/p.radius}!p.sliding&&p.isInContact||0===p.engineForce||!p.useCustomSlidingRotationalSpeed||(p.deltaRotation=(p.engineForce>0?1:-1)*p.customSlidingRotationalSpeed*t),Math.abs(p.brake)>Math.abs(p.engineForce)&&(p.deltaRotation=0),p.rotation+=p.deltaRotation,p.deltaRotation*=.99}},a.prototype.updateSuspension=function(t){for(var e=this.chassisBody.mass,n=this.wheelInfos,r=n.length,i=0;i<r;i++){var o=n[i];if(o.isInContact){var s;s=o.suspensionStiffness*(o.suspensionRestLength-o.suspensionLength)*o.clippedInvContactDotSuspension;var a=o.suspensionRelativeVelocity;o.suspensionForce=(s-=(a<0?o.dampingCompression:o.dampingRelaxation)*a)*e,o.suspensionForce<0&&(o.suspensionForce=0)}else o.suspensionForce=0}},a.prototype.removeFromWorld=function(t){t.remove(this.chassisBody),t.removeEventListener("preStep",this.updateVehicle),this.world=null};var h=new r,d=new r;a.prototype.castRay=function(t){var e=h,n=d;this.updateWheelTransformWorld(t);var i=this.chassisBody,o=-1;t.directionWorld.scale(t.suspensionRestLength+t.radius,e);var s=t.chassisConnectionPointWorld;s.vadd(e,n);var a=t.raycastResult;a.reset();var l=i.collisionResponse;i.collisionResponse=!1,this.world.rayTest(s,n,a),i.collisionResponse=l;var u=a.body;if(t.raycastResult.groundObject=0,u){o=a.distance,t.raycastResult.hitNormalWorld=a.hitNormalWorld,t.isInContact=!0,t.suspensionLength=a.distance-t.radius;var c=t.suspensionRestLength-t.maxSuspensionTravel,p=t.suspensionRestLength+t.maxSuspensionTravel;t.suspensionLength<c&&(t.suspensionLength=c),t.suspensionLength>p&&(t.suspensionLength=p,t.raycastResult.reset());var f=t.raycastResult.hitNormalWorld.dot(t.directionWorld),m=new r;i.getVelocityAtWorldPoint(t.raycastResult.hitPointWorld,m);var g=t.raycastResult.hitNormalWorld.dot(m);if(f>=-.1)t.suspensionRelativeVelocity=0,t.clippedInvContactDotSuspension=10;else{var v=-1/f;t.suspensionRelativeVelocity=g*v,t.clippedInvContactDotSuspension=v}}else t.suspensionLength=t.suspensionRestLength+0*t.maxSuspensionTravel,t.suspensionRelativeVelocity=0,t.directionWorld.scale(-1,t.raycastResult.hitNormalWorld),t.clippedInvContactDotSuspension=1;return o},a.prototype.updateWheelTransformWorld=function(t){t.isInContact=!1;var e=this.chassisBody;e.pointToWorldFrame(t.chassisConnectionPointLocal,t.chassisConnectionPointWorld),e.vectorToWorldFrame(t.directionLocal,t.directionWorld),e.vectorToWorldFrame(t.axleLocal,t.axleWorld)},a.prototype.updateWheelTransform=function(t){var e=l,n=u,r=c,o=this.wheelInfos[t];this.updateWheelTransformWorld(o),o.directionLocal.scale(-1,e),n.copy(o.axleLocal),e.cross(n,r),r.normalize(),n.normalize();var s=o.steering,a=new i;a.setFromAxisAngle(e,s);var h=new i;h.setFromAxisAngle(n,o.rotation);var d=o.worldTransform.quaternion;this.chassisBody.quaternion.mult(a,d),d.mult(h,d),d.normalize();var p=o.worldTransform.position;p.copy(o.directionWorld),p.scale(o.suspensionLength,p),p.vadd(o.chassisConnectionPointWorld,p)};var p=[new r(1,0,0),new r(0,1,0),new r(0,0,1)];a.prototype.getWheelTransformWorld=function(t){return this.wheelInfos[t].worldTransform};var f=new r,m=[],g=[];a.prototype.updateFriction=function(t){for(var e=f,n=this.wheelInfos,i=n.length,o=this.chassisBody,s=g,a=m,l=0;l<i;l++){var u=(T=n[l]).raycastResult.body;T.sideImpulse=0,T.forwardImpulse=0,s[l]||(s[l]=new r),a[l]||(a[l]=new r)}for(l=0;l<i;l++)if(u=(T=n[l]).raycastResult.body){var c=a[l];this.getWheelTransformWorld(l).vectorToWorldFrame(p[this.indexRightAxis],c);var h=T.raycastResult.hitNormalWorld,d=c.dot(h);h.scale(d,e),c.vsub(e,c),c.normalize(),h.cross(c,s[l]),s[l].normalize(),T.sideImpulse=R(o,T.raycastResult.hitPointWorld,u,T.raycastResult.hitPointWorld,c),T.sideImpulse*=1}for(this.sliding=!1,l=0;l<i;l++){u=(T=n[l]).raycastResult.body;var v=0;if(T.slipInfo=1,u){var y=T.brake?T.brake:0;v=b(o,u,T.raycastResult.hitPointWorld,s[l],y);var w=y/(v+=T.engineForce*t);T.slipInfo*=w}if(T.forwardImpulse=0,T.skidInfo=1,u){T.skidInfo=1;var x=T.suspensionForce*t*T.frictionSlip,_=x*x;T.forwardImpulse=v;var E=.5*T.forwardImpulse,S=1*T.sideImpulse,M=E*E+S*S;T.sliding=!1,M>_&&(this.sliding=!0,T.sliding=!0,w=x/Math.sqrt(M),T.skidInfo*=w)}}if(this.sliding)for(l=0;l<i;l++)0!==(T=n[l]).sideImpulse&&T.skidInfo<1&&(T.forwardImpulse*=T.skidInfo,T.sideImpulse*=T.skidInfo);for(l=0;l<i;l++){var T=n[l],C=new r;if(C.copy(T.raycastResult.hitPointWorld),0!==T.forwardImpulse){var A=new r;s[l].scale(T.forwardImpulse,A),o.applyImpulse(A,C)}if(0!==T.sideImpulse){u=T.raycastResult.body;var P=new r;P.copy(T.raycastResult.hitPointWorld);var L=new r;a[l].scale(T.sideImpulse,L),o.pointToLocalFrame(C,C),C["xyz"[this.indexUpAxis]]*=T.rollInfluence,o.pointToWorldFrame(C,C),o.applyImpulse(L,C),L.scale(-1,L),u.applyImpulse(L,P)}}};var v=new r,y=new r,w=new r;function b(t,e,n,r,i){var o=0,s=n,a=v,l=y,u=w;return t.getVelocityAtWorldPoint(s,a),e.getVelocityAtWorldPoint(s,l),a.vsub(l,u),i<(o=-r.dot(u)*(1/(M(t,n,r)+M(e,n,r))))&&(o=i),o<-i&&(o=-i),o}var x=new r,_=new r,E=new r,S=new r;function M(t,e,n){var r=x,i=_,o=E,s=S;return e.vsub(t.position,r),r.cross(n,i),t.invInertiaWorld.vmult(i,s),s.cross(r,o),t.invMass+n.dot(o)}var T=new r,C=new r,A=new r;function R(t,e,n,r,i,o){if(i.norm2()>1.1)return 0;var s=T,a=C,l=A;return t.getVelocityAtWorldPoint(e,s),n.getVelocityAtWorldPoint(r,a),s.vsub(a,l),-.2*i.dot(l)*(1/(t.invMass+n.invMass))}},{"../collision/Ray":9,"../collision/RaycastResult":10,"../math/Quaternion":25,"../math/Vec3":27,"../objects/WheelInfo":33,"./Body":28}],30:[function(t,e,n){var r=t("./Body"),i=t("../shapes/Sphere"),o=t("../shapes/Box"),s=t("../math/Vec3"),a=t("../constraints/HingeConstraint");function l(t){if(this.wheelBodies=[],this.coordinateSystem=void 0===t.coordinateSystem?new s(1,2,3):t.coordinateSystem.clone(),this.chassisBody=t.chassisBody,!this.chassisBody){var e=new o(new s(5,2,.5));this.chassisBody=new r(1,e)}this.constraints=[],this.wheelAxes=[],this.wheelForces=[]}e.exports=l,l.prototype.addWheel=function(t){var e=(t=t||{}).body;e||(e=new r(1,new i(1.2))),this.wheelBodies.push(e),this.wheelForces.push(0),new s;var n=void 0!==t.position?t.position.clone():new s,o=new s;this.chassisBody.pointToWorldFrame(n,o),e.position.set(o.x,o.y,o.z);var l=void 0!==t.axis?t.axis.clone():new s(0,1,0);this.wheelAxes.push(l);var u=new a(this.chassisBody,e,{pivotA:n,axisA:l,pivotB:s.ZERO,axisB:l,collideConnected:!1});return this.constraints.push(u),this.wheelBodies.length-1},l.prototype.setSteeringValue=function(t,e){var n=this.wheelAxes[e],r=Math.cos(t),i=Math.sin(t),o=n.x,s=n.y;this.constraints[e].axisA.set(r*o-i*s,i*o+r*s,0)},l.prototype.setMotorSpeed=function(t,e){var n=this.constraints[e];n.enableMotor(),n.motorTargetVelocity=t},l.prototype.disableMotor=function(t){this.constraints[t].disableMotor()};var u=new s;l.prototype.setWheelForce=function(t,e){this.wheelForces[e]=t},l.prototype.applyWheelForce=function(t,e){var n=this.wheelBodies[e],r=n.torque;this.wheelAxes[e].scale(t,u),n.vectorToWorldFrame(u,u),r.vadd(u,r)},l.prototype.addToWorld=function(t){for(var e=this.constraints,n=this.wheelBodies.concat([this.chassisBody]),r=0;r<n.length;r++)t.add(n[r]);for(r=0;r<e.length;r++)t.addConstraint(e[r]);t.addEventListener("preStep",this._update.bind(this))},l.prototype._update=function(){for(var t=this.wheelForces,e=0;e<t.length;e++)this.applyWheelForce(t[e],e)},l.prototype.removeFromWorld=function(t){for(var e=this.constraints,n=this.wheelBodies.concat([this.chassisBody]),r=0;r<n.length;r++)t.remove(n[r]);for(r=0;r<e.length;r++)t.removeConstraint(e[r])};var c=new s;l.prototype.getWheelSpeed=function(t){var e=this.wheelBodies[t].angularVelocity;return this.chassisBody.vectorToWorldFrame(this.wheelAxes[t],c),e.dot(c)}},{"../constraints/HingeConstraint":14,"../math/Vec3":27,"../shapes/Box":34,"../shapes/Sphere":41,"./Body":28}],31:[function(t,e,n){e.exports=i,t("../shapes/Shape");var r=t("../math/Vec3");function i(){this.particles=[],this.density=1,this.smoothingRadius=1,this.speedOfSound=1,this.viscosity=.01,this.eps=1e-6,this.pressures=[],this.densities=[],this.neighbors=[]}t("../math/Quaternion"),t("../shapes/Particle"),t("../objects/Body"),t("../material/Material"),i.prototype.add=function(t){this.particles.push(t),this.neighbors.length<this.particles.length&&this.neighbors.push([])},i.prototype.remove=function(t){var e=this.particles.indexOf(t);-1!==e&&(this.particles.splice(e,1),this.neighbors.length>this.particles.length&&this.neighbors.pop())};var o=new r;i.prototype.getNeighbors=function(t,e){for(var n=this.particles.length,r=t.id,i=this.smoothingRadius*this.smoothingRadius,s=o,a=0;a!==n;a++){var l=this.particles[a];l.position.vsub(t.position,s),r!==l.id&&s.norm2()<i&&e.push(l)}};var s=new r,a=new r,l=new r,u=new r,c=new r,h=new r;i.prototype.update=function(){for(var t=this.particles.length,e=s,n=this.speedOfSound,r=this.eps,i=0;i!==t;i++){var o=this.particles[i];(S=this.neighbors[i]).length=0,this.getNeighbors(o,S),S.push(this.particles[i]);for(var d=S.length,p=0,f=0;f!==d;f++){o.position.vsub(S[f].position,e);var m=e.norm(),g=this.w(m);p+=S[f].mass*g}this.densities[i]=p,this.pressures[i]=n*n*(this.densities[i]-this.density)}var v=a,y=l,w=u,b=c,x=h;for(i=0;i!==t;i++){var _,E,S,M=this.particles[i];for(v.set(0,0,0),y.set(0,0,0),d=(S=this.neighbors[i]).length,f=0;f!==d;f++){var T=S[f];M.position.vsub(T.position,b);var C=b.norm();_=-T.mass*(this.pressures[i]/(this.densities[i]*this.densities[i]+r)+this.pressures[f]/(this.densities[f]*this.densities[f]+r)),this.gradw(b,w),w.mult(_,w),v.vadd(w,v),T.velocity.vsub(M.velocity,x),x.mult(1/(1e-4+this.densities[i]*this.densities[f])*this.viscosity*T.mass,x),E=this.nablaw(C),x.mult(E,x),y.vadd(x,y)}y.mult(M.mass,y),v.mult(M.mass,v),M.force.vadd(y,M.force),M.force.vadd(v,M.force)}},i.prototype.w=function(t){var e=this.smoothingRadius;return 315/(64*Math.PI*Math.pow(e,9))*Math.pow(e*e-t*t,3)},i.prototype.gradw=function(t,e){var n=t.norm(),r=this.smoothingRadius;t.mult(945/(32*Math.PI*Math.pow(r,9))*Math.pow(r*r-n*n,2),e)},i.prototype.nablaw=function(t){var e=this.smoothingRadius;return 945/(32*Math.PI*Math.pow(e,9))*(e*e-t*t)*(7*t*t-3*e*e)}},{"../material/Material":22,"../math/Quaternion":25,"../math/Vec3":27,"../objects/Body":28,"../shapes/Particle":38,"../shapes/Shape":40}],32:[function(t,e,n){var r=t("../math/Vec3");function i(t,e,n){this.restLength="number"==typeof(n=n||{}).restLength?n.restLength:1,this.stiffness=n.stiffness||100,this.damping=n.damping||1,this.bodyA=t,this.bodyB=e,this.localAnchorA=new r,this.localAnchorB=new r,n.localAnchorA&&this.localAnchorA.copy(n.localAnchorA),n.localAnchorB&&this.localAnchorB.copy(n.localAnchorB),n.worldAnchorA&&this.setWorldAnchorA(n.worldAnchorA),n.worldAnchorB&&this.setWorldAnchorB(n.worldAnchorB)}e.exports=i,i.prototype.setWorldAnchorA=function(t){this.bodyA.pointToLocalFrame(t,this.localAnchorA)},i.prototype.setWorldAnchorB=function(t){this.bodyB.pointToLocalFrame(t,this.localAnchorB)},i.prototype.getWorldAnchorA=function(t){this.bodyA.pointToWorldFrame(this.localAnchorA,t)},i.prototype.getWorldAnchorB=function(t){this.bodyB.pointToWorldFrame(this.localAnchorB,t)};var o=new r,s=new r,a=new r,l=new r,u=new r,c=new r,h=new r,d=new r,p=new r,f=new r,m=new r;i.prototype.applyForce=function(){var t=this.stiffness,e=this.damping,n=this.restLength,r=this.bodyA,i=this.bodyB,g=o,v=s,y=a,w=l,b=m,x=u,_=c,E=h,S=d,M=p,T=f;this.getWorldAnchorA(x),this.getWorldAnchorB(_),x.vsub(r.position,E),_.vsub(i.position,S),_.vsub(x,g);var C=g.norm();v.copy(g),v.normalize(),i.velocity.vsub(r.velocity,y),i.angularVelocity.cross(S,b),y.vadd(b,y),r.angularVelocity.cross(E,b),y.vsub(b,y),v.mult(-t*(C-n)-e*y.dot(v),w),r.force.vsub(w,r.force),i.force.vadd(w,i.force),E.cross(w,M),S.cross(w,T),r.torque.vsub(M,r.torque),i.torque.vadd(T,i.torque)}},{"../math/Vec3":27}],33:[function(t,e,n){var r=t("../math/Vec3"),i=t("../math/Transform"),o=t("../collision/RaycastResult"),s=t("../utils/Utils");function a(t){t=s.defaults(t,{chassisConnectionPointLocal:new r,chassisConnectionPointWorld:new r,directionLocal:new r,directionWorld:new r,axleLocal:new r,axleWorld:new r,suspensionRestLength:1,suspensionMaxLength:2,radius:1,suspensionStiffness:100,dampingCompression:10,dampingRelaxation:10,frictionSlip:1e4,steering:0,rotation:0,deltaRotation:0,rollInfluence:.01,maxSuspensionForce:Number.MAX_VALUE,isFrontWheel:!0,clippedInvContactDotSuspension:1,suspensionRelativeVelocity:0,suspensionForce:0,skidInfo:0,suspensionLength:0,maxSuspensionTravel:1,useCustomSlidingRotationalSpeed:!1,customSlidingRotationalSpeed:-.1}),this.maxSuspensionTravel=t.maxSuspensionTravel,this.customSlidingRotationalSpeed=t.customSlidingRotationalSpeed,this.useCustomSlidingRotationalSpeed=t.useCustomSlidingRotationalSpeed,this.sliding=!1,this.chassisConnectionPointLocal=t.chassisConnectionPointLocal.clone(),this.chassisConnectionPointWorld=t.chassisConnectionPointWorld.clone(),this.directionLocal=t.directionLocal.clone(),this.directionWorld=t.directionWorld.clone(),this.axleLocal=t.axleLocal.clone(),this.axleWorld=t.axleWorld.clone(),this.suspensionRestLength=t.suspensionRestLength,this.suspensionMaxLength=t.suspensionMaxLength,this.radius=t.radius,this.suspensionStiffness=t.suspensionStiffness,this.dampingCompression=t.dampingCompression,this.dampingRelaxation=t.dampingRelaxation,this.frictionSlip=t.frictionSlip,this.steering=0,this.rotation=0,this.deltaRotation=0,this.rollInfluence=t.rollInfluence,this.maxSuspensionForce=t.maxSuspensionForce,this.engineForce=0,this.brake=0,this.isFrontWheel=t.isFrontWheel,this.clippedInvContactDotSuspension=1,this.suspensionRelativeVelocity=0,this.suspensionForce=0,this.skidInfo=0,this.suspensionLength=0,this.sideImpulse=0,this.forwardImpulse=0,this.raycastResult=new o,this.worldTransform=new i,this.isInContact=!1}e.exports=a;var l=new r,u=new r;l=new r,a.prototype.updateWheel=function(t){var e=this.raycastResult;if(this.isInContact){var n=e.hitNormalWorld.dot(e.directionWorld);e.hitPointWorld.vsub(t.position,u),t.getVelocityAtWorldPoint(u,l);var r=e.hitNormalWorld.dot(l);if(n>=-.1)this.suspensionRelativeVelocity=0,this.clippedInvContactDotSuspension=10;else{var i=-1/n;this.suspensionRelativeVelocity=r*i,this.clippedInvContactDotSuspension=i}}else e.suspensionLength=this.suspensionRestLength,this.suspensionRelativeVelocity=0,e.directionWorld.scale(-1,e.hitNormalWorld),this.clippedInvContactDotSuspension=1}},{"../collision/RaycastResult":10,"../math/Transform":26,"../math/Vec3":27,"../utils/Utils":48}],34:[function(t,e,n){e.exports=s;var r=t("./Shape"),i=t("../math/Vec3"),o=t("./ConvexPolyhedron");function s(t){r.call(this),this.type=r.types.BOX,this.halfExtents=t,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}(s.prototype=new r).constructor=s,s.prototype.updateConvexPolyhedronRepresentation=function(){var t=this.halfExtents.x,e=this.halfExtents.y,n=this.halfExtents.z,r=i,s=new o([new r(-t,-e,-n),new r(t,-e,-n),new r(t,e,-n),new r(-t,e,-n),new r(-t,-e,n),new r(t,-e,n),new r(t,e,n),new r(-t,e,n)],[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],[new r(0,0,-1),new r(0,0,1),new r(0,-1,0),new r(0,1,0),new r(-1,0,0),new r(1,0,0)]);this.convexPolyhedronRepresentation=s},s.prototype.calculateLocalInertia=function(t,e){return e=e||new i,s.calculateInertia(this.halfExtents,t,e),e},s.calculateInertia=function(t,e,n){var r=t;n.x=1/12*e*(2*r.y*2*r.y+2*r.z*2*r.z),n.y=1/12*e*(2*r.x*2*r.x+2*r.z*2*r.z),n.z=1/12*e*(2*r.y*2*r.y+2*r.x*2*r.x)},s.prototype.getSideNormals=function(t,e){var n=t,r=this.halfExtents;if(n[0].set(r.x,0,0),n[1].set(0,r.y,0),n[2].set(0,0,r.z),n[3].set(-r.x,0,0),n[4].set(0,-r.y,0),n[5].set(0,0,-r.z),void 0!==e)for(var i=0;i!==n.length;i++)e.vmult(n[i],n[i]);return n},s.prototype.volume=function(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z},s.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.halfExtents.norm()};var a=new i;new i,s.prototype.forEachWorldCorner=function(t,e,n){for(var r=this.halfExtents,i=[[r.x,r.y,r.z],[-r.x,r.y,r.z],[-r.x,-r.y,r.z],[-r.x,-r.y,-r.z],[r.x,-r.y,-r.z],[r.x,r.y,-r.z],[-r.x,r.y,-r.z],[r.x,-r.y,r.z]],o=0;o<i.length;o++)a.set(i[o][0],i[o][1],i[o][2]),e.vmult(a,a),t.vadd(a,a),n(a.x,a.y,a.z)};var l=[new i,new i,new i,new i,new i,new i,new i,new i];s.prototype.calculateWorldAABB=function(t,e,n,r){var i=this.halfExtents;l[0].set(i.x,i.y,i.z),l[1].set(-i.x,i.y,i.z),l[2].set(-i.x,-i.y,i.z),l[3].set(-i.x,-i.y,-i.z),l[4].set(i.x,-i.y,-i.z),l[5].set(i.x,i.y,-i.z),l[6].set(-i.x,i.y,-i.z),l[7].set(i.x,-i.y,i.z),e.vmult(s=l[0],s),t.vadd(s,s),r.copy(s),n.copy(s);for(var o=1;o<8;o++){var s;e.vmult(s=l[o],s),t.vadd(s,s);var a=s.x,u=s.y,c=s.z;a>r.x&&(r.x=a),u>r.y&&(r.y=u),c>r.z&&(r.z=c),a<n.x&&(n.x=a),u<n.y&&(n.y=u),c<n.z&&(n.z=c)}}},{"../math/Vec3":27,"./ConvexPolyhedron":35,"./Shape":40}],35:[function(t,e,n){e.exports=a;var r=t("./Shape"),i=t("../math/Vec3"),o=t("../math/Quaternion"),s=t("../math/Transform");function a(t,e){r.call(this),this.type=r.types.CONVEXPOLYHEDRON,this.vertices=t||[],this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.faces=e||[],this.faceNormals=[],this.computeNormals(),this.worldFaceNormalsNeedsUpdate=!0,this.worldFaceNormals=[],this.uniqueEdges=[],this.computeEdges(),this.updateBoundingSphereRadius()}(a.prototype=new r).constructor=a,a.prototype.computeEdges=function(){var t=this.faces,e=this.vertices,n=e.length,r=this.uniqueEdges;r.length=0;for(var o=0;o<n;o++){if(!((p=e[o])instanceof i))throw"Argument 1 must be instance of Vec3";this.uniqueEdges.push(p)}for(var s=0;s<t.length;s++)for(var a=t[s],l=a.length,u=0;u<l;u++){var c=(u+1)%l,h=new i;e[a[u]].vsub(e[a[c]],h),h.normalize();for(var d=!1,p=0;p<r.length;p++)if(r[p].almostEquals(h)||r[p].almostEquals(h)){d=!0;break}d||r.push(h),h&&(h.face1=s)}},a.prototype.computeNormals=function(){this.faceNormals.length=this.faces.length;for(var t=0;t<this.faces.length;t++){for(var e=0;e<this.faces[t].length;e++)if(!this.vertices[this.faces[t][e]])throw new Error("Vertex "+this.faces[t][e]+" not found!");var n=this.faceNormals[t]||new i;if(this.getFaceNormal(t,n),n.negate(n),this.faceNormals[t]=n,n.dot(this.vertices[this.faces[t][0]])<0)for(console.error(".faceNormals["+t+"] = Vec3("+n.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule."),e=0;e<this.faces[t].length;e++)console.warn(".vertices["+this.faces[t][e]+"] = Vec3("+this.vertices[this.faces[t][e]].toString()+")")}};var l=new i,u=new i;a.computeNormal=function(t,e,n,r){e.vsub(t,u),n.vsub(e,l),l.cross(u,r),r.isZero()||r.normalize()},a.prototype.getFaceNormal=function(t,e){var n=this.faces[t];return a.computeNormal(this.vertices[n[0]],this.vertices[n[1]],this.vertices[n[2]],e)};var c=new i;a.prototype.clipAgainstHull=function(t,e,n,r,s,a,l,u,h){var d=c;if(!(t instanceof i))throw new Error("posA must be Vec3");if(!(e instanceof o))throw new Error("quatA must be Quaternion");for(var p=-1,f=-1/0,m=0;m<n.faces.length;m++){d.copy(n.faceNormals[m]),s.vmult(d,d);var g=d.dot(a);g>f&&(f=g,p=m)}for(var v=[],y=n.faces[p],w=y.length,b=0;b<w;b++){var x=n.vertices[y[b]],_=new i;_.copy(x),s.vmult(_,_),r.vadd(_,_),v.push(_)}p>=0&&this.clipFaceAgainstHull(a,t,e,v,l,u,h)};var h=new i,d=new i,p=new i,f=new i,m=new i,g=new i;a.prototype.findSeparatingAxis=function(t,e,n,r,i,o,s,a){for(var l=h,u=d,c=p,v=f,y=m,w=g,b=1/0,x=s?s.length:this.faces.length,_=0;_<x;_++){if(l.copy(this.faceNormals[s?s[_]:_]),n.vmult(l,l),!1===(S=this.testSepAxis(l,t,e,n,r,i)))return!1;S<b&&(b=S,o.copy(l))}var E=a?a.length:t.faces.length;for(_=0;_<E;_++){var S;if(u.copy(t.faceNormals[a?a[_]:_]),i.vmult(u,u),!1===(S=this.testSepAxis(u,t,e,n,r,i)))return!1;S<b&&(b=S,o.copy(u))}for(var M=0;M<this.uniqueEdges.length;M++){v.copy(this.uniqueEdges[M]),n.vmult(v,v);for(var T=0;T<t.uniqueEdges.length;T++)if(y.copy(t.uniqueEdges[T]),i.vmult(y,y),v.cross(y,w),!w.almostZero()){w.normalize();var C=this.testSepAxis(w,t,e,n,r,i);if(!1===C)return!1;C<b&&(b=C,o.copy(w))}}return r.vsub(e,c),c.dot(o)>0&&o.negate(o),!0},a.prototype.testSepAxis=function(t,e,n,r,i,o){var s=[],l=[];a.project(this,t,n,r,s),a.project(e,t,i,o,l);var u=s[0],c=s[1],h=l[0],d=l[1];if(u<d||h<c)return!1;var p=u-d,f=h-c;return p<f?p:f};var v=new i,y=new i;a.prototype.calculateLocalInertia=function(t,e){this.computeLocalAABB(v,y);var n=y.x-v.x,r=y.y-v.y,i=y.z-v.z;e.x=1/12*t*(2*r*2*r+2*i*2*i),e.y=1/12*t*(2*n*2*n+2*i*2*i),e.z=1/12*t*(2*r*2*r+2*n*2*n)},a.prototype.getPlaneConstantOfFace=function(t){return-this.faceNormals[t].dot(this.vertices[this.faces[t][0]])};var w=new i,b=new i,x=new i,_=new i,E=new i,S=new i,M=new i,T=new i;a.prototype.clipFaceAgainstHull=function(t,e,n,r,o,s,a){if(!(t instanceof i))throw new Error("sep normal must be vector");if(!(r instanceof Array))throw new Error("world verts must be array");var l=w,u=b,c=x,h=_,d=E,p=S,f=M,m=T;o=Number(o),s=Number(s);for(var g=r,v=[],y=-1,C=1/0,A=0;A<this.faces.length;A++){l.copy(this.faceNormals[A]),n.vmult(l,l);var R=l.dot(t);R<C&&(C=R,y=A)}if(y<0)console.log("--- did not find any closest face... ---");else{var P=this.faces[y];P.connectedFaces=[];for(var L=0;L<this.faces.length;L++)for(var I=0;I<this.faces[L].length;I++)-1!==P.indexOf(this.faces[L][I])&&L!==y&&-1===P.connectedFaces.indexOf(L)&&P.connectedFaces.push(L);for(var N=P.length,O=0;O<N;O++){var D=this.vertices[P[O]];D.vsub(this.vertices[P[(O+1)%N]],u),c.copy(u),n.vmult(c,c),e.vadd(c,c),h.copy(this.faceNormals[y]),n.vmult(h,h),e.vadd(h,h),c.cross(h,d),d.negate(d),p.copy(D),n.vmult(p,p),e.vadd(p,p),p.dot(d);var B=P.connectedFaces[O];f.copy(this.faceNormals[B]);var U=this.getPlaneConstantOfFace(B);m.copy(f),n.vmult(m,m);var z=U-m.dot(e);for(this.clipFaceAgainstPlane(g,v,m,z);g.length;)g.shift();for(;v.length;)g.push(v.shift())}for(f.copy(this.faceNormals[y]),U=this.getPlaneConstantOfFace(y),m.copy(f),n.vmult(m,m),z=U-m.dot(e),L=0;L<g.length;L++){var F=m.dot(g[L])+z;F<=o&&(console.log("clamped: depth="+F+" to minDist="+o),F=o),F<=s&&F<=0&&a.push({point:g[L],normal:m,depth:F})}}},a.prototype.clipFaceAgainstPlane=function(t,e,n,r){if(!(n instanceof i))throw new Error("planeNormal must be Vec3, "+n+" given");if(!(t instanceof Array))throw new Error("invertices must be Array, "+t+" given");if(!(e instanceof Array))throw new Error("outvertices must be Array, "+e+" given");var o,s,a=t.length;if(a<2)return e;var l=t[t.length-1],u=t[0];o=n.dot(l)+r;for(var c=0;c<a;c++){if(s=n.dot(u=t[c])+r,o<0)if(s<0)(h=new i).copy(u),e.push(h);else{var h=new i;l.lerp(u,o/(o-s),h),e.push(h)}else s<0&&(h=new i,l.lerp(u,o/(o-s),h),e.push(h),e.push(u));l=u,o=s}return e},a.prototype.computeWorldVertices=function(t,e){for(var n=this.vertices.length;this.worldVertices.length<n;)this.worldVertices.push(new i);for(var r=this.vertices,o=this.worldVertices,s=0;s!==n;s++)e.vmult(r[s],o[s]),t.vadd(o[s],o[s]);this.worldVerticesNeedsUpdate=!1},new i,a.prototype.computeLocalAABB=function(t,e){var n=this.vertices.length,r=this.vertices;t.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),e.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var i=0;i<n;i++){var o=r[i];o.x<t.x?t.x=o.x:o.x>e.x&&(e.x=o.x),o.y<t.y?t.y=o.y:o.y>e.y&&(e.y=o.y),o.z<t.z?t.z=o.z:o.z>e.z&&(e.z=o.z)}},a.prototype.computeWorldFaceNormals=function(t){for(var e=this.faceNormals.length;this.worldFaceNormals.length<e;)this.worldFaceNormals.push(new i);for(var n=this.faceNormals,r=this.worldFaceNormals,o=0;o!==e;o++)t.vmult(n[o],r[o]);this.worldFaceNormalsNeedsUpdate=!1},a.prototype.updateBoundingSphereRadius=function(){for(var t=0,e=this.vertices,n=0,r=e.length;n!==r;n++){var i=e[n].norm2();i>t&&(t=i)}this.boundingSphereRadius=Math.sqrt(t)};var C=new i;a.prototype.calculateWorldAABB=function(t,e,n,r){for(var i,o,s,a,l,u,c=this.vertices.length,h=this.vertices,d=0;d<c;d++)C.copy(h[d]),e.vmult(C,C),t.vadd(C,C),C.x<i||void 0===i?i=C.x:(C.x>a||void 0===a)&&(a=C.x),C.y<o||void 0===o?o=C.y:(C.y>l||void 0===l)&&(l=C.y),C.z<s||void 0===s?s=C.z:(C.z>u||void 0===u)&&(u=C.z);n.set(i,o,s),r.set(a,l,u)},a.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3},a.prototype.getAveragePointLocal=function(t){t=t||new i;for(var e=this.vertices.length,n=this.vertices,r=0;r<e;r++)t.vadd(n[r],t);return t.mult(1/e,t),t},a.prototype.transformAllPoints=function(t,e){var n=this.vertices.length,r=this.vertices;if(e){for(var i=0;i<n;i++)e.vmult(o=r[i],o);for(i=0;i<this.faceNormals.length;i++)e.vmult(o=this.faceNormals[i],o)}if(t)for(i=0;i<n;i++){var o;(o=r[i]).vadd(t,o)}};var A=new i,R=new i,P=new i;a.prototype.pointIsInside=function(t){var e=this.vertices.length,n=this.vertices,r=this.faces,i=this.faceNormals,o=this.faces.length,s=A;this.getAveragePointLocal(s);for(var a=0;a<o;a++){e=i[a];var l=n[r[a][0]],u=R;t.vsub(l,u);var c=e.dot(u),h=P;s.vsub(l,h);var d=e.dot(h);if(c<0&&d>0||c>0&&d<0)return!1}return-1},new i;var L=new i,I=new i;a.project=function(t,e,n,r,i){var o=t.vertices.length,a=L,l=0,u=0,c=I,h=t.vertices;c.setZero(),s.vectorToLocalFrame(n,r,e,a),s.pointToLocalFrame(n,r,c,c);var d=c.dot(a);u=l=h[0].dot(a);for(var p=1;p<o;p++){var f=h[p].dot(a);f>l&&(l=f),f<u&&(u=f)}if((u-=d)>(l-=d)){var m=u;u=l,l=m}i[0]=l,i[1]=u}},{"../math/Quaternion":25,"../math/Transform":26,"../math/Vec3":27,"./Shape":40}],36:[function(t,e,n){e.exports=s;var r=t("./Shape"),i=t("../math/Vec3"),o=(t("../math/Quaternion"),t("./ConvexPolyhedron"));function s(t,e,n,s){var a=s,l=[],u=[],c=[],h=[],d=[],p=Math.cos,f=Math.sin;l.push(new i(e*p(0),e*f(0),.5*-n)),h.push(0),l.push(new i(t*p(0),t*f(0),.5*n)),d.push(1);for(var m=0;m<a;m++){var g=2*Math.PI/a*(m+1),v=2*Math.PI/a*(m+.5);m<a-1?(l.push(new i(e*p(g),e*f(g),.5*-n)),h.push(2*m+2),l.push(new i(t*p(g),t*f(g),.5*n)),d.push(2*m+3),u.push(new i(p(v),f(v),0)),c.push([2*m+2,2*m+3,2*m+1,2*m])):(c.push([0,1,2*m+1,2*m]),u.push(new i(p(v),f(v),0)))}c.push(d),u.push(new i(0,0,1));var y=[];for(m=0;m<h.length;m++)y.push(h[h.length-m-1]);c.push(y),u.push(new i(0,0,-1)),this.type=r.types.CONVEXPOLYHEDRON,o.call(this,l,c,u)}s.prototype=new o},{"../math/Quaternion":25,"../math/Vec3":27,"./ConvexPolyhedron":35,"./Shape":40}],37:[function(t,e,n){var r=t("./Shape"),i=t("./ConvexPolyhedron"),o=t("../math/Vec3"),s=t("../utils/Utils");function a(t,e){e=s.defaults(e,{maxValue:null,minValue:null,elementSize:1}),this.data=t,this.maxValue=e.maxValue,this.minValue=e.minValue,this.elementSize=e.elementSize,null===e.minValue&&this.updateMinValue(),null===e.maxValue&&this.updateMaxValue(),this.cacheEnabled=!0,r.call(this),this.pillarConvex=new i,this.pillarOffset=new o,this.type=r.types.HEIGHTFIELD,this.updateBoundingSphereRadius(),this._cachedPillars={}}e.exports=a,(a.prototype=new r).update=function(){this._cachedPillars={}},a.prototype.updateMinValue=function(){for(var t=this.data,e=t[0][0],n=0;n!==t.length;n++)for(var r=0;r!==t[n].length;r++){var i=t[n][r];i<e&&(e=i)}this.minValue=e},a.prototype.updateMaxValue=function(){for(var t=this.data,e=t[0][0],n=0;n!==t.length;n++)for(var r=0;r!==t[n].length;r++){var i=t[n][r];i>e&&(e=i)}this.maxValue=e},a.prototype.setHeightValueAtIndex=function(t,e,n){this.data[t][e]=n,this.clearCachedConvexTrianglePillar(t,e,!1),t>0&&(this.clearCachedConvexTrianglePillar(t-1,e,!0),this.clearCachedConvexTrianglePillar(t-1,e,!1)),e>0&&(this.clearCachedConvexTrianglePillar(t,e-1,!0),this.clearCachedConvexTrianglePillar(t,e-1,!1)),e>0&&t>0&&this.clearCachedConvexTrianglePillar(t-1,e-1,!0)},a.prototype.getRectMinMax=function(t,e,n,r,i){i=i||[];for(var o=this.data,s=this.minValue,a=t;a<n;a++)for(var l=e;l<r;l++){var u=o[a][l];u>s&&(s=u)}i[0]=this.minValue,i[1]=s},a.prototype.getIndexOfPosition=function(t,e,n,r){var i=this.elementSize,o=this.data,s=Math.floor(t/i),a=Math.floor(e/i);return n[0]=s,n[1]=a,r&&(s<0&&(s=0),a<0&&(a=0),s>=o.length-1&&(s=o.length-1),a>=o[0].length-1&&(a=o[0].length-1)),!(s<0||a<0||s>=o.length-1||a>=o[0].length-1)},a.prototype.getHeightAt=function(t,e,n){var r=[];this.getIndexOfPosition(t,e,r,n);var i=[];return this.getRectMinMax(r[0],r[1]+1,r[0],r[1]+1,i),(i[0]+i[1])/2},a.prototype.getCacheConvexTrianglePillarKey=function(t,e,n){return t+"_"+e+"_"+(n?1:0)},a.prototype.getCachedConvexTrianglePillar=function(t,e,n){return this._cachedPillars[this.getCacheConvexTrianglePillarKey(t,e,n)]},a.prototype.setCachedConvexTrianglePillar=function(t,e,n,r,i){this._cachedPillars[this.getCacheConvexTrianglePillarKey(t,e,n)]={convex:r,offset:i}},a.prototype.clearCachedConvexTrianglePillar=function(t,e,n){delete this._cachedPillars[this.getCacheConvexTrianglePillarKey(t,e,n)]},a.prototype.getConvexTrianglePillar=function(t,e,n){var r=this.pillarConvex,s=this.pillarOffset;if(this.cacheEnabled){if(a=this.getCachedConvexTrianglePillar(t,e,n))return this.pillarConvex=a.convex,void(this.pillarOffset=a.offset);r=new i,s=new o,this.pillarConvex=r,this.pillarOffset=s}var a=this.data,l=this.elementSize,u=r.faces;r.vertices.length=6;for(var c=0;c<6;c++)r.vertices[c]||(r.vertices[c]=new o);for(u.length=5,c=0;c<5;c++)u[c]||(u[c]=[]);var h=r.vertices,d=(Math.min(a[t][e],a[t+1][e],a[t][e+1],a[t+1][e+1])-this.minValue)/2+this.minValue;n?(s.set((t+.75)*l,(e+.75)*l,d),h[0].set(.25*l,.25*l,a[t+1][e+1]-d),h[1].set(-.75*l,.25*l,a[t][e+1]-d),h[2].set(.25*l,-.75*l,a[t+1][e]-d),h[3].set(.25*l,.25*l,-d-1),h[4].set(-.75*l,.25*l,-d-1),h[5].set(.25*l,-.75*l,-d-1),u[0][0]=0,u[0][1]=1,u[0][2]=2,u[1][0]=5,u[1][1]=4,u[1][2]=3,u[2][0]=2,u[2][1]=5,u[2][2]=3,u[2][3]=0,u[3][0]=3,u[3][1]=4,u[3][2]=1,u[3][3]=0,u[4][0]=1,u[4][1]=4,u[4][2]=5,u[4][3]=2):(s.set((t+.25)*l,(e+.25)*l,d),h[0].set(-.25*l,-.25*l,a[t][e]-d),h[1].set(.75*l,-.25*l,a[t+1][e]-d),h[2].set(-.25*l,.75*l,a[t][e+1]-d),h[3].set(-.25*l,-.25*l,-d-1),h[4].set(.75*l,-.25*l,-d-1),h[5].set(-.25*l,.75*l,-d-1),u[0][0]=0,u[0][1]=1,u[0][2]=2,u[1][0]=5,u[1][1]=4,u[1][2]=3,u[2][0]=0,u[2][1]=2,u[2][2]=5,u[2][3]=3,u[3][0]=1,u[3][1]=0,u[3][2]=3,u[3][3]=4,u[4][0]=4,u[4][1]=5,u[4][2]=2,u[4][3]=1),r.computeNormals(),r.computeEdges(),r.updateBoundingSphereRadius(),this.setCachedConvexTrianglePillar(t,e,n,r,s)},a.prototype.calculateLocalInertia=function(t,e){return(e=e||new o).set(0,0,0),e},a.prototype.volume=function(){return Number.MAX_VALUE},a.prototype.calculateWorldAABB=function(t,e,n,r){n.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),r.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)},a.prototype.updateBoundingSphereRadius=function(){var t=this.data,e=this.elementSize;this.boundingSphereRadius=new o(t.length*e,t[0].length*e,Math.max(Math.abs(this.maxValue),Math.abs(this.minValue))).norm()}},{"../math/Vec3":27,"../utils/Utils":48,"./ConvexPolyhedron":35,"./Shape":40}],38:[function(t,e,n){e.exports=o;var r=t("./Shape"),i=t("../math/Vec3");function o(){r.call(this),this.type=r.types.PARTICLE}(o.prototype=new r).constructor=o,o.prototype.calculateLocalInertia=function(t,e){return(e=e||new i).set(0,0,0),e},o.prototype.volume=function(){return 0},o.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=0},o.prototype.calculateWorldAABB=function(t,e,n,r){n.copy(t),r.copy(t)}},{"../math/Vec3":27,"./Shape":40}],39:[function(t,e,n){e.exports=o;var r=t("./Shape"),i=t("../math/Vec3");function o(){r.call(this),this.type=r.types.PLANE,this.worldNormal=new i,this.worldNormalNeedsUpdate=!0,this.boundingSphereRadius=Number.MAX_VALUE}(o.prototype=new r).constructor=o,o.prototype.computeWorldNormal=function(t){var e=this.worldNormal;e.set(0,0,1),t.vmult(e,e),this.worldNormalNeedsUpdate=!1},o.prototype.calculateLocalInertia=function(t,e){return e||new i},o.prototype.volume=function(){return Number.MAX_VALUE};var s=new i;o.prototype.calculateWorldAABB=function(t,e,n,r){s.set(0,0,1),e.vmult(s,s);var i=Number.MAX_VALUE;n.set(-i,-i,-i),r.set(i,i,i),1===s.x&&(r.x=t.x),1===s.y&&(r.y=t.y),1===s.z&&(r.z=t.z),-1===s.x&&(n.x=t.x),-1===s.y&&(n.y=t.y),-1===s.z&&(n.z=t.z)},o.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=Number.MAX_VALUE}},{"../math/Vec3":27,"./Shape":40}],40:[function(t,e,n){e.exports=r;var r=t("./Shape");function r(){this.type=0,this.boundingSphereRadius=0,this.collisionResponse=!0}t("../math/Vec3"),t("../math/Quaternion"),t("../material/Material"),r.prototype.constructor=r,r.prototype.updateBoundingSphereRadius=function(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type},r.prototype.volume=function(){throw"volume() not implemented for shape type "+this.type},r.prototype.calculateLocalInertia=function(t,e){throw"calculateLocalInertia() not implemented for shape type "+this.type},r.types={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128}},{"../material/Material":22,"../math/Quaternion":25,"../math/Vec3":27,"./Shape":40}],41:[function(t,e,n){e.exports=o;var r=t("./Shape"),i=t("../math/Vec3");function o(t){r.call(this),this.radius=void 0!==t?Number(t):1,this.type=r.types.SPHERE,this.updateBoundingSphereRadius()}(o.prototype=new r).constructor=o,o.prototype.calculateLocalInertia=function(t,e){e=e||new i;var n=2*t*this.radius*this.radius/5;return e.x=n,e.y=n,e.z=n,e},o.prototype.volume=function(){return 4*Math.PI*this.radius/3},o.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.radius},o.prototype.calculateWorldAABB=function(t,e,n,r){for(var i=this.radius,o=["x","y","z"],s=0;s<o.length;s++){var a=o[s];n[a]=t[a]-i,r[a]=t[a]+i}}},{"../math/Vec3":27,"./Shape":40}],42:[function(t,e,n){e.exports=i,t("../math/Vec3"),t("../math/Quaternion");var r=t("./Solver");function i(){r.call(this),this.iterations=10,this.tolerance=0}var o=[],s=[],a=[];(i.prototype=new r).solve=function(t,e){var n,r,i,l=0,u=this.iterations,c=this.tolerance*this.tolerance,h=this.equations,d=h.length,p=e.bodies,f=p.length,m=t;if(0!==d)for(var g=0;g!==f;g++)p[g].updateSolveMassProperties();var v=s,y=a,w=o;for(v.length=d,y.length=d,w.length=d,g=0;g!==d;g++){var b=h[g];w[g]=0,y[g]=b.computeB(m),v[g]=1/b.computeC()}if(0!==d){for(g=0;g!==f;g++){var x=(E=p[g]).wlambda;E.vlambda.set(0,0,0),x&&x.set(0,0,0)}for(l=0;l!==u;l++){r=0;for(var _=0;_!==d;_++)(i=w[_])+(n=v[_]*(y[_]-(b=h[_]).computeGWlambda()-b.eps*i))<b.minForce?n=b.minForce-i:i+n>b.maxForce&&(n=b.maxForce-i),w[_]+=n,r+=n>0?n:-n,b.addToWlambda(n);if(r*r<c)break}for(g=0;g!==f;g++){var E,S=(E=p[g]).velocity,M=E.angularVelocity;S.vadd(E.vlambda,S),M&&M.vadd(E.wlambda,M)}}return l}},{"../math/Quaternion":25,"../math/Vec3":27,"./Solver":43}],43:[function(t,e,n){function r(){this.equations=[]}e.exports=r,r.prototype.solve=function(t,e){return 0},r.prototype.addEquation=function(t){t.enabled&&this.equations.push(t)},r.prototype.removeEquation=function(t){var e=this.equations,n=e.indexOf(t);-1!==n&&e.splice(n,1)},r.prototype.removeAllEquations=function(){this.equations.length=0}},{}],44:[function(t,e,n){e.exports=o,t("../math/Vec3"),t("../math/Quaternion");var r=t("./Solver"),i=t("../objects/Body");function o(t){r.call(this),this.subsolver=t}var s=[],a=[],l=[],u={bodies:null};(o.prototype=new r).solve=function(t,e){var n=s,r=e.bodies,o=this.equations,c=o.length,h=r.length,d=this.subsolver;for(n.length>h&&(n.length=h);n.length<h;)n.push({body:null,children:[],eqs:[],visited:!1});for(var p=0;p!==h;p++){var f=n[p];f.body=r[p],f.children.length=0,f.eqs.length=0,f.visited=!1}for(var m=0;m!==c;m++){var g=o[m],v=(p=r.indexOf(g.bi),r.indexOf(g.bj)),y=n[p],w=n[v];y.children.push(w),y.eqs.push(g),w.children.push(y),w.eqs.push(g)}var b=i.STATIC;function x(t){for(var e=t.length,n=0;n!==e;n++){var r=t[n];if(!(r.visited||r.body.type&b))return r}return!1}function _(t,e){var n=[];for(n.push(t),t.visited=!0,e(t);n.length;)for(var r,i=n.pop();r=x(i.children);)r.visited=!0,e(r),n.push(r)}var E,S=0,M=a,T=l;function C(t){T.push(t.body);for(var e=t.eqs.length,n=0;n!==e;n++){var r=t.eqs[n];-1===M.indexOf(r)&&M.push(r)}}for(var A=u;E=x(n);){M.length=0,T.length=0,_(E,C);var R=M.length;for(p=0;p!==R;p++)d.addEquation(M[p]);A.bodies=T,d.solve(t,A),d.removeAllEquations(),S++}return S}},{"../math/Quaternion":25,"../math/Vec3":27,"../objects/Body":28,"./Solver":43}],45:[function(t,e,n){var r=function(){};e.exports=r,r.prototype={constructor:r,addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;return void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e),this},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0===this._listeners)return this;var n=this._listeners;if(void 0===n[t])return this;var r=n[t].indexOf(e);return-1!==r&&n[t].splice(r,1),this},dispatchEvent:function(t){if(void 0===this._listeners)return this;var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var n=0,r=e.length;n<r;n++)e[n].call(this,t)}return this}}},{}],46:[function(t,e,n){function r(){this.objects=[],this.type=Object}e.exports=r,r.prototype.release=function(){for(var t=arguments.length,e=0;e!==t;e++)this.objects.push(arguments[e])},r.prototype.get=function(){return 0===this.objects.length?this.constructObject():this.objects.pop()},r.prototype.constructObject=function(){throw new Error("constructObject() not implemented in this Pool subclass yet!")}},{}],47:[function(t,e,n){function r(){this.data={keys:[]}}e.exports=r,r.prototype.get=function(t,e){if(t>e){var n=e;e=t,t=n}return this.data[t+"-"+e]},r.prototype.set=function(t,e,n){if(t>e){var r=e;e=t,t=r}var i=t+"-"+e;this.get(t,e)||this.data.keys.push(i),this.data[i]=n},r.prototype.reset=function(){for(var t=this.data,e=t.keys;e.length>0;)delete t[e.pop()]}},{}],48:[function(t,e,n){function r(){}e.exports=r,r.defaults=function(t,e){for(var n in t=t||{},e)n in t||(t[n]=e[n]);return t}},{}],49:[function(t,e,n){e.exports=o;var r=t("../math/Vec3"),i=t("./Pool");function o(){i.call(this),this.type=r}(o.prototype=new i).constructObject=function(){return new r}},{"../math/Vec3":27,"./Pool":46}],50:[function(t,e,n){e.exports=u;var r=t("../shapes/Shape"),i=t("../math/Vec3"),o=t("../math/Transform"),s=(t("../shapes/ConvexPolyhedron"),t("../math/Quaternion")),a=(t("../solver/Solver"),t("../utils/Vec3Pool")),l=t("../equations/ContactEquation");function u(){this.contactPointPool=[],this.v3pool=new a}u.prototype.makeResult=function(t,e,n,r,i,o){var s;return this.contactPointPool.length?((s=this.contactPointPool.pop()).bi=t,s.bj=e):s=new l(t,e),s.enabled=!0,s.si=i||n,s.sj=o||r,s};var c=new i,h=new i,d=new s,p=new s;u.prototype.getContacts=function(t,e,n,r,i){this.contactPointPool=i;for(var o=d,s=p,a=c,l=h,u=0,f=t.length;u!==f;u++)for(var m=t[u],g=e[u],v=0;v<m.shapes.length;v++){m.quaternion.mult(m.shapeOrientations[v],o),m.quaternion.vmult(m.shapeOffsets[v],a),a.vadd(m.position,a);for(var y=m.shapes[v],w=0;w<g.shapes.length;w++){g.quaternion.mult(g.shapeOrientations[w],s),g.quaternion.vmult(g.shapeOffsets[w],l),l.vadd(g.position,l);var b=g.shapes[w];if(!(a.distanceTo(l)>y.boundingSphereRadius+b.boundingSphereRadius)){var x=this[y.type|b.type];x&&(y.type<b.type?x.call(this,r,y,b,a,l,o,s,m,g,y,b):x.call(this,r,b,y,l,a,s,o,g,m,y,b))}}}},u.prototype[r.types.BOX|r.types.BOX]=u.prototype.boxBox=function(t,e,n,r,i,o,s,a,l){this.convexConvex(t,e.convexPolyhedronRepresentation,n.convexPolyhedronRepresentation,r,i,o,s,a,l,e,n)},u.prototype[r.types.BOX|r.types.CONVEXPOLYHEDRON]=u.prototype.boxConvex=function(t,e,n,r,i,o,s,a,l){this.convexConvex(t,e.convexPolyhedronRepresentation,n,r,i,o,s,a,l,e,n)},u.prototype[r.types.BOX|r.types.PARTICLE]=u.prototype.boxParticle=function(t,e,n,r,i,o,s,a,l){this.convexParticle(t,e.convexPolyhedronRepresentation,n,r,i,o,s,a,l,e,n)},u.prototype[r.types.SPHERE]=u.prototype.sphereSphere=function(t,e,n,r,i,o,s,a,l){var u=this.makeResult(a,l,e,n);l.position.vsub(r,u.ni),u.ni.normalize(),u.ri.copy(u.ni),u.rj.copy(u.ni),u.ri.mult(e.radius,u.ri),u.rj.mult(-n.radius,u.rj),t.push(u)};var f=new i,m=new i;u.prototype[r.types.SPHERE|r.types.PLANE]=u.prototype.spherePlane=function(t,e,n,r,i,o,s,a,l){var u=this.makeResult(a,l,e,n);if(u.ni.set(0,0,1),s.vmult(u.ni,u.ni),u.ni.negate(u.ni),u.ni.normalize(),u.ni.mult(e.radius,u.ri),r.vsub(i,f),u.ni.mult(u.ni.dot(f),m),f.vsub(m,u.rj),m.norm2()<=e.radius*e.radius){t.push(u);var c=u.ri,h=u.rj;c.vadd(r,c),c.vsub(a.position,c),h.vadd(i,h),h.vsub(l.position,h)}};var g=new i,v=new i,y=new i;function w(t,e,n){for(var r=null,i=t.length,o=0;o!==i;o++){var s=t[o],a=g;t[(o+1)%i].vsub(s,a);var l=v;a.cross(e,l);var u=y;n.vsub(s,u);var c=l.dot(u);if(!(null===r||c>0&&!0===r||c<=0&&!1===r))return!1;null===r&&(r=c>0)}return!0}var b=new i,x=new i,_=new i,E=new i,S=[new i,new i,new i,new i,new i,new i],M=new i,T=new i,C=new i,A=new i;u.prototype[r.types.SPHERE|r.types.BOX]=u.prototype.sphereBox=function(t,e,n,r,i,o,s,a,l){var u=this.v3pool,c=S;r.vsub(i,b),n.getSideNormals(c,s);for(var h=e.radius,d=!1,p=T,f=C,m=A,g=null,v=0,y=0,w=0,R=null,P=0,L=c.length;P!==L&&!1===d;P++){var I=x;I.copy(c[P]);var N=I.norm();I.normalize();var O=b.dot(I);if(O<N+h&&O>0){var D=_,B=E;D.copy(c[(P+1)%3]),B.copy(c[(P+2)%3]);var U=D.norm(),z=B.norm();D.normalize(),B.normalize();var F=b.dot(D),k=b.dot(B);if(F<U&&F>-U&&k<z&&k>-z){var V=Math.abs(O-N-h);(null===R||V<R)&&(R=V,y=F,w=k,g=N,p.copy(I),f.copy(D),m.copy(B),v++)}}}if(v){d=!0;var G=this.makeResult(a,l,e,n);p.mult(-h,G.ri),G.ni.copy(p),G.ni.negate(G.ni),p.mult(g,p),f.mult(y,f),p.vadd(f,p),m.mult(w,m),p.vadd(m,G.rj),G.ri.vadd(r,G.ri),G.ri.vsub(a.position,G.ri),G.rj.vadd(i,G.rj),G.rj.vsub(l.position,G.rj),t.push(G)}for(var j=u.get(),H=M,W=0;2!==W&&!d;W++)for(var q=0;2!==q&&!d;q++)for(var X=0;2!==X&&!d;X++)j.set(0,0,0),W?j.vadd(c[0],j):j.vsub(c[0],j),q?j.vadd(c[1],j):j.vsub(c[1],j),X?j.vadd(c[2],j):j.vsub(c[2],j),i.vadd(j,H),H.vsub(r,H),H.norm2()<h*h&&(d=!0,(G=this.makeResult(a,l,e,n)).ri.copy(H),G.ri.normalize(),G.ni.copy(G.ri),G.ri.mult(h,G.ri),G.rj.copy(j),G.ri.vadd(r,G.ri),G.ri.vsub(a.position,G.ri),G.rj.vadd(i,G.rj),G.rj.vsub(l.position,G.rj),t.push(G));u.release(j),j=null;var Y=u.get(),Z=u.get(),$=(G=u.get(),u.get()),Q=(V=u.get(),c.length);for(W=0;W!==Q&&!d;W++)for(q=0;q!==Q&&!d;q++)if(W%3!=q%3){c[q].cross(c[W],Y),Y.normalize(),c[W].vadd(c[q],Z),G.copy(r),G.vsub(Z,G),G.vsub(i,G);var J=G.dot(Y);for(Y.mult(J,$),X=0;X===W%3||X===q%3;)X++;V.copy(r),V.vsub($,V),V.vsub(Z,V),V.vsub(i,V);var K=Math.abs(J),tt=V.norm();if(K<c[X].norm()&&tt<h){d=!0;var et=this.makeResult(a,l,e,n);Z.vadd($,et.rj),et.rj.copy(et.rj),V.negate(et.ni),et.ni.normalize(),et.ri.copy(et.rj),et.ri.vadd(i,et.ri),et.ri.vsub(r,et.ri),et.ri.normalize(),et.ri.mult(h,et.ri),et.ri.vadd(r,et.ri),et.ri.vsub(a.position,et.ri),et.rj.vadd(i,et.rj),et.rj.vsub(l.position,et.rj),t.push(et)}}u.release(Y,Z,G,$,V)};var R=new i,P=new i,L=new i,I=new i,N=new i,O=new i,D=new i,B=new i,U=new i,z=new i;u.prototype[r.types.SPHERE|r.types.CONVEXPOLYHEDRON]=u.prototype.sphereConvex=function(t,e,n,r,i,o,s,a,l){var u=this.v3pool;r.vsub(i,R);for(var c=n.faceNormals,h=n.faces,d=n.vertices,p=e.radius,f=0;f!==d.length;f++){var m=N;s.vmult(d[f],m),i.vadd(m,m);var g=I;if(m.vsub(r,g),g.norm2()<p*p)return v=!0,(V=this.makeResult(a,l,e,n)).ri.copy(g),V.ri.normalize(),V.ni.copy(V.ri),V.ri.mult(p,V.ri),m.vsub(i,V.rj),V.ri.vadd(r,V.ri),V.ri.vsub(a.position,V.ri),V.rj.vadd(i,V.rj),V.rj.vsub(l.position,V.rj),void t.push(V)}for(var v=!1,y=(f=0,h.length);f!==y&&!1===v;f++){var b=h[f],x=O;s.vmult(c[f],x);var _=D;s.vmult(d[b[0]],_),_.vadd(i,_);var E=B;x.mult(-p,E),r.vadd(E,E);var S=U;E.vsub(_,S);var M=S.dot(x),T=z;if(r.vsub(_,T),M<0&&T.dot(x)>0){for(var C=[],A=0,F=b.length;A!==F;A++){var k=u.get();s.vmult(d[b[A]],k),i.vadd(k,k),C.push(k)}if(w(C,x,r)){v=!0;var V=this.makeResult(a,l,e,n);x.mult(-p,V.ri),x.negate(V.ni);var G=u.get();x.mult(-M,G);var j=u.get();x.mult(-p,j),r.vsub(i,V.rj),V.rj.vadd(j,V.rj),V.rj.vadd(G,V.rj),V.rj.vadd(i,V.rj),V.rj.vsub(l.position,V.rj),V.ri.vadd(r,V.ri),V.ri.vsub(a.position,V.ri),u.release(G),u.release(j),t.push(V),A=0;for(var H=C.length;A!==H;A++)u.release(C[A]);return}for(A=0;A!==b.length;A++){var W=u.get(),q=u.get();s.vmult(d[b[(A+1)%b.length]],W),s.vmult(d[b[(A+2)%b.length]],q),i.vadd(W,W),i.vadd(q,q);var X=P;q.vsub(W,X);var Y=L;X.unit(Y);var Z=u.get(),$=u.get();r.vsub(W,$);var Q=$.dot(Y);Y.mult(Q,Z),Z.vadd(W,Z);var J=u.get();if(Z.vsub(r,J),Q>0&&Q*Q<X.norm2()&&J.norm2()<p*p){for(V=this.makeResult(a,l,e,n),Z.vsub(i,V.rj),Z.vsub(r,V.ni),V.ni.normalize(),V.ni.mult(p,V.ri),V.rj.vadd(i,V.rj),V.rj.vsub(l.position,V.rj),V.ri.vadd(r,V.ri),V.ri.vsub(a.position,V.ri),t.push(V),A=0,H=C.length;A!==H;A++)u.release(C[A]);return u.release(W),u.release(q),u.release(Z),u.release(J),void u.release($)}u.release(W),u.release(q),u.release(Z),u.release(J),u.release($)}for(A=0,H=C.length;A!==H;A++)u.release(C[A])}}},new i,new i,u.prototype[r.types.PLANE|r.types.BOX]=u.prototype.planeBox=function(t,e,n,r,i,o,s,a,l){this.planeConvex(t,e,n.convexPolyhedronRepresentation,r,i,o,s,a,l)};var F=new i,k=new i,V=new i,G=new i;u.prototype[r.types.PLANE|r.types.CONVEXPOLYHEDRON]=u.prototype.planeConvex=function(t,e,n,r,i,o,s,a,l){var u=F,c=k;c.set(0,0,1),o.vmult(c,c);for(var h=V,d=0;d!==n.vertices.length;d++)if(u.copy(n.vertices[d]),s.vmult(u,u),i.vadd(u,u),u.vsub(r,h),c.dot(h)<=0){var p=this.makeResult(a,l,e,n),f=G;c.mult(c.dot(h),f),u.vsub(f,f),f.vsub(r,p.ri),p.ni.copy(c),u.vsub(i,p.rj),p.ri.vadd(r,p.ri),p.ri.vsub(a.position,p.ri),p.rj.vadd(i,p.rj),p.rj.vsub(l.position,p.rj),t.push(p)}};var j=new i,H=new i;u.prototype[r.types.CONVEXPOLYHEDRON]=u.prototype.convexConvex=function(t,e,n,r,i,o,s,a,l,u,c,h,d){var p=j;if(!(r.distanceTo(i)>e.boundingSphereRadius+n.boundingSphereRadius)&&e.findSeparatingAxis(n,r,o,i,s,p,h,d)){var f=[],m=H;e.clipAgainstHull(r,o,n,i,s,p,-100,100,f);for(var g=0;g!==f.length;g++){var v=this.makeResult(a,l,e,n,u,c),y=v.ri,w=v.rj;p.negate(v.ni),f[g].normal.negate(m),m.mult(f[g].depth,m),f[g].point.vadd(m,y),w.copy(f[g].point),y.vsub(r,y),w.vsub(i,w),y.vadd(r,y),y.vsub(a.position,y),w.vadd(i,w),w.vsub(l.position,w),t.push(v)}}};var W=new i,q=new i,X=new i;u.prototype[r.types.PLANE|r.types.PARTICLE]=u.prototype.planeParticle=function(t,e,n,r,i,o,s,a,l){var u=W;u.set(0,0,1),a.quaternion.vmult(u,u);var c=q;if(i.vsub(a.position,c),u.dot(c)<=0){var h=this.makeResult(l,a,n,e);h.ni.copy(u),h.ni.negate(h.ni),h.ri.set(0,0,0);var d=X;u.mult(u.dot(i),d),i.vsub(d,d),h.rj.copy(d),t.push(h)}};var Y=new i;u.prototype[r.types.PARTICLE|r.types.SPHERE]=u.prototype.sphereParticle=function(t,e,n,r,i,o,s,a,l){var u=Y;if(u.set(0,0,1),i.vsub(r,u),u.norm2()<=e.radius*e.radius){var c=this.makeResult(l,a,n,e);u.normalize(),c.rj.copy(u),c.rj.mult(e.radius,c.rj),c.ni.copy(u),c.ni.negate(c.ni),c.ri.set(0,0,0),t.push(c)}};var Z=new s,$=new i,Q=(new i,new i),J=new i,K=new i;u.prototype[r.types.PARTICLE|r.types.CONVEXPOLYHEDRON]=u.prototype.convexParticle=function(t,e,n,r,i,o,s,a,l){var u=-1,c=Q,h=K,d=null,p=$;if(p.copy(i),p.vsub(r,p),o.conjugate(Z),Z.vmult(p,p),e.pointIsInside(p)){e.worldVerticesNeedsUpdate&&e.computeWorldVertices(r,o),e.worldFaceNormalsNeedsUpdate&&e.computeWorldFaceNormals(o);for(var f=0,m=e.faces.length;f!==m;f++){var g=e.worldFaceNormals[f];i.vsub(e.worldVertices[e.faces[f][0]],J);var v=-g.dot(J);(null===d||Math.abs(v)<Math.abs(d))&&(d=v,u=f,c.copy(g))}if(-1!==u){var y=this.makeResult(l,a,n,e);c.mult(d,h),h.vadd(i,h),h.vsub(r,h),y.rj.copy(h),c.negate(y.ni),y.ri.set(0,0,0);var w=y.ri,b=y.rj;w.vadd(i,w),w.vsub(l.position,w),b.vadd(r,b),b.vsub(a.position,b),t.push(y)}else console.warn("Point found inside convex, but did not find penetrating face!")}},u.prototype[r.types.BOX|r.types.HEIGHTFIELD]=u.prototype.boxHeightfield=function(t,e,n,r,i,o,s,a,l){this.convexHeightfield(t,e.convexPolyhedronRepresentation,n,r,i,o,s,a,l)};var tt=new i,et=new i,nt=[0];u.prototype[r.types.CONVEXPOLYHEDRON|r.types.HEIGHTFIELD]=u.prototype.convexHeightfield=function(t,e,n,r,i,s,a,l,u){var c=n.data,h=n.elementSize,d=e.boundingSphereRadius,p=et,f=nt,m=tt;o.pointToLocalFrame(i,a,r,m);var g=Math.floor((m.x-d)/h)-1,v=Math.ceil((m.x+d)/h)+1,y=Math.floor((m.y-d)/h)-1,w=Math.ceil((m.y+d)/h)+1;if(!(v<0||w<0||g>c.length||w>c[0].length)){g<0&&(g=0),v<0&&(v=0),y<0&&(y=0),w<0&&(w=0),g>=c.length&&(g=c.length-1),v>=c.length&&(v=c.length-1),w>=c[0].length&&(w=c[0].length-1),y>=c[0].length&&(y=c[0].length-1);var b=[];if(n.getRectMinMax(g,y,v,w,b),!(m.z-d>b[1]||m.z+d<b[0]))for(var x=g;x<v;x++)for(var _=y;_<w;_++)n.getConvexTrianglePillar(x,_,!1),o.pointToWorldFrame(i,a,n.pillarOffset,p),r.distanceTo(p)<n.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&this.convexConvex(t,e,n.pillarConvex,r,p,s,a,l,u,null,null,f,null),n.getConvexTrianglePillar(x,_,!0),o.pointToWorldFrame(i,a,n.pillarOffset,p),r.distanceTo(p)<n.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&this.convexConvex(t,e,n.pillarConvex,r,p,s,a,l,u,null,null,f,null)}};var rt=new i,it=new i;u.prototype[r.types.SPHERE|r.types.HEIGHTFIELD]=u.prototype.sphereHeightfield=function(t,e,n,r,i,s,a,l,u){var c=n.data,h=e.radius,d=n.elementSize,p=it,f=rt;o.pointToLocalFrame(i,a,r,f);var m=Math.floor((f.x-h)/d)-1,g=Math.ceil((f.x+h)/d)+1,v=Math.floor((f.y-h)/d)-1,y=Math.ceil((f.y+h)/d)+1;if(!(g<0||y<0||m>c.length||y>c[0].length)){m<0&&(m=0),g<0&&(g=0),v<0&&(v=0),y<0&&(y=0),m>=c.length&&(m=c.length-1),g>=c.length&&(g=c.length-1),y>=c[0].length&&(y=c[0].length-1),v>=c[0].length&&(v=c[0].length-1);var w=[];if(n.getRectMinMax(m,v,g,y,w),!(f.z-h>w[1]||f.z+h<w[0]))for(var b=m;b<g;b++)for(var x=v;x<y;x++){var _=t.length;if(n.getConvexTrianglePillar(b,x,!1),o.pointToWorldFrame(i,a,n.pillarOffset,p),r.distanceTo(p)<n.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&this.sphereConvex(t,e,n.pillarConvex,r,p,s,a,l,u),n.getConvexTrianglePillar(b,x,!0),o.pointToWorldFrame(i,a,n.pillarOffset,p),r.distanceTo(p)<n.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&this.sphereConvex(t,e,n.pillarConvex,r,p,s,a,l,u),t.length-_>2)return}}}},{"../equations/ContactEquation":16,"../math/Quaternion":25,"../math/Transform":26,"../math/Vec3":27,"../shapes/ConvexPolyhedron":35,"../shapes/Shape":40,"../solver/Solver":43,"../utils/Vec3Pool":49}],51:[function(t,e,n){e.exports=y;var r=t("../shapes/Shape"),i=t("../math/Vec3"),o=t("../math/Quaternion"),s=t("../solver/GSSolver"),a=(t("../utils/Vec3Pool"),t("../equations/ContactEquation"),t("../equations/FrictionEquation")),l=t("./Narrowphase"),u=t("../utils/EventTarget"),c=t("../collision/ArrayCollisionMatrix"),h=t("../material/Material"),d=t("../material/ContactMaterial"),p=t("../objects/Body"),f=t("../utils/TupleDictionary"),m=(t("../collision/RaycastResult"),t("../collision/AABB")),g=t("../collision/Ray"),v=t("../collision/NaiveBroadphase");function y(){u.apply(this),this.dt=-1,this.allowSleep=!1,this.contacts=[],this.frictionEquations=[],this.quatNormalizeSkip=0,this.quatNormalizeFast=!1,this.time=0,this.stepnumber=0,this.default_dt=1/60,this.nextId=0,this.gravity=new i,this.broadphase=new v,this.bodies=[],this.solver=new s,this.constraints=[],this.narrowphase=new l,this.collisionMatrix=new c,this.collisionMatrixPrevious=new c,this.materials=[],this.contactmaterials=[],this.contactMaterialTable=new f,this.defaultMaterial=new h("default"),this.defaultContactMaterial=new d(this.defaultMaterial,this.defaultMaterial,{friction:.3,restitution:0}),this.doProfiling=!1,this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0},this.subsystems=[],this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null}}y.prototype=new u;var w=new m,b=[],x=new g;if(y.prototype.getContactMaterial=function(t,e){return this.contactMaterialTable.get(t.id,e.id)},y.prototype.numObjects=function(){return this.bodies.length},y.prototype.collisionMatrixTick=function(){var t=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix,this.collisionMatrix=t,this.collisionMatrix.reset()},y.prototype.add=y.prototype.addBody=function(t){-1===this.bodies.indexOf(t)&&(t.index=this.bodies.length,this.bodies.push(t),t.world=this,t.initPosition.copy(t.position),t.initVelocity.copy(t.velocity),t.timeLastSleepy=this.time,t instanceof p&&(t.initAngularVelocity.copy(t.angularVelocity),t.initQuaternion.copy(t.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=t,this.dispatchEvent(this.addBodyEvent))},y.prototype.addConstraint=function(t){this.constraints.push(t)},y.prototype.removeConstraint=function(t){var e=this.constraints.indexOf(t);-1!==e&&this.constraints.splice(e,1)},y.prototype.rayTest=function(t,e,n){x.from.copy(t),x.to.copy(e),x.getAABB(w),b.length=0,this.broadphase.aabbQuery(this,w,b),x.intersectBodies(b,n)},y.prototype.remove=function(t){t.world=null;var e=this.bodies.length-1,n=this.bodies,r=n.indexOf(t);if(-1!==r){n.splice(r,1);for(var i=0;i!==n.length;i++)n[i].index=i;this.collisionMatrix.setNumObjects(e),this.removeBodyEvent.body=t,this.dispatchEvent(this.removeBodyEvent)}},y.prototype.addMaterial=function(t){this.materials.push(t)},y.prototype.addContactMaterial=function(t){this.contactmaterials.push(t),this.contactMaterialTable.set(t.materials[0].id,t.materials[1].id,t)},"undefined"==typeof performance&&(performance={}),!performance.now){var _=Date.now();performance.timing&&performance.timing.navigationStart&&(_=performance.timing.navigationStart),performance.now=function(){return Date.now()-_}}var E=new i;y.prototype.step=function(t,e,n){if(n=n||10,0===(e=e||0))this.internalStep(t),this.time+=t;else{var r=Math.floor((this.time+e)/t)-Math.floor(this.time/t);r=Math.min(r,n);for(var i=performance.now(),o=0;o!==r&&(this.internalStep(t),!(performance.now()-i>1e3*t));o++);this.time+=e;for(var s=this.time%t/t,a=E,l=this.bodies,u=0;u!==l.length;u++){var c=l[u];c.type!==p.STATIC&&c.sleepState!==p.SLEEPING?(c.position.vsub(c.previousPosition,a),a.scale(s,a),c.position.vadd(a,c.interpolatedPosition)):(c.interpolatedPosition.copy(c.position),c.interpolatedQuaternion.copy(c.quaternion))}}};var S={type:"postStep"},M={type:"preStep"},T={type:"collide",body:null,contact:null},C=[],A=[],R=[],P=[],L=new i,I=(new i,new i,new i,new i,new i,new i,new i,new i,new o,new o),N=new o,O=new i;y.prototype.internalStep=function(t){this.dt=t;var e,n=this.contacts,i=R,o=P,s=this.numObjects(),l=this.bodies,u=this.solver,c=this.gravity,h=this.doProfiling,d=this.profile,f=p.DYNAMIC,m=this.constraints,g=A,v=c.norm(),y=c.x,w=c.y,b=c.z,x=0;for(h&&(e=performance.now()),x=0;x!==s;x++)if((Tt=l[x]).type&f){var _=Tt.force,E=Tt.mass;_.x+=E*y,_.y+=E*w,_.z+=E*b}x=0;for(var D=this.subsystems.length;x!==D;x++)this.subsystems[x].update();h&&(e=performance.now()),i.length=0,o.length=0,this.broadphase.collisionPairs(this,i,o),h&&(d.broadphase=performance.now()-e);var B=m.length;for(x=0;x!==B;x++)if(!(et=m[x]).collideConnected)for(var U=i.length-1;U>=0;U-=1)(et.bodyA===i[U]&&et.bodyB===o[U]||et.bodyB===i[U]&&et.bodyA===o[U])&&(i.splice(U,1),o.splice(U,1));this.collisionMatrixTick(),h&&(e=performance.now());var z=C,F=n.length;for(x=0;x!==F;x++)z.push(n[x]);n.length=0,this.narrowphase.getContacts(i,o,this,n,z),h&&(d.narrowphase=performance.now()-e),h&&(e=performance.now());var k=n.length,V=this.frictionEquations.length;for(x=0;x!==V;x++)g.push(this.frictionEquations[x]);this.frictionEquations.length=0;for(var G=0;G!==k;G++){var j,H=(et=n[G]).bj,W=et.si,q=et.sj,X=(x=l.indexOf(Tt=et.bi),U=l.indexOf(H),(j=Tt.material&&H.material&&this.getContactMaterial(Tt.material,H.material)||this.defaultContactMaterial).friction),Y=L;Y.set(H.position.x+et.rj.x-Tt.position.x-et.ri.x,H.position.y+et.rj.y-Tt.position.y-et.ri.y,H.position.z+et.rj.z-Tt.position.z-et.ri.z);var Z=Y.dot(et.ni);if(Z<0){if(et.enabled=Tt.collisionResponse&&H.collisionResponse&&W.collisionResponse&&q.collisionResponse,et.restitution=j.restitution,et.penetration=Z,et.setSpookParams(j.contactEquationStiffness,j.contactEquationRelaxation,t),u.addEquation(et),X>0){var $=X*v,Q=Tt.invMass+H.invMass;Q>0&&(Q=1/Q);var J=g,K=J.length?J.pop():new a(Tt,H,$*Q),tt=J.length?J.pop():new a(Tt,H,$*Q);this.frictionEquations.push(K),this.frictionEquations.push(tt),K.bi=tt.bi=Tt,K.bj=tt.bj=H,K.minForce=tt.minForce=-$*Q,K.maxForce=tt.maxForce=$*Q,K.ri.copy(et.ri),K.rj.copy(et.rj),tt.ri.copy(et.ri),tt.rj.copy(et.rj),et.ni.tangents(K.t,tt.t),K.setSpookParams(j.frictionEquationStiffness,j.frictionEquationRelaxation,t),tt.setSpookParams(j.frictionEquationStiffness,j.frictionEquationRelaxation,t),K.enabled=tt.enabled=et.enabled,u.addEquation(K),u.addEquation(tt)}Tt.allowSleep&&Tt.type===p.DYNAMIC&&Tt.sleepState===p.SLEEPING&&H.sleepState===p.AWAKE&&H.type!==p.STATIC&&H.velocity.norm2()+H.angularVelocity.norm2()>=2*Math.pow(H.sleepSpeedLimit,2)&&(Tt._wakeUpAfterNarrowphase=!0),H.allowSleep&&H.type===p.DYNAMIC&&H.sleepState===p.SLEEPING&&Tt.sleepState===p.AWAKE&&Tt.type!==p.STATIC&&Tt.velocity.norm2()+Tt.angularVelocity.norm2()>=2*Math.pow(Tt.sleepSpeedLimit,2)&&(H._wakeUpAfterNarrowphase=!0),this.collisionMatrix.set(Tt,H,!0),this.collisionMatrix.get(Tt,H)!==this.collisionMatrixPrevious.get(Tt,H)&&(T.body=H,T.contact=et,Tt.dispatchEvent(T),T.body=Tt,H.dispatchEvent(T))}}for(h&&(d.makeContactConstraints=performance.now()-e,e=performance.now()),x=0;x!==s;x++)(Tt=l[x])._wakeUpAfterNarrowphase&&(Tt.wakeUp(),Tt._wakeUpAfterNarrowphase=!1);for(B=m.length,x=0;x!==B;x++){var et;(et=m[x]).update(),U=0;for(var nt=et.equations.length;U!==nt;U++)u.addEquation(et.equations[U])}u.solve(t,this),h&&(d.solve=performance.now()-e),u.removeAllEquations();var rt=Math.pow;for(x=0;x!==s;x++)if((Tt=l[x]).type&f){var it=rt(1-Tt.linearDamping,t),ot=Tt.velocity;ot.mult(it,ot);var st=Tt.angularVelocity;if(st){var at=rt(1-Tt.angularDamping,t);st.mult(at,st)}}for(this.dispatchEvent(M),x=0;x!==s;x++)(Tt=l[x]).preStep&&Tt.preStep.call(Tt);h&&(e=performance.now());var lt=I,ut=N,ct=p.DYNAMIC|p.KINEMATIC,ht=this.stepnumber%(this.quatNormalizeSkip+1)==0,dt=this.quatNormalizeFast,pt=.5*t,ft=r.types.PLANE,mt=r.types.CONVEXPOLYHEDRON;for(x=0;x!==s;x++){var gt=l[x],vt=gt.shape,yt=gt.force,wt=gt.torque;if(gt.type&ct&&gt.sleepState!==p.SLEEPING){var bt=gt.velocity,xt=gt.angularVelocity,_t=gt.position,Et=gt.quaternion,St=gt.invMass,Mt=gt.invInertiaWorld;if(bt.x+=yt.x*St*t,bt.y+=yt.y*St*t,bt.z+=yt.z*St*t,gt.angularVelocity&&(Mt.vmult(wt,O),O.mult(t,O),O.vadd(xt,xt)),_t.x+=bt.x*t,_t.y+=bt.y*t,_t.z+=bt.z*t,gt.angularVelocity&&(lt.set(xt.x,xt.y,xt.z,0),lt.mult(Et,ut),Et.x+=pt*ut.x,Et.y+=pt*ut.y,Et.z+=pt*ut.z,Et.w+=pt*ut.w,ht&&(dt?Et.normalizeFast():Et.normalize())),gt.aabb&&(gt.aabbNeedsUpdate=!0),vt)switch(vt.type){case ft:vt.worldNormalNeedsUpdate=!0;break;case mt:vt.worldFaceNormalsNeedsUpdate=!0,vt.worldVerticesNeedsUpdate=!0}gt.updateInertiaWorld&&gt.updateInertiaWorld()}gt.force.set(0,0,0),gt.torque&&gt.torque.set(0,0,0)}for(this.broadphase.dirty=!0,h&&(d.integrate=performance.now()-e),this.time+=t,this.stepnumber+=1,this.dispatchEvent(S),x=0;x!==s;x++){var Tt,Ct=(Tt=l[x]).postStep;Ct&&Ct.call(Tt)}if(this.allowSleep)for(x=0;x!==s;x++)l[x].sleepTick(this.time)}},{"../collision/AABB":3,"../collision/ArrayCollisionMatrix":4,"../collision/NaiveBroadphase":7,"../collision/Ray":9,"../collision/RaycastResult":10,"../equations/ContactEquation":16,"../equations/FrictionEquation":18,"../material/ContactMaterial":21,"../material/Material":22,"../math/Quaternion":25,"../math/Vec3":27,"../objects/Body":28,"../shapes/Shape":40,"../solver/GSSolver":42,"../utils/EventTarget":45,"../utils/TupleDictionary":47,"../utils/Vec3Pool":49,"./Narrowphase":50}]},{},[2])(2)},N5P7:function(t,e,n){var r=n("Womt");function i(t){r.Object3D.call(this),this.element=t,this.element.style.position="absolute",this.addEventListener("removed",function(){null!==this.element.parentNode&&this.element.parentNode.removeChild(this.element)})}function o(){var t,e,n,o,s=new r.Matrix4,a={camera:{fov:0,style:""},objects:{}},l=document.createElement("div");l.style.overflow="hidden",this.domElement=l;var u=document.createElement("div");u.style.WebkitTransformStyle="preserve-3d",u.style.MozTransformStyle="preserve-3d",u.style.transformStyle="preserve-3d",l.appendChild(u);var c=/Trident/i.test(navigator.userAgent);function h(t){return Math.abs(t)<1e-10?0:t}function d(t,e){var r=t.elements,i="matrix3d("+h(r[0])+","+h(r[1])+","+h(r[2])+","+h(r[3])+","+h(-r[4])+","+h(-r[5])+","+h(-r[6])+","+h(-r[7])+","+h(r[8])+","+h(r[9])+","+h(r[10])+","+h(r[11])+","+h(r[12])+","+h(r[13])+","+h(r[14])+","+h(r[15])+")";return c?"translate(-50%,-50%)translate("+n+"px,"+o+"px)"+e+i:"translate(-50%,-50%)"+i}this.setClearColor=function(){},this.getSize=function(){return{width:t,height:e}},this.setSize=function(r,i){n=(t=r)/2,o=(e=i)/2,l.style.width=r+"px",l.style.height=i+"px",u.style.width=r+"px",u.style.height=i+"px"};var p=function(){var t=new r.Vector3,e=new r.Vector3;return function(n,r){return t.setFromMatrixPosition(n.matrixWorld),e.setFromMatrixPosition(r.matrixWorld),t.distanceToSquared(e)}}();this.render=function(t,e){var r=e.projectionMatrix.elements[5]*o;a.camera.fov!==r&&(l.style.WebkitPerspective=r+"px",l.style.MozPerspective=r+"px",l.style.perspective=r+"px",a.camera.fov=r),t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld();var f="translateZ("+r+"px)"+function(t){var n=e.matrixWorldInverse.elements;return"matrix3d("+h(n[0])+","+h(-n[1])+","+h(n[2])+","+h(n[3])+","+h(n[4])+","+h(-n[5])+","+h(n[6])+","+h(n[7])+","+h(n[8])+","+h(-n[9])+","+h(n[10])+","+h(n[11])+","+h(n[12])+","+h(-n[13])+","+h(n[14])+","+h(n[15])+")"}(),m=f+"translate("+n+"px,"+o+"px)";a.camera.style===m||c||(u.style.WebkitTransform=m,u.style.MozTransform=m,u.style.transform=m,a.camera.style=m),function t(e,n,r){if(e instanceof i){var o;e instanceof CSS3DSprite?(s.copy(n.matrixWorldInverse),s.transpose(),s.copyPosition(e.matrixWorld),s.scale(e.scale),s.elements[3]=0,s.elements[7]=0,s.elements[11]=0,s.elements[15]=1,o=d(s,r)):o=d(e.matrixWorld,r);var l=e.element,h=a.objects[e.id]&&a.objects[e.id].style;void 0!==h&&h===o||(l.style.WebkitTransform=o,l.style.MozTransform=o,l.style.transform=o,a.objects[e.id]={style:o},c&&(a.objects[e.id].distanceToCameraSquared=p(n,e))),l.parentNode!==u&&u.appendChild(l)}for(var f=0,m=e.children.length;f<m;f++)t(e.children[f],n,r)}(t,e,f),c&&function(t){var e=Object.keys(a.objects).sort(function(t,e){return a.objects[t].distanceToCameraSquared-a.objects[e].distanceToCameraSquared}),n=e.length;t.traverse(function(t){var r=e.indexOf(t.id+"");-1!==r&&(t.element.style.zIndex=n-r)})}(t)}}(i.prototype=Object.create(r.Object3D.prototype)).constructor=i,t.exports.CSS3DObject=i,CSS3DSprite=function(t){i.call(this,t)},CSS3DSprite.prototype=Object.create(i.prototype),CSS3DSprite.prototype.constructor=CSS3DSprite,t.exports.CSS3DSprite=CSS3DSprite,(o.prototype=Object.create(r.EventDispatcher.prototype)).constructor=o,t.exports.CSS3DRenderer=o},OREr:function(t,e,n){var r,i=i||function(){var t=[];return{getAll:function(){return t},removeAll:function(){t=[]},add:function(e){t.push(e)},remove:function(e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)},update:function(e,n){if(0===t.length)return!1;var r=0;for(e=void 0!==e?e:i.now();r<t.length;)t[r].update(e)||n?r++:t.splice(r,1);return!0}}}();i.now="undefined"==typeof window&&"undefined"!=typeof process?function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now.bind(window.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()},i.Tween=function(t){var e,n=t,r={},o={},s={},a=1e3,l=0,u=!1,c=!1,h=!1,d=0,p=null,f=i.Easing.Linear.None,m=i.Interpolation.Linear,g=[],v=null,y=!1,w=null,b=null,x=null;this.to=function(t,e){return o=t,void 0!==e&&(a=e),this},this.start=function(t){for(var e in i.add(this),c=!0,y=!1,p=void 0!==t?t:i.now(),p+=d,o){if(o[e]instanceof Array){if(0===o[e].length)continue;o[e]=[n[e]].concat(o[e])}void 0!==n[e]&&(r[e]=n[e],r[e]instanceof Array==0&&(r[e]*=1),s[e]=r[e]||0)}return this},this.stop=function(){return c?(i.remove(this),c=!1,null!==x&&x.call(n,n),this.stopChainedTweens(),this):this},this.end=function(){return this.update(p+a),this},this.stopChainedTweens=function(){for(var t=0,e=g.length;t<e;t++)g[t].stop()},this.delay=function(t){return d=t,this},this.repeat=function(t){return l=t,this},this.repeatDelay=function(t){return e=t,this},this.yoyo=function(t){return u=t,this},this.easing=function(t){return f=t,this},this.interpolation=function(t){return m=t,this},this.chain=function(){return g=arguments,this},this.onStart=function(t){return v=t,this},this.onUpdate=function(t){return w=t,this},this.onComplete=function(t){return b=t,this},this.onStop=function(t){return x=t,this},this.update=function(t){var i,c,x;if(t<p)return!0;for(i in!1===y&&(null!==v&&v.call(n,n),y=!0),x=f(c=(c=(t-p)/a)>1?1:c),o)if(void 0!==r[i]){var _=r[i]||0,E=o[i];E instanceof Array?n[i]=m(E,x):("string"==typeof E&&(E="+"===E.charAt(0)||"-"===E.charAt(0)?_+parseFloat(E):parseFloat(E)),"number"==typeof E&&(n[i]=_+(E-_)*x))}if(null!==w&&w.call(n,x),1===c){if(l>0){for(i in isFinite(l)&&l--,s){if("string"==typeof o[i]&&(s[i]=s[i]+parseFloat(o[i])),u){var S=s[i];s[i]=o[i],o[i]=S}r[i]=s[i]}return u&&(h=!h),p=void 0!==e?t+e:t+d,!0}null!==b&&b.call(n,n);for(var M=0,T=g.length;M<T;M++)g[M].start(p+a);return!1}return!0}},i.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-i.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*i.Easing.Bounce.In(2*t):.5*i.Easing.Bounce.Out(2*t-1)+.5}}},i.Interpolation={Linear:function(t,e){var n=t.length-1,r=n*e,o=Math.floor(r),s=i.Interpolation.Utils.Linear;return e<0?s(t[0],t[1],r):e>1?s(t[n],t[n-1],n-r):s(t[o],t[o+1>n?n:o+1],r-o)},Bezier:function(t,e){for(var n=0,r=t.length-1,o=Math.pow,s=i.Interpolation.Utils.Bernstein,a=0;a<=r;a++)n+=o(1-e,r-a)*o(e,a)*t[a]*s(r,a);return n},CatmullRom:function(t,e){var n=t.length-1,r=n*e,o=Math.floor(r),s=i.Interpolation.Utils.CatmullRom;return t[0]===t[n]?(e<0&&(o=Math.floor(r=n*(1+e))),s(t[(o-1+n)%n],t[o],t[(o+1)%n],t[(o+2)%n],r-o)):e<0?t[0]-(s(t[0],t[0],t[1],t[1],-r)-t[0]):e>1?t[n]-(s(t[n],t[n],t[n-1],t[n-1],r-n)-t[n]):s(t[o?o-1:0],t[o],t[n<o+1?n:o+1],t[n<o+2?n:o+2],r-o)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){var n=i.Interpolation.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:function(){var t=[1];return function(e){var n=1;if(t[e])return t[e];for(var r=e;r>1;r--)n*=r;return t[e]=n,n}}(),CatmullRom:function(t,e,n,r,i){var o=.5*(n-t),s=.5*(r-e),a=i*i;return(2*e-2*n+o+s)*(i*a)+(-3*e+3*n-2*o-s)*a+o*i+e}}},void 0===(r=(function(){return i}).apply(e,[]))||(t.exports=r)},"VT+s":function(t,e){function n(t,e){for(var n=new Array(t*e),r=0;r<n.length;++r)n[r]=Math.random();return n}function r(t,e,n){return t*(1-n)+n*e}e.generatePerlinNoise=function(t,e,i){var o,s=(i=i||{}).octaveCount||4,a=i.amplitude||.1,l=i.persistence||.2,u=n(t,e),c=new Array(s);for(o=0;o<s;++o)c[o]=f(o);var h=new Array(t*e),d=0;for(o=s-1;o>=0;--o){d+=a*=l;for(var p=0;p<h.length;++p)h[p]=h[p]||0,h[p]+=c[o][p]*a}for(o=0;o<h.length;++o)h[o]/=d;return h;function f(n){for(var i=new Array(t*e),o=Math.pow(2,n),s=1/o,a=0,l=0;l<e;++l)for(var c=Math.floor(l/o)*o,h=(c+o)%e,d=(l-c)*s,p=0;p<t;++p){var f=Math.floor(p/o)*o,m=(f+o)%t,g=(p-f)*s,v=r(u[c*t+f],u[h*t+f],d),y=r(u[c*t+m],u[h*t+m],d);i[a]=r(v,y,g),a+=1}return i}},e.generateWhiteNoise=n},Womt:function(t,e,n){"use strict";function r(){}n.r(e),n.d(e,"WebGLRenderTargetCube",function(){return We}),n.d(e,"WebGLRenderTarget",function(){return He}),n.d(e,"WebGLRenderer",function(){return qr}),n.d(e,"ShaderLib",function(){return nn}),n.d(e,"UniformsLib",function(){return en}),n.d(e,"UniformsUtils",function(){return Je}),n.d(e,"ShaderChunk",function(){return Qe}),n.d(e,"FogExp2",function(){return Xr}),n.d(e,"Fog",function(){return Yr}),n.d(e,"Scene",function(){return Zr}),n.d(e,"Sprite",function(){return Qr}),n.d(e,"LOD",function(){return Jr}),n.d(e,"SkinnedMesh",function(){return ei}),n.d(e,"Skeleton",function(){return Kr}),n.d(e,"Bone",function(){return ti}),n.d(e,"Mesh",function(){return zn}),n.d(e,"LineSegments",function(){return ii}),n.d(e,"LineLoop",function(){return oi}),n.d(e,"Line",function(){return ri}),n.d(e,"Points",function(){return ai}),n.d(e,"Group",function(){return li}),n.d(e,"VideoTexture",function(){return ui}),n.d(e,"DataTexture",function(){return qe}),n.d(e,"CompressedTexture",function(){return ci}),n.d(e,"CubeTexture",function(){return kn}),n.d(e,"CanvasTexture",function(){return Vr}),n.d(e,"DepthTexture",function(){return hi}),n.d(e,"Texture",function(){return Ge}),n.d(e,"CompressedTextureLoader",function(){return zo}),n.d(e,"DataTextureLoader",function(){return Fo}),n.d(e,"CubeTextureLoader",function(){return Vo}),n.d(e,"TextureLoader",function(){return Go}),n.d(e,"ObjectLoader",function(){return Gs}),n.d(e,"MaterialLoader",function(){return Bs}),n.d(e,"BufferGeometryLoader",function(){return Us}),n.d(e,"DefaultLoadingManager",function(){return Do}),n.d(e,"LoadingManager",function(){return Oo}),n.d(e,"JSONLoader",function(){return Vs}),n.d(e,"ImageLoader",function(){return ko}),n.d(e,"ImageBitmapLoader",function(){return Xs}),n.d(e,"FontLoader",function(){return Qs}),n.d(e,"FileLoader",function(){return Uo}),n.d(e,"Loader",function(){return Fs}),n.d(e,"LoaderUtils",function(){return ks}),n.d(e,"Cache",function(){return No}),n.d(e,"AudioLoader",function(){return ea}),n.d(e,"SpotLightShadow",function(){return ms}),n.d(e,"SpotLight",function(){return gs}),n.d(e,"PointLight",function(){return vs}),n.d(e,"RectAreaLight",function(){return xs}),n.d(e,"HemisphereLight",function(){return ps}),n.d(e,"DirectionalLightShadow",function(){return ys}),n.d(e,"DirectionalLight",function(){return ws}),n.d(e,"AmbientLight",function(){return bs}),n.d(e,"LightShadow",function(){return fs}),n.d(e,"Light",function(){return ds}),n.d(e,"StereoCamera",function(){return na}),n.d(e,"PerspectiveCamera",function(){return jr}),n.d(e,"OrthographicCamera",function(){return un}),n.d(e,"CubeCamera",function(){return ra}),n.d(e,"ArrayCamera",function(){return Hr}),n.d(e,"Camera",function(){return ln}),n.d(e,"AudioListener",function(){return ia}),n.d(e,"PositionalAudio",function(){return sa}),n.d(e,"AudioContext",function(){return ta}),n.d(e,"AudioAnalyser",function(){return aa}),n.d(e,"Audio",function(){return oa}),n.d(e,"VectorKeyframeTrack",function(){return Os}),n.d(e,"StringKeyframeTrack",function(){return _s}),n.d(e,"QuaternionKeyframeTrack",function(){return Ts}),n.d(e,"NumberKeyframeTrack",function(){return As}),n.d(e,"ColorKeyframeTrack",function(){return Cs}),n.d(e,"BooleanKeyframeTrack",function(){return Es}),n.d(e,"PropertyMixer",function(){return la}),n.d(e,"PropertyBinding",function(){return ca}),n.d(e,"KeyframeTrack",function(){return Ns}),n.d(e,"AnimationUtils",function(){return Is}),n.d(e,"AnimationObjectGroup",function(){return ha}),n.d(e,"AnimationMixer",function(){return pa}),n.d(e,"AnimationClip",function(){return Ds}),n.d(e,"Uniform",function(){return fa}),n.d(e,"InstancedBufferGeometry",function(){return ma}),n.d(e,"BufferGeometry",function(){return Tn}),n.d(e,"Geometry",function(){return dn}),n.d(e,"InterleavedBufferAttribute",function(){return ga}),n.d(e,"InstancedInterleavedBuffer",function(){return ya}),n.d(e,"InterleavedBuffer",function(){return va}),n.d(e,"InstancedBufferAttribute",function(){return wa}),n.d(e,"Face3",function(){return cn}),n.d(e,"Object3D",function(){return an}),n.d(e,"Raycaster",function(){return ba}),n.d(e,"Layers",function(){return on}),n.d(e,"EventDispatcher",function(){return r}),n.d(e,"Clock",function(){return Ea}),n.d(e,"QuaternionLinearInterpolant",function(){return Ms}),n.d(e,"LinearInterpolant",function(){return Ps}),n.d(e,"DiscreteInterpolant",function(){return Ls}),n.d(e,"CubicInterpolant",function(){return Rs}),n.d(e,"Interpolant",function(){return Ss}),n.d(e,"Triangle",function(){return Un}),n.d(e,"Math",function(){return De}),n.d(e,"Spherical",function(){return Sa}),n.d(e,"Cylindrical",function(){return Ma}),n.d(e,"Plane",function(){return Ze}),n.d(e,"Frustum",function(){return $e}),n.d(e,"Sphere",function(){return Ye}),n.d(e,"Ray",function(){return Dn}),n.d(e,"Matrix4",function(){return Ue}),n.d(e,"Matrix3",function(){return ke}),n.d(e,"Box3",function(){return Xe}),n.d(e,"Box2",function(){return Ta}),n.d(e,"Line3",function(){return Bn}),n.d(e,"Euler",function(){return rn}),n.d(e,"Vector4",function(){return je}),n.d(e,"Vector3",function(){return Fe}),n.d(e,"Vector2",function(){return Be}),n.d(e,"Quaternion",function(){return ze}),n.d(e,"Color",function(){return tn}),n.d(e,"ImmediateRenderObject",function(){return Ca}),n.d(e,"VertexNormalsHelper",function(){return Aa}),n.d(e,"SpotLightHelper",function(){return Ra}),n.d(e,"SkeletonHelper",function(){return Pa}),n.d(e,"PointLightHelper",function(){return La}),n.d(e,"RectAreaLightHelper",function(){return Ia}),n.d(e,"HemisphereLightHelper",function(){return Na}),n.d(e,"GridHelper",function(){return Oa}),n.d(e,"PolarGridHelper",function(){return Da}),n.d(e,"FaceNormalsHelper",function(){return Ba}),n.d(e,"DirectionalLightHelper",function(){return Ua}),n.d(e,"CameraHelper",function(){return za}),n.d(e,"BoxHelper",function(){return Fa}),n.d(e,"Box3Helper",function(){return ka}),n.d(e,"PlaneHelper",function(){return Va}),n.d(e,"ArrowHelper",function(){return Ga}),n.d(e,"AxesHelper",function(){return ja}),n.d(e,"Shape",function(){return hs}),n.d(e,"Path",function(){return cs}),n.d(e,"ShapePath",function(){return Ys}),n.d(e,"Font",function(){return Zs}),n.d(e,"CurvePath",function(){return us}),n.d(e,"Curve",function(){return jo}),n.d(e,"ShapeUtils",function(){return Ji}),n.d(e,"WebGLUtils",function(){return Gr}),n.d(e,"WireframeGeometry",function(){return di}),n.d(e,"ParametricGeometry",function(){return pi}),n.d(e,"ParametricBufferGeometry",function(){return fi}),n.d(e,"TetrahedronGeometry",function(){return vi}),n.d(e,"TetrahedronBufferGeometry",function(){return yi}),n.d(e,"OctahedronGeometry",function(){return wi}),n.d(e,"OctahedronBufferGeometry",function(){return bi}),n.d(e,"IcosahedronGeometry",function(){return xi}),n.d(e,"IcosahedronBufferGeometry",function(){return _i}),n.d(e,"DodecahedronGeometry",function(){return Ei}),n.d(e,"DodecahedronBufferGeometry",function(){return Si}),n.d(e,"PolyhedronGeometry",function(){return mi}),n.d(e,"PolyhedronBufferGeometry",function(){return gi}),n.d(e,"TubeGeometry",function(){return Mi}),n.d(e,"TubeBufferGeometry",function(){return Ti}),n.d(e,"TorusKnotGeometry",function(){return Ci}),n.d(e,"TorusKnotBufferGeometry",function(){return Ai}),n.d(e,"TorusGeometry",function(){return Ri}),n.d(e,"TorusBufferGeometry",function(){return Pi}),n.d(e,"TextGeometry",function(){return ro}),n.d(e,"TextBufferGeometry",function(){return io}),n.d(e,"SphereGeometry",function(){return oo}),n.d(e,"SphereBufferGeometry",function(){return so}),n.d(e,"RingGeometry",function(){return ao}),n.d(e,"RingBufferGeometry",function(){return lo}),n.d(e,"PlaneGeometry",function(){return Rn}),n.d(e,"PlaneBufferGeometry",function(){return Pn}),n.d(e,"LatheGeometry",function(){return uo}),n.d(e,"LatheBufferGeometry",function(){return co}),n.d(e,"ShapeGeometry",function(){return ho}),n.d(e,"ShapeBufferGeometry",function(){return po}),n.d(e,"ExtrudeGeometry",function(){return eo}),n.d(e,"ExtrudeBufferGeometry",function(){return no}),n.d(e,"EdgesGeometry",function(){return mo}),n.d(e,"ConeGeometry",function(){return yo}),n.d(e,"ConeBufferGeometry",function(){return wo}),n.d(e,"CylinderGeometry",function(){return go}),n.d(e,"CylinderBufferGeometry",function(){return vo}),n.d(e,"CircleGeometry",function(){return bo}),n.d(e,"CircleBufferGeometry",function(){return xo}),n.d(e,"BoxGeometry",function(){return Cn}),n.d(e,"BoxBufferGeometry",function(){return An}),n.d(e,"ShadowMaterial",function(){return Eo}),n.d(e,"SpriteMaterial",function(){return $r}),n.d(e,"RawShaderMaterial",function(){return So}),n.d(e,"ShaderMaterial",function(){return On}),n.d(e,"PointsMaterial",function(){return si}),n.d(e,"MeshPhysicalMaterial",function(){return To}),n.d(e,"MeshStandardMaterial",function(){return Mo}),n.d(e,"MeshPhongMaterial",function(){return Co}),n.d(e,"MeshToonMaterial",function(){return Ao}),n.d(e,"MeshNormalMaterial",function(){return Ro}),n.d(e,"MeshLambertMaterial",function(){return Po}),n.d(e,"MeshDepthMaterial",function(){return zr}),n.d(e,"MeshDistanceMaterial",function(){return Fr}),n.d(e,"MeshBasicMaterial",function(){return Nn}),n.d(e,"LineDashedMaterial",function(){return Lo}),n.d(e,"LineBasicMaterial",function(){return ni}),n.d(e,"Material",function(){return In}),n.d(e,"Float64BufferAttribute",function(){return _n}),n.d(e,"Float32BufferAttribute",function(){return xn}),n.d(e,"Uint32BufferAttribute",function(){return bn}),n.d(e,"Int32BufferAttribute",function(){return wn}),n.d(e,"Uint16BufferAttribute",function(){return yn}),n.d(e,"Int16BufferAttribute",function(){return vn}),n.d(e,"Uint8ClampedBufferAttribute",function(){return gn}),n.d(e,"Uint8BufferAttribute",function(){return mn}),n.d(e,"Int8BufferAttribute",function(){return fn}),n.d(e,"BufferAttribute",function(){return pn}),n.d(e,"ArcCurve",function(){return Wo}),n.d(e,"CatmullRomCurve3",function(){return Qo}),n.d(e,"CubicBezierCurve",function(){return es}),n.d(e,"CubicBezierCurve3",function(){return ns}),n.d(e,"EllipseCurve",function(){return Ho}),n.d(e,"LineCurve",function(){return rs}),n.d(e,"LineCurve3",function(){return is}),n.d(e,"QuadraticBezierCurve",function(){return os}),n.d(e,"QuadraticBezierCurve3",function(){return ss}),n.d(e,"SplineCurve",function(){return as}),n.d(e,"REVISION",function(){return i}),n.d(e,"MOUSE",function(){return o}),n.d(e,"CullFaceNone",function(){return s}),n.d(e,"CullFaceBack",function(){return a}),n.d(e,"CullFaceFront",function(){return l}),n.d(e,"CullFaceFrontBack",function(){return u}),n.d(e,"FrontFaceDirectionCW",function(){return c}),n.d(e,"FrontFaceDirectionCCW",function(){return h}),n.d(e,"BasicShadowMap",function(){return d}),n.d(e,"PCFShadowMap",function(){return p}),n.d(e,"PCFSoftShadowMap",function(){return f}),n.d(e,"FrontSide",function(){return m}),n.d(e,"BackSide",function(){return g}),n.d(e,"DoubleSide",function(){return v}),n.d(e,"FlatShading",function(){return y}),n.d(e,"SmoothShading",function(){return w}),n.d(e,"NoColors",function(){return b}),n.d(e,"FaceColors",function(){return x}),n.d(e,"VertexColors",function(){return _}),n.d(e,"NoBlending",function(){return E}),n.d(e,"NormalBlending",function(){return S}),n.d(e,"AdditiveBlending",function(){return M}),n.d(e,"SubtractiveBlending",function(){return T}),n.d(e,"MultiplyBlending",function(){return C}),n.d(e,"CustomBlending",function(){return A}),n.d(e,"AddEquation",function(){return R}),n.d(e,"SubtractEquation",function(){return P}),n.d(e,"ReverseSubtractEquation",function(){return L}),n.d(e,"MinEquation",function(){return I}),n.d(e,"MaxEquation",function(){return N}),n.d(e,"ZeroFactor",function(){return O}),n.d(e,"OneFactor",function(){return D}),n.d(e,"SrcColorFactor",function(){return B}),n.d(e,"OneMinusSrcColorFactor",function(){return U}),n.d(e,"SrcAlphaFactor",function(){return z}),n.d(e,"OneMinusSrcAlphaFactor",function(){return F}),n.d(e,"DstAlphaFactor",function(){return k}),n.d(e,"OneMinusDstAlphaFactor",function(){return V}),n.d(e,"DstColorFactor",function(){return G}),n.d(e,"OneMinusDstColorFactor",function(){return j}),n.d(e,"SrcAlphaSaturateFactor",function(){return H}),n.d(e,"NeverDepth",function(){return W}),n.d(e,"AlwaysDepth",function(){return q}),n.d(e,"LessDepth",function(){return X}),n.d(e,"LessEqualDepth",function(){return Y}),n.d(e,"EqualDepth",function(){return Z}),n.d(e,"GreaterEqualDepth",function(){return $}),n.d(e,"GreaterDepth",function(){return Q}),n.d(e,"NotEqualDepth",function(){return J}),n.d(e,"MultiplyOperation",function(){return K}),n.d(e,"MixOperation",function(){return tt}),n.d(e,"AddOperation",function(){return et}),n.d(e,"NoToneMapping",function(){return nt}),n.d(e,"LinearToneMapping",function(){return rt}),n.d(e,"ReinhardToneMapping",function(){return it}),n.d(e,"Uncharted2ToneMapping",function(){return ot}),n.d(e,"CineonToneMapping",function(){return st}),n.d(e,"UVMapping",function(){return at}),n.d(e,"CubeReflectionMapping",function(){return lt}),n.d(e,"CubeRefractionMapping",function(){return ut}),n.d(e,"EquirectangularReflectionMapping",function(){return ct}),n.d(e,"EquirectangularRefractionMapping",function(){return ht}),n.d(e,"SphericalReflectionMapping",function(){return dt}),n.d(e,"CubeUVReflectionMapping",function(){return pt}),n.d(e,"CubeUVRefractionMapping",function(){return ft}),n.d(e,"RepeatWrapping",function(){return mt}),n.d(e,"ClampToEdgeWrapping",function(){return gt}),n.d(e,"MirroredRepeatWrapping",function(){return vt}),n.d(e,"NearestFilter",function(){return yt}),n.d(e,"NearestMipMapNearestFilter",function(){return wt}),n.d(e,"NearestMipMapLinearFilter",function(){return bt}),n.d(e,"LinearFilter",function(){return xt}),n.d(e,"LinearMipMapNearestFilter",function(){return _t}),n.d(e,"LinearMipMapLinearFilter",function(){return Et}),n.d(e,"UnsignedByteType",function(){return St}),n.d(e,"ByteType",function(){return Mt}),n.d(e,"ShortType",function(){return Tt}),n.d(e,"UnsignedShortType",function(){return Ct}),n.d(e,"IntType",function(){return At}),n.d(e,"UnsignedIntType",function(){return Rt}),n.d(e,"FloatType",function(){return Pt}),n.d(e,"HalfFloatType",function(){return Lt}),n.d(e,"UnsignedShort4444Type",function(){return It}),n.d(e,"UnsignedShort5551Type",function(){return Nt}),n.d(e,"UnsignedShort565Type",function(){return Ot}),n.d(e,"UnsignedInt248Type",function(){return Dt}),n.d(e,"AlphaFormat",function(){return Bt}),n.d(e,"RGBFormat",function(){return Ut}),n.d(e,"RGBAFormat",function(){return zt}),n.d(e,"LuminanceFormat",function(){return Ft}),n.d(e,"LuminanceAlphaFormat",function(){return kt}),n.d(e,"RGBEFormat",function(){return Vt}),n.d(e,"DepthFormat",function(){return Gt}),n.d(e,"DepthStencilFormat",function(){return jt}),n.d(e,"RGB_S3TC_DXT1_Format",function(){return Ht}),n.d(e,"RGBA_S3TC_DXT1_Format",function(){return Wt}),n.d(e,"RGBA_S3TC_DXT3_Format",function(){return qt}),n.d(e,"RGBA_S3TC_DXT5_Format",function(){return Xt}),n.d(e,"RGB_PVRTC_4BPPV1_Format",function(){return Yt}),n.d(e,"RGB_PVRTC_2BPPV1_Format",function(){return Zt}),n.d(e,"RGBA_PVRTC_4BPPV1_Format",function(){return $t}),n.d(e,"RGBA_PVRTC_2BPPV1_Format",function(){return Qt}),n.d(e,"RGB_ETC1_Format",function(){return Jt}),n.d(e,"RGBA_ASTC_4x4_Format",function(){return Kt}),n.d(e,"RGBA_ASTC_5x4_Format",function(){return te}),n.d(e,"RGBA_ASTC_5x5_Format",function(){return ee}),n.d(e,"RGBA_ASTC_6x5_Format",function(){return ne}),n.d(e,"RGBA_ASTC_6x6_Format",function(){return re}),n.d(e,"RGBA_ASTC_8x5_Format",function(){return ie}),n.d(e,"RGBA_ASTC_8x6_Format",function(){return oe}),n.d(e,"RGBA_ASTC_8x8_Format",function(){return se}),n.d(e,"RGBA_ASTC_10x5_Format",function(){return ae}),n.d(e,"RGBA_ASTC_10x6_Format",function(){return le}),n.d(e,"RGBA_ASTC_10x8_Format",function(){return ue}),n.d(e,"RGBA_ASTC_10x10_Format",function(){return ce}),n.d(e,"RGBA_ASTC_12x10_Format",function(){return he}),n.d(e,"RGBA_ASTC_12x12_Format",function(){return de}),n.d(e,"LoopOnce",function(){return pe}),n.d(e,"LoopRepeat",function(){return fe}),n.d(e,"LoopPingPong",function(){return me}),n.d(e,"InterpolateDiscrete",function(){return ge}),n.d(e,"InterpolateLinear",function(){return ve}),n.d(e,"InterpolateSmooth",function(){return ye}),n.d(e,"ZeroCurvatureEnding",function(){return we}),n.d(e,"ZeroSlopeEnding",function(){return be}),n.d(e,"WrapAroundEnding",function(){return xe}),n.d(e,"TrianglesDrawMode",function(){return _e}),n.d(e,"TriangleStripDrawMode",function(){return Ee}),n.d(e,"TriangleFanDrawMode",function(){return Se}),n.d(e,"LinearEncoding",function(){return Me}),n.d(e,"sRGBEncoding",function(){return Te}),n.d(e,"GammaEncoding",function(){return Ce}),n.d(e,"RGBEEncoding",function(){return Ae}),n.d(e,"LogLuvEncoding",function(){return Re}),n.d(e,"RGBM7Encoding",function(){return Pe}),n.d(e,"RGBM16Encoding",function(){return Le}),n.d(e,"RGBDEncoding",function(){return Ie}),n.d(e,"BasicDepthPacking",function(){return Ne}),n.d(e,"RGBADepthPacking",function(){return Oe}),n.d(e,"CubeGeometry",function(){return Cn}),n.d(e,"Face4",function(){return Ha}),n.d(e,"LineStrip",function(){return Wa}),n.d(e,"LinePieces",function(){return qa}),n.d(e,"MeshFaceMaterial",function(){return Xa}),n.d(e,"MultiMaterial",function(){return Ya}),n.d(e,"PointCloud",function(){return Za}),n.d(e,"Particle",function(){return $a}),n.d(e,"ParticleSystem",function(){return Qa}),n.d(e,"PointCloudMaterial",function(){return Ja}),n.d(e,"ParticleBasicMaterial",function(){return Ka}),n.d(e,"ParticleSystemMaterial",function(){return tl}),n.d(e,"Vertex",function(){return el}),n.d(e,"DynamicBufferAttribute",function(){return nl}),n.d(e,"Int8Attribute",function(){return rl}),n.d(e,"Uint8Attribute",function(){return il}),n.d(e,"Uint8ClampedAttribute",function(){return ol}),n.d(e,"Int16Attribute",function(){return sl}),n.d(e,"Uint16Attribute",function(){return al}),n.d(e,"Int32Attribute",function(){return ll}),n.d(e,"Uint32Attribute",function(){return ul}),n.d(e,"Float32Attribute",function(){return cl}),n.d(e,"Float64Attribute",function(){return hl}),n.d(e,"ClosedSplineCurve3",function(){return dl}),n.d(e,"SplineCurve3",function(){return pl}),n.d(e,"Spline",function(){return fl}),n.d(e,"AxisHelper",function(){return ml}),n.d(e,"BoundingBoxHelper",function(){return gl}),n.d(e,"EdgesHelper",function(){return vl}),n.d(e,"WireframeHelper",function(){return yl}),n.d(e,"XHRLoader",function(){return wl}),n.d(e,"BinaryTextureLoader",function(){return bl}),n.d(e,"GeometryUtils",function(){return xl}),n.d(e,"ImageUtils",function(){return _l}),n.d(e,"Projector",function(){return El}),n.d(e,"CanvasRenderer",function(){return Sl}),n.d(e,"SceneUtils",function(){return Ml}),n.d(e,"LensFlare",function(){return Tl}),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),"name"in Function.prototype==0&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(void 0!==r&&null!==r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}),Object.assign(r.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var r=n.indexOf(e);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var n=e.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,t)}}}});var i="91",o={LEFT:0,MIDDLE:1,RIGHT:2},s=0,a=1,l=2,u=3,c=0,h=1,d=0,p=1,f=2,m=0,g=1,v=2,y=1,w=2,b=0,x=1,_=2,E=0,S=1,M=2,T=3,C=4,A=5,R=100,P=101,L=102,I=103,N=104,O=200,D=201,B=202,U=203,z=204,F=205,k=206,V=207,G=208,j=209,H=210,W=0,q=1,X=2,Y=3,Z=4,$=5,Q=6,J=7,K=0,tt=1,et=2,nt=0,rt=1,it=2,ot=3,st=4,at=300,lt=301,ut=302,ct=303,ht=304,dt=305,pt=306,ft=307,mt=1e3,gt=1001,vt=1002,yt=1003,wt=1004,bt=1005,xt=1006,_t=1007,Et=1008,St=1009,Mt=1010,Tt=1011,Ct=1012,At=1013,Rt=1014,Pt=1015,Lt=1016,It=1017,Nt=1018,Ot=1019,Dt=1020,Bt=1021,Ut=1022,zt=1023,Ft=1024,kt=1025,Vt=zt,Gt=1026,jt=1027,Ht=33776,Wt=33777,qt=33778,Xt=33779,Yt=35840,Zt=35841,$t=35842,Qt=35843,Jt=36196,Kt=37808,te=37809,ee=37810,ne=37811,re=37812,ie=37813,oe=37814,se=37815,ae=37816,le=37817,ue=37818,ce=37819,he=37820,de=37821,pe=2200,fe=2201,me=2202,ge=2300,ve=2301,ye=2302,we=2400,be=2401,xe=2402,_e=0,Ee=1,Se=2,Me=3e3,Te=3001,Ce=3007,Ae=3002,Re=3003,Pe=3004,Le=3005,Ie=3006,Ne=3200,Oe=3201,De={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var t=[],e=0;e<256;e++)t[e]=(e<16?"0":"")+e.toString(16).toUpperCase();return function(){var e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255]+"-"+t[255&n]+t[n>>8&255]+"-"+t[n>>16&15|64]+t[n>>24&255]+"-"+t[63&r|128]+t[r>>8&255]+"-"+t[r>>16&255]+t[r>>24&255]+t[255&i]+t[i>>8&255]+t[i>>16&255]+t[i>>24&255]}}(),clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*De.DEG2RAD},radToDeg:function(t){return t*De.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}};function Be(t,e){this.x=t||0,this.y=e||0}function Ue(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function ze(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==r?r:1}function Fe(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}function ke(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(Be.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(Be.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(){var t=new Be,e=new Be;return function(n,r){return t.set(n,n),e.set(r,r),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,o=this.y-t.y;return this.x=i*n-o*r+t.x,this.y=i*r+o*n+t.y,this}}),Object.assign(Ue.prototype,{isMatrix4:!0,set:function(t,e,n,r,i,o,s,a,l,u,c,h,d,p,f,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=r,g[1]=i,g[5]=o,g[9]=s,g[13]=a,g[2]=l,g[6]=u,g[10]=c,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Ue).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this},copyPosition:function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(){var t=new Fe;return function(e){var n=this.elements,r=e.elements,i=1/t.setFromMatrixColumn(e,0).length(),o=1/t.setFromMatrixColumn(e,1).length(),s=1/t.setFromMatrixColumn(e,2).length();return n[0]=r[0]*i,n[1]=r[1]*i,n[2]=r[2]*i,n[4]=r[4]*o,n[5]=r[5]*o,n[6]=r[6]*o,n[8]=r[8]*s,n[9]=r[9]*s,n[10]=r[10]*s,this}}(),makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,r=t.y,i=t.z,o=Math.cos(n),s=Math.sin(n),a=Math.cos(r),l=Math.sin(r),u=Math.cos(i),c=Math.sin(i);if("XYZ"===t.order){var h=o*u,d=o*c,p=s*u,f=s*c;e[0]=a*u,e[4]=-a*c,e[8]=l,e[1]=d+p*l,e[5]=h-f*l,e[9]=-s*a,e[2]=f-h*l,e[6]=p+d*l,e[10]=o*a}else if("YXZ"===t.order){var m=a*c,g=l*u;e[0]=(v=a*u)+(y=l*c)*s,e[4]=g*s-m,e[8]=o*l,e[1]=o*c,e[5]=o*u,e[9]=-s,e[2]=m*s-g,e[6]=y+v*s,e[10]=o*a}else if("ZXY"===t.order){var v,y;m=a*c,g=l*u,e[0]=(v=a*u)-(y=l*c)*s,e[4]=-o*c,e[8]=g+m*s,e[1]=m+g*s,e[5]=o*u,e[9]=y-v*s,e[2]=-o*l,e[6]=s,e[10]=o*a}else if("ZYX"===t.order)h=o*u,d=o*c,p=s*u,f=s*c,e[0]=a*u,e[4]=p*l-d,e[8]=h*l+f,e[1]=a*c,e[5]=f*l+h,e[9]=d*l-p,e[2]=-l,e[6]=s*a,e[10]=o*a;else if("YZX"===t.order){var w=o*a,b=o*l,x=s*a,_=s*l;e[0]=a*u,e[4]=_-w*c,e[8]=x*c+b,e[1]=c,e[5]=o*u,e[9]=-s*u,e[2]=-l*u,e[6]=b*c+x,e[10]=w-_*c}else"XZY"===t.order&&(w=o*a,b=o*l,x=s*a,_=s*l,e[0]=a*u,e[4]=-c,e[8]=l*u,e[1]=w*c+_,e[5]=o*u,e[9]=b*c-x,e[2]=x*c-b,e[6]=s*u,e[10]=_*c+w);return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){var e=this.elements,n=t._x,r=t._y,i=t._z,o=t._w,s=n+n,a=r+r,l=i+i,u=n*s,c=n*a,h=n*l,d=r*a,p=r*l,f=i*l,m=o*s,g=o*a,v=o*l;return e[0]=1-(d+f),e[4]=c-v,e[8]=h+g,e[1]=c+v,e[5]=1-(u+f),e[9]=p-m,e[2]=h-g,e[6]=p+m,e[10]=1-(u+d),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(){var t=new Fe,e=new Fe,n=new Fe;return function(r,i,o){var s=this.elements;return n.subVectors(r,i),0===n.lengthSq()&&(n.z=1),n.normalize(),t.crossVectors(o,n),0===t.lengthSq()&&(1===Math.abs(o.z)?n.x+=1e-4:n.z+=1e-4,n.normalize(),t.crossVectors(o,n)),t.normalize(),e.crossVectors(n,t),s[0]=t.x,s[4]=e.x,s[8]=n.x,s[1]=t.y,s[5]=e.y,s[9]=n.y,s[2]=t.z,s[6]=e.z,s[10]=n.z,this}}(),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,o=n[0],s=n[4],a=n[8],l=n[12],u=n[1],c=n[5],h=n[9],d=n[13],p=n[2],f=n[6],m=n[10],g=n[14],v=n[3],y=n[7],w=n[11],b=n[15],x=r[0],_=r[4],E=r[8],S=r[12],M=r[1],T=r[5],C=r[9],A=r[13],R=r[2],P=r[6],L=r[10],I=r[14],N=r[3],O=r[7],D=r[11],B=r[15];return i[0]=o*x+s*M+a*R+l*N,i[4]=o*_+s*T+a*P+l*O,i[8]=o*E+s*C+a*L+l*D,i[12]=o*S+s*A+a*I+l*B,i[1]=u*x+c*M+h*R+d*N,i[5]=u*_+c*T+h*P+d*O,i[9]=u*E+c*C+h*L+d*D,i[13]=u*S+c*A+h*I+d*B,i[2]=p*x+f*M+m*R+g*N,i[6]=p*_+f*T+m*P+g*O,i[10]=p*E+f*C+m*L+g*D,i[14]=p*S+f*A+m*I+g*B,i[3]=v*x+y*M+w*R+b*N,i[7]=v*_+y*T+w*P+b*O,i[11]=v*E+y*C+w*L+b*D,i[15]=v*S+y*A+w*I+b*B,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToBufferAttribute:function(){var t=new Fe;return function(e){for(var n=0,r=e.count;n<r;n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.applyMatrix4(this),e.setXYZ(n,t.x,t.y,t.z);return e}}(),determinant:function(){var t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],o=t[1],s=t[5],a=t[9],l=t[13],u=t[2],c=t[6],h=t[10],d=t[14];return t[3]*(+i*a*c-r*l*c-i*s*h+n*l*h+r*s*d-n*a*d)+t[7]*(+e*a*d-e*l*h+i*o*h-r*o*d+r*l*u-i*a*u)+t[11]*(+e*l*c-e*s*d-i*o*c+n*o*d+i*s*u-n*l*u)+t[15]*(-r*s*u-e*a*c+e*s*h+r*o*c-n*o*h+n*a*u)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var n=this.elements,r=t.elements,i=r[0],o=r[1],s=r[2],a=r[3],l=r[4],u=r[5],c=r[6],h=r[7],d=r[8],p=r[9],f=r[10],m=r[11],g=r[12],v=r[13],y=r[14],w=r[15],b=p*y*h-v*f*h+v*c*m-u*y*m-p*c*w+u*f*w,x=g*f*h-d*y*h-g*c*m+l*y*m+d*c*w-l*f*w,_=d*v*h-g*p*h+g*u*m-l*v*m-d*u*w+l*p*w,E=g*p*c-d*v*c-g*u*f+l*v*f+d*u*y-l*p*y,S=i*b+o*x+s*_+a*E;if(0===S){var M="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(M);return console.warn(M),this.identity()}var T=1/S;return n[0]=b*T,n[1]=(v*f*a-p*y*a-v*s*m+o*y*m+p*s*w-o*f*w)*T,n[2]=(u*y*a-v*c*a+v*s*h-o*y*h-u*s*w+o*c*w)*T,n[3]=(p*c*a-u*f*a-p*s*h+o*f*h+u*s*m-o*c*m)*T,n[4]=x*T,n[5]=(d*y*a-g*f*a+g*s*m-i*y*m-d*s*w+i*f*w)*T,n[6]=(g*c*a-l*y*a-g*s*h+i*y*h+l*s*w-i*c*w)*T,n[7]=(l*f*a-d*c*a+d*s*h-i*f*h-l*s*m+i*c*m)*T,n[8]=_*T,n[9]=(g*p*a-d*v*a-g*o*m+i*v*m+d*o*w-i*p*w)*T,n[10]=(l*v*a-g*u*a+g*o*h-i*v*h-l*o*w+i*u*w)*T,n[11]=(d*u*a-l*p*a-d*o*h+i*p*h+l*o*m-i*u*m)*T,n[12]=E*T,n[13]=(d*v*s-g*p*s+g*o*f-i*v*f-d*o*y+i*p*y)*T,n[14]=(g*u*s-l*v*s-g*o*c+i*v*c+l*o*y-i*u*y)*T,n[15]=(l*p*s-d*u*s+d*o*c-i*p*c-l*o*f+i*u*f)*T,this},scale:function(t){var e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this},getMaxScaleOnAxis:function(){var t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=1-n,o=t.x,s=t.y,a=t.z,l=i*o,u=i*s;return this.set(l*o+n,l*s-r*a,l*a+r*s,0,l*s+r*a,u*s+n,u*a-r*o,0,l*a-r*s,u*a+r*o,i*a*a+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){return this.makeRotationFromQuaternion(e),this.scale(n),this.setPosition(t),this},decompose:function(){var t=new Fe,e=new Ue;return function(n,r,i){var o=this.elements,s=t.set(o[0],o[1],o[2]).length(),a=t.set(o[4],o[5],o[6]).length(),l=t.set(o[8],o[9],o[10]).length();this.determinant()<0&&(s=-s),n.x=o[12],n.y=o[13],n.z=o[14],e.copy(this);var u=1/s,c=1/a,h=1/l;return e.elements[0]*=u,e.elements[1]*=u,e.elements[2]*=u,e.elements[4]*=c,e.elements[5]*=c,e.elements[6]*=c,e.elements[8]*=h,e.elements[9]*=h,e.elements[10]*=h,r.setFromRotationMatrix(e),i.x=s,i.y=a,i.z=l,this}}(),makePerspective:function(t,e,n,r,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var s=this.elements,a=2*i/(n-r),l=(e+t)/(e-t),u=(n+r)/(n-r),c=-(o+i)/(o-i),h=-2*o*i/(o-i);return s[0]=2*i/(e-t),s[4]=0,s[8]=l,s[12]=0,s[1]=0,s[5]=a,s[9]=u,s[13]=0,s[2]=0,s[6]=0,s[10]=c,s[14]=h,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this},makeOrthographic:function(t,e,n,r,i,o){var s=this.elements,a=1/(e-t),l=1/(n-r),u=1/(o-i),c=(e+t)*a,h=(n+r)*l,d=(o+i)*u;return s[0]=2*a,s[4]=0,s[8]=0,s[12]=-c,s[1]=0,s[5]=2*l,s[9]=0,s[13]=-h,s[2]=0,s[6]=0,s[10]=-2*u,s[14]=-d,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}),Object.assign(ze,{slerp:function(t,e,n,r){return n.copy(t).slerp(e,r)},slerpFlat:function(t,e,n,r,i,o,s){var a=n[r+0],l=n[r+1],u=n[r+2],c=n[r+3],h=i[o+0],d=i[o+1],p=i[o+2],f=i[o+3];if(c!==f||a!==h||l!==d||u!==p){var m=1-s,g=a*h+l*d+u*p+c*f,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){var w=Math.sqrt(y),b=Math.atan2(w,g*v);m=Math.sin(m*b)/w,s=Math.sin(s*b)/w}var x=s*v;if(a=a*m+h*x,l=l*m+d*x,u=u*m+p*x,c=c*m+f*x,m===1-s){var _=1/Math.sqrt(a*a+l*l+u*u+c*c);a*=_,l*=_,u*=_,c*=_}}t[e]=a,t[e+1]=l,t[e+2]=u,t[e+3]=c}}),Object.defineProperties(ze.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this.onChangeCallback()}}}),Object.assign(ze.prototype,{set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,r=t._y,i=t._z,o=t.order,s=Math.cos,a=Math.sin,l=s(n/2),u=s(r/2),c=s(i/2),h=a(n/2),d=a(r/2),p=a(i/2);return"XYZ"===o?(this._x=h*u*c+l*d*p,this._y=l*d*c-h*u*p,this._z=l*u*p+h*d*c,this._w=l*u*c-h*d*p):"YXZ"===o?(this._x=h*u*c+l*d*p,this._y=l*d*c-h*u*p,this._z=l*u*p-h*d*c,this._w=l*u*c+h*d*p):"ZXY"===o?(this._x=h*u*c-l*d*p,this._y=l*d*c+h*u*p,this._z=l*u*p+h*d*c,this._w=l*u*c-h*d*p):"ZYX"===o?(this._x=h*u*c-l*d*p,this._y=l*d*c+h*u*p,this._z=l*u*p-h*d*c,this._w=l*u*c+h*d*p):"YZX"===o?(this._x=h*u*c+l*d*p,this._y=l*d*c+h*u*p,this._z=l*u*p-h*d*c,this._w=l*u*c-h*d*p):"XZY"===o&&(this._x=h*u*c-l*d*p,this._y=l*d*c-h*u*p,this._z=l*u*p+h*d*c,this._w=l*u*c+h*d*p),!1!==e&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e,n=t.elements,r=n[0],i=n[4],o=n[8],s=n[1],a=n[5],l=n[9],u=n[2],c=n[6],h=n[10],d=r+a+h;return d>0?(e=.5/Math.sqrt(d+1),this._w=.25/e,this._x=(c-l)*e,this._y=(o-u)*e,this._z=(s-i)*e):r>a&&r>h?(e=2*Math.sqrt(1+r-a-h),this._w=(c-l)/e,this._x=.25*e,this._y=(i+s)/e,this._z=(o+u)/e):a>h?(e=2*Math.sqrt(1+a-r-h),this._w=(o-u)/e,this._x=(i+s)/e,this._y=.25*e,this._z=(l+c)/e):(e=2*Math.sqrt(1+h-r-a),this._w=(s-i)/e,this._x=(o+u)/e,this._y=(l+c)/e,this._z=.25*e),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,e=new Fe;return function(n,r){return void 0===e&&(e=new Fe),(t=n.dot(r)+1)<1e-6?(t=0,Math.abs(n.x)>Math.abs(n.z)?e.set(-n.y,n.x,0):e.set(0,-n.z,n.y)):e.crossVectors(n,r),this._x=e.x,this._y=e.y,this._z=e.z,this._w=t,this.normalize()}}(),inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(this._x=this._x*(t=1/t),this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,r=t._y,i=t._z,o=t._w,s=e._x,a=e._y,l=e._z,u=e._w;return this._x=n*u+o*s+r*l-i*a,this._y=r*u+o*a+i*s-n*l,this._z=i*u+o*l+n*a-r*s,this._w=o*u-n*s-r*a-i*l,this.onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,r=this._y,i=this._z,o=this._w,s=o*t._w+n*t._x+r*t._y+i*t._z;if(s<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,s=-s):this.copy(t),s>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;var a=Math.sqrt(1-s*s);if(Math.abs(a)<.001)return this._w=.5*(o+this._w),this._x=.5*(n+this._x),this._y=.5*(r+this._y),this._z=.5*(i+this._z),this;var l=Math.atan2(a,s),u=Math.sin((1-e)*l)/a,c=Math.sin(e*l)/a;return this._w=o*u+this._w*c,this._x=n*u+this._x*c,this._y=r*u+this._y*c,this._z=i*u+this._z*c,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(Fe.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(){var t=new ze;return function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(t.setFromEuler(e))}}(),applyAxisAngle:function(){var t=new ze;return function(e,n){return this.applyQuaternion(t.setFromAxisAngle(e,n))}}(),applyMatrix3:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements,o=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*o,this},applyQuaternion:function(t){var e=this.x,n=this.y,r=this.z,i=t.x,o=t.y,s=t.z,a=t.w,l=a*e+o*r-s*n,u=a*n+s*e-i*r,c=a*r+i*n-o*e,h=-i*e-o*n-s*r;return this.x=l*a+h*-i+u*-s-c*-o,this.y=u*a+h*-o+c*-i-l*-s,this.z=c*a+h*-s+l*-o-u*-i,this},project:function(){var t=new Ue;return function(e){return t.multiplyMatrices(e.projectionMatrix,t.getInverse(e.matrixWorld)),this.applyMatrix4(t)}}(),unproject:function(){var t=new Ue;return function(e){return t.multiplyMatrices(e.matrixWorld,t.getInverse(e.projectionMatrix)),this.applyMatrix4(t)}}(),transformDirection:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(){var t=new Fe,e=new Fe;return function(n,r){return t.set(n,n,n),e.set(r,r,r),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var n=t.x,r=t.y,i=t.z,o=e.x,s=e.y,a=e.z;return this.x=r*a-i*s,this.y=i*o-n*a,this.z=n*s-r*o,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:function(){var t=new Fe;return function(e){return t.copy(this).projectOnVector(e),this.sub(t)}}(),reflect:function(){var t=new Fe;return function(e){return this.sub(t.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(t){var e=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(De.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){var e=Math.sin(t.phi)*t.radius;return this.x=e*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=e*Math.cos(t.theta),this},setFromCylindrical:function(t){return this.x=t.radius*Math.sin(t.theta),this.y=t.y,this.z=t.radius*Math.cos(t.theta),this},setFromMatrixPosition:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}}),Object.assign(ke.prototype,{isMatrix3:!0,set:function(t,e,n,r,i,o,s,a,l){var u=this.elements;return u[0]=t,u[1]=r,u[2]=s,u[3]=e,u[4]=i,u[5]=a,u[6]=n,u[7]=o,u[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},applyToBufferAttribute:function(){var t=new Fe;return function(e){for(var n=0,r=e.count;n<r;n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.applyMatrix3(this),e.setXYZ(n,t.x,t.y,t.z);return e}}(),multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,o=n[0],s=n[3],a=n[6],l=n[1],u=n[4],c=n[7],h=n[2],d=n[5],p=n[8],f=r[0],m=r[3],g=r[6],v=r[1],y=r[4],w=r[7],b=r[2],x=r[5],_=r[8];return i[0]=o*f+s*v+a*b,i[3]=o*m+s*y+a*x,i[6]=o*g+s*w+a*_,i[1]=l*f+u*v+c*b,i[4]=l*m+u*y+c*x,i[7]=l*g+u*w+c*_,i[2]=h*f+d*v+p*b,i[5]=h*m+d*y+p*x,i[8]=h*g+d*w+p*_,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],l=t[7],u=t[8];return e*o*u-e*s*l-n*i*u+n*s*a+r*i*l-r*o*a},getInverse:function(t,e){t&&t.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var n=t.elements,r=this.elements,i=n[0],o=n[1],s=n[2],a=n[3],l=n[4],u=n[5],c=n[6],h=n[7],d=n[8],p=d*l-u*h,f=u*c-d*a,m=h*a-l*c,g=i*p+o*f+s*m;if(0===g){var v="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(v);return console.warn(v),this.identity()}var y=1/g;return r[0]=p*y,r[1]=(s*h-d*o)*y,r[2]=(u*o-s*l)*y,r[3]=f*y,r[4]=(d*i-s*c)*y,r[5]=(s*a-u*i)*y,r[6]=m*y,r[7]=(o*c-h*i)*y,r[8]=(l*i-o*a)*y,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,n,r,i,o,s){var a=Math.cos(i),l=Math.sin(i);this.set(n*a,n*l,-n*(a*o+l*s)+o+t,-r*l,r*a,-r*(-l*o+a*s)+s+e,0,0,1)},scale:function(t,e){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this},rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=this.elements,i=r[0],o=r[3],s=r[6],a=r[1],l=r[4],u=r[7];return r[0]=e*i+n*a,r[3]=e*o+n*l,r[6]=e*s+n*u,r[1]=-n*i+e*a,r[4]=-n*o+e*l,r[7]=-n*s+e*u,this},translate:function(t,e){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<9;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}});var Ve=0;function Ge(t,e,n,r,i,o,s,a,l,u){Object.defineProperty(this,"id",{value:Ve++}),this.uuid=De.generateUUID(),this.name="",this.image=void 0!==t?t:Ge.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:Ge.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:gt,this.wrapT=void 0!==r?r:gt,this.magFilter=void 0!==i?i:xt,this.minFilter=void 0!==o?o:Et,this.anisotropy=void 0!==l?l:1,this.format=void 0!==s?s:zt,this.type=void 0!==a?a:St,this.offset=new Be(0,0),this.repeat=new Be(1,1),this.center=new Be(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ke,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==u?u:Me,this.version=0,this.onUpdate=null}function je(t,e,n,r){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==r?r:1}function He(t,e,n){this.width=t,this.height=e,this.scissor=new je(0,0,t,e),this.scissorTest=!1,this.viewport=new je(0,0,t,e),void 0===(n=n||{}).minFilter&&(n.minFilter=xt),this.texture=new Ge(void 0,void 0,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function We(t,e,n){He.call(this,t,e,n),this.activeCubeFace=0,this.activeMipMapLevel=0}function qe(t,e,n,r,i,o,s,a,l,u,c,h){Ge.call(this,null,o,s,a,l,u,r,i,c,h),this.image={data:t,width:e,height:n},this.magFilter=void 0!==l?l:yt,this.minFilter=void 0!==u?u:yt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function Xe(t,e){this.min=void 0!==t?t:new Fe(1/0,1/0,1/0),this.max=void 0!==e?e:new Fe(-1/0,-1/0,-1/0)}function Ye(t,e){this.center=void 0!==t?t:new Fe,this.radius=void 0!==e?e:0}function Ze(t,e){this.normal=void 0!==t?t:new Fe(1,0,0),this.constant=void 0!==e?e:0}function $e(t,e,n,r,i,o){this.planes=[void 0!==t?t:new Ze,void 0!==e?e:new Ze,void 0!==n?n:new Ze,void 0!==r?r:new Ze,void 0!==i?i:new Ze,void 0!==o?o:new Ze]}Ge.DEFAULT_IMAGE=void 0,Ge.DEFAULT_MAPPING=at,Ge.prototype=Object.assign(Object.create(r.prototype),{constructor:Ge,isTexture:!0,clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var r=this.image;void 0===r.uuid&&(r.uuid=De.generateUUID()),e||void 0!==t.images[r.uuid]||(t.images[r.uuid]={uuid:r.uuid,url:function(t){var e;if(t instanceof HTMLCanvasElement)e=t;else{(e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=t.width,e.height=t.height;var n=e.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height)}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}(r)}),n.image=r.uuid}return e||(t.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping===at){if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case mt:t.x=t.x-Math.floor(t.x);break;case gt:t.x=t.x<0?0:1;break;case vt:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case mt:t.y=t.y-Math.floor(t.y);break;case gt:t.y=t.y<0?0:1;break;case vt:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}}}),Object.defineProperty(Ge.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(je.prototype,{isVector4:!0,set:function(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*e+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*e+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*e+o[7]*n+o[11]*r+o[15]*i,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,r,i,o=t.elements,s=o[0],a=o[4],l=o[8],u=o[1],c=o[5],h=o[9],d=o[2],p=o[6],f=o[10];if(Math.abs(a-u)<.01&&Math.abs(l-d)<.01&&Math.abs(h-p)<.01){if(Math.abs(a+u)<.1&&Math.abs(l+d)<.1&&Math.abs(h+p)<.1&&Math.abs(s+c+f-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;var m=(s+1)/2,g=(c+1)/2,v=(f+1)/2,y=(a+u)/4,w=(l+d)/4,b=(h+p)/4;return m>g&&m>v?m<.01?(n=0,r=.707106781,i=.707106781):(r=y/(n=Math.sqrt(m)),i=w/n):g>v?g<.01?(n=.707106781,r=0,i=.707106781):(n=y/(r=Math.sqrt(g)),i=b/r):v<.01?(n=.707106781,r=.707106781,i=0):(n=w/(i=Math.sqrt(v)),r=b/i),this.set(n,r,i,e),this}var x=Math.sqrt((p-h)*(p-h)+(l-d)*(l-d)+(u-a)*(u-a));return Math.abs(x)<.001&&(x=1),this.x=(p-h)/x,this.y=(l-d)/x,this.z=(u-a)/x,this.w=Math.acos((s+c+f-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(){var t,e;return function(n,r){return void 0===t&&(t=new je,e=new je),t.set(n,n,n,n),e.set(r,r,r,r),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}}),He.prototype=Object.assign(Object.create(r.prototype),{constructor:He,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),(We.prototype=Object.create(He.prototype)).constructor=We,We.prototype.isWebGLRenderTargetCube=!0,(qe.prototype=Object.create(Ge.prototype)).constructor=qe,qe.prototype.isDataTexture=!0,Object.assign(Xe.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,s=-1/0,a=0,l=t.length;a<l;a+=3){var u=t[a],c=t[a+1],h=t[a+2];u<e&&(e=u),c<n&&(n=c),h<r&&(r=h),u>i&&(i=u),c>o&&(o=c),h>s&&(s=h)}return this.min.set(e,n,r),this.max.set(i,o,s),this},setFromBufferAttribute:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,s=-1/0,a=0,l=t.count;a<l;a++){var u=t.getX(a),c=t.getY(a),h=t.getZ(a);u<e&&(e=u),c<n&&(n=c),h<r&&(r=h),u>i&&(i=u),c>o&&(o=c),h>s&&(s=h)}return this.min.set(e,n,r),this.max.set(i,o,s),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new Fe;return function(e,n){var r=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}}(),setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new Fe),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new Fe),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(){var t,e,n,r=new Fe;function i(i){var o=i.geometry;if(void 0!==o)if(o.isGeometry){var s=o.vertices;for(e=0,n=s.length;e<n;e++)r.copy(s[e]),r.applyMatrix4(i.matrixWorld),t.expandByPoint(r)}else if(o.isBufferGeometry){var a=o.attributes.position;if(void 0!==a)for(e=0,n=a.count;e<n;e++)r.fromBufferAttribute(a,e).applyMatrix4(i.matrixWorld),t.expandByPoint(r)}}return function(e){return t=this,e.updateMatrixWorld(!0),e.traverse(i),this}}(),containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new Fe),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(){var t=new Fe;return function(e){return this.clampPoint(e.center,t),t.distanceToSquared(e.center)<=e.radius*e.radius}}(),intersectsPlane:function(t){var e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=t.constant&&n>=t.constant},intersectsTriangle:function(){var t=new Fe,e=new Fe,n=new Fe,r=new Fe,i=new Fe,o=new Fe,s=new Fe,a=new Fe,l=new Fe,u=new Fe;function c(r){var i,o;for(i=0,o=r.length-3;i<=o;i+=3){s.fromArray(r,i);var a=l.x*Math.abs(s.x)+l.y*Math.abs(s.y)+l.z*Math.abs(s.z),u=t.dot(s),c=e.dot(s),h=n.dot(s);if(Math.max(-Math.max(u,c,h),Math.min(u,c,h))>a)return!1}return!0}return function(s){if(this.isEmpty())return!1;this.getCenter(a),l.subVectors(this.max,a),t.subVectors(s.a,a),e.subVectors(s.b,a),n.subVectors(s.c,a),r.subVectors(e,t),i.subVectors(n,e),o.subVectors(t,n);var h=[0,-r.z,r.y,0,-i.z,i.y,0,-o.z,o.y,r.z,0,-r.x,i.z,0,-i.x,o.z,0,-o.x,-r.y,r.x,0,-i.y,i.x,0,-o.y,o.x,0];return!!c(h)&&!!c(h=[1,0,0,0,1,0,0,0,1])&&(u.crossVectors(r,i),c(h=[u.x,u.y,u.z]))}}(),clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new Fe),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new Fe;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),getBoundingSphere:function(){var t=new Fe;return function(e){return void 0===e&&(console.warn("THREE.Box3: .getBoundingSphere() target is now required"),e=new Ye),this.getCenter(e.center),e.radius=.5*this.getSize(t).length(),e}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(){var t=[new Fe,new Fe,new Fe,new Fe,new Fe,new Fe,new Fe,new Fe];return function(e){return this.isEmpty()?this:(t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(t),this)}}(),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Object.assign(Ye.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(){var t=new Xe;return function(e,n){var r=this.center;void 0!==n?r.copy(n):t.setFromPoints(e).getCenter(r);for(var i=0,o=0,s=e.length;o<s;o++)i=Math.max(i,r.distanceToSquared(e[o]));return this.radius=Math.sqrt(i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var n=this.center.distanceToSquared(t);return void 0===e&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),e=new Fe),e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new Xe),t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}}),Object.assign(Ze.prototype,{set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new Fe,e=new Fe;return function(n,r,i){var o=t.subVectors(i,r).cross(e.subVectors(n,r)).normalize();return this.setFromNormalAndCoplanarPoint(o,n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return void 0===e&&(console.warn("THREE.Plane: .projectPoint() target is now required"),e=new Fe),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(){var t=new Fe;return function(e,n){void 0===n&&(console.warn("THREE.Plane: .intersectLine() target is now required"),n=new Fe);var r=e.delta(t),i=this.normal.dot(r);if(0===i)return 0===this.distanceToPoint(e.start)?n.copy(e.start):void 0;var o=-(e.start.dot(this.normal)+this.constant)/i;return o<0||o>1?void 0:n.copy(r).multiplyScalar(o).add(e.start)}}(),intersectsLine:function(t){var e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new Fe),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new Fe,e=new ke;return function(n,r){var i=r||e.getNormalMatrix(n),o=this.coplanarPoint(t).applyMatrix4(n),s=this.normal.applyMatrix3(i).normalize();return this.constant=-o.dot(s),this}}(),translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}}),Object.assign($e.prototype,{set:function(t,e,n,r,i,o){var s=this.planes;return s[0].copy(t),s[1].copy(e),s[2].copy(n),s[3].copy(r),s[4].copy(i),s[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,n=0;n<6;n++)e[n].copy(t.planes[n]);return this},setFromMatrix:function(t){var e=this.planes,n=t.elements,r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],l=n[5],u=n[6],c=n[7],h=n[8],d=n[9],p=n[10],f=n[11],m=n[12],g=n[13],v=n[14],y=n[15];return e[0].setComponents(s-r,c-a,f-h,y-m).normalize(),e[1].setComponents(s+r,c+a,f+h,y+m).normalize(),e[2].setComponents(s+i,c+l,f+d,y+g).normalize(),e[3].setComponents(s-i,c-l,f-d,y-g).normalize(),e[4].setComponents(s-o,c-u,f-p,y-v).normalize(),e[5].setComponents(s+o,c+u,f+p,y+v).normalize(),this},intersectsObject:function(){var t=new Ye;return function(e){var n=e.geometry;return null===n.boundingSphere&&n.computeBoundingSphere(),t.copy(n.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSprite:function(){var t=new Ye;return function(e){return t.center.set(0,0,0),t.radius=.7071067811865476,t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){for(var e=this.planes,n=t.center,r=-t.radius,i=0;i<6;i++)if(e[i].distanceToPoint(n)<r)return!1;return!0},intersectsBox:function(){var t=new Fe,e=new Fe;return function(n){for(var r=this.planes,i=0;i<6;i++){var o=r[i];t.x=o.normal.x>0?n.min.x:n.max.x,e.x=o.normal.x>0?n.max.x:n.min.x,t.y=o.normal.y>0?n.min.y:n.max.y,e.y=o.normal.y>0?n.max.y:n.min.y,t.z=o.normal.z>0?n.min.z:n.max.z,e.z=o.normal.z>0?n.max.z:n.min.z;var s=o.distanceToPoint(t),a=o.distanceToPoint(e);if(s<0&&a<0)return!1}return!0}}(),containsPoint:function(t){for(var e=this.planes,n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}});var Qe={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_vertex:"\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars_begin:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n",lights_pars_maps:"#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif\n",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif\n",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n",normal_fragment_maps:"#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n"},Je={merge:function(t){for(var e={},n=0;n<t.length;n++){var r=this.clone(t[n]);for(var i in r)e[i]=r[i]}return e},clone:function(t){var e={};for(var n in t)for(var r in e[n]={},t[n]){var i=t[n][r];e[n][r]=i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?i.clone():Array.isArray(i)?i.slice():i}return e}},Ke={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function tn(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}Object.assign(tn.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(){function t(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}return function(e,n,r){if(e=De.euclideanModulo(e,1),n=De.clamp(n,0,1),r=De.clamp(r,0,1),0===n)this.r=this.g=this.b=r;else{var i=r<=.5?r*(1+n):r+n-r*n,o=2*r-i;this.r=t(o,i,e+1/3),this.g=t(o,i,e),this.b=t(o,i,e-1/3)}return this}}(),setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var r,i=n[2];switch(n[1]){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,e(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,e(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i)){var o=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,a=parseInt(r[3],10)/100;return e(r[5]),this.setHSL(o,s,a)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){var l,u=(l=n[1]).length;if(3===u)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,this;if(6===u)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,this}return t&&t.length>0&&(void 0!==(l=Ke[t])?this.setHex(l):console.warn("THREE.Color: Unknown color "+t)),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},convertGammaToLinear:function(){var t=this.r,e=this.g,n=this.b;return this.r=t*t,this.g=e*e,this.b=n*n,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var e,n,r=this.r,i=this.g,o=this.b,s=Math.max(r,i,o),a=Math.min(r,i,o),l=(a+s)/2;if(a===s)e=0,n=0;else{var u=s-a;switch(n=l<=.5?u/(s+a):u/(2-s-a),s){case r:e=(i-o)/u+(i<o?6:0);break;case i:e=(o-r)/u+2;break;case o:e=(r-i)/u+4}e/=6}return t.h=e,t.s=n,t.l=l,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(){var t={};return function(e,n,r){return this.getHSL(t),t.h+=e,t.s+=n,t.l+=r,this.setHSL(t.h,t.s,t.l),this}}(),add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}});var en={common:{diffuse:{value:new tn(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new ke},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Be(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new tn(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new tn(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new ke}}},nn={basic:{uniforms:Je.merge([en.common,en.specularmap,en.envmap,en.aomap,en.lightmap,en.fog]),vertexShader:Qe.meshbasic_vert,fragmentShader:Qe.meshbasic_frag},lambert:{uniforms:Je.merge([en.common,en.specularmap,en.envmap,en.aomap,en.lightmap,en.emissivemap,en.fog,en.lights,{emissive:{value:new tn(0)}}]),vertexShader:Qe.meshlambert_vert,fragmentShader:Qe.meshlambert_frag},phong:{uniforms:Je.merge([en.common,en.specularmap,en.envmap,en.aomap,en.lightmap,en.emissivemap,en.bumpmap,en.normalmap,en.displacementmap,en.gradientmap,en.fog,en.lights,{emissive:{value:new tn(0)},specular:{value:new tn(1118481)},shininess:{value:30}}]),vertexShader:Qe.meshphong_vert,fragmentShader:Qe.meshphong_frag},standard:{uniforms:Je.merge([en.common,en.envmap,en.aomap,en.lightmap,en.emissivemap,en.bumpmap,en.normalmap,en.displacementmap,en.roughnessmap,en.metalnessmap,en.fog,en.lights,{emissive:{value:new tn(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Qe.meshphysical_vert,fragmentShader:Qe.meshphysical_frag},points:{uniforms:Je.merge([en.points,en.fog]),vertexShader:Qe.points_vert,fragmentShader:Qe.points_frag},dashed:{uniforms:Je.merge([en.common,en.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Qe.linedashed_vert,fragmentShader:Qe.linedashed_frag},depth:{uniforms:Je.merge([en.common,en.displacementmap]),vertexShader:Qe.depth_vert,fragmentShader:Qe.depth_frag},normal:{uniforms:Je.merge([en.common,en.bumpmap,en.normalmap,en.displacementmap,{opacity:{value:1}}]),vertexShader:Qe.normal_vert,fragmentShader:Qe.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Qe.cube_vert,fragmentShader:Qe.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Qe.equirect_vert,fragmentShader:Qe.equirect_frag},distanceRGBA:{uniforms:Je.merge([en.common,en.displacementmap,{referencePosition:{value:new Fe},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Qe.distanceRGBA_vert,fragmentShader:Qe.distanceRGBA_frag},shadow:{uniforms:Je.merge([en.lights,en.fog,{color:{value:new tn(0)},opacity:{value:1}}]),vertexShader:Qe.shadow_vert,fragmentShader:Qe.shadow_frag}};function rn(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._order=r||rn.DefaultOrder}function on(){this.mask=1}nn.physical={uniforms:Je.merge([nn.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Qe.meshphysical_vert,fragmentShader:Qe.meshphysical_frag},rn.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],rn.DefaultOrder="XYZ",Object.defineProperties(rn.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback()}}}),Object.assign(rn.prototype,{isEuler:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._order=r||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e,n){var r=De.clamp,i=t.elements,o=i[0],s=i[4],a=i[8],l=i[1],u=i[5],c=i[9],h=i[2],d=i[6],p=i[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(r(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(-c,p),this._z=Math.atan2(-s,o)):(this._x=Math.atan2(d,u),this._z=0)):"YXZ"===e?(this._x=Math.asin(-r(c,-1,1)),Math.abs(c)<.99999?(this._y=Math.atan2(a,p),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,o),this._z=0)):"ZXY"===e?(this._x=Math.asin(r(d,-1,1)),Math.abs(d)<.99999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-s,u)):(this._y=0,this._z=Math.atan2(l,o))):"ZYX"===e?(this._y=Math.asin(-r(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(d,p),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-s,u))):"YZX"===e?(this._z=Math.asin(r(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(a,p))):"XZY"===e?(this._z=Math.asin(-r(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(d,u),this._y=Math.atan2(a,o)):(this._x=Math.atan2(-c,p),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==n&&this.onChangeCallback(),this},setFromQuaternion:function(){var t=new Ue;return function(e,n,r){return t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t,n,r)}}(),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(){var t=new ze;return function(e){return t.setFromEuler(this),this.setFromQuaternion(t,e)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new Fe(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(on.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},test:function(t){return 0!=(this.mask&t.mask)}});var sn=0;function an(){Object.defineProperty(this,"id",{value:sn++}),this.uuid=De.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=an.DefaultUp.clone();var t=new Fe,e=new rn,n=new ze,r=new Fe(1,1,1);e.onChange(function(){n.setFromEuler(e,!1)}),n.onChange(function(){e.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:t},rotation:{enumerable:!0,value:e},quaternion:{enumerable:!0,value:n},scale:{enumerable:!0,value:r},modelViewMatrix:{value:new Ue},normalMatrix:{value:new ke}}),this.matrix=new Ue,this.matrixWorld=new Ue,this.matrixAutoUpdate=an.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new on,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function ln(){an.call(this),this.type="Camera",this.matrixWorldInverse=new Ue,this.projectionMatrix=new Ue}function un(t,e,n,r,i,o){ln.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=r,this.near=void 0!==i?i:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function cn(t,e,n,r,i,o){this.a=t,this.b=e,this.c=n,this.normal=r&&r.isVector3?r:new Fe,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new tn,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==o?o:0}an.DefaultUp=new Fe(0,1,0),an.DefaultMatrixAutoUpdate=!0,an.prototype=Object.assign(Object.create(r.prototype),{constructor:an,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(){var t=new ze;return function(e,n){return t.setFromAxisAngle(e,n),this.quaternion.multiply(t),this}}(),rotateOnWorldAxis:function(){var t=new ze;return function(e,n){return t.setFromAxisAngle(e,n),this.quaternion.premultiply(t),this}}(),rotateX:function(){var t=new Fe(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new Fe(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new Fe(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new Fe;return function(e,n){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(n)),this}}(),translateX:function(){var t=new Fe(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new Fe(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new Fe(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new Ue;return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new Ue,e=new Fe;return function(n,r,i){n.isVector3?e.copy(n):e.set(n,r,i),this.isCamera?t.lookAt(this.position,e,this.up):t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var n=this.children.indexOf(t);return-1!==n&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(n,1)),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new Fe),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var t=new Fe,e=new Fe;return function(n){return void 0===n&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),n=new ze),this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,n,e),n}}(),getWorldScale:function(){var t=new Fe,e=new ze;return function(n){return void 0===n&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),n=new Fe),this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,n),n}}(),getWorldDirection:function(){var t=new ze;return function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new Fe),this.getWorldQuaternion(t),e.set(0,0,1).applyQuaternion(t)}}(),raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)},toJSON:function(t){var e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.matrix=this.matrix.toArray(),void 0!==this.geometry){r.geometry=i(t.geometries,this.geometry);var o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes){var s=o.shapes;if(Array.isArray(s))for(var a=0,l=s.length;a<l;a++)i(t.shapes,s[a]);else i(t.shapes,s)}}if(void 0!==this.material)if(Array.isArray(this.material)){var u=[];for(a=0,l=this.material.length;a<l;a++)u.push(i(t.materials,this.material[a]));r.material=u}else r.material=i(t.materials,this.material);if(this.children.length>0)for(r.children=[],a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(t).object);if(e){var c=f(t.geometries),h=f(t.materials),d=f(t.textures),p=f(t.images);s=f(t.shapes),c.length>0&&(n.geometries=c),h.length>0&&(n.materials=h),d.length>0&&(n.textures=d),p.length>0&&(n.images=p),s.length>0&&(n.shapes=s)}return n.object=r,n;function f(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var n=0;n<t.children.length;n++)this.add(t.children[n].clone());return this}}),ln.prototype=Object.assign(Object.create(an.prototype),{constructor:ln,isCamera:!0,copy:function(t,e){return an.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this},getWorldDirection:function(){var t=new ze;return function(e){return void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new Fe),this.getWorldQuaternion(t),e.set(0,0,-1).applyQuaternion(t)}}(),updateMatrixWorld:function(t){an.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),un.prototype=Object.assign(Object.create(ln.prototype),{constructor:un,isOrthographicCamera:!0,copy:function(t,e){return ln.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-t,o=n+t,s=r+e,a=r-e;if(null!==this.view&&this.view.enabled){var l=this.zoom/(this.view.width/this.view.fullWidth),u=this.zoom/(this.view.height/this.view.fullHeight),c=(this.right-this.left)/this.view.width,h=(this.top-this.bottom)/this.view.height;o=(i+=c*(this.view.offsetX/l))+c*(this.view.width/l),a=(s-=h*(this.view.offsetY/u))-h*(this.view.height/u)}this.projectionMatrix.makeOrthographic(i,o,s,a,this.near,this.far)},toJSON:function(t){var e=an.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}),Object.assign(cn.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}});var hn=0;function dn(){Object.defineProperty(this,"id",{value:hn+=2}),this.uuid=De.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function pn(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function fn(t,e,n){pn.call(this,new Int8Array(t),e,n)}function mn(t,e,n){pn.call(this,new Uint8Array(t),e,n)}function gn(t,e,n){pn.call(this,new Uint8ClampedArray(t),e,n)}function vn(t,e,n){pn.call(this,new Int16Array(t),e,n)}function yn(t,e,n){pn.call(this,new Uint16Array(t),e,n)}function wn(t,e,n){pn.call(this,new Int32Array(t),e,n)}function bn(t,e,n){pn.call(this,new Uint32Array(t),e,n)}function xn(t,e,n){pn.call(this,new Float32Array(t),e,n)}function _n(t,e,n){pn.call(this,new Float64Array(t),e,n)}function En(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Sn(t){if(0===t.length)return-1/0;for(var e=t[0],n=1,r=t.length;n<r;++n)t[n]>e&&(e=t[n]);return e}dn.prototype=Object.assign(Object.create(r.prototype),{constructor:dn,isGeometry:!0,applyMatrix:function(t){for(var e=(new ke).getNormalMatrix(t),n=0,r=this.vertices.length;n<r;n++)this.vertices[n].applyMatrix4(t);for(n=0,r=this.faces.length;n<r;n++){var i=this.faces[n];i.normal.applyMatrix3(e).normalize();for(var o=0,s=i.vertexNormals.length;o<s;o++)i.vertexNormals[o].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var t=new Ue;return function(e){return t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t=new Ue;return function(e){return t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new Ue;return function(e){return t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t=new Ue;return function(e,n,r){return t.makeTranslation(e,n,r),this.applyMatrix(t),this}}(),scale:function(){var t=new Ue;return function(e,n,r){return t.makeScale(e,n,r),this.applyMatrix(t),this}}(),lookAt:function(){var t=new an;return function(e){t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),fromBufferGeometry:function(t){var e=this,n=null!==t.index?t.index.array:void 0,r=t.attributes,i=r.position.array,o=void 0!==r.normal?r.normal.array:void 0,s=void 0!==r.color?r.color.array:void 0,a=void 0!==r.uv?r.uv.array:void 0,l=void 0!==r.uv2?r.uv2.array:void 0;void 0!==l&&(this.faceVertexUvs[1]=[]);for(var u=[],c=[],h=[],d=0,p=0;d<i.length;d+=3,p+=2)e.vertices.push(new Fe(i[d],i[d+1],i[d+2])),void 0!==o&&u.push(new Fe(o[d],o[d+1],o[d+2])),void 0!==s&&e.colors.push(new tn(s[d],s[d+1],s[d+2])),void 0!==a&&c.push(new Be(a[p],a[p+1])),void 0!==l&&h.push(new Be(l[p],l[p+1]));function f(t,n,r,i){var d=new cn(t,n,r,void 0!==o?[u[t].clone(),u[n].clone(),u[r].clone()]:[],void 0!==s?[e.colors[t].clone(),e.colors[n].clone(),e.colors[r].clone()]:[],i);e.faces.push(d),void 0!==a&&e.faceVertexUvs[0].push([c[t].clone(),c[n].clone(),c[r].clone()]),void 0!==l&&e.faceVertexUvs[1].push([h[t].clone(),h[n].clone(),h[r].clone()])}var m=t.groups;if(m.length>0)for(d=0;d<m.length;d++)for(var g=m[d],v=g.start,y=(p=v,v+g.count);p<y;p+=3)void 0!==n?f(n[p],n[p+1],n[p+2],g.materialIndex):f(p,p+1,p+2,g.materialIndex);else if(void 0!==n)for(d=0;d<n.length;d+=3)f(n[d],n[d+1],n[d+2]);else for(d=0;d<i.length/3;d+=3)f(d,d+1,d+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){var t=new Fe;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(t).negate(),this.translate(t.x,t.y,t.z),this}}(),normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,n=0===e?1:1/e,r=new Ue;return r.set(n,0,0,-n*t.x,0,n,0,-n*t.y,0,0,n,-n*t.z,0,0,0,1),this.applyMatrix(r),this},computeFaceNormals:function(){for(var t=new Fe,e=new Fe,n=0,r=this.faces.length;n<r;n++){var i=this.faces[n],o=this.vertices[i.a],s=this.vertices[i.b];t.subVectors(this.vertices[i.c],s),e.subVectors(o,s),t.cross(e),t.normalize(),i.normal.copy(t)}},computeVertexNormals:function(t){var e,n,r,i,o,s;for(void 0===t&&(t=!0),s=new Array(this.vertices.length),e=0,n=this.vertices.length;e<n;e++)s[e]=new Fe;if(t){var a,l,u=new Fe,c=new Fe;for(r=0,i=this.faces.length;r<i;r++)a=this.vertices[(o=this.faces[r]).a],u.subVectors(this.vertices[o.c],l=this.vertices[o.b]),c.subVectors(a,l),u.cross(c),s[o.a].add(u),s[o.b].add(u),s[o.c].add(u)}else for(this.computeFaceNormals(),r=0,i=this.faces.length;r<i;r++)s[(o=this.faces[r]).a].add(o.normal),s[o.b].add(o.normal),s[o.c].add(o.normal);for(e=0,n=this.vertices.length;e<n;e++)s[e].normalize();for(r=0,i=this.faces.length;r<i;r++){var h=(o=this.faces[r]).vertexNormals;3===h.length?(h[0].copy(s[o.a]),h[1].copy(s[o.b]),h[2].copy(s[o.c])):(h[0]=s[o.a].clone(),h[1]=s[o.b].clone(),h[2]=s[o.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,e,n;for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++){var r=(n=this.faces[t]).vertexNormals;3===r.length?(r[0].copy(n.normal),r[1].copy(n.normal),r[2].copy(n.normal)):(r[0]=n.normal.clone(),r[1]=n.normal.clone(),r[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,n,r,i;for(n=0,r=this.faces.length;n<r;n++)for((i=this.faces[n]).__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),t=0,e=i.vertexNormals.length;t<e;t++)i.__originalVertexNormals[t]?i.__originalVertexNormals[t].copy(i.vertexNormals[t]):i.__originalVertexNormals[t]=i.vertexNormals[t].clone();var o=new dn;for(o.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var s=this.morphNormals[t].faceNormals,a=this.morphNormals[t].vertexNormals;for(n=0,r=this.faces.length;n<r;n++)l=new Fe,u={a:new Fe,b:new Fe,c:new Fe},s.push(l),a.push(u)}var l,u,c=this.morphNormals[t];for(o.vertices=this.morphTargets[t].vertices,o.computeFaceNormals(),o.computeVertexNormals(),n=0,r=this.faces.length;n<r;n++)u=c.vertexNormals[n],(l=c.faceNormals[n]).copy((i=this.faces[n]).normal),u.a.copy(i.vertexNormals[0]),u.b.copy(i.vertexNormals[1]),u.c.copy(i.vertexNormals[2])}for(n=0,r=this.faces.length;n<r;n++)(i=this.faces[n]).normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Xe),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Ye),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,n){if(t&&t.isGeometry){var r,i=this.vertices.length,o=this.vertices,s=t.vertices,a=this.faces,l=t.faces,u=this.faceVertexUvs[0],c=t.faceVertexUvs[0],h=this.colors,d=t.colors;void 0===n&&(n=0),void 0!==e&&(r=(new ke).getNormalMatrix(e));for(var p=0,f=s.length;p<f;p++){var m=s[p].clone();void 0!==e&&m.applyMatrix4(e),o.push(m)}for(p=0,f=d.length;p<f;p++)h.push(d[p].clone());for(p=0,f=l.length;p<f;p++){var g,v,y=l[p],w=y.vertexNormals,b=y.vertexColors;(g=new cn(y.a+i,y.b+i,y.c+i)).normal.copy(y.normal),void 0!==r&&g.normal.applyMatrix3(r).normalize();for(var x=0,_=w.length;x<_;x++)v=w[x].clone(),void 0!==r&&v.applyMatrix3(r).normalize(),g.vertexNormals.push(v);for(g.color.copy(y.color),x=0,_=b.length;x<_;x++)g.vertexColors.push(b[x].clone());g.materialIndex=y.materialIndex+n,a.push(g)}for(p=0,f=c.length;p<f;p++){var E=c[p],S=[];if(void 0!==E){for(x=0,_=E.length;x<_;x++)S.push(E[x].clone());u.push(S)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){var t,e,n,r,i,o,s,a,l={},u=[],c=[],h=Math.pow(10,4);for(n=0,r=this.vertices.length;n<r;n++)t=this.vertices[n],void 0===l[e=Math.round(t.x*h)+"_"+Math.round(t.y*h)+"_"+Math.round(t.z*h)]?(l[e]=n,u.push(this.vertices[n]),c[n]=u.length-1):c[n]=c[l[e]];var d=[];for(n=0,r=this.faces.length;n<r;n++){(i=this.faces[n]).a=c[i.a],i.b=c[i.b],i.c=c[i.c],o=[i.a,i.b,i.c];for(var p=0;p<3;p++)if(o[p]===o[(p+1)%3]){d.push(n);break}}for(n=d.length-1;n>=0;n--){var f=d[n];for(this.faces.splice(f,1),s=0,a=this.faceVertexUvs.length;s<a;s++)this.faceVertexUvs[s].splice(f,1)}var m=this.vertices.length-u.length;return this.vertices=u,m},setFromPoints:function(t){this.vertices=[];for(var e=0,n=t.length;e<n;e++){var r=t[e];this.vertices.push(new Fe(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,n=0;n<e;n++)t[n]._id=n;t.sort(function(t,e){return t.materialIndex-e.materialIndex});var r,i,o=this.faceVertexUvs[0],s=this.faceVertexUvs[1];for(o&&o.length===e&&(r=[]),s&&s.length===e&&(i=[]),n=0;n<e;n++){var a=t[n]._id;r&&r.push(o[a]),i&&i.push(s[a])}r&&(this.faceVertexUvs[0]=r),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){var t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}for(var r=[],i=0;i<this.vertices.length;i++){var o=this.vertices[i];r.push(o.x,o.y,o.z)}var s=[],a=[],l={},u=[],c={},h=[],d={};for(i=0;i<this.faces.length;i++){var p=this.faces[i],f=void 0!==this.faceVertexUvs[0][i],m=p.normal.length()>0,g=p.vertexNormals.length>0,v=1!==p.color.r||1!==p.color.g||1!==p.color.b,y=p.vertexColors.length>0,w=0;if(w=E(w=E(w=E(w=E(w=E(w=E(w=E(w=E(w,0,0),1,!0),2,!1),3,f),4,m),5,g),6,v),7,y),s.push(w),s.push(p.a,p.b,p.c),s.push(p.materialIndex),f){var b=this.faceVertexUvs[0][i];s.push(T(b[0]),T(b[1]),T(b[2]))}if(m&&s.push(S(p.normal)),g){var x=p.vertexNormals;s.push(S(x[0]),S(x[1]),S(x[2]))}if(v&&s.push(M(p.color)),y){var _=p.vertexColors;s.push(M(_[0]),M(_[1]),M(_[2]))}}function E(t,e,n){return n?t|1<<e:t&~(1<<e)}function S(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==l[e]?l[e]:(l[e]=a.length/3,a.push(t.x,t.y,t.z),l[e])}function M(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==c[e]?c[e]:(c[e]=u.length,u.push(t.getHex()),c[e])}function T(t){var e=t.x.toString()+t.y.toString();return void 0!==d[e]?d[e]:(d[e]=h.length/2,h.push(t.x,t.y),d[e])}return t.data={},t.data.vertices=r,t.data.normals=a,u.length>0&&(t.data.colors=u),h.length>0&&(t.data.uvs=[h]),t.data.faces=s,t},clone:function(){return(new dn).copy(this)},copy:function(t){var e,n,r,i,o,s;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var a=t.vertices;for(e=0,n=a.length;e<n;e++)this.vertices.push(a[e].clone());var l=t.colors;for(e=0,n=l.length;e<n;e++)this.colors.push(l[e].clone());var u=t.faces;for(e=0,n=u.length;e<n;e++)this.faces.push(u[e].clone());for(e=0,n=t.faceVertexUvs.length;e<n;e++){var c=t.faceVertexUvs[e];for(void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]),r=0,i=c.length;r<i;r++){var h=c[r],d=[];for(o=0,s=h.length;o<s;o++)d.push(h[o].clone());this.faceVertexUvs[e].push(d)}}var p=t.morphTargets;for(e=0,n=p.length;e<n;e++){var f={};if(f.name=p[e].name,void 0!==p[e].vertices)for(f.vertices=[],r=0,i=p[e].vertices.length;r<i;r++)f.vertices.push(p[e].vertices[r].clone());if(void 0!==p[e].normals)for(f.normals=[],r=0,i=p[e].normals.length;r<i;r++)f.normals.push(p[e].normals[r].clone());this.morphTargets.push(f)}var m=t.morphNormals;for(e=0,n=m.length;e<n;e++){var g={};if(void 0!==m[e].vertexNormals)for(g.vertexNormals=[],r=0,i=m[e].vertexNormals.length;r<i;r++){var v=m[e].vertexNormals[r],y={};y.a=v.a.clone(),y.b=v.b.clone(),y.c=v.c.clone(),g.vertexNormals.push(y)}if(void 0!==m[e].faceNormals)for(g.faceNormals=[],r=0,i=m[e].faceNormals.length;r<i;r++)g.faceNormals.push(m[e].faceNormals[r].clone());this.morphNormals.push(g)}var w=t.skinWeights;for(e=0,n=w.length;e<n;e++)this.skinWeights.push(w[e].clone());var b=t.skinIndices;for(e=0,n=b.length;e<n;e++)this.skinIndices.push(b[e].clone());var x=t.lineDistances;for(e=0,n=x.length;e<n;e++)this.lineDistances.push(x[e]);var _=t.boundingBox;null!==_&&(this.boundingBox=_.clone());var E=t.boundingSphere;return null!==E&&(this.boundingSphere=E.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(pn.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(pn.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.itemSize:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[t+r]=e.array[n+r];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new tn),e[n++]=o.r,e[n++]=o.g,e[n++]=o.b}return this},copyVector2sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new Be),e[n++]=o.x,e[n++]=o.y}return this},copyVector3sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new Fe),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z}return this},copyVector4sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new je),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z,e[n++]=o.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return this.array[0+(t*=this.itemSize)]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,r){return this.array[0+(t*=this.itemSize)]=e,this.array[t+1]=n,this.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return this.array[0+(t*=this.itemSize)]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=i,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),(fn.prototype=Object.create(pn.prototype)).constructor=fn,(mn.prototype=Object.create(pn.prototype)).constructor=mn,(gn.prototype=Object.create(pn.prototype)).constructor=gn,(vn.prototype=Object.create(pn.prototype)).constructor=vn,(yn.prototype=Object.create(pn.prototype)).constructor=yn,(wn.prototype=Object.create(pn.prototype)).constructor=wn,(bn.prototype=Object.create(pn.prototype)).constructor=bn,(xn.prototype=Object.create(pn.prototype)).constructor=xn,(_n.prototype=Object.create(pn.prototype)).constructor=_n,Object.assign(En.prototype,{computeGroups:function(t){for(var e,n=[],r=void 0,i=t.faces,o=0;o<i.length;o++){var s=i[o];s.materialIndex!==r&&(r=s.materialIndex,void 0!==e&&(e.count=3*o-e.start,n.push(e)),e={start:3*o,materialIndex:r})}void 0!==e&&(e.count=3*o-e.start,n.push(e)),this.groups=n},fromGeometry:function(t){var e,n=t.faces,r=t.vertices,i=t.faceVertexUvs,o=i[0]&&i[0].length>0,s=i[1]&&i[1].length>0,a=t.morphTargets,l=a.length;if(l>0){e=[];for(var u=0;u<l;u++)e[u]=[];this.morphTargets.position=e}var c,h=t.morphNormals,d=h.length;if(d>0){for(c=[],u=0;u<d;u++)c[u]=[];this.morphTargets.normal=c}var p=t.skinIndices,f=t.skinWeights,m=p.length===r.length,g=f.length===r.length;for(u=0;u<n.length;u++){var v=n[u];this.vertices.push(r[v.a],r[v.b],r[v.c]);var y=v.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var w=v.normal;this.normals.push(w,w,w)}var b,x=v.vertexColors;if(3===x.length)this.colors.push(x[0],x[1],x[2]);else{var _=v.color;this.colors.push(_,_,_)}!0===o&&(void 0!==(b=i[0][u])?this.uvs.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",u),this.uvs.push(new Be,new Be,new Be))),!0===s&&(void 0!==(b=i[1][u])?this.uvs2.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",u),this.uvs2.push(new Be,new Be,new Be)));for(var E=0;E<l;E++){var S=a[E].vertices;e[E].push(S[v.a],S[v.b],S[v.c])}for(E=0;E<d;E++){var M=h[E].vertexNormals[u];c[E].push(M.a,M.b,M.c)}m&&this.skinIndices.push(p[v.a],p[v.b],p[v.c]),g&&this.skinWeights.push(f[v.a],f[v.b],f[v.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this}});var Mn=1;function Tn(){Object.defineProperty(this,"id",{value:Mn+=2}),this.uuid=De.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}}function Cn(t,e,n,r,i,o){dn.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:o},this.fromBufferGeometry(new An(t,e,n,r,i,o)),this.mergeVertices()}function An(t,e,n,r,i,o){Tn.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:o};var s=this;t=t||1,e=e||1,n=n||1,r=Math.floor(r)||1,i=Math.floor(i)||1;var a=[],l=[],u=[],c=[],h=0,d=0;function p(t,e,n,r,i,o,p,f,m,g,v){var y,w,b=o/m,x=p/g,_=o/2,E=p/2,S=f/2,M=m+1,T=g+1,C=0,A=0,R=new Fe;for(w=0;w<T;w++){var P=w*x-E;for(y=0;y<M;y++)R[t]=(y*b-_)*r,R[e]=P*i,R[n]=S,l.push(R.x,R.y,R.z),R[t]=0,R[e]=0,R[n]=f>0?1:-1,u.push(R.x,R.y,R.z),c.push(y/m),c.push(1-w/g),C+=1}for(w=0;w<g;w++)for(y=0;y<m;y++){var L=h+y+M*(w+1),I=h+(y+1)+M*(w+1),N=h+(y+1)+M*w;a.push(h+y+M*w,L,N),a.push(L,I,N),A+=6}s.addGroup(d,A,v),d+=A,h+=C}p("z","y","x",-1,-1,n,e,t,o=Math.floor(o)||1,i,0),p("z","y","x",1,-1,n,e,-t,o,i,1),p("x","z","y",1,1,t,n,e,r,o,2),p("x","z","y",1,-1,t,n,-e,r,o,3),p("x","y","z",1,-1,t,e,n,r,i,4),p("x","y","z",-1,-1,t,e,-n,r,i,5),this.setIndex(a),this.addAttribute("position",new xn(l,3)),this.addAttribute("normal",new xn(u,3)),this.addAttribute("uv",new xn(c,2))}function Rn(t,e,n,r){dn.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new Pn(t,e,n,r)),this.mergeVertices()}function Pn(t,e,n,r){Tn.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};var i,o,s=(t=t||1)/2,a=(e=e||1)/2,l=Math.floor(n)||1,u=Math.floor(r)||1,c=l+1,h=u+1,d=t/l,p=e/u,f=[],m=[],g=[],v=[];for(o=0;o<h;o++){var y=o*p-a;for(i=0;i<c;i++)m.push(i*d-s,-y,0),g.push(0,0,1),v.push(i/l),v.push(1-o/u)}for(o=0;o<u;o++)for(i=0;i<l;i++){var w=i+c*(o+1),b=i+1+c*(o+1),x=i+1+c*o;f.push(i+c*o,w,x),f.push(w,b,x)}this.setIndex(f),this.addAttribute("position",new xn(m,3)),this.addAttribute("normal",new xn(g,3)),this.addAttribute("uv",new xn(v,2))}Tn.prototype=Object.assign(Object.create(r.prototype),{constructor:Tn,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){this.index=Array.isArray(t)?new(Sn(t)>65535?bn:yn)(t,1):t},addAttribute:function(t,e){return e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(e)):(this.attributes[t]=e,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(t,new pn(arguments[1],arguments[2])))},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;void 0!==e&&(t.applyToBufferAttribute(e),e.needsUpdate=!0);var n=this.attributes.normal;return void 0!==n&&((new ke).getNormalMatrix(t).applyToBufferAttribute(n),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var t=new Ue;return function(e){return t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t=new Ue;return function(e){return t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new Ue;return function(e){return t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t=new Ue;return function(e,n,r){return t.makeTranslation(e,n,r),this.applyMatrix(t),this}}(),scale:function(){var t=new Ue;return function(e,n,r){return t.makeScale(e,n,r),this.applyMatrix(t),this}}(),lookAt:function(){var t=new an;return function(e){t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),center:function(){var t=new Fe;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(t).negate(),this.translate(t.x,t.y,t.z),this}}(),setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){var n=new xn(3*e.vertices.length,3),r=new xn(3*e.colors.length,3);if(this.addAttribute("position",n.copyVector3sArray(e.vertices)),this.addAttribute("color",r.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var i=new xn(e.lineDistances.length,1);this.addAttribute("lineDistance",i.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},setFromPoints:function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];e.push(i.x,i.y,i.z||0)}return this.addAttribute("position",new xn(e,3)),this},updateFromObject:function(t){var e,n=t.geometry;if(t.isMesh){var r=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(r=void 0,n.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(n);r.verticesNeedUpdate=n.verticesNeedUpdate,r.normalsNeedUpdate=n.normalsNeedUpdate,r.colorsNeedUpdate=n.colorsNeedUpdate,r.uvsNeedUpdate=n.uvsNeedUpdate,r.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=r}return!0===n.verticesNeedUpdate&&(void 0!==(e=this.attributes.position)&&(e.copyVector3sArray(n.vertices),e.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(e=this.attributes.normal)&&(e.copyVector3sArray(n.normals),e.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(e=this.attributes.color)&&(e.copyColorsArray(n.colors),e.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(e=this.attributes.uv)&&(e.copyVector2sArray(n.uvs),e.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(e=this.attributes.lineDistance)&&(e.copyArray(n.lineDistances),e.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(t.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new En).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.addAttribute("position",new pn(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var n=new Float32Array(3*t.normals.length);this.addAttribute("normal",new pn(n,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var r=new Float32Array(3*t.colors.length);this.addAttribute("color",new pn(r,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var i=new Float32Array(2*t.uvs.length);this.addAttribute("uv",new pn(i,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var o=new Float32Array(2*t.uvs2.length);this.addAttribute("uv2",new pn(o,2).copyVector2sArray(t.uvs2))}for(var s in this.groups=t.groups,t.morphTargets){for(var a=[],l=t.morphTargets[s],u=0,c=l.length;u<c;u++){var h=l[u],d=new xn(3*h.length,3);a.push(d.copyVector3sArray(h))}this.morphAttributes[s]=a}if(t.skinIndices.length>0){var p=new xn(4*t.skinIndices.length,4);this.addAttribute("skinIndex",p.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var f=new xn(4*t.skinWeights.length,4);this.addAttribute("skinWeight",f.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Xe);var t=this.attributes.position;void 0!==t?this.boundingBox.setFromBufferAttribute(t):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var t=new Xe,e=new Fe;return function(){null===this.boundingSphere&&(this.boundingSphere=new Ye);var n=this.attributes.position;if(n){var r=this.boundingSphere.center;t.setFromBufferAttribute(n),t.getCenter(r);for(var i=0,o=0,s=n.count;o<s;o++)e.x=n.getX(o),e.y=n.getY(o),e.z=n.getZ(o),i=Math.max(i,r.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes,n=this.groups;if(e.position){var r=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new pn(new Float32Array(r.length),3));else for(var i=e.normal.array,o=0,s=i.length;o<s;o++)i[o]=0;var a,l,u,c=e.normal.array,h=new Fe,d=new Fe,p=new Fe,f=new Fe,m=new Fe;if(t){var g=t.array;0===n.length&&this.addGroup(0,g.length);for(var v=0,y=n.length;v<y;++v){var w=n[v],b=w.start;for(o=b,s=b+w.count;o<s;o+=3)l=3*g[o+1],u=3*g[o+2],h.fromArray(r,a=3*g[o+0]),d.fromArray(r,l),p.fromArray(r,u),f.subVectors(p,d),m.subVectors(h,d),f.cross(m),c[a]+=f.x,c[a+1]+=f.y,c[a+2]+=f.z,c[l]+=f.x,c[l+1]+=f.y,c[l+2]+=f.z,c[u]+=f.x,c[u+1]+=f.y,c[u+2]+=f.z}}else for(o=0,s=r.length;o<s;o+=9)h.fromArray(r,o),d.fromArray(r,o+3),p.fromArray(r,o+6),f.subVectors(p,d),m.subVectors(h,d),f.cross(m),c[o]=f.x,c[o+1]=f.y,c[o+2]=f.z,c[o+3]=f.x,c[o+4]=f.y,c[o+5]=f.z,c[o+6]=f.x,c[o+7]=f.y,c[o+8]=f.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==t.attributes[r])for(var i=n[r].array,o=t.attributes[r],s=o.array,a=0,l=o.itemSize*e;a<s.length;a++,l++)i[l]=s[a];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){var t=new Fe;return function(){for(var e=this.attributes.normal,n=0,r=e.count;n<r;n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.normalize(),e.setXYZ(n,t.x,t.y,t.z)}}(),toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new Tn,e=this.index.array,n=this.attributes;for(var r in n){for(var i=n[r],o=i.array,s=i.itemSize,a=new o.constructor(e.length*s),l=0,u=0,c=0,h=e.length;c<h;c++){l=e[c]*s;for(var d=0;d<s;d++)a[u++]=o[l++]}t.addAttribute(r,new pn(a,s))}var p=this.groups;for(c=0,h=p.length;c<h;c++){var f=p[c];t.addGroup(f.start,f.count,f.materialIndex)}return t},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};var r=this.index;if(null!==r){var i=Array.prototype.slice.call(r.array);t.data.index={type:r.array.constructor.name,array:i}}var o=this.attributes;for(var n in o){var s=o[n];i=Array.prototype.slice.call(s.array),t.data.attributes[n]={itemSize:s.itemSize,type:s.array.constructor.name,array:i,normalized:s.normalized}}var a=this.groups;a.length>0&&(t.data.groups=JSON.parse(JSON.stringify(a)));var l=this.boundingSphere;return null!==l&&(t.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),t},clone:function(){return(new Tn).copy(this)},copy:function(t){var e,n,r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var i=t.index;null!==i&&this.setIndex(i.clone());var o=t.attributes;for(e in o)this.addAttribute(e,o[e].clone());var s=t.morphAttributes;for(e in s){var a=[],l=s[e];for(n=0,r=l.length;n<r;n++)a.push(l[n].clone());this.morphAttributes[e]=a}var u=t.groups;for(n=0,r=u.length;n<r;n++){var c=u[n];this.addGroup(c.start,c.count,c.materialIndex)}var h=t.boundingBox;null!==h&&(this.boundingBox=h.clone());var d=t.boundingSphere;return null!==d&&(this.boundingSphere=d.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),(Cn.prototype=Object.create(dn.prototype)).constructor=Cn,(An.prototype=Object.create(Tn.prototype)).constructor=An,(Rn.prototype=Object.create(dn.prototype)).constructor=Rn,(Pn.prototype=Object.create(Tn.prototype)).constructor=Pn;var Ln=0;function In(){Object.defineProperty(this,"id",{value:Ln++}),this.uuid=De.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=S,this.side=m,this.flatShading=!1,this.vertexColors=b,this.opacity=1,this.transparent=!1,this.blendSrc=z,this.blendDst=F,this.blendEquation=R,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Y,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}function Nn(t){In.call(this),this.type="MeshBasicMaterial",this.color=new tn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=K,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(t)}function On(t){In.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function Dn(t,e){this.origin=void 0!==t?t:new Fe,this.direction=void 0!==e?e:new Fe}function Bn(t,e){this.start=void 0!==t?t:new Fe,this.end=void 0!==e?e:new Fe}function Un(t,e,n){this.a=void 0!==t?t:new Fe,this.b=void 0!==e?e:new Fe,this.c=void 0!==n?n:new Fe}function zn(t,e){an.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new Tn,this.material=void 0!==e?e:new Nn({color:16777215*Math.random()}),this.drawMode=_e,this.updateMorphTargets()}function Fn(t,e){return Math.abs(e[1])-Math.abs(t[1])}function kn(t,e,n,r,i,o,s,a,l,u){Ge.call(this,t=void 0!==t?t:[],e=void 0!==e?e:lt,n,r,i,o,s,a,l,u),this.flipY=!1}In.prototype=Object.assign(Object.create(r.prototype),{constructor:In,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var n=t[e];if(void 0!==n)if("shading"!==e){var r=this[e];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]="overdraw"===e?Number(n):n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===y;else console.warn("THREE.Material: '"+e+"' parameter is undefined.")}},toJSON:function(t){var e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearCoat&&(n.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(n.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,n.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==S&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),this.side!==m&&(n.side=this.side),this.vertexColors!==b&&(n.vertexColors=this.vertexColors),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,0!==this.rotation&&(n.rotation=this.rotation),1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e){var i=r(t.textures),o=r(t.images);i.length>0&&(n.textures=i),o.length>0&&(n.images=o)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.lights=t.lights,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.overdraw=t.overdraw,this.visible=t.visible,this.userData=JSON.parse(JSON.stringify(t.userData)),this.clipShadows=t.clipShadows,this.clipIntersection=t.clipIntersection;var e=t.clippingPlanes,n=null;if(null!==e){var r=e.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=e[i].clone()}return this.clippingPlanes=n,this.shadowSide=t.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),(Nn.prototype=Object.create(In.prototype)).constructor=Nn,Nn.prototype.isMeshBasicMaterial=!0,Nn.prototype.copy=function(t){return In.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},(On.prototype=Object.create(In.prototype)).constructor=On,On.prototype.isShaderMaterial=!0,On.prototype.copy=function(t){return In.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Je.clone(t.uniforms),this.defines=t.defines,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},On.prototype.toJSON=function(t){var e=In.prototype.toJSON.call(this,t);return e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e},Object.assign(Dn.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return void 0===e&&(console.warn("THREE.Ray: .at() target is now required"),e=new Fe),e.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(){var t=new Fe;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),e=new Fe),e.subVectors(t,this.origin);var n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(){var t=new Fe;return function(e){var n=t.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(t.copy(this.direction).multiplyScalar(n).add(this.origin),t.distanceToSquared(e))}}(),distanceSqToSegment:function(){var t=new Fe,e=new Fe,n=new Fe;return function(r,i,o,s){t.copy(r).add(i).multiplyScalar(.5),e.copy(i).sub(r).normalize(),n.copy(this.origin).sub(t);var a,l,u,c,h=.5*r.distanceTo(i),d=-this.direction.dot(e),p=n.dot(this.direction),f=-n.dot(e),m=n.lengthSq(),g=Math.abs(1-d*d);if(g>0)if(l=d*p-f,c=h*g,(a=d*f-p)>=0)if(l>=-c)if(l<=c){var v=1/g;u=(a*=v)*(a+d*(l*=v)+2*p)+l*(d*a+l+2*f)+m}else l=h,u=-(a=Math.max(0,-(d*l+p)))*a+l*(l+2*f)+m;else l=-h,u=-(a=Math.max(0,-(d*l+p)))*a+l*(l+2*f)+m;else l<=-c?u=-(a=Math.max(0,-(-d*h+p)))*a+(l=a>0?-h:Math.min(Math.max(-h,-f),h))*(l+2*f)+m:l<=c?(a=0,u=(l=Math.min(Math.max(-h,-f),h))*(l+2*f)+m):u=-(a=Math.max(0,-(d*h+p)))*a+(l=a>0?h:Math.min(Math.max(-h,-f),h))*(l+2*f)+m;else l=d>0?-h:h,u=-(a=Math.max(0,-(d*l+p)))*a+l*(l+2*f)+m;return o&&o.copy(this.direction).multiplyScalar(a).add(this.origin),s&&s.copy(e).multiplyScalar(l).add(t),u}}(),intersectSphere:function(){var t=new Fe;return function(e,n){t.subVectors(e.center,this.origin);var r=t.dot(this.direction),i=t.dot(t)-r*r,o=e.radius*e.radius;if(i>o)return null;var s=Math.sqrt(o-i),a=r-s,l=r+s;return a<0&&l<0?null:this.at(a<0?l:a,n)}}(),intersectsSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null},intersectPlane:function(t,e){var n=this.distanceToPlane(t);return null===n?null:this.at(n,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var n,r,i,o,s,a,l=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,h=this.origin;return l>=0?(n=(t.min.x-h.x)*l,r=(t.max.x-h.x)*l):(n=(t.max.x-h.x)*l,r=(t.min.x-h.x)*l),u>=0?(i=(t.min.y-h.y)*u,o=(t.max.y-h.y)*u):(i=(t.max.y-h.y)*u,o=(t.min.y-h.y)*u),n>o||i>r?null:((i>n||n!=n)&&(n=i),(o<r||r!=r)&&(r=o),c>=0?(s=(t.min.z-h.z)*c,a=(t.max.z-h.z)*c):(s=(t.max.z-h.z)*c,a=(t.min.z-h.z)*c),n>a||s>r?null:((s>n||n!=n)&&(n=s),(a<r||r!=r)&&(r=a),r<0?null:this.at(n>=0?n:r,e)))},intersectsBox:function(){var t=new Fe;return function(e){return null!==this.intersectBox(e,t)}}(),intersectTriangle:function(){var t=new Fe,e=new Fe,n=new Fe,r=new Fe;return function(i,o,s,a,l){e.subVectors(o,i),n.subVectors(s,i),r.crossVectors(e,n);var u,c=this.direction.dot(r);if(c>0){if(a)return null;u=1}else{if(!(c<0))return null;u=-1,c=-c}t.subVectors(this.origin,i);var h=u*this.direction.dot(n.crossVectors(t,n));if(h<0)return null;var d=u*this.direction.dot(e.cross(t));if(d<0)return null;if(h+d>c)return null;var p=-u*t.dot(r);return p<0?null:this.at(p/c,l)}}(),applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}}),Object.assign(Bn.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return void 0===t&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new Fe),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return void 0===t&&(console.warn("THREE.Line3: .delta() target is now required"),t=new Fe),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){return void 0===e&&(console.warn("THREE.Line3: .at() target is now required"),e=new Fe),this.delta(e).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var t=new Fe,e=new Fe;return function(n,r){t.subVectors(n,this.start),e.subVectors(this.end,this.start);var i=e.dot(e),o=e.dot(t)/i;return r&&(o=De.clamp(o,0,1)),o}}(),closestPointToPoint:function(t,e,n){var r=this.closestPointToPointParameter(t,e);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new Fe),this.delta(n).multiplyScalar(r).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),Object.assign(Un,{getNormal:function(){var t=new Fe;return function(e,n,r,i){void 0===i&&(console.warn("THREE.Triangle: .getNormal() target is now required"),i=new Fe),i.subVectors(r,n),t.subVectors(e,n),i.cross(t);var o=i.lengthSq();return o>0?i.multiplyScalar(1/Math.sqrt(o)):i.set(0,0,0)}}(),getBarycoord:function(){var t=new Fe,e=new Fe,n=new Fe;return function(r,i,o,s,a){t.subVectors(s,i),e.subVectors(o,i),n.subVectors(r,i);var l=t.dot(t),u=t.dot(e),c=t.dot(n),h=e.dot(e),d=e.dot(n),p=l*h-u*u;if(void 0===a&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),a=new Fe),0===p)return a.set(-2,-1,-1);var f=1/p,m=(h*c-u*d)*f,g=(l*d-u*c)*f;return a.set(1-m-g,g,m)}}(),containsPoint:function(){var t=new Fe;return function(e,n,r,i){return Un.getBarycoord(e,n,r,i,t),t.x>=0&&t.y>=0&&t.x+t.y<=1}}()}),Object.assign(Un.prototype,{set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){var t=new Fe,e=new Fe;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),getMidpoint:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new Fe),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return Un.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new Fe),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,e){return Un.getBarycoord(t,this.a,this.b,this.c,e)},containsPoint:function(t){return Un.containsPoint(t,this.a,this.b,this.c)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(){var t=new Ze,e=[new Bn,new Bn,new Bn],n=new Fe,r=new Fe;return function(i,o){void 0===o&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),o=new Fe);var s=1/0;if(t.setFromCoplanarPoints(this.a,this.b,this.c),t.projectPoint(i,n),!0===this.containsPoint(n))o.copy(n);else{e[0].set(this.a,this.b),e[1].set(this.b,this.c),e[2].set(this.c,this.a);for(var a=0;a<e.length;a++){e[a].closestPointToPoint(n,!0,r);var l=n.distanceToSquared(r);l<s&&(s=l,o.copy(r))}}return o}}(),equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}),zn.prototype=Object.assign(Object.create(an.prototype),{constructor:zn,isMesh:!0,setDrawMode:function(t){this.drawMode=t},copy:function(t){return an.prototype.copy.call(this,t),this.drawMode=t.drawMode,void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t,e,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,o=Object.keys(i);if(o.length>0){var s=i[o[0]];if(void 0!==s)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=s.length;t<e;t++)n=s[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else{var a=r.morphTargets;if(void 0!==a&&a.length>0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=a.length;t<e;t++)n=a[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}},raycast:function(){var t=new Ue,e=new Dn,n=new Ye,r=new Fe,i=new Fe,o=new Fe,s=new Fe,a=new Fe,l=new Fe,u=new Be,c=new Be,h=new Be,d=new Fe,p=new Fe,f=new Fe;function m(t,e,n,r,i,o,s){return Un.getBarycoord(t,e,n,r,d),i.multiplyScalar(d.x),o.multiplyScalar(d.y),s.multiplyScalar(d.z),i.add(o).add(s),i.clone()}function y(t,e,n,r,i,o,s,a){if(null===(e.side===g?r.intersectTriangle(s,o,i,!0,a):r.intersectTriangle(i,o,s,e.side!==v,a)))return null;f.copy(a),f.applyMatrix4(t.matrixWorld);var l=n.ray.origin.distanceTo(f);return l<n.near||l>n.far?null:{distance:l,point:f.clone(),object:t}}function w(t,e,n,s,a,l,d,f){r.fromBufferAttribute(s,l),i.fromBufferAttribute(s,d),o.fromBufferAttribute(s,f);var g=y(t,t.material,e,n,r,i,o,p);if(g){a&&(u.fromBufferAttribute(a,l),c.fromBufferAttribute(a,d),h.fromBufferAttribute(a,f),g.uv=m(p,r,i,o,u,c,h));var v=new cn(l,d,f);Un.getNormal(r,i,o,v.normal),g.face=v,g.faceIndex=l}return g}return function(d,f){var g,v=this.geometry,b=this.material,x=this.matrixWorld;if(void 0!==b&&(null===v.boundingSphere&&v.computeBoundingSphere(),n.copy(v.boundingSphere),n.applyMatrix4(x),!1!==d.ray.intersectsSphere(n)&&(t.getInverse(x),e.copy(d.ray).applyMatrix4(t),null===v.boundingBox||!1!==e.intersectsBox(v.boundingBox))))if(v.isBufferGeometry){var _,E,S,M,T,C=v.index,A=v.attributes.position,R=v.attributes.uv;if(null!==C)for(M=0,T=C.count;M<T;M+=3)_=C.getX(M),E=C.getX(M+1),S=C.getX(M+2),(g=w(this,d,e,A,R,_,E,S))&&(g.faceIndex=Math.floor(M/3),f.push(g));else if(void 0!==A)for(M=0,T=A.count;M<T;M+=3)(g=w(this,d,e,A,R,_=M,E=M+1,S=M+2))&&(g.index=_,f.push(g))}else if(v.isGeometry){var P,L,I,N,O=Array.isArray(b),D=v.vertices,B=v.faces,U=v.faceVertexUvs[0];U.length>0&&(N=U);for(var z=0,F=B.length;z<F;z++){var k=B[z],V=O?b[k.materialIndex]:b;if(void 0!==V){if(P=D[k.a],L=D[k.b],I=D[k.c],!0===V.morphTargets){var G=v.morphTargets,j=this.morphTargetInfluences;r.set(0,0,0),i.set(0,0,0),o.set(0,0,0);for(var H=0,W=G.length;H<W;H++){var q=j[H];if(0!==q){var X=G[H].vertices;r.addScaledVector(s.subVectors(X[k.a],P),q),i.addScaledVector(a.subVectors(X[k.b],L),q),o.addScaledVector(l.subVectors(X[k.c],I),q)}}r.add(P),i.add(L),o.add(I),P=r,L=i,I=o}if(g=y(this,V,d,e,P,L,I,p)){if(N&&N[z]){var Y=N[z];u.copy(Y[0]),c.copy(Y[1]),h.copy(Y[2]),g.uv=m(p,P,L,I,u,c,h)}g.face=k,g.faceIndex=z,f.push(g)}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),(kn.prototype=Object.create(Ge.prototype)).constructor=kn,kn.prototype.isCubeTexture=!0,Object.defineProperty(kn.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}});var Vn=new Ge,Gn=new kn;function jn(){this.seq=[],this.map={}}var Hn=[],Wn=[],qn=new Float32Array(16),Xn=new Float32Array(9);function Yn(t,e,n){var r=t[0];if(r<=0||r>0)return t;var i=e*n,o=Hn[i];if(void 0===o&&(o=new Float32Array(i),Hn[i]=o),0!==e){r.toArray(o,0);for(var s=1,a=0;s!==e;++s)t[s].toArray(o,a+=n)}return o}function Zn(t,e){var n=Wn[e];void 0===n&&(n=new Int32Array(e),Wn[e]=n);for(var r=0;r!==e;++r)n[r]=t.allocTextureUnit();return n}function $n(t,e){t.uniform1f(this.addr,e)}function Qn(t,e){t.uniform1i(this.addr,e)}function Jn(t,e){void 0===e.x?t.uniform2fv(this.addr,e):t.uniform2f(this.addr,e.x,e.y)}function Kn(t,e){void 0!==e.x?t.uniform3f(this.addr,e.x,e.y,e.z):void 0!==e.r?t.uniform3f(this.addr,e.r,e.g,e.b):t.uniform3fv(this.addr,e)}function tr(t,e){void 0===e.x?t.uniform4fv(this.addr,e):t.uniform4f(this.addr,e.x,e.y,e.z,e.w)}function er(t,e){t.uniformMatrix2fv(this.addr,!1,e.elements||e)}function nr(t,e){void 0===e.elements?t.uniformMatrix3fv(this.addr,!1,e):(Xn.set(e.elements),t.uniformMatrix3fv(this.addr,!1,Xn))}function rr(t,e){void 0===e.elements?t.uniformMatrix4fv(this.addr,!1,e):(qn.set(e.elements),t.uniformMatrix4fv(this.addr,!1,qn))}function ir(t,e,n){var r=n.allocTextureUnit();t.uniform1i(this.addr,r),n.setTexture2D(e||Vn,r)}function or(t,e,n){var r=n.allocTextureUnit();t.uniform1i(this.addr,r),n.setTextureCube(e||Gn,r)}function sr(t,e){t.uniform2iv(this.addr,e)}function ar(t,e){t.uniform3iv(this.addr,e)}function lr(t,e){t.uniform4iv(this.addr,e)}function ur(t,e){t.uniform1fv(this.addr,e)}function cr(t,e){t.uniform1iv(this.addr,e)}function hr(t,e){t.uniform2fv(this.addr,Yn(e,this.size,2))}function dr(t,e){t.uniform3fv(this.addr,Yn(e,this.size,3))}function pr(t,e){t.uniform4fv(this.addr,Yn(e,this.size,4))}function fr(t,e){t.uniformMatrix2fv(this.addr,!1,Yn(e,this.size,4))}function mr(t,e){t.uniformMatrix3fv(this.addr,!1,Yn(e,this.size,9))}function gr(t,e){t.uniformMatrix4fv(this.addr,!1,Yn(e,this.size,16))}function vr(t,e,n){var r=e.length,i=Zn(n,r);t.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.setTexture2D(e[o]||Vn,i[o])}function yr(t,e,n){var r=e.length,i=Zn(n,r);t.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.setTextureCube(e[o]||Gn,i[o])}function wr(t,e,n){this.id=t,this.addr=n,this.setValue=function(t){switch(e.type){case 5126:return $n;case 35664:return Jn;case 35665:return Kn;case 35666:return tr;case 35674:return er;case 35675:return nr;case 35676:return rr;case 35678:case 36198:return ir;case 35680:return or;case 5124:case 35670:return Qn;case 35667:case 35671:return sr;case 35668:case 35672:return ar;case 35669:case 35673:return lr}}()}function br(t,e,n){this.id=t,this.addr=n,this.size=e.size,this.setValue=function(t){switch(e.type){case 5126:return ur;case 35664:return hr;case 35665:return dr;case 35666:return pr;case 35674:return fr;case 35675:return mr;case 35676:return gr;case 35678:return vr;case 35680:return yr;case 5124:case 35670:return cr;case 35667:case 35671:return sr;case 35668:case 35672:return ar;case 35669:case 35673:return lr}}()}function xr(t){this.id=t,jn.call(this)}xr.prototype.setValue=function(t,e){for(var n=this.seq,r=0,i=n.length;r!==i;++r){var o=n[r];o.setValue(t,e[o.id])}};var _r=/([\w\d_]+)(\])?(\[|\.)?/g;function Er(t,e){t.seq.push(e),t.map[e.id]=e}function Sr(t,e,n){var r=t.name,i=r.length;for(_r.lastIndex=0;;){var o=_r.exec(r),s=o[1],a=o[3];if("]"===o[2]&&(s|=0),void 0===a||"["===a&&_r.lastIndex+2===i){Er(n,void 0===a?new wr(s,t,e):new br(s,t,e));break}var l=n.map[s];void 0===l&&Er(n,l=new xr(s)),n=l}}function Mr(t,e,n){jn.call(this),this.renderer=n;for(var r=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),i=0;i<r;++i){var o=t.getActiveUniform(e,i);Sr(o,t.getUniformLocation(e,o.name),this)}}function Tr(t,e,n){var r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),!1===t.getShaderParameter(r,t.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(r)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e===t.VERTEX_SHADER?"vertex":"fragment",t.getShaderInfoLog(r),function(t){for(var e=t.split("\n"),n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join("\n")}(n)),r}Mr.prototype.setValue=function(t,e,n){var r=this.map[e];void 0!==r&&r.setValue(t,n,this.renderer)},Mr.prototype.setOptional=function(t,e,n){var r=e[n];void 0!==r&&this.setValue(t,n,r)},Mr.upload=function(t,e,n,r){for(var i=0,o=e.length;i!==o;++i){var s=e[i],a=n[s.id];!1!==a.needsUpdate&&s.setValue(t,a.value,r)}},Mr.seqWithValue=function(t,e){for(var n=[],r=0,i=t.length;r!==i;++r){var o=t[r];o.id in e&&n.push(o)}return n};var Cr=0;function Ar(t){switch(t){case Me:return["Linear","( value )"];case Te:return["sRGB","( value )"];case Ae:return["RGBE","( value )"];case Pe:return["RGBM","( value, 7.0 )"];case Le:return["RGBM","( value, 16.0 )"];case Ie:return["RGBD","( value, 256.0 )"];case Ce:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+t)}}function Rr(t,e){var n=Ar(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function Pr(t){return""!==t}function Lr(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function Ir(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}function Nr(t){return t.replace(/^[ \t]*#include +<([\w\d.]+)>/gm,function(t,e){var n=Qe[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return Nr(n)})}function Or(t){return t.replace(/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(t,e,n,r){for(var i="",o=parseInt(e);o<parseInt(n);o++)i+=r.replace(/\[ i \]/g,"[ "+o+" ]");return i})}function Dr(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program&&e.program&&t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Br(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}var Ur=0;function zr(t){In.call(this),this.type="MeshDepthMaterial",this.depthPacking=Ne,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(t)}function Fr(t){In.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Fe,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(t)}function kr(t,e,n){for(var r=new $e,i=new Ue,o=new Be,s=new Be(n,n),a=new Fe,l=new Fe,u=1,c=2,h=1+(u|c),d=new Array(h),f=new Array(h),y={},w={0:g,1:m,2:v},b=[new Fe(1,0,0),new Fe(-1,0,0),new Fe(0,0,1),new Fe(0,0,-1),new Fe(0,1,0),new Fe(0,-1,0)],x=[new Fe(0,1,0),new Fe(0,1,0),new Fe(0,1,0),new Fe(0,1,0),new Fe(0,0,1),new Fe(0,0,-1)],_=[new je,new je,new je,new je,new je,new je],E=0;E!==h;++E){var S=0!=(E&u),M=0!=(E&c),T=new zr({depthPacking:Oe,morphTargets:S,skinning:M});d[E]=T;var C=new Fr({morphTargets:S,skinning:M});f[E]=C}var A=this;function R(e,n,r,i,o,s){var a=e.geometry,l=null,h=d,p=e.customDepthMaterial;if(r&&(h=f,p=e.customDistanceMaterial),p)l=p;else{var m=!1;n.morphTargets&&(a&&a.isBufferGeometry?m=a.morphAttributes&&a.morphAttributes.position&&a.morphAttributes.position.length>0:a&&a.isGeometry&&(m=a.morphTargets&&a.morphTargets.length>0)),e.isSkinnedMesh&&!1===n.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e);var g=0;m&&(g|=u),e.isSkinnedMesh&&n.skinning&&(g|=c),l=h[g]}if(t.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){var v=l.uuid,b=n.uuid,x=y[v];void 0===x&&(y[v]=x={});var _=x[b];void 0===_&&(_=l.clone(),x[b]=_),l=_}return l.visible=n.visible,l.wireframe=n.wireframe,l.side=null!=n.shadowSide?n.shadowSide:w[n.side],l.clipShadows=n.clipShadows,l.clippingPlanes=n.clippingPlanes,l.clipIntersection=n.clipIntersection,l.wireframeLinewidth=n.wireframeLinewidth,l.linewidth=n.linewidth,r&&l.isMeshDistanceMaterial&&(l.referencePosition.copy(i),l.nearDistance=o,l.farDistance=s),l}function P(n,i,o,s){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&n.castShadow&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);var a=e.update(n),u=n.material;if(Array.isArray(u))for(var c=a.groups,h=0,d=c.length;h<d;h++){var p=c[h],f=u[p.materialIndex];if(f&&f.visible){var m=R(n,f,s,l,o.near,o.far);t.renderBufferDirect(o,null,a,m,n,p)}}else u.visible&&(m=R(n,u,s,l,o.near,o.far),t.renderBufferDirect(o,null,a,m,n,null))}for(var g=n.children,v=0,y=g.length;v<y;v++)P(g[v],i,o,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=p,this.render=function(e,n,u){if(!1!==A.enabled&&(!1!==A.autoUpdate||!1!==A.needsUpdate)&&0!==e.length){var c,h=t.state;h.disable(t.context.BLEND),h.buffers.color.setClear(1,1,1,1),h.buffers.depth.setTest(!0),h.setScissorTest(!1);for(var d=0,p=e.length;d<p;d++){var f=e[d],m=f.shadow,g=f&&f.isPointLight;if(void 0!==m){var v=m.camera;if(o.copy(m.mapSize),o.min(s),g){var y=o.x,w=o.y;_[0].set(2*y,w,y,w),_[1].set(0,w,y,w),_[2].set(3*y,w,y,w),_[3].set(y,w,y,w),_[4].set(3*y,0,y,w),_[5].set(y,0,y,w),o.x*=4,o.y*=2}null===m.map&&(m.map=new He(o.x,o.y,{minFilter:yt,magFilter:yt,format:zt}),m.map.texture.name=f.name+".shadowMap",v.updateProjectionMatrix()),m.isSpotLightShadow&&m.update(f);var E=m.map,S=m.matrix;l.setFromMatrixPosition(f.matrixWorld),v.position.copy(l),g?(c=6,S.makeTranslation(-l.x,-l.y,-l.z)):(c=1,a.setFromMatrixPosition(f.target.matrixWorld),v.lookAt(a),v.updateMatrixWorld(),S.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),S.multiply(v.projectionMatrix),S.multiply(v.matrixWorldInverse)),t.setRenderTarget(E),t.clear();for(var M=0;M<c;M++)g&&(a.copy(v.position),a.add(b[M]),v.up.copy(x[M]),v.lookAt(a),v.updateMatrixWorld(),h.viewport(_[M])),i.multiplyMatrices(v.projectionMatrix,v.matrixWorldInverse),r.setFromMatrix(i),P(n,u,v,g)}else console.warn("THREE.WebGLShadowMap:",f,"has no shadow.")}A.needsUpdate=!1}}}function Vr(t,e,n,r,i,o,s,a,l){Ge.call(this,t,e,n,r,i,o,s,a,l),this.needsUpdate=!0}function Gr(t,e){return{convert:function(n){var r;if(n===mt)return t.REPEAT;if(n===gt)return t.CLAMP_TO_EDGE;if(n===vt)return t.MIRRORED_REPEAT;if(n===yt)return t.NEAREST;if(n===wt)return t.NEAREST_MIPMAP_NEAREST;if(n===bt)return t.NEAREST_MIPMAP_LINEAR;if(n===xt)return t.LINEAR;if(n===_t)return t.LINEAR_MIPMAP_NEAREST;if(n===Et)return t.LINEAR_MIPMAP_LINEAR;if(n===St)return t.UNSIGNED_BYTE;if(n===It)return t.UNSIGNED_SHORT_4_4_4_4;if(n===Nt)return t.UNSIGNED_SHORT_5_5_5_1;if(n===Ot)return t.UNSIGNED_SHORT_5_6_5;if(n===Mt)return t.BYTE;if(n===Tt)return t.SHORT;if(n===Ct)return t.UNSIGNED_SHORT;if(n===At)return t.INT;if(n===Rt)return t.UNSIGNED_INT;if(n===Pt)return t.FLOAT;if(n===Lt&&null!==(r=e.get("OES_texture_half_float")))return r.HALF_FLOAT_OES;if(n===Bt)return t.ALPHA;if(n===Ut)return t.RGB;if(n===zt)return t.RGBA;if(n===Ft)return t.LUMINANCE;if(n===kt)return t.LUMINANCE_ALPHA;if(n===Gt)return t.DEPTH_COMPONENT;if(n===jt)return t.DEPTH_STENCIL;if(n===R)return t.FUNC_ADD;if(n===P)return t.FUNC_SUBTRACT;if(n===L)return t.FUNC_REVERSE_SUBTRACT;if(n===O)return t.ZERO;if(n===D)return t.ONE;if(n===B)return t.SRC_COLOR;if(n===U)return t.ONE_MINUS_SRC_COLOR;if(n===z)return t.SRC_ALPHA;if(n===F)return t.ONE_MINUS_SRC_ALPHA;if(n===k)return t.DST_ALPHA;if(n===V)return t.ONE_MINUS_DST_ALPHA;if(n===G)return t.DST_COLOR;if(n===j)return t.ONE_MINUS_DST_COLOR;if(n===H)return t.SRC_ALPHA_SATURATE;if((n===Ht||n===Wt||n===qt||n===Xt)&&null!==(r=e.get("WEBGL_compressed_texture_s3tc"))){if(n===Ht)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Wt)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===qt)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Xt)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((n===Yt||n===Zt||n===$t||n===Qt)&&null!==(r=e.get("WEBGL_compressed_texture_pvrtc"))){if(n===Yt)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===Zt)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===$t)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Qt)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===Jt&&null!==(r=e.get("WEBGL_compressed_texture_etc1")))return r.COMPRESSED_RGB_ETC1_WEBGL;if((n===Kt||n===te||n===ee||n===ne||n===re||n===ie||n===oe||n===se||n===ae||n===le||n===ue||n===ce||n===he||n===de)&&null!==(r=e.get("WEBGL_compressed_texture_astc")))return n;if((n===I||n===N)&&null!==(r=e.get("EXT_blend_minmax"))){if(n===I)return r.MIN_EXT;if(n===N)return r.MAX_EXT}return n===Dt&&null!==(r=e.get("WEBGL_depth_texture"))?r.UNSIGNED_INT_24_8_WEBGL:0}}}function jr(t,e,n,r){ln.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function Hr(t){jr.call(this),this.cameras=t||[]}function Wr(t){var e=this,n=null,r=null,i=null,o=new Ue,s=new Ue;"undefined"!=typeof window&&"VRFrameData"in window&&(r=new window.VRFrameData);var a=new Ue,l=new ze,u=new Fe,c=new jr;c.bounds=new je(0,0,.5,1),c.layers.enable(1);var h=new jr;h.bounds=new je(.5,0,.5,1),h.layers.enable(2);var d,p,f=new Hr([c,h]);function m(){if(null!==n&&n.isPresenting){var r=n.getEyeParameters("left"),i=r.renderWidth,o=r.renderHeight;p=t.getPixelRatio(),d=t.getSize(),t.setDrawingBufferSize(2*i,o,1)}else e.enabled&&t.setDrawingBufferSize(d.width,d.height,p)}f.layers.enable(1),f.layers.enable(2),"undefined"!=typeof window&&window.addEventListener("vrdisplaypresentchange",m,!1),this.enabled=!1,this.userHeight=1.6,this.getDevice=function(){return n},this.setDevice=function(t){void 0!==t&&(n=t)},this.setPoseTarget=function(t){void 0!==t&&(i=t)},this.getCamera=function(t){if(null===n)return t;n.depthNear=t.near,n.depthFar=t.far,n.getFrameData(r);var d=n.stageParameters;d?o.fromArray(d.sittingToStandingTransform):o.makeTranslation(0,e.userHeight,0);var p=r.pose,m=null!==i?i:t;if(m.matrix.copy(o),m.matrix.decompose(m.position,m.quaternion,m.scale),null!==p.orientation&&(l.fromArray(p.orientation),m.quaternion.multiply(l)),null!==p.position&&(l.setFromRotationMatrix(o),u.fromArray(p.position),u.applyQuaternion(l),m.position.add(u)),m.updateMatrixWorld(),!1===n.isPresenting)return t;c.near=t.near,h.near=t.near,c.far=t.far,h.far=t.far,f.matrixWorld.copy(t.matrixWorld),f.matrixWorldInverse.copy(t.matrixWorldInverse),c.matrixWorldInverse.fromArray(r.leftViewMatrix),h.matrixWorldInverse.fromArray(r.rightViewMatrix),s.getInverse(o),c.matrixWorldInverse.multiply(s),h.matrixWorldInverse.multiply(s);var g=m.parent;null!==g&&(a.getInverse(g.matrixWorld),c.matrixWorldInverse.multiply(a),h.matrixWorldInverse.multiply(a)),c.matrixWorld.getInverse(c.matrixWorldInverse),h.matrixWorld.getInverse(h.matrixWorldInverse),c.projectionMatrix.fromArray(r.leftProjectionMatrix),h.projectionMatrix.fromArray(r.rightProjectionMatrix),f.projectionMatrix.copy(c.projectionMatrix);var v=n.getLayers();if(v.length){var y=v[0];null!==y.leftBounds&&4===y.leftBounds.length&&c.bounds.fromArray(y.leftBounds),null!==y.rightBounds&&4===y.rightBounds.length&&h.bounds.fromArray(y.rightBounds)}return f},this.getStandingMatrix=function(){return o},this.submitFrame=function(){n&&n.isPresenting&&n.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",m)}}function qr(t){console.log("THREE.WebGLRenderer",i);var e=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==t.context?t.context:null,r=void 0!==t.alpha&&t.alpha,o=void 0===t.depth||t.depth,u=void 0===t.stencil||t.stencil,c=void 0!==t.antialias&&t.antialias,h=void 0===t.premultipliedAlpha||t.premultipliedAlpha,d=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,m=void 0!==t.powerPreference?t.powerPreference:"default",y=null,w=null;this.domElement=e,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=rt,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var x,_,R,P,L,I,N,O,D,B,U,z,F,k,V,G,j,H,at,mt=this,vt=!1,_t=null,Et=null,Mt=-1,Tt="",At=null,It=null,Nt=new je,Ot=new je,Bt=null,Ft=0,kt=e.width,Vt=e.height,Ht=1,Wt=new je(0,0,kt,Vt),qt=new je(0,0,kt,Vt),Xt=!1,Yt=new $e,Zt=new function(){var t=this,e=null,n=0,r=!1,i=!1,o=new Ze,s=new ke,a={value:null,needsUpdate:!1};function l(){a.value!==e&&(a.value=e,a.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}function u(e,n,r,i){var l=null!==e?e.length:0,u=null;if(0!==l){if(u=a.value,!0!==i||null===u){var c=r+4*l,h=n.matrixWorldInverse;s.getNormalMatrix(h),(null===u||u.length<c)&&(u=new Float32Array(c));for(var d=0,p=r;d!==l;++d,p+=4)o.copy(e[d]).applyMatrix4(h,s),o.normal.toArray(u,p),u[p+3]=o.constant}a.value=u,a.needsUpdate=!0}return t.numPlanes=l,u}this.uniform=a,this.numPlanes=0,this.numIntersection=0,this.init=function(t,i,o){var s=0!==t.length||i||0!==n||r;return r=i,e=u(t,o,0),n=t.length,s},this.beginShadows=function(){i=!0,u(null)},this.endShadows=function(){i=!1,l()},this.setState=function(t,o,s,c,h,d){if(!r||null===t||0===t.length||i&&!s)i?u(null):l();else{var p=i?0:n,f=4*p,m=h.clippingState||null;a.value=m,m=u(t,c,f,d);for(var g=0;g!==f;++g)m[g]=e[g];h.clippingState=m,this.numIntersection=o?this.numPlanes:0,this.numPlanes+=p}}},$t=!1,Qt=!1,Jt=new Ue,Kt=new Fe;function te(){return null===_t?Ht:1}try{var ee={alpha:r,depth:o,stencil:u,antialias:c,premultipliedAlpha:h,preserveDrawingBuffer:d,powerPreference:m};if(e.addEventListener("webglcontextlost",oe,!1),e.addEventListener("webglcontextrestored",se,!1),null===(x=n||e.getContext("webgl",ee)||e.getContext("experimental-webgl",ee)))throw null!==e.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===x.getShaderPrecisionFormat&&(x.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){console.error("THREE.WebGLRenderer: "+t.message)}function ne(){(_=new function(t){var e={};return{get:function(n){if(void 0!==e[n])return e[n];var r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":r=t.getExtension("WEBGL_compressed_texture_etc1");break;default:r=t.getExtension(n)}return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),e[n]=r,r}}}(x)).get("WEBGL_depth_texture"),_.get("OES_texture_float"),_.get("OES_texture_float_linear"),_.get("OES_texture_half_float"),_.get("OES_texture_half_float_linear"),_.get("OES_standard_derivatives"),_.get("OES_element_index_uint"),_.get("ANGLE_instanced_arrays"),at=new Gr(x,_),R=new function(t,e,n){var r;function i(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var o=void 0!==n.precision?n.precision:"highp",s=i(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);var a=!0===n.logarithmicDepthBuffer,l=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),u=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),c=t.getParameter(t.MAX_TEXTURE_SIZE),h=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),d=t.getParameter(t.MAX_VERTEX_ATTRIBS),p=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),f=t.getParameter(t.MAX_VARYING_VECTORS),m=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),g=u>0,v=!!e.get("OES_texture_float");return{getMaxAnisotropy:function(){if(void 0!==r)return r;var n=e.get("EXT_texture_filter_anisotropic");return r=null!==n?t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:o,logarithmicDepthBuffer:a,maxTextures:l,maxVertexTextures:u,maxTextureSize:c,maxCubemapSize:h,maxAttributes:d,maxVertexUniforms:p,maxVaryings:f,maxFragmentUniforms:m,vertexTextures:g,floatFragmentTextures:v,floatVertexTextures:g&&v}}(x,_,t),(P=new function(t,e,n){var r=new function(){var e=!1,n=new je,r=null,i=new je(0,0,0,0);return{setMask:function(n){r===n||e||(t.colorMask(n,n,n,n),r=n)},setLocked:function(t){e=t},setClear:function(e,r,o,s,a){!0===a&&(e*=s,r*=s,o*=s),n.set(e,r,o,s),!1===i.equals(n)&&(t.clearColor(e,r,o,s),i.copy(n))},reset:function(){e=!1,r=null,i.set(-1,0,0,0)}}},i=new function(){var e=!1,n=null,r=null,i=null;return{setTest:function(e){e?et(t.DEPTH_TEST):nt(t.DEPTH_TEST)},setMask:function(r){n===r||e||(t.depthMask(r),n=r)},setFunc:function(e){if(r!==e){if(e)switch(e){case W:t.depthFunc(t.NEVER);break;case q:t.depthFunc(t.ALWAYS);break;case X:t.depthFunc(t.LESS);break;case Y:t.depthFunc(t.LEQUAL);break;case Z:t.depthFunc(t.EQUAL);break;case $:t.depthFunc(t.GEQUAL);break;case Q:t.depthFunc(t.GREATER);break;case J:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}else t.depthFunc(t.LEQUAL);r=e}},setLocked:function(t){e=t},setClear:function(e){i!==e&&(t.clearDepth(e),i=e)},reset:function(){e=!1,n=null,r=null,i=null}}},o=new function(){var e=!1,n=null,r=null,i=null,o=null,s=null,a=null,l=null,u=null;return{setTest:function(e){e?et(t.STENCIL_TEST):nt(t.STENCIL_TEST)},setMask:function(r){n===r||e||(t.stencilMask(r),n=r)},setFunc:function(e,n,s){r===e&&i===n&&o===s||(t.stencilFunc(e,n,s),r=e,i=n,o=s)},setOp:function(e,n,r){s===e&&a===n&&l===r||(t.stencilOp(e,n,r),s=e,a=n,l=r)},setLocked:function(t){e=t},setClear:function(e){u!==e&&(t.clearStencil(e),u=e)},reset:function(){e=!1,n=null,r=null,i=null,o=null,s=null,a=null,l=null,u=null}}},u=t.getParameter(t.MAX_VERTEX_ATTRIBS),c=new Uint8Array(u),h=new Uint8Array(u),d=new Uint8Array(u),p={},f=null,m=null,y=null,w=null,b=null,x=null,_=null,R=null,P=null,L=!1,I=null,N=null,O=null,D=null,B=null,U=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),z=!1,F=0,k=t.getParameter(t.VERSION);-1!==k.indexOf("WebGL")?(F=parseFloat(/^WebGL\ ([0-9])/.exec(k)[1]),z=F>=1):-1!==k.indexOf("OpenGL ES")&&(F=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(k)[1]),z=F>=2);var V=null,G={},j=new je,H=new je;function K(e,n,r){var i=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST);for(var s=0;s<r;s++)t.texImage2D(n+s,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,i);return o}var tt={};function et(e){!0!==p[e]&&(t.enable(e),p[e]=!0)}function nt(e){!1!==p[e]&&(t.disable(e),p[e]=!1)}function rt(e,r,i,o,s,a,l,u){if(e!==E?et(t.BLEND):nt(t.BLEND),e!==A){if(e!==y||u!==L)switch(e){case M:u?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE,t.ONE,t.ONE)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE));break;case T:u?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR));break;case C:u?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR));break;default:u?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA))}w=null,b=null,x=null,_=null,R=null,P=null}else s=s||r,a=a||i,l=l||o,r===w&&s===_||(t.blendEquationSeparate(n.convert(r),n.convert(s)),w=r,_=s),i===b&&o===x&&a===R&&l===P||(t.blendFuncSeparate(n.convert(i),n.convert(o),n.convert(a),n.convert(l)),b=i,x=o,R=a,P=l);y=e,L=u}function it(e){I!==e&&(t.frontFace(e?t.CW:t.CCW),I=e)}function ot(e){e!==s?(et(t.CULL_FACE),e!==N&&t.cullFace(e===a?t.BACK:e===l?t.FRONT:t.FRONT_AND_BACK)):nt(t.CULL_FACE),N=e}function st(e,n,r){e?(et(t.POLYGON_OFFSET_FILL),D===n&&B===r||(t.polygonOffset(n,r),D=n,B=r)):nt(t.POLYGON_OFFSET_FILL)}function at(e){void 0===e&&(e=t.TEXTURE0+U-1),V!==e&&(t.activeTexture(e),V=e)}return tt[t.TEXTURE_2D]=K(t.TEXTURE_2D,t.TEXTURE_2D,1),tt[t.TEXTURE_CUBE_MAP]=K(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),r.setClear(0,0,0,1),i.setClear(1),o.setClear(0),et(t.DEPTH_TEST),i.setFunc(Y),it(!1),ot(a),et(t.CULL_FACE),et(t.BLEND),rt(S),{buffers:{color:r,depth:i,stencil:o},initAttributes:function(){for(var t=0,e=c.length;t<e;t++)c[t]=0},enableAttribute:function(n){c[n]=1,0===h[n]&&(t.enableVertexAttribArray(n),h[n]=1),0!==d[n]&&(e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(n,0),d[n]=0)},enableAttributeAndDivisor:function(n,r){c[n]=1,0===h[n]&&(t.enableVertexAttribArray(n),h[n]=1),d[n]!==r&&(e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(n,r),d[n]=r)},disableUnusedAttributes:function(){for(var e=0,n=h.length;e!==n;++e)h[e]!==c[e]&&(t.disableVertexAttribArray(e),h[e]=0)},enable:et,disable:nt,getCompressedTextureFormats:function(){if(null===f&&(f=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")||e.get("WEBGL_compressed_texture_astc")))for(var n=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),r=0;r<n.length;r++)f.push(n[r]);return f},useProgram:function(e){return m!==e&&(t.useProgram(e),m=e,!0)},setBlending:rt,setMaterial:function(e,n){e.side===v?nt(t.CULL_FACE):et(t.CULL_FACE);var o=e.side===g;n&&(o=!o),it(o),!0===e.transparent?rt(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha):rt(E),i.setFunc(e.depthFunc),i.setTest(e.depthTest),i.setMask(e.depthWrite),r.setMask(e.colorWrite),st(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:it,setCullFace:ot,setLineWidth:function(e){e!==O&&(z&&t.lineWidth(e),O=e)},setPolygonOffset:st,setScissorTest:function(e){e?et(t.SCISSOR_TEST):nt(t.SCISSOR_TEST)},activeTexture:at,bindTexture:function(e,n){null===V&&at();var r=G[V];void 0===r&&(G[V]=r={type:void 0,texture:void 0}),r.type===e&&r.texture===n||(t.bindTexture(e,n||tt[e]),r.type=e,r.texture=n)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(e){!1===j.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),j.copy(e))},viewport:function(e){!1===H.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),H.copy(e))},reset:function(){for(var e=0;e<h.length;e++)1===h[e]&&(t.disableVertexAttribArray(e),h[e]=0);p={},f=null,V=null,G={},m=null,y=null,I=null,N=null,r.reset(),i.reset(),o.reset()}}}(x,_,at)).scissor(Ot.copy(qt).multiplyScalar(Ht)),P.viewport(Nt.copy(Wt).multiplyScalar(Ht)),L=new function(t){var e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(n,r,i){switch(i=i||1,e.calls++,r){case t.TRIANGLES:e.triangles+=i*(n/3);break;case t.TRIANGLE_STRIP:case t.TRIANGLE_FAN:e.triangles+=i*(n-2);break;case t.LINES:e.lines+=i*(n/2);break;case t.LINE_STRIP:e.lines+=i*(n-1);break;case t.LINE_LOOP:e.lines+=i*n;break;case t.POINTS:e.points+=i*n;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r)}}}}(x),I=new function(){var t=new WeakMap;return{get:function(e){var n=t.get(e);return void 0===n&&t.set(e,n={}),n},remove:function(e){t.delete(e)},update:function(e,n,r){t.get(e)[n]=r},dispose:function(){t=new WeakMap}}},N=new function(t,e,n,r,i,o,s){var a,l="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext,u={};function c(t,e){if(t.width>e||t.height>e){if("data"in t)return void console.warn("THREE.WebGLRenderer: image in DataTexture is too big ("+t.width+"x"+t.height+").");var n=e/Math.max(t.width,t.height),r=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return r.width=Math.floor(t.width*n),r.height=Math.floor(t.height*n),r.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,r.width,r.height),console.warn("THREE.WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+r.width+"x"+r.height,t),r}return t}function h(t){return De.isPowerOfTwo(t.width)&&De.isPowerOfTwo(t.height)}function d(t,e){return t.generateMipmaps&&e&&t.minFilter!==yt&&t.minFilter!==xt}function p(e,n,i,o){t.generateMipmap(e),r.get(n).__maxMipLevel=Math.log2(Math.max(i,o))}function f(e){return e===yt||e===wt||e===bt?t.NEAREST:t.LINEAR}function m(e){var n=e.target;n.removeEventListener("dispose",m),function(e){var n=r.get(e);if(e.image&&n.__image__webglTextureCube)t.deleteTexture(n.__image__webglTextureCube);else{if(void 0===n.__webglInit)return;t.deleteTexture(n.__webglTexture)}r.remove(e)}(n),n.isVideoTexture&&delete u[n.id],s.memory.textures--}function g(e){var n=e.target;n.removeEventListener("dispose",g),function(e){var n=r.get(e),i=r.get(e.texture);if(e){if(void 0!==i.__webglTexture&&t.deleteTexture(i.__webglTexture),e.depthTexture&&e.depthTexture.dispose(),e.isWebGLRenderTargetCube)for(var o=0;o<6;o++)t.deleteFramebuffer(n.__webglFramebuffer[o]),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[o]);else t.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer);r.remove(e.texture),r.remove(e)}}(n),s.memory.textures--}function v(e,f){var g=r.get(e);if(e.isVideoTexture&&function(t){var e=t.id,n=s.render.frame;u[e]!==n&&(u[e]=n,t.update())}(e),e.version>0&&g.__version!==e.version){var v=e.image;if(void 0===v)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",e);else{if(!1!==v.complete)return void function(e,r,u){void 0===e.__webglInit&&(e.__webglInit=!0,r.addEventListener("dispose",m),e.__webglTexture=t.createTexture(),s.memory.textures++),n.activeTexture(t.TEXTURE0+u),n.bindTexture(t.TEXTURE_2D,e.__webglTexture),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,r.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,r.unpackAlignment);var f=c(r.image,i.maxTextureSize);(function(t){return t.wrapS!==gt||t.wrapT!==gt||t.minFilter!==yt&&t.minFilter!==xt})(r)&&!1===h(f)&&(f=function(t){return t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof ImageBitmap?(void 0===a&&(a=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),a.width=De.floorPowerOfTwo(t.width),a.height=De.floorPowerOfTwo(t.height),a.getContext("2d").drawImage(t,0,0,a.width,a.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+t.width+"x"+t.height+"). Resized to "+a.width+"x"+a.height,t),a):t}(f));var g=h(f),v=o.convert(r.format),w=o.convert(r.type);y(t.TEXTURE_2D,r,g);var b,x=r.mipmaps;if(r.isDepthTexture){var _=t.DEPTH_COMPONENT;if(r.type===Pt){if(!l)throw new Error("Float Depth Texture only supported in WebGL2.0");_=t.DEPTH_COMPONENT32F}else l&&(_=t.DEPTH_COMPONENT16);r.format===Gt&&_===t.DEPTH_COMPONENT&&r.type!==Ct&&r.type!==Rt&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=Ct,w=o.convert(r.type)),r.format===jt&&(_=t.DEPTH_STENCIL,r.type!==Dt&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=Dt,w=o.convert(r.type))),n.texImage2D(t.TEXTURE_2D,0,_,f.width,f.height,0,v,w,null)}else if(r.isDataTexture)if(x.length>0&&g){for(var E=0,S=x.length;E<S;E++)n.texImage2D(t.TEXTURE_2D,E,v,(b=x[E]).width,b.height,0,v,w,b.data);r.generateMipmaps=!1,e.__maxMipLevel=x.length-1}else n.texImage2D(t.TEXTURE_2D,0,v,f.width,f.height,0,v,w,f.data),e.__maxMipLevel=0;else if(r.isCompressedTexture){for(E=0,S=x.length;E<S;E++)b=x[E],r.format!==zt&&r.format!==Ut?n.getCompressedTextureFormats().indexOf(v)>-1?n.compressedTexImage2D(t.TEXTURE_2D,E,v,b.width,b.height,0,b.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(t.TEXTURE_2D,E,v,b.width,b.height,0,v,w,b.data);e.__maxMipLevel=x.length-1}else if(x.length>0&&g){for(E=0,S=x.length;E<S;E++)n.texImage2D(t.TEXTURE_2D,E,v,v,w,b=x[E]);r.generateMipmaps=!1,e.__maxMipLevel=x.length-1}else n.texImage2D(t.TEXTURE_2D,0,v,v,w,f),e.__maxMipLevel=0;d(r,g)&&p(t.TEXTURE_2D,r,f.width,f.height),e.__version=r.version,r.onUpdate&&r.onUpdate(r)}(g,e,f);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",e)}}n.activeTexture(t.TEXTURE0+f),n.bindTexture(t.TEXTURE_2D,g.__webglTexture)}function y(n,s,a){var l;if(a?(t.texParameteri(n,t.TEXTURE_WRAP_S,o.convert(s.wrapS)),t.texParameteri(n,t.TEXTURE_WRAP_T,o.convert(s.wrapT)),t.texParameteri(n,t.TEXTURE_MAG_FILTER,o.convert(s.magFilter)),t.texParameteri(n,t.TEXTURE_MIN_FILTER,o.convert(s.minFilter))):(t.texParameteri(n,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(n,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),s.wrapS===gt&&s.wrapT===gt||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",s),t.texParameteri(n,t.TEXTURE_MAG_FILTER,f(s.magFilter)),t.texParameteri(n,t.TEXTURE_MIN_FILTER,f(s.minFilter)),s.minFilter!==yt&&s.minFilter!==xt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",s)),l=e.get("EXT_texture_filter_anisotropic")){if(s.type===Pt&&null===e.get("OES_texture_float_linear"))return;if(s.type===Lt&&null===e.get("OES_texture_half_float_linear"))return;(s.anisotropy>1||r.get(s).__currentAnisotropy)&&(t.texParameterf(n,l.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,i.getMaxAnisotropy())),r.get(s).__currentAnisotropy=s.anisotropy)}}function w(e,i,s,a){var l=o.convert(i.texture.format),u=o.convert(i.texture.type);n.texImage2D(a,0,l,i.width,i.height,0,l,u,null),t.bindFramebuffer(t.FRAMEBUFFER,e),t.framebufferTexture2D(t.FRAMEBUFFER,s,a,r.get(i.texture).__webglTexture,0),t.bindFramebuffer(t.FRAMEBUFFER,null)}function b(e,n){t.bindRenderbuffer(t.RENDERBUFFER,e),n.depthBuffer&&!n.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e)):n.depthBuffer&&n.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e)):t.renderbufferStorage(t.RENDERBUFFER,t.RGBA4,n.width,n.height),t.bindRenderbuffer(t.RENDERBUFFER,null)}this.setTexture2D=v,this.setTextureCube=function(e,a){var l=r.get(e);if(6===e.image.length)if(e.version>0&&l.__version!==e.version){l.__image__webglTextureCube||(e.addEventListener("dispose",m),l.__image__webglTextureCube=t.createTexture(),s.memory.textures++),n.activeTexture(t.TEXTURE0+a),n.bindTexture(t.TEXTURE_CUBE_MAP,l.__image__webglTextureCube),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var u=e&&e.isCompressedTexture,f=e.image[0]&&e.image[0].isDataTexture,g=[],v=0;v<6;v++)g[v]=u||f?f?e.image[v].image:e.image[v]:c(e.image[v],i.maxCubemapSize);var w=g[0],b=h(w),x=o.convert(e.format),_=o.convert(e.type);for(y(t.TEXTURE_CUBE_MAP,e,b),v=0;v<6;v++)if(u)for(var E,S=g[v].mipmaps,M=0,T=S.length;M<T;M++)E=S[M],e.format!==zt&&e.format!==Ut?n.getCompressedTextureFormats().indexOf(x)>-1?n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,M,x,E.width,E.height,0,E.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,M,x,E.width,E.height,0,x,_,E.data);else f?n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,x,g[v].width,g[v].height,0,x,_,g[v].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,x,x,_,g[v]);l.__maxMipLevel=u?S.length-1:0,d(e,b)&&p(t.TEXTURE_CUBE_MAP,e,w.width,w.height),l.__version=e.version,e.onUpdate&&e.onUpdate(e)}else n.activeTexture(t.TEXTURE0+a),n.bindTexture(t.TEXTURE_CUBE_MAP,l.__image__webglTextureCube)},this.setTextureCubeDynamic=function(e,i){n.activeTexture(t.TEXTURE0+i),n.bindTexture(t.TEXTURE_CUBE_MAP,r.get(e).__webglTexture)},this.setupRenderTarget=function(e){var i=r.get(e),o=r.get(e.texture);e.addEventListener("dispose",g),o.__webglTexture=t.createTexture(),s.memory.textures++;var a=!0===e.isWebGLRenderTargetCube,l=h(e);if(a){i.__webglFramebuffer=[];for(var u=0;u<6;u++)i.__webglFramebuffer[u]=t.createFramebuffer()}else i.__webglFramebuffer=t.createFramebuffer();if(a){for(n.bindTexture(t.TEXTURE_CUBE_MAP,o.__webglTexture),y(t.TEXTURE_CUBE_MAP,e.texture,l),u=0;u<6;u++)w(i.__webglFramebuffer[u],e,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+u);d(e.texture,l)&&p(t.TEXTURE_CUBE_MAP,e.texture,e.width,e.height),n.bindTexture(t.TEXTURE_CUBE_MAP,null)}else n.bindTexture(t.TEXTURE_2D,o.__webglTexture),y(t.TEXTURE_2D,e.texture,l),w(i.__webglFramebuffer,e,t.COLOR_ATTACHMENT0,t.TEXTURE_2D),d(e.texture,l)&&p(t.TEXTURE_2D,e.texture,e.width,e.height),n.bindTexture(t.TEXTURE_2D,null);e.depthBuffer&&function(e){var n=r.get(e),i=!0===e.isWebGLRenderTargetCube;if(e.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,n){if(n&&n.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(t.FRAMEBUFFER,e),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),v(n.depthTexture,0);var i=r.get(n.depthTexture).__webglTexture;if(n.depthTexture.format===Gt)t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,i,0);else{if(n.depthTexture.format!==jt)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,i,0)}}(n.__webglFramebuffer,e)}else if(i){n.__webglDepthbuffer=[];for(var o=0;o<6;o++)t.bindFramebuffer(t.FRAMEBUFFER,n.__webglFramebuffer[o]),n.__webglDepthbuffer[o]=t.createRenderbuffer(),b(n.__webglDepthbuffer[o],e)}else t.bindFramebuffer(t.FRAMEBUFFER,n.__webglFramebuffer),n.__webglDepthbuffer=t.createRenderbuffer(),b(n.__webglDepthbuffer,e);t.bindFramebuffer(t.FRAMEBUFFER,null)}(e)},this.updateRenderTargetMipmap=function(e){var i=e.texture;if(d(i,h(e))){var o=e.isWebGLRenderTargetCube?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,s=r.get(i).__webglTexture;n.bindTexture(o,s),p(o,i,e.width,e.height),n.bindTexture(o,null)}}}(x,_,P,I,R,at,L),O=new function(t){var e=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),e.get(t)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);var r=e.get(n);r&&(t.deleteBuffer(r.buffer),e.delete(n))},update:function(n,r){n.isInterleavedBufferAttribute&&(n=n.data);var i=e.get(n);void 0===i?e.set(n,function(e,n){var r=e.array,i=e.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW,o=t.createBuffer();t.bindBuffer(n,o),t.bufferData(n,r,i),e.onUploadCallback();var s=t.FLOAT;return r instanceof Float32Array?s=t.FLOAT:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?s=t.UNSIGNED_SHORT:r instanceof Int16Array?s=t.SHORT:r instanceof Uint32Array?s=t.UNSIGNED_INT:r instanceof Int32Array?s=t.INT:r instanceof Int8Array?s=t.BYTE:r instanceof Uint8Array&&(s=t.UNSIGNED_BYTE),{buffer:o,type:s,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version}}(n,r)):i.version<n.version&&(function(e,n,r){var o=n.array,s=n.updateRange;t.bindBuffer(r,i.buffer),!1===n.dynamic?t.bufferData(r,o,t.STATIC_DRAW):-1===s.count?t.bufferSubData(r,0,o):0===s.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(r,s.offset*o.BYTES_PER_ELEMENT,o.subarray(s.offset,s.offset+s.count)),s.count=-1)}(0,n,r),i.version=n.version)}}}(x),D=new function(t,e,n){var r={},i={};function o(t){var s=t.target,a=r[s.id];for(var l in null!==a.index&&e.remove(a.index),a.attributes)e.remove(a.attributes[l]);s.removeEventListener("dispose",o),delete r[s.id];var u=i[s.id];u&&(e.remove(u),delete i[s.id]),(u=i[a.id])&&(e.remove(u),delete i[a.id]),n.memory.geometries--}return{get:function(t,e){var i=r[e.id];return i||(e.addEventListener("dispose",o),e.isBufferGeometry?i=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new Tn).setFromObject(t)),i=e._bufferGeometry),r[e.id]=i,n.memory.geometries++,i)},update:function(n){var r=n.index,i=n.attributes;for(var o in null!==r&&e.update(r,t.ELEMENT_ARRAY_BUFFER),i)e.update(i[o],t.ARRAY_BUFFER);var s=n.morphAttributes;for(var o in s)for(var a=s[o],l=0,u=a.length;l<u;l++)e.update(a[l],t.ARRAY_BUFFER)},getWireframeAttribute:function(n){var r=i[n.id];if(r)return r;var o,s=[],a=n.index,l=n.attributes;if(null!==a)for(var u=0,c=(o=a.array).length;u<c;u+=3)s.push(h=o[u+0],d=o[u+1],d,p=o[u+2],p,h);else for(u=0,c=(o=l.position.array).length/3-1;u<c;u+=3){var h,d,p;s.push(h=u+0,d=u+1,d,p=u+2,p,h)}return r=new(Sn(s)>65535?bn:yn)(s,1),e.update(r,t.ELEMENT_ARRAY_BUFFER),i[n.id]=r,r}}}(x,O,L),B=new function(t,e){var n={};return{update:function(r){var i=e.render.frame,o=r.geometry,s=t.get(r,o);return n[s.id]!==i&&(o.isGeometry&&s.updateFromObject(r),t.update(s),n[s.id]=i),s},dispose:function(){n={}}}}(D,L),V=new function(t){var e={},n=new Float32Array(8);return{update:function(r,i,o,s){var a=r.morphTargetInfluences,l=a.length,u=e[i.id];if(void 0===u){u=[];for(var c=0;c<l;c++)u[c]=[c,0];e[i.id]=u}var h=o.morphTargets&&i.morphAttributes.position,d=o.morphNormals&&i.morphAttributes.normal;for(c=0;c<l;c++)0!==(p=u[c])[1]&&(h&&i.removeAttribute("morphTarget"+c),d&&i.removeAttribute("morphNormal"+c));for(c=0;c<l;c++)(p=u[c])[0]=c,p[1]=a[c];for(u.sort(Fn),c=0;c<8;c++){var p;if(p=u[c]){var f=p[0],m=p[1];if(m){h&&i.addAttribute("morphTarget"+c,h[f]),d&&i.addAttribute("morphNormal"+c,d[f]),n[c]=m;continue}}n[c]=0}s.getUniforms().setValue(t,"morphTargetInfluences",n)}}}(x),U=new function(t,e,n){var r=[],i={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow"},o=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function s(t,e){var n;return t?t.isTexture?n=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),n=t.texture.encoding):n=Me,n===Me&&e&&(n=Ce),n}this.getParameters=function(e,r,o,a,l,u,c){var h=i[e.type],d=c.isSkinnedMesh?function(t){var e=t.skeleton.bones;if(n.floatVertexTextures)return 1024;var r=Math.floor((n.maxVertexUniforms-20)/4),i=Math.min(r,e.length);return i<e.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+e.length+" bones. This GPU supports "+i+"."),0):i}(c):0,p=n.precision;null!==e.precision&&(p=n.getMaxPrecision(e.precision))!==e.precision&&console.warn("THREE.WebGLProgram.getParameters:",e.precision,"not supported, using",p,"instead.");var f=t.getRenderTarget();return{shaderID:h,precision:p,supportsVertexTextures:n.vertexTextures,outputEncoding:s(f?f.texture:null,t.gammaOutput),map:!!e.map,mapEncoding:s(e.map,t.gammaInput),envMap:!!e.envMap,envMapMode:e.envMap&&e.envMap.mapping,envMapEncoding:s(e.envMap,t.gammaInput),envMapCubeUV:!!e.envMap&&(e.envMap.mapping===pt||e.envMap.mapping===ft),lightMap:!!e.lightMap,aoMap:!!e.aoMap,emissiveMap:!!e.emissiveMap,emissiveMapEncoding:s(e.emissiveMap,t.gammaInput),bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,displacementMap:!!e.displacementMap,roughnessMap:!!e.roughnessMap,metalnessMap:!!e.metalnessMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,gradientMap:!!e.gradientMap,combine:e.combine,vertexColors:e.vertexColors,fog:!!a,useFog:e.fog,fogExp:a&&a.isFogExp2,flatShading:e.flatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:n.logarithmicDepthBuffer,skinning:e.skinning&&d>0,maxBones:d,useVertexTexture:n.floatVertexTextures,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:r.directional.length,numPointLights:r.point.length,numSpotLights:r.spot.length,numRectAreaLights:r.rectArea.length,numHemiLights:r.hemi.length,numClippingPlanes:l,numClipIntersection:u,dithering:e.dithering,shadowMapEnabled:t.shadowMap.enabled&&c.receiveShadow&&o.length>0,shadowMapType:t.shadowMap.type,toneMapping:t.toneMapping,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:e.premultipliedAlpha,alphaTest:e.alphaTest,doubleSided:e.side===v,flipSided:e.side===g,depthPacking:void 0!==e.depthPacking&&e.depthPacking}},this.getProgramCode=function(e,n){var r=[];if(n.shaderID?r.push(n.shaderID):(r.push(e.fragmentShader),r.push(e.vertexShader)),void 0!==e.defines)for(var i in e.defines)r.push(i),r.push(e.defines[i]);for(var s=0;s<o.length;s++)r.push(n[o[s]]);return r.push(e.onBeforeCompile.toString()),r.push(t.gammaOutput),r.join()},this.acquireProgram=function(n,i,o,s){for(var a,l=0,u=r.length;l<u;l++){var c=r[l];if(c.code===s){++(a=c).usedTimes;break}}return void 0===a&&(a=new function(t,e,n,r,i,o){var s=t.context,a=r.defines,l=i.vertexShader,u=i.fragmentShader,c="SHADOWMAP_TYPE_BASIC";o.shadowMapType===p?c="SHADOWMAP_TYPE_PCF":o.shadowMapType===f&&(c="SHADOWMAP_TYPE_PCF_SOFT");var h="ENVMAP_TYPE_CUBE",d="ENVMAP_MODE_REFLECTION",m="ENVMAP_BLENDING_MULTIPLY";if(o.envMap){switch(r.envMap.mapping){case lt:case ut:h="ENVMAP_TYPE_CUBE";break;case pt:case ft:h="ENVMAP_TYPE_CUBE_UV";break;case ct:case ht:h="ENVMAP_TYPE_EQUIREC";break;case dt:h="ENVMAP_TYPE_SPHERE"}switch(r.envMap.mapping){case ut:case ht:d="ENVMAP_MODE_REFRACTION"}switch(r.combine){case K:m="ENVMAP_BLENDING_MULTIPLY";break;case tt:m="ENVMAP_BLENDING_MIX";break;case et:m="ENVMAP_BLENDING_ADD"}}var g,v,y=t.gammaFactor>0?t.gammaFactor:1,w=function(t,e,n){return[(t=t||{}).derivatives||e.envMapCubeUV||e.bumpMap||e.normalMap||e.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(t.fragDepth||e.logarithmicDepthBuffer)&&n.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",t.drawBuffers&&n.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(t.shaderTextureLOD||e.envMap)&&n.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Pr).join("\n")}(r.extensions,o,e),b=function(t){var e=[];for(var n in t){var r=t[n];!1!==r&&e.push("#define "+n+" "+r)}return e.join("\n")}(a),x=s.createProgram();r.isRawShaderMaterial?((g=[b].filter(Pr).join("\n")).length>0&&(g+="\n"),(v=[w,b].filter(Pr).join("\n")).length>0&&(v+="\n")):(g=["precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,b,o.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+y,"#define MAX_BONES "+o.maxBones,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+d:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.displacementMap&&o.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.flatShading?"#define FLAT_SHADED":"",o.skinning?"#define USE_SKINNING":"",o.useVertexTexture?"#define BONE_TEXTURE":"",o.morphTargets?"#define USE_MORPHTARGETS":"",o.morphNormals&&!1===o.flatShading?"#define USE_MORPHNORMALS":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+c:"",o.sizeAttenuation?"#define USE_SIZEATTENUATION":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&e.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Pr).join("\n"),v=[w,"precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,b,o.alphaTest?"#define ALPHATEST "+o.alphaTest:"","#define GAMMA_FACTOR "+y,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+h:"",o.envMap?"#define "+d:"",o.envMap?"#define "+m:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.gradientMap?"#define USE_GRADIENTMAP":"",o.flatShading?"#define FLAT_SHADED":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+c:"",o.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",o.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&e.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",o.envMap&&e.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",o.toneMapping!==nt?"#define TONE_MAPPING":"",o.toneMapping!==nt?Qe.tonemapping_pars_fragment:"",o.toneMapping!==nt?function(t,e){var n;switch(e){case rt:n="Linear";break;case it:n="Reinhard";break;case ot:n="Uncharted2";break;case st:n="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 toneMapping( vec3 color ) { return "+n+"ToneMapping( color ); }"}(0,o.toneMapping):"",o.dithering?"#define DITHERING":"",o.outputEncoding||o.mapEncoding||o.envMapEncoding||o.emissiveMapEncoding?Qe.encodings_pars_fragment:"",o.mapEncoding?Rr("mapTexelToLinear",o.mapEncoding):"",o.envMapEncoding?Rr("envMapTexelToLinear",o.envMapEncoding):"",o.emissiveMapEncoding?Rr("emissiveMapTexelToLinear",o.emissiveMapEncoding):"",o.outputEncoding?function(t,e){var n=Ar(o.outputEncoding);return"vec4 linearToOutputTexel( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}():"",o.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(Pr).join("\n")),l=Ir(l=Lr(l=Nr(l),o),o),u=Ir(u=Lr(u=Nr(u),o),o),l=Or(l);var _=v+(u=Or(u)),E=Tr(s,s.VERTEX_SHADER,g+l),S=Tr(s,s.FRAGMENT_SHADER,_);s.attachShader(x,E),s.attachShader(x,S),void 0!==r.index0AttributeName?s.bindAttribLocation(x,0,r.index0AttributeName):!0===o.morphTargets&&s.bindAttribLocation(x,0,"position"),s.linkProgram(x);var M,T,C=s.getProgramInfoLog(x).trim(),A=s.getShaderInfoLog(E).trim(),R=s.getShaderInfoLog(S).trim(),P=!0,L=!0;return!1===s.getProgramParameter(x,s.LINK_STATUS)?(P=!1,console.error("THREE.WebGLProgram: shader error: ",s.getError(),"gl.VALIDATE_STATUS",s.getProgramParameter(x,s.VALIDATE_STATUS),"gl.getProgramInfoLog",C,A,R)):""!==C?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",C):""!==A&&""!==R||(L=!1),L&&(this.diagnostics={runnable:P,material:r,programLog:C,vertexShader:{log:A,prefix:g},fragmentShader:{log:R,prefix:v}}),s.deleteShader(E),s.deleteShader(S),this.getUniforms=function(){return void 0===M&&(M=new Mr(s,x,t)),M},this.getAttributes=function(){return void 0===T&&(T=function(t,e){for(var n={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),i=0;i<r;i++){var o=t.getActiveAttrib(e,i).name;n[o]=t.getAttribLocation(e,o)}return n}(s,x)),T},this.destroy=function(){s.deleteProgram(x),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=Cr++,this.code=n,this.usedTimes=1,this.program=x,this.vertexShader=E,this.fragmentShader=S,this}(t,e,s,n,i,o),r.push(a)),a},this.releaseProgram=function(t){if(0==--t.usedTimes){var e=r.indexOf(t);r[e]=r[r.length-1],r.pop(),t.destroy()}},this.programs=r}(mt,_,R),z=new function(){var t={};return{get:function(e,n){var r=e.id+","+n.id,i=t[r];return void 0===i&&(i=new function(){var t=[],e=0,n=[],r=[];return{opaque:n,transparent:r,init:function(){e=0,n.length=0,r.length=0},push:function(i,o,s,a,l){var u=t[e];void 0===u?t[e]=u={id:i.id,object:i,geometry:o,material:s,program:s.program,renderOrder:i.renderOrder,z:a,group:l}:(u.id=i.id,u.object=i,u.geometry=o,u.material=s,u.program=s.program,u.renderOrder=i.renderOrder,u.z=a,u.group=l),(!0===s.transparent?r:n).push(u),e++},sort:function(){n.length>1&&n.sort(Dr),r.length>1&&r.sort(Br)}}},t[r]=i),i},dispose:function(){t={}}}},F=new function(){var t={};return{get:function(e,n){var r=e.id+","+n.id,i=t[r];return void 0===i&&(i=new function(){var t=new function(){var t=new function(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":n={direction:new Fe,color:new tn,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Be};break;case"SpotLight":n={position:new Fe,direction:new Fe,color:new tn,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Be};break;case"PointLight":n={position:new Fe,color:new tn,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Be,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":n={direction:new Fe,skyColor:new tn,groundColor:new tn};break;case"RectAreaLight":n={color:new tn,position:new Fe,halfWidth:new Fe,halfHeight:new Fe}}return t[e.id]=n,n}}},e={id:Ur++,hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},n=new Fe,r=new Ue,i=new Ue;return{setup:function(o,s,a){for(var l=0,u=0,c=0,h=0,d=0,p=0,f=0,m=0,g=a.matrixWorldInverse,v=0,y=o.length;v<y;v++){var w=o[v],b=w.color,x=w.intensity,_=w.distance,E=w.shadow&&w.shadow.map?w.shadow.map.texture:null;if(w.isAmbientLight)l+=b.r*x,u+=b.g*x,c+=b.b*x;else if(w.isDirectionalLight)(M=t.get(w)).color.copy(w.color).multiplyScalar(w.intensity),M.direction.setFromMatrixPosition(w.matrixWorld),n.setFromMatrixPosition(w.target.matrixWorld),M.direction.sub(n),M.direction.transformDirection(g),M.shadow=w.castShadow,w.castShadow&&(M.shadowBias=(S=w.shadow).bias,M.shadowRadius=S.radius,M.shadowMapSize=S.mapSize),e.directionalShadowMap[h]=E,e.directionalShadowMatrix[h]=w.shadow.matrix,e.directional[h]=M,h++;else if(w.isSpotLight)(M=t.get(w)).position.setFromMatrixPosition(w.matrixWorld),M.position.applyMatrix4(g),M.color.copy(b).multiplyScalar(x),M.distance=_,M.direction.setFromMatrixPosition(w.matrixWorld),n.setFromMatrixPosition(w.target.matrixWorld),M.direction.sub(n),M.direction.transformDirection(g),M.coneCos=Math.cos(w.angle),M.penumbraCos=Math.cos(w.angle*(1-w.penumbra)),M.decay=0===w.distance?0:w.decay,M.shadow=w.castShadow,w.castShadow&&(M.shadowBias=(S=w.shadow).bias,M.shadowRadius=S.radius,M.shadowMapSize=S.mapSize),e.spotShadowMap[p]=E,e.spotShadowMatrix[p]=w.shadow.matrix,e.spot[p]=M,p++;else if(w.isRectAreaLight)(M=t.get(w)).color.copy(b).multiplyScalar(x),M.position.setFromMatrixPosition(w.matrixWorld),M.position.applyMatrix4(g),i.identity(),r.copy(w.matrixWorld),r.premultiply(g),i.extractRotation(r),M.halfWidth.set(.5*w.width,0,0),M.halfHeight.set(0,.5*w.height,0),M.halfWidth.applyMatrix4(i),M.halfHeight.applyMatrix4(i),e.rectArea[f]=M,f++;else if(w.isPointLight){var S;(M=t.get(w)).position.setFromMatrixPosition(w.matrixWorld),M.position.applyMatrix4(g),M.color.copy(w.color).multiplyScalar(w.intensity),M.distance=w.distance,M.decay=0===w.distance?0:w.decay,M.shadow=w.castShadow,w.castShadow&&(M.shadowBias=(S=w.shadow).bias,M.shadowRadius=S.radius,M.shadowMapSize=S.mapSize,M.shadowCameraNear=S.camera.near,M.shadowCameraFar=S.camera.far),e.pointShadowMap[d]=E,e.pointShadowMatrix[d]=w.shadow.matrix,e.point[d]=M,d++}else if(w.isHemisphereLight){var M;(M=t.get(w)).direction.setFromMatrixPosition(w.matrixWorld),M.direction.transformDirection(g),M.direction.normalize(),M.skyColor.copy(w.color).multiplyScalar(x),M.groundColor.copy(w.groundColor).multiplyScalar(x),e.hemi[m]=M,m++}}e.ambient[0]=l,e.ambient[1]=u,e.ambient[2]=c,e.directional.length=h,e.spot.length=p,e.rectArea.length=f,e.point.length=d,e.hemi.length=m,e.hash=e.id+","+h+","+d+","+p+","+f+","+m+","+s.length},state:e}},e=[],n=[],r=[];return{init:function(){e.length=0,n.length=0,r.length=0},state:{lightsArray:e,shadowsArray:n,spritesArray:r,lights:t},setupLights:function(r){t.setup(e,n,r)},pushLight:function(t){e.push(t)},pushShadow:function(t){n.push(t)},pushSprite:function(t){r.push(t)}}},t[r]=i),i},dispose:function(){t={}}}},k=new function(t,e,n,r){var i,o,s,a=new tn(0),l=0;function u(t,n){e.buffers.color.setClear(t.r,t.g,t.b,n,r)}return{getClearColor:function(){return a},setClearColor:function(t,e){a.set(t),u(a,l=void 0!==e?e:1)},getClearAlpha:function(){return l},setClearAlpha:function(t){u(a,l=t)},render:function(e,r,c,h){var d=r.background;null===d?u(a,l):d&&d.isColor&&(u(d,1),h=!0),(t.autoClear||h)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),d&&d.isCubeTexture?(void 0===s&&((s=new zn(new An(1,1,1),new On({uniforms:nn.cube.uniforms,vertexShader:nn.cube.vertexShader,fragmentShader:nn.cube.fragmentShader,side:g,depthTest:!0,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),s.geometry.removeAttribute("uv"),s.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},n.update(s.geometry)),s.material.uniforms.tCube.value=d,e.push(s,s.geometry,s.material,0,null)):d&&d.isTexture&&(void 0===i&&(i=new un(-1,1,1,-1,0,1),o=new zn(new Pn(2,2),new Nn({depthTest:!1,depthWrite:!1,fog:!1})),n.update(o.geometry)),o.material.map=d,t.renderBufferDirect(i,null,o.geometry,o.material,o,null))}}}(mt,P,D,h),G=new function(t,e,n){var r;this.setMode=function(t){r=t},this.render=function(e,i){t.drawArrays(r,e,i),n.update(i,r)},this.renderInstances=function(t,i,o){var s=e.get("ANGLE_instanced_arrays");if(null!==s){var a=t.attributes.position;a.isInterleavedBufferAttribute?s.drawArraysInstancedANGLE(r,0,o=a.data.count,t.maxInstancedCount):s.drawArraysInstancedANGLE(r,i,o,t.maxInstancedCount),n.update(o,r,t.maxInstancedCount)}else console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}(x,_,L),j=new function(t,e,n){var r,i,o;this.setMode=function(t){r=t},this.setIndex=function(t){i=t.type,o=t.bytesPerElement},this.render=function(e,s){t.drawElements(r,s,i,e*o),n.update(s,r)},this.renderInstances=function(t,s,a){var l=e.get("ANGLE_instanced_arrays");null!==l?(l.drawElementsInstancedANGLE(r,a,i,s*o,t.maxInstancedCount),n.update(a,r,t.maxInstancedCount)):console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}(x,_,L),H=new function(t,e,n,r,i){var o,s,a,l,u,c,h=new Fe,d=new ze,p=new Fe;function f(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:e.id-t.id}this.render=function(m,g,v){if(0!==m.length){void 0===a&&function(){var t=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),n=new Uint16Array([0,1,2,0,2,3]);o=e.createBuffer(),s=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,s),e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW),a=function(){var t=e.createProgram(),n=e.createShader(e.VERTEX_SHADER),r=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(n,["precision "+i.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 center;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvUV = uvOffset + uv * uvScale;","\tvec2 alignedPosition = ( position - center ) * scale;","\tvec2 rotatedPosition;","\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","\tvec4 mvPosition;","\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","\tmvPosition.xy += rotatedPosition;","\tgl_Position = projectionMatrix * mvPosition;","\tfogDepth = - mvPosition.z;","}"].join("\n")),e.shaderSource(r,["precision "+i.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvec4 texture = texture2D( map, vUV );","\tgl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","\tif ( gl_FragColor.a < alphaTest ) discard;","\tif ( fogType > 0 ) {","\t\tfloat fogFactor = 0.0;","\t\tif ( fogType == 1 ) {","\t\t\tfogFactor = smoothstep( fogNear, fogFar, fogDepth );","\t\t} else {","\t\t\tconst float LOG2 = 1.442695;","\t\t\tfogFactor = exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 );","\t\t\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","\t\t}","\t\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );","\t}","}"].join("\n")),e.compileShader(n),e.compileShader(r),e.attachShader(t,n),e.attachShader(t,r),e.linkProgram(t),t}(),l={position:e.getAttribLocation(a,"position"),uv:e.getAttribLocation(a,"uv")},u={uvOffset:e.getUniformLocation(a,"uvOffset"),uvScale:e.getUniformLocation(a,"uvScale"),rotation:e.getUniformLocation(a,"rotation"),center:e.getUniformLocation(a,"center"),scale:e.getUniformLocation(a,"scale"),color:e.getUniformLocation(a,"color"),map:e.getUniformLocation(a,"map"),opacity:e.getUniformLocation(a,"opacity"),modelViewMatrix:e.getUniformLocation(a,"modelViewMatrix"),projectionMatrix:e.getUniformLocation(a,"projectionMatrix"),fogType:e.getUniformLocation(a,"fogType"),fogDensity:e.getUniformLocation(a,"fogDensity"),fogNear:e.getUniformLocation(a,"fogNear"),fogFar:e.getUniformLocation(a,"fogFar"),fogColor:e.getUniformLocation(a,"fogColor"),fogDepth:e.getUniformLocation(a,"fogDepth"),alphaTest:e.getUniformLocation(a,"alphaTest")};var r=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");r.width=8,r.height=8;var h=r.getContext("2d");h.fillStyle="white",h.fillRect(0,0,8,8),c=new Vr(r)}(),n.useProgram(a),n.initAttributes(),n.enableAttribute(l.position),n.enableAttribute(l.uv),n.disableUnusedAttributes(),n.disable(e.CULL_FACE),n.enable(e.BLEND),e.bindBuffer(e.ARRAY_BUFFER,o),e.vertexAttribPointer(l.position,2,e.FLOAT,!1,16,0),e.vertexAttribPointer(l.uv,2,e.FLOAT,!1,16,8),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,s),e.uniformMatrix4fv(u.projectionMatrix,!1,v.projectionMatrix.elements),n.activeTexture(e.TEXTURE0),e.uniform1i(u.map,0);var y=0,w=0,b=g.fog;b?(e.uniform3f(u.fogColor,b.color.r,b.color.g,b.color.b),b.isFog?(e.uniform1f(u.fogNear,b.near),e.uniform1f(u.fogFar,b.far),e.uniform1i(u.fogType,1),y=1,w=1):b.isFogExp2&&(e.uniform1f(u.fogDensity,b.density),e.uniform1i(u.fogType,2),y=2,w=2)):(e.uniform1i(u.fogType,0),y=0,w=0);for(var x=0,_=m.length;x<_;x++)(M=m[x]).modelViewMatrix.multiplyMatrices(v.matrixWorldInverse,M.matrixWorld),M.z=-M.modelViewMatrix.elements[14];m.sort(f);var E=[],S=[];for(x=0,_=m.length;x<_;x++){var M,T=(M=m[x]).material;if(!1!==T.visible){M.onBeforeRender(t,g,v,void 0,T,void 0),e.uniform1f(u.alphaTest,T.alphaTest),e.uniformMatrix4fv(u.modelViewMatrix,!1,M.modelViewMatrix.elements),M.matrixWorld.decompose(h,d,p),E[0]=p.x,E[1]=p.y,S[0]=M.center.x-.5,S[1]=M.center.y-.5;var C=0;g.fog&&T.fog&&(C=w),y!==C&&(e.uniform1i(u.fogType,C),y=C),null!==T.map?(e.uniform2f(u.uvOffset,T.map.offset.x,T.map.offset.y),e.uniform2f(u.uvScale,T.map.repeat.x,T.map.repeat.y)):(e.uniform2f(u.uvOffset,0,0),e.uniform2f(u.uvScale,1,1)),e.uniform1f(u.opacity,T.opacity),e.uniform3f(u.color,T.color.r,T.color.g,T.color.b),e.uniform1f(u.rotation,T.rotation),e.uniform2fv(u.center,S),e.uniform2fv(u.scale,E),n.setBlending(T.blending,T.blendEquation,T.blendSrc,T.blendDst,T.blendEquationAlpha,T.blendSrcAlpha,T.blendDstAlpha,T.premultipliedAlpha),n.buffers.depth.setTest(T.depthTest),n.buffers.depth.setMask(T.depthWrite),n.buffers.color.setMask(T.colorWrite),r.setTexture2D(T.map||c,0),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),M.onAfterRender(t,g,v,void 0,T,void 0)}}n.enable(e.CULL_FACE),n.reset()}}}(mt,x,P,N,R),L.programs=U.programs,mt.context=x,mt.capabilities=R,mt.extensions=_,mt.properties=I,mt.renderLists=z,mt.state=P,mt.info=L}ne();var re=new Wr(mt);this.vr=re;var ie=new kr(mt,B,R.maxTextureSize);function oe(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),vt=!0}function se(){console.log("THREE.WebGLRenderer: Context Restored."),vt=!1,ne()}function ae(t){var e=t.target;e.removeEventListener("dispose",ae),function(t){le(t),I.remove(t)}(e)}function le(t){var e=I.get(t).program;t.program=void 0,void 0!==e&&U.releaseProgram(e)}this.shadowMap=ie,this.getContext=function(){return x},this.getContextAttributes=function(){return x.getContextAttributes()},this.forceContextLoss=function(){var t=_.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=_.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return Ht},this.setPixelRatio=function(t){void 0!==t&&(Ht=t,this.setSize(kt,Vt,!1))},this.getSize=function(){return{width:kt,height:Vt}},this.setSize=function(t,n,r){var i=re.getDevice();i&&i.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(kt=t,Vt=n,e.width=t*Ht,e.height=n*Ht,!1!==r&&(e.style.width=t+"px",e.style.height=n+"px"),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(){return{width:kt*Ht,height:Vt*Ht}},this.setDrawingBufferSize=function(t,n,r){kt=t,Vt=n,Ht=r,e.width=t*r,e.height=n*r,this.setViewport(0,0,t,n)},this.getCurrentViewport=function(){return Nt},this.setViewport=function(t,e,n,r){Wt.set(t,Vt-e-r,n,r),P.viewport(Nt.copy(Wt).multiplyScalar(Ht))},this.setScissor=function(t,e,n,r){qt.set(t,Vt-e-r,n,r),P.scissor(Ot.copy(qt).multiplyScalar(Ht))},this.setScissorTest=function(t){P.setScissorTest(Xt=t)},this.getClearColor=function(){return k.getClearColor()},this.setClearColor=function(){k.setClearColor.apply(k,arguments)},this.getClearAlpha=function(){return k.getClearAlpha()},this.setClearAlpha=function(){k.setClearAlpha.apply(k,arguments)},this.clear=function(t,e,n){var r=0;(void 0===t||t)&&(r|=x.COLOR_BUFFER_BIT),(void 0===e||e)&&(r|=x.DEPTH_BUFFER_BIT),(void 0===n||n)&&(r|=x.STENCIL_BUFFER_BIT),x.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(t,e,n,r){this.setRenderTarget(t),this.clear(e,n,r)},this.dispose=function(){e.removeEventListener("webglcontextlost",oe,!1),e.removeEventListener("webglcontextrestored",se,!1),z.dispose(),F.dispose(),I.dispose(),B.dispose(),re.dispose(),he()},this.renderBufferImmediate=function(t,e,n){P.initAttributes();var r=I.get(t);t.hasPositions&&!r.position&&(r.position=x.createBuffer()),t.hasNormals&&!r.normal&&(r.normal=x.createBuffer()),t.hasUvs&&!r.uv&&(r.uv=x.createBuffer()),t.hasColors&&!r.color&&(r.color=x.createBuffer());var i=e.getAttributes();if(t.hasPositions&&(x.bindBuffer(x.ARRAY_BUFFER,r.position),x.bufferData(x.ARRAY_BUFFER,t.positionArray,x.DYNAMIC_DRAW),P.enableAttribute(i.position),x.vertexAttribPointer(i.position,3,x.FLOAT,!1,0,0)),t.hasNormals){if(x.bindBuffer(x.ARRAY_BUFFER,r.normal),!n.isMeshPhongMaterial&&!n.isMeshStandardMaterial&&!n.isMeshNormalMaterial&&!0===n.flatShading)for(var o=0,s=3*t.count;o<s;o+=9){var a=t.normalArray,l=(a[o+0]+a[o+3]+a[o+6])/3,u=(a[o+1]+a[o+4]+a[o+7])/3,c=(a[o+2]+a[o+5]+a[o+8])/3;a[o+0]=l,a[o+1]=u,a[o+2]=c,a[o+3]=l,a[o+4]=u,a[o+5]=c,a[o+6]=l,a[o+7]=u,a[o+8]=c}x.bufferData(x.ARRAY_BUFFER,t.normalArray,x.DYNAMIC_DRAW),P.enableAttribute(i.normal),x.vertexAttribPointer(i.normal,3,x.FLOAT,!1,0,0)}t.hasUvs&&n.map&&(x.bindBuffer(x.ARRAY_BUFFER,r.uv),x.bufferData(x.ARRAY_BUFFER,t.uvArray,x.DYNAMIC_DRAW),P.enableAttribute(i.uv),x.vertexAttribPointer(i.uv,2,x.FLOAT,!1,0,0)),t.hasColors&&n.vertexColors!==b&&(x.bindBuffer(x.ARRAY_BUFFER,r.color),x.bufferData(x.ARRAY_BUFFER,t.colorArray,x.DYNAMIC_DRAW),P.enableAttribute(i.color),x.vertexAttribPointer(i.color,3,x.FLOAT,!1,0,0)),P.disableUnusedAttributes(),x.drawArrays(x.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,n,r,i,o){var s=i.isMesh&&i.matrixWorld.determinant()<0;P.setMaterial(r,s);var a=ve(t,e,r,i),l=n.id+"_"+a.id+"_"+(!0===r.wireframe),u=!1;l!==Tt&&(Tt=l,u=!0),i.morphTargetInfluences&&(V.update(i,n,r,a),u=!0);var c,h=n.index,d=n.attributes.position,p=1;!0===r.wireframe&&(h=D.getWireframeAttribute(n),p=2);var f=G;null!==h&&(c=O.get(h),(f=j).setIndex(c)),u&&(function(t,e,n,r){if(n&&n.isInstancedBufferGeometry&&null===_.get("ANGLE_instanced_arrays"))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{void 0===r&&(r=0),P.initAttributes();var i=n.attributes,o=e.getAttributes(),s=t.defaultAttributeValues;for(var a in o){var l=o[a];if(l>=0){var u=i[a];if(void 0!==u){var c=u.normalized,h=u.itemSize,d=O.get(u);if(void 0===d)continue;var p=d.buffer,f=d.type,m=d.bytesPerElement;if(u.isInterleavedBufferAttribute){var g=u.data,v=g.stride,y=u.offset;g&&g.isInstancedInterleavedBuffer?(P.enableAttributeAndDivisor(l,g.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=g.meshPerAttribute*g.count)):P.enableAttribute(l),x.bindBuffer(x.ARRAY_BUFFER,p),x.vertexAttribPointer(l,h,f,c,v*m,(r*v+y)*m)}else u.isInstancedBufferAttribute?(P.enableAttributeAndDivisor(l,u.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=u.meshPerAttribute*u.count)):P.enableAttribute(l),x.bindBuffer(x.ARRAY_BUFFER,p),x.vertexAttribPointer(l,h,f,c,0,r*h*m)}else if(void 0!==s){var w=s[a];if(void 0!==w)switch(w.length){case 2:x.vertexAttrib2fv(l,w);break;case 3:x.vertexAttrib3fv(l,w);break;case 4:x.vertexAttrib4fv(l,w);break;default:x.vertexAttrib1fv(l,w)}}}}P.disableUnusedAttributes()}}(r,a,n),null!==h&&x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,c.buffer));var m=1/0;null!==h?m=h.count:void 0!==d&&(m=d.count);var g=n.drawRange.start*p,v=n.drawRange.count*p,y=null!==o?o.start*p:0,w=null!==o?o.count*p:1/0,b=Math.max(g,y),E=Math.min(m,g+v,y+w)-1,S=Math.max(0,E-b+1);if(0!==S){if(i.isMesh)if(!0===r.wireframe)P.setLineWidth(r.wireframeLinewidth*te()),f.setMode(x.LINES);else switch(i.drawMode){case _e:f.setMode(x.TRIANGLES);break;case Ee:f.setMode(x.TRIANGLE_STRIP);break;case Se:f.setMode(x.TRIANGLE_FAN)}else if(i.isLine){var M=r.linewidth;void 0===M&&(M=1),P.setLineWidth(M*te()),f.setMode(i.isLineSegments?x.LINES:i.isLineLoop?x.LINE_LOOP:x.LINE_STRIP)}else i.isPoints&&f.setMode(x.POINTS);n&&n.isInstancedBufferGeometry?n.maxInstancedCount>0&&f.renderInstances(n,b,S):f.render(b,S)}},this.compile=function(t,e){(w=F.get(t,e)).init(),t.traverse(function(t){t.isLight&&(w.pushLight(t),t.castShadow&&w.pushShadow(t))}),w.setupLights(e),t.traverse(function(e){if(e.material)if(Array.isArray(e.material))for(var n=0;n<e.material.length;n++)ge(e.material[n],t.fog,e);else ge(e.material,t.fog,e)})};var ue=!1,ce=null;function he(){ue=!1}function de(){var t=re.getDevice();t&&t.isPresenting?t.requestAnimationFrame(pe):window.requestAnimationFrame(pe)}function pe(t){!1!==ue&&(ce(t),de())}function fe(t,e,n,r){for(var i=0,o=t.length;i<o;i++){var s=t[i],a=s.object,l=s.geometry,u=void 0===r?s.material:r,c=s.group;if(n.isArrayCamera){It=n;for(var h=n.cameras,d=0,p=h.length;d<p;d++){var f=h[d];if(a.layers.test(f.layers)){var m=f.bounds;P.viewport(Nt.set(m.x*kt,m.y*Vt,m.z*kt,m.w*Vt).multiplyScalar(Ht)),me(a,e,f,l,u,c)}}}else It=null,me(a,e,n,l,u,c)}}function me(t,e,n,r,i,o){if(t.onBeforeRender(mt,e,n,r,i,o),w=F.get(e,It||n),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){var s=t.isMesh&&t.matrixWorld.determinant()<0;P.setMaterial(i,s);var a=ve(n,e.fog,i,t);Tt="",function(t,e,n){t.render(function(t){mt.renderBufferImmediate(t,e,n)})}(t,a,i)}else mt.renderBufferDirect(n,e.fog,r,i,t,o);t.onAfterRender(mt,e,n,r,i,o),w=F.get(e,It||n)}function ge(t,e,n){var r=I.get(t),i=w.state.lights,o=U.getParameters(t,i.state,w.state.shadowsArray,e,Zt.numPlanes,Zt.numIntersection,n),s=U.getProgramCode(t,o),a=r.program,l=!0;if(void 0===a)t.addEventListener("dispose",ae);else if(a.code!==s)le(t);else if(r.lightsHash!==i.state.hash)I.update(t,"lightsHash",i.state.hash),l=!1;else{if(void 0!==o.shaderID)return;l=!1}if(l){if(o.shaderID){var u=nn[o.shaderID];r.shader={name:t.type,uniforms:Je.clone(u.uniforms),vertexShader:u.vertexShader,fragmentShader:u.fragmentShader}}else r.shader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};t.onBeforeCompile(r.shader,mt),a=U.acquireProgram(t,r.shader,o,s),r.program=a,t.program=a}var c=a.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(var h=0;h<mt.maxMorphTargets;h++)c["morphTarget"+h]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals)for(t.numSupportedMorphNormals=0,h=0;h<mt.maxMorphNormals;h++)c["morphNormal"+h]>=0&&t.numSupportedMorphNormals++;var d=r.shader.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(r.numClippingPlanes=Zt.numPlanes,r.numIntersection=Zt.numIntersection,d.clippingPlanes=Zt.uniform),r.fog=e,r.lightsHash=i.state.hash,t.lights&&(d.ambientLightColor.value=i.state.ambient,d.directionalLights.value=i.state.directional,d.spotLights.value=i.state.spot,d.rectAreaLights.value=i.state.rectArea,d.pointLights.value=i.state.point,d.hemisphereLights.value=i.state.hemi,d.directionalShadowMap.value=i.state.directionalShadowMap,d.directionalShadowMatrix.value=i.state.directionalShadowMatrix,d.spotShadowMap.value=i.state.spotShadowMap,d.spotShadowMatrix.value=i.state.spotShadowMatrix,d.pointShadowMap.value=i.state.pointShadowMap,d.pointShadowMatrix.value=i.state.pointShadowMatrix);var p=r.program.getUniforms(),f=Mr.seqWithValue(p.seq,d);r.uniformsList=f}function ve(t,e,n,r){Ft=0;var i=I.get(n),o=w.state.lights;$t&&(Qt||t!==At)&&Zt.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,t,i,t===At&&n.id===Mt),!1===n.needsUpdate&&(void 0===i.program?n.needsUpdate=!0:n.fog&&i.fog!==e?n.needsUpdate=!0:n.lights&&i.lightsHash!==o.state.hash?n.needsUpdate=!0:void 0===i.numClippingPlanes||i.numClippingPlanes===Zt.numPlanes&&i.numIntersection===Zt.numIntersection||(n.needsUpdate=!0)),n.needsUpdate&&(ge(n,e,r),n.needsUpdate=!1);var s=!1,a=!1,l=!1,u=i.program,c=u.getUniforms(),h=i.shader.uniforms;if(P.useProgram(u.program)&&(s=!0,a=!0,l=!0),n.id!==Mt&&(Mt=n.id,a=!0),s||t!==At){if(c.setValue(x,"projectionMatrix",t.projectionMatrix),R.logarithmicDepthBuffer&&c.setValue(x,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),At!==(It||t)&&(At=It||t,a=!0,l=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.envMap){var d=c.map.cameraPosition;void 0!==d&&d.setValue(x,Kt.setFromMatrixPosition(t.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&c.setValue(x,"viewMatrix",t.matrixWorldInverse)}if(n.skinning){c.setOptional(x,r,"bindMatrix"),c.setOptional(x,r,"bindMatrixInverse");var p=r.skeleton;if(p)if(R.floatVertexTextures){if(void 0===p.boneTexture){var f=Math.sqrt(4*p.bones.length);f=De.ceilPowerOfTwo(f),f=Math.max(f,4);var m=new Float32Array(f*f*4);m.set(p.boneMatrices);var g=new qe(m,f,f,zt,Pt);g.needsUpdate=!0,p.boneMatrices=m,p.boneTexture=g,p.boneTextureSize=f}c.setValue(x,"boneTexture",p.boneTexture),c.setValue(x,"boneTextureSize",p.boneTextureSize)}else c.setOptional(x,p,"boneMatrices")}return a&&(c.setValue(x,"toneMappingExposure",mt.toneMappingExposure),c.setValue(x,"toneMappingWhitePoint",mt.toneMappingWhitePoint),n.lights&&function(t,e){t.ambientLightColor.needsUpdate=e,t.directionalLights.needsUpdate=e,t.pointLights.needsUpdate=e,t.spotLights.needsUpdate=e,t.rectAreaLights.needsUpdate=e,t.hemisphereLights.needsUpdate=e}(h,l),e&&n.fog&&function(t,e){t.fogColor.value=e.color,e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)}(h,e),n.isMeshBasicMaterial?ye(h,n):n.isMeshLambertMaterial?(ye(h,n),function(t,e){e.emissiveMap&&(h.emissiveMap.value=e.emissiveMap)}(0,n)):n.isMeshPhongMaterial?(ye(h,n),n.isMeshToonMaterial?function(t,e){we(t,e),e.gradientMap&&(t.gradientMap.value=e.gradientMap)}(h,n):we(h,n)):n.isMeshStandardMaterial?(ye(h,n),n.isMeshPhysicalMaterial?function(t,e){t.clearCoat.value=e.clearCoat,t.clearCoatRoughness.value=e.clearCoatRoughness,be(t,e)}(h,n):be(h,n)):n.isMeshDepthMaterial?(ye(h,n),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(h,n)):n.isMeshDistanceMaterial?(ye(h,n),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(h,n)):n.isMeshNormalMaterial?(ye(h,n),function(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(h,n)):n.isLineBasicMaterial?(function(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity}(h,n),n.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(h,n)):n.isPointsMaterial?function(t,e){if(t.diffuse.value=e.color,t.opacity.value=e.opacity,t.size.value=e.size*Ht,t.scale.value=.5*Vt,t.map.value=e.map,null!==e.map){if(!0===e.map.matrixAutoUpdate){var n=e.map.offset,r=e.map.repeat,i=e.map.center;e.map.matrix.setUvTransform(n.x,n.y,r.x,r.y,e.map.rotation,i.x,i.y)}t.uvTransform.value.copy(e.map.matrix)}}(h,n):n.isShadowMaterial&&(h.color.value=n.color,h.opacity.value=n.opacity),void 0!==h.ltc_1&&(h.ltc_1.value=en.LTC_1),void 0!==h.ltc_2&&(h.ltc_2.value=en.LTC_2),Mr.upload(x,i.uniformsList,h,mt)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(Mr.upload(x,i.uniformsList,h,mt),n.uniformsNeedUpdate=!1),c.setValue(x,"modelViewMatrix",r.modelViewMatrix),c.setValue(x,"normalMatrix",r.normalMatrix),c.setValue(x,"modelMatrix",r.matrixWorld),u}function ye(t,e){var n;if(t.opacity.value=e.opacity,e.color&&(t.diffuse.value=e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap),e.envMap&&(t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap&&e.envMap.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio,t.maxMipLevel.value=I.get(e.envMap).__maxMipLevel),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity),e.map?n=e.map:e.specularMap?n=e.specularMap:e.displacementMap?n=e.displacementMap:e.normalMap?n=e.normalMap:e.bumpMap?n=e.bumpMap:e.roughnessMap?n=e.roughnessMap:e.metalnessMap?n=e.metalnessMap:e.alphaMap?n=e.alphaMap:e.emissiveMap&&(n=e.emissiveMap),void 0!==n){if(n.isWebGLRenderTarget&&(n=n.texture),!0===n.matrixAutoUpdate){var r=n.offset,i=n.repeat,o=n.center;n.matrix.setUvTransform(r.x,r.y,i.x,i.y,n.rotation,o.x,o.y)}t.uvTransform.value.copy(n.matrix)}}function we(t,e){t.specular.value=e.specular,t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function be(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}this.animate=function(t){null!==(ce=t)?ue||(de(),ue=!0):he()},this.render=function(t,e,n,r){if(e&&e.isCamera){if(!vt){Tt="",Mt=-1,At=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),re.enabled&&(e=re.getCamera(e)),(w=F.get(t,e)).init(),t.onBeforeRender(mt,t,e,n),Jt.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),Yt.setFromMatrix(Jt),$t=Zt.init(this.clippingPlanes,Qt=this.localClippingEnabled,e),(y=z.get(t,e)).init(),function t(e,n,r){if(!1!==e.visible){if(e.layers.test(n.layers))if(e.isLight)w.pushLight(e),e.castShadow&&w.pushShadow(e);else if(e.isSprite)e.frustumCulled&&!Yt.intersectsSprite(e)||w.pushSprite(e);else if(e.isImmediateRenderObject)r&&Kt.setFromMatrixPosition(e.matrixWorld).applyMatrix4(Jt),y.push(e,null,e.material,Kt.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.update(),!e.frustumCulled||Yt.intersectsObject(e))){r&&Kt.setFromMatrixPosition(e.matrixWorld).applyMatrix4(Jt);var i=B.update(e),o=e.material;if(Array.isArray(o))for(var s=i.groups,a=0,l=s.length;a<l;a++){var u=s[a],c=o[u.materialIndex];c&&c.visible&&y.push(e,i,c,Kt.z,u)}else o.visible&&y.push(e,i,o,Kt.z,null)}var h=e.children;for(a=0,l=h.length;a<l;a++)t(h[a],n,r)}}(t,e,mt.sortObjects),!0===mt.sortObjects&&y.sort(),$t&&Zt.beginShadows(),ie.render(w.state.shadowsArray,t,e),w.setupLights(e),$t&&Zt.endShadows(),this.info.autoReset&&this.info.reset(),void 0===n&&(n=null),this.setRenderTarget(n),k.render(y,t,e,r);var i=y.opaque,o=y.transparent;if(t.overrideMaterial){var s=t.overrideMaterial;i.length&&fe(i,t,e,s),o.length&&fe(o,t,e,s)}else i.length&&fe(i,t,e),o.length&&fe(o,t,e);H.render(w.state.spritesArray,t,e),n&&N.updateRenderTargetMipmap(n),P.buffers.depth.setTest(!0),P.buffers.depth.setMask(!0),P.buffers.color.setMask(!0),P.setPolygonOffset(!1),t.onAfterRender(mt,t,e),re.enabled&&re.submitFrame(),y=null,w=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.allocTextureUnit=function(){var t=Ft;return t>=R.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+t+" texture units while this GPU supports only "+R.maxTextures),Ft+=1,t},this.setTexture2D=function(){var t=!1;return function(e,n){e&&e.isWebGLRenderTarget&&(t||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),N.setTexture2D(e,n)}}(),this.setTexture=function(){var t=!1;return function(e,n){t||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),t=!0),N.setTexture2D(e,n)}}(),this.setTextureCube=function(){var t=!1;return function(e,n){e&&e.isWebGLRenderTargetCube&&(t||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?N.setTextureCube(e,n):N.setTextureCubeDynamic(e,n)}}(),this.getRenderTarget=function(){return _t},this.setRenderTarget=function(t){_t=t,t&&void 0===I.get(t).__webglFramebuffer&&N.setupRenderTarget(t);var e=null,n=!1;if(t){var r=I.get(t).__webglFramebuffer;t.isWebGLRenderTargetCube?(e=r[t.activeCubeFace],n=!0):e=r,Nt.copy(t.viewport),Ot.copy(t.scissor),Bt=t.scissorTest}else Nt.copy(Wt).multiplyScalar(Ht),Ot.copy(qt).multiplyScalar(Ht),Bt=Xt;if(Et!==e&&(x.bindFramebuffer(x.FRAMEBUFFER,e),Et=e),P.viewport(Nt),P.scissor(Ot),P.setScissorTest(Bt),n){var i=I.get(t.texture);x.framebufferTexture2D(x.FRAMEBUFFER,x.COLOR_ATTACHMENT0,x.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,i.__webglTexture,t.activeMipMapLevel)}},this.readRenderTargetPixels=function(t,e,n,r,i,o){if(t&&t.isWebGLRenderTarget){var s=I.get(t).__webglFramebuffer;if(s){var a=!1;s!==Et&&(x.bindFramebuffer(x.FRAMEBUFFER,s),a=!0);try{var l=t.texture,u=l.format,c=l.type;if(u!==zt&&at.convert(u)!==x.getParameter(x.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(c===St||at.convert(c)===x.getParameter(x.IMPLEMENTATION_COLOR_READ_TYPE)||c===Pt&&(_.get("OES_texture_float")||_.get("WEBGL_color_buffer_float"))||c===Lt&&_.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");x.checkFramebufferStatus(x.FRAMEBUFFER)===x.FRAMEBUFFER_COMPLETE?e>=0&&e<=t.width-r&&n>=0&&n<=t.height-i&&x.readPixels(e,n,r,i,at.convert(u),at.convert(c),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{a&&x.bindFramebuffer(x.FRAMEBUFFER,Et)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(t,e,n){var r=e.image.width,i=e.image.height,o=at.convert(e.format);this.setTexture2D(e,0),x.copyTexImage2D(x.TEXTURE_2D,n||0,o,t.x,t.y,r,i,0)},this.copyTextureToTexture=function(t,e,n,r){var i=e.image.width,o=e.image.height,s=at.convert(n.format),a=at.convert(n.type),l=e.isDataTexture?e.image.data:e.image;this.setTexture2D(n,0),x.texSubImage2D(x.TEXTURE_2D,r||0,t.x,t.y,i,o,s,a,l)}}function Xr(t,e){this.name="",this.color=new tn(t),this.density=void 0!==e?e:25e-5}function Yr(t,e,n){this.name="",this.color=new tn(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3}function Zr(){an.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function $r(t){In.call(this),this.type="SpriteMaterial",this.color=new tn(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(t)}function Qr(t){an.call(this),this.type="Sprite",this.material=void 0!==t?t:new $r,this.center=new Be(.5,.5)}function Jr(){an.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function Kr(t,e){if(this.bones=(t=t||[]).slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new Ue)}}function ti(){an.call(this),this.type="Bone"}function ei(t,e){zn.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ue,this.bindMatrixInverse=new Ue;var n=new Kr(this.initBones());this.bind(n,this.matrixWorld),this.normalizeSkinWeights()}function ni(t){In.call(this),this.type="LineBasicMaterial",this.color=new tn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(t)}function ri(t,e,n){if(1===n)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new ii(t,e);an.call(this),this.type="Line",this.geometry=void 0!==t?t:new Tn,this.material=void 0!==e?e:new ni({color:16777215*Math.random()})}function ii(t,e){ri.call(this,t,e),this.type="LineSegments"}function oi(t,e){ri.call(this,t,e),this.type="LineLoop"}function si(t){In.call(this),this.type="PointsMaterial",this.color=new tn(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(t)}function ai(t,e){an.call(this),this.type="Points",this.geometry=void 0!==t?t:new Tn,this.material=void 0!==e?e:new si({color:16777215*Math.random()})}function li(){an.call(this),this.type="Group"}function ui(t,e,n,r,i,o,s,a,l){Ge.call(this,t,e,n,r,i,o,s,a,l),this.generateMipmaps=!1}function ci(t,e,n,r,i,o,s,a,l,u,c,h){Ge.call(this,null,o,s,a,l,u,r,i,c,h),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function hi(t,e,n,r,i,o,s,a,l,u){if((u=void 0!==u?u:Gt)!==Gt&&u!==jt)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&u===Gt&&(n=Ct),void 0===n&&u===jt&&(n=Dt),Ge.call(this,null,r,i,o,s,a,u,n,l),this.image={width:t,height:e},this.magFilter=void 0!==s?s:yt,this.minFilter=void 0!==a?a:yt,this.flipY=!1,this.generateMipmaps=!1}function di(t){Tn.call(this),this.type="WireframeGeometry";var e,n,r,i,o,s,a,l,u,c,h=[],d=[0,0],p={},f=["a","b","c"];if(t&&t.isGeometry){var m=t.faces;for(e=0,r=m.length;e<r;e++){var g=m[e];for(n=0;n<3;n++)a=g[f[n]],l=g[f[(n+1)%3]],d[0]=Math.min(a,l),d[1]=Math.max(a,l),void 0===p[u=d[0]+","+d[1]]&&(p[u]={index1:d[0],index2:d[1]})}for(u in p)h.push((c=t.vertices[(s=p[u]).index1]).x,c.y,c.z),h.push((c=t.vertices[s.index2]).x,c.y,c.z)}else if(t&&t.isBufferGeometry){var v,y,w,b,x;if(c=new Fe,null!==t.index){for(v=t.attributes.position,y=t.index,0===(w=t.groups).length&&(w=[{start:0,count:y.count,materialIndex:0}]),i=0,o=w.length;i<o;++i)for(e=x=(b=w[i]).start,r=x+b.count;e<r;e+=3)for(n=0;n<3;n++)a=y.getX(e+n),l=y.getX(e+(n+1)%3),d[0]=Math.min(a,l),d[1]=Math.max(a,l),void 0===p[u=d[0]+","+d[1]]&&(p[u]={index1:d[0],index2:d[1]});for(u in p)c.fromBufferAttribute(v,(s=p[u]).index1),h.push(c.x,c.y,c.z),c.fromBufferAttribute(v,s.index2),h.push(c.x,c.y,c.z)}else for(e=0,r=(v=t.attributes.position).count/3;e<r;e++)for(n=0;n<3;n++)c.fromBufferAttribute(v,3*e+n),h.push(c.x,c.y,c.z),c.fromBufferAttribute(v,3*e+(n+1)%3),h.push(c.x,c.y,c.z)}this.addAttribute("position",new xn(h,3))}function pi(t,e,n){dn.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n},this.fromBufferGeometry(new fi(t,e,n)),this.mergeVertices()}function fi(t,e,n){Tn.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:n};var r,i,o=[],s=[],a=[],l=[],u=new Fe,c=new Fe,h=new Fe,d=new Fe,p=new Fe,f=e+1;for(r=0;r<=n;r++){var m=r/n;for(i=0;i<=e;i++){var g=i/e;t(g,m,c),s.push(c.x,c.y,c.z),g-1e-5>=0?(t(g-1e-5,m,h),d.subVectors(c,h)):(t(g+1e-5,m,h),d.subVectors(h,c)),m-1e-5>=0?(t(g,m-1e-5,h),p.subVectors(c,h)):(t(g,m+1e-5,h),p.subVectors(h,c)),u.crossVectors(d,p).normalize(),a.push(u.x,u.y,u.z),l.push(g,m)}}for(r=0;r<n;r++)for(i=0;i<e;i++){var v=r*f+i+1,y=(r+1)*f+i+1,w=(r+1)*f+i;o.push(r*f+i,v,w),o.push(v,y,w)}this.setIndex(o),this.addAttribute("position",new xn(s,3)),this.addAttribute("normal",new xn(a,3)),this.addAttribute("uv",new xn(l,2))}function mi(t,e,n,r){dn.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},this.fromBufferGeometry(new gi(t,e,n,r)),this.mergeVertices()}function gi(t,e,n,r){Tn.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},n=n||1;var i=[],o=[];function s(t,e,n,r){var i,o,s=Math.pow(2,r),l=[];for(i=0;i<=s;i++){l[i]=[];var u=t.clone().lerp(n,i/s),c=e.clone().lerp(n,i/s),h=s-i;for(o=0;o<=h;o++)l[i][o]=0===o&&i===s?u:u.clone().lerp(c,o/h)}for(i=0;i<s;i++)for(o=0;o<2*(s-i)-1;o++){var d=Math.floor(o/2);o%2==0?(a(l[i][d+1]),a(l[i+1][d]),a(l[i][d])):(a(l[i][d+1]),a(l[i+1][d+1]),a(l[i+1][d]))}}function a(t){i.push(t.x,t.y,t.z)}function l(e,n){var r=3*e;n.x=t[r+0],n.y=t[r+1],n.z=t[r+2]}function u(t,e,n,r){r<0&&1===t.x&&(o[e]=t.x-1),0===n.x&&0===n.z&&(o[e]=r/2/Math.PI+.5)}function c(t){return Math.atan2(t.z,-t.x)}function h(t){return Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))}!function(t){for(var n=new Fe,r=new Fe,i=new Fe,o=0;o<e.length;o+=3)l(e[o+0],n),l(e[o+1],r),l(e[o+2],i),s(n,r,i,t)}(r=r||0),function(t){for(var e=new Fe,n=0;n<i.length;n+=3)e.x=i[n+0],e.y=i[n+1],e.z=i[n+2],e.normalize().multiplyScalar(t),i[n+0]=e.x,i[n+1]=e.y,i[n+2]=e.z}(n),function(){for(var t=new Fe,e=0;e<i.length;e+=3){t.x=i[e+0],t.y=i[e+1],t.z=i[e+2];var n=c(t)/2/Math.PI+.5,r=h(t)/Math.PI+.5;o.push(n,1-r)}(function(){for(var t=new Fe,e=new Fe,n=new Fe,r=new Fe,s=new Be,a=new Be,l=new Be,h=0,d=0;h<i.length;h+=9,d+=6){t.set(i[h+0],i[h+1],i[h+2]),e.set(i[h+3],i[h+4],i[h+5]),n.set(i[h+6],i[h+7],i[h+8]),s.set(o[d+0],o[d+1]),a.set(o[d+2],o[d+3]),l.set(o[d+4],o[d+5]),r.copy(t).add(e).add(n).divideScalar(3);var p=c(r);u(s,d+0,t,p),u(a,d+2,e,p),u(l,d+4,n,p)}})(),function(){for(var t=0;t<o.length;t+=6){var e=o[t+0],n=o[t+2],r=o[t+4],i=Math.max(e,n,r),s=Math.min(e,n,r);i>.9&&s<.1&&(e<.2&&(o[t+0]+=1),n<.2&&(o[t+2]+=1),r<.2&&(o[t+4]+=1))}}()}(),this.addAttribute("position",new xn(i,3)),this.addAttribute("normal",new xn(i.slice(),3)),this.addAttribute("uv",new xn(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function vi(t,e){dn.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new yi(t,e)),this.mergeVertices()}function yi(t,e){gi.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function wi(t,e){dn.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new bi(t,e)),this.mergeVertices()}function bi(t,e){gi.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function xi(t,e){dn.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new _i(t,e)),this.mergeVertices()}function _i(t,e){var n=(1+Math.sqrt(5))/2;gi.call(this,[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Ei(t,e){dn.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Si(t,e)),this.mergeVertices()}function Si(t,e){var n=(1+Math.sqrt(5))/2,r=1/n;gi.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Mi(t,e,n,r,i,o){dn.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed.");var s=new Ti(t,e,n,r,i);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals,this.fromBufferGeometry(s),this.mergeVertices()}function Ti(t,e,n,r,i){Tn.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i},e=e||64,n=n||1,r=r||8;var o=t.computeFrenetFrames(e,i=i||!1);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;var s,a,l=new Fe,u=new Fe,c=new Be,h=new Fe,d=[],p=[],f=[],m=[];function g(i){h=t.getPointAt(i/e,h);var s=o.normals[i],c=o.binormals[i];for(a=0;a<=r;a++){var f=a/r*Math.PI*2,m=Math.sin(f),g=-Math.cos(f);u.x=g*s.x+m*c.x,u.y=g*s.y+m*c.y,u.z=g*s.z+m*c.z,u.normalize(),p.push(u.x,u.y,u.z),l.x=h.x+n*u.x,l.y=h.y+n*u.y,l.z=h.z+n*u.z,d.push(l.x,l.y,l.z)}}!function(){for(s=0;s<e;s++)g(s);g(!1===i?e:0),function(){for(s=0;s<=e;s++)for(a=0;a<=r;a++)c.x=s/e,c.y=a/r,f.push(c.x,c.y)}(),function(){for(a=1;a<=e;a++)for(s=1;s<=r;s++){var t=(r+1)*a+(s-1),n=(r+1)*a+s,i=(r+1)*(a-1)+s;m.push((r+1)*(a-1)+(s-1),t,i),m.push(t,n,i)}}()}(),this.setIndex(m),this.addAttribute("position",new xn(d,3)),this.addAttribute("normal",new xn(p,3)),this.addAttribute("uv",new xn(f,2))}function Ci(t,e,n,r,i,o,s){dn.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},void 0!==s&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Ai(t,e,n,r,i,o)),this.mergeVertices()}function Ai(t,e,n,r,i,o){Tn.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},t=t||1,e=e||.4,n=Math.floor(n)||64,r=Math.floor(r)||8,i=i||2,o=o||3;var s,a,l=[],u=[],c=[],h=[],d=new Fe,p=new Fe,f=new Fe,m=new Fe,g=new Fe,v=new Fe,y=new Fe;for(s=0;s<=n;++s){var w=s/n*i*Math.PI*2;for(T(w,i,o,t,f),T(w+.01,i,o,t,m),v.subVectors(m,f),y.addVectors(m,f),g.crossVectors(v,y),y.crossVectors(g,v),g.normalize(),y.normalize(),a=0;a<=r;++a){var b=a/r*Math.PI*2,x=-e*Math.cos(b),_=e*Math.sin(b);d.x=f.x+(x*y.x+_*g.x),d.y=f.y+(x*y.y+_*g.y),d.z=f.z+(x*y.z+_*g.z),u.push(d.x,d.y,d.z),p.subVectors(d,f).normalize(),c.push(p.x,p.y,p.z),h.push(s/n),h.push(a/r)}}for(a=1;a<=n;a++)for(s=1;s<=r;s++){var E=(r+1)*a+(s-1),S=(r+1)*a+s,M=(r+1)*(a-1)+s;l.push((r+1)*(a-1)+(s-1),E,M),l.push(E,S,M)}function T(t,e,n,r,i){var o=Math.cos(t),s=Math.sin(t),a=n/e*t,l=Math.cos(a);i.x=r*(2+l)*.5*o,i.y=r*(2+l)*s*.5,i.z=r*Math.sin(a)*.5}this.setIndex(l),this.addAttribute("position",new xn(u,3)),this.addAttribute("normal",new xn(c,3)),this.addAttribute("uv",new xn(h,2))}function Ri(t,e,n,r,i){dn.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},this.fromBufferGeometry(new Pi(t,e,n,r,i)),this.mergeVertices()}function Pi(t,e,n,r,i){Tn.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},t=t||1,e=e||.4,n=Math.floor(n)||8,r=Math.floor(r)||6,i=i||2*Math.PI;var o,s,a=[],l=[],u=[],c=[],h=new Fe,d=new Fe,p=new Fe;for(o=0;o<=n;o++)for(s=0;s<=r;s++){var f=s/r*i,m=o/n*Math.PI*2;d.x=(t+e*Math.cos(m))*Math.cos(f),d.y=(t+e*Math.cos(m))*Math.sin(f),d.z=e*Math.sin(m),l.push(d.x,d.y,d.z),h.x=t*Math.cos(f),h.y=t*Math.sin(f),p.subVectors(d,h).normalize(),u.push(p.x,p.y,p.z),c.push(s/r),c.push(o/n)}for(o=1;o<=n;o++)for(s=1;s<=r;s++){var g=(r+1)*(o-1)+s-1,v=(r+1)*(o-1)+s,y=(r+1)*o+s;a.push((r+1)*o+s-1,g,y),a.push(g,v,y)}this.setIndex(a),this.addAttribute("position",new xn(l,3)),this.addAttribute("normal",new xn(u,3)),this.addAttribute("uv",new xn(c,2))}function Li(t,e,n,r,i){var o,s;if(i===function(t,e,n,r){for(var i=0,o=e,s=n-r;o<n;o+=r)i+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return i}(t,e,n,r)>0)for(o=e;o<n;o+=r)s=Zi(o,t[o],t[o+1],s);else for(o=n-r;o>=e;o-=r)s=Zi(o,t[o],t[o+1],s);return s&&Wi(s,s.next)&&($i(s),s=s.next),s}function Ii(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!Wi(r,r.next)&&0!==Hi(r.prev,r,r.next))r=r.next;else{if($i(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function Ni(t,e,n,r,i,o,s){if(t){!s&&o&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=ki(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,s,a,l,u=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,r=n,a=0,e=0;e<u&&(a++,r=r.nextZ);e++);for(l=u;a>0||l>0&&r;)0!==a&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,l--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,u*=2}while(s>1)}(i)}(t,r,i,o);for(var a,l,u=t;t.prev!==t.next;)if(a=t.prev,l=t.next,o?Di(t,r,i,o):Oi(t))e.push(a.i/n),e.push(t.i/n),e.push(l.i/n),$i(t),t=l.next,u=l.next;else if((t=l)===u){s?1===s?Ni(t=Bi(t,e,n),e,n,r,i,o,2):2===s&&Ui(t,e,n,r,i,o):Ni(Ii(t),e,n,r,i,o,1);break}}}function Oi(t){var e=t.prev,n=t,r=t.next;if(Hi(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(Gi(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&Hi(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function Di(t,e,n,r){var i=t.prev,o=t,s=t.next;if(Hi(i,o,s)>=0)return!1;for(var a=i.x>o.x?i.x>s.x?i.x:s.x:o.x>s.x?o.x:s.x,l=i.y>o.y?i.y>s.y?i.y:s.y:o.y>s.y?o.y:s.y,u=ki(i.x<o.x?i.x<s.x?i.x:s.x:o.x<s.x?o.x:s.x,i.y<o.y?i.y<s.y?i.y:s.y:o.y<s.y?o.y:s.y,e,n,r),c=ki(a,l,e,n,r),h=t.nextZ;h&&h.z<=c;){if(h!==t.prev&&h!==t.next&&Gi(i.x,i.y,o.x,o.y,s.x,s.y,h.x,h.y)&&Hi(h.prev,h,h.next)>=0)return!1;h=h.nextZ}for(h=t.prevZ;h&&h.z>=u;){if(h!==t.prev&&h!==t.next&&Gi(i.x,i.y,o.x,o.y,s.x,s.y,h.x,h.y)&&Hi(h.prev,h,h.next)>=0)return!1;h=h.prevZ}return!0}function Bi(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!Wi(i,o)&&qi(i,r,r.next,o)&&Xi(i,o)&&Xi(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),$i(r),$i(r.next),r=t=o),r=r.next}while(r!==t);return r}function Ui(t,e,n,r,i,o){var s=t;do{for(var a=s.next.next;a!==s.prev;){if(s.i!==a.i&&ji(s,a)){var l=Yi(s,a);return s=Ii(s,s.next),l=Ii(l,l.next),Ni(s,e,n,r,i,o),void Ni(l,e,n,r,i,o)}a=a.next}s=s.next}while(s!==t)}function zi(t,e){return t.x-e.x}function Fi(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,s=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var a=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=i&&a>s){if(s=a,a===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===s)return n.prev;var l,u=n,c=n.x,h=n.y,d=1/0;for(r=n.next;r!==u;)i>=r.x&&r.x>=c&&i!==r.x&&Gi(o<h?i:s,o,c,h,o<h?s:i,o,r.x,r.y)&&((l=Math.abs(o-r.y)/(i-r.x))<d||l===d&&r.x>n.x)&&Xi(r,t)&&(n=r,d=l),r=r.next;return n}(t,e)){var n=Yi(e,t);Ii(n,n.next)}}function ki(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Vi(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function Gi(t,e,n,r,i,o,s,a){return(i-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(r-a)-(n-s)*(e-a)>=0&&(n-s)*(o-a)-(i-s)*(r-a)>=0}function ji(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&qi(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&Xi(t,e)&&Xi(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)}function Hi(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Wi(t,e){return t.x===e.x&&t.y===e.y}function qi(t,e,n,r){return!!(Wi(t,e)&&Wi(n,r)||Wi(t,r)&&Wi(n,e))||Hi(t,e,n)>0!=Hi(t,e,r)>0&&Hi(n,r,t)>0!=Hi(n,r,e)>0}function Xi(t,e){return Hi(t.prev,t,t.next)<0?Hi(t,e,t.next)>=0&&Hi(t,t.prev,e)>=0:Hi(t,e,t.prev)<0||Hi(t,t.next,e)<0}function Yi(t,e){var n=new Qi(t.i,t.x,t.y),r=new Qi(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function Zi(t,e,n,r){var i=new Qi(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function $i(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Qi(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}(zr.prototype=Object.create(In.prototype)).constructor=zr,zr.prototype.isMeshDepthMaterial=!0,zr.prototype.copy=function(t){return In.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},(Fr.prototype=Object.create(In.prototype)).constructor=Fr,Fr.prototype.isMeshDistanceMaterial=!0,Fr.prototype.copy=function(t){return In.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},(Vr.prototype=Object.create(Ge.prototype)).constructor=Vr,jr.prototype=Object.assign(Object.create(ln.prototype),{constructor:jr,isPerspectiveCamera:!0,copy:function(t,e){return ln.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var e=.5*this.getFilmHeight()/t;this.fov=2*De.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*De.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*De.RAD2DEG*Math.atan(Math.tan(.5*De.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,r,i,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=t*Math.tan(.5*De.DEG2RAD*this.fov)/this.zoom,n=2*e,r=this.aspect*n,i=-.5*r,o=this.view;if(null!==this.view&&this.view.enabled){var s=o.fullWidth,a=o.fullHeight;i+=o.offsetX*r/s,e-=o.offsetY*n/a,r*=o.width/s,n*=o.height/a}var l=this.filmOffset;0!==l&&(i+=t*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,e,e-n,t,this.far)},toJSON:function(t){var e=an.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}),Hr.prototype=Object.assign(Object.create(jr.prototype),{constructor:Hr,isArrayCamera:!0}),Xr.prototype.isFogExp2=!0,Xr.prototype.clone=function(){return new Xr(this.color.getHex(),this.density)},Xr.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},Yr.prototype.isFog=!0,Yr.prototype.clone=function(){return new Yr(this.color.getHex(),this.near,this.far)},Yr.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},Zr.prototype=Object.assign(Object.create(an.prototype),{constructor:Zr,copy:function(t,e){return an.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=an.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}),($r.prototype=Object.create(In.prototype)).constructor=$r,$r.prototype.isSpriteMaterial=!0,$r.prototype.copy=function(t){return In.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this},Qr.prototype=Object.assign(Object.create(an.prototype),{constructor:Qr,isSprite:!0,raycast:function(){var t=new Fe,e=new Fe,n=new Fe;return function(r,i){e.setFromMatrixPosition(this.matrixWorld),r.ray.closestPointToPoint(e,t),n.setFromMatrixScale(this.matrixWorld);var o=n.x*n.y/4;if(!(e.distanceToSquared(t)>o)){var s=r.ray.origin.distanceTo(t);s<r.near||s>r.far||i.push({distance:s,point:t.clone(),face:null,object:this})}}}(),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(t){return an.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this}}),Jr.prototype=Object.assign(Object.create(an.prototype),{constructor:Jr,copy:function(t){an.prototype.copy.call(this,t,!1);for(var e=t.levels,n=0,r=e.length;n<r;n++){var i=e[n];this.addLevel(i.object.clone(),i.distance)}return this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var n=this.levels,r=0;r<n.length&&!(e<n[r].distance);r++);n.splice(r,0,{distance:e,object:t}),this.add(t)},getObjectForDistance:function(t){for(var e=this.levels,n=1,r=e.length;n<r&&!(t<e[n].distance);n++);return e[n-1].object},raycast:function(){var t=new Fe;return function(e,n){t.setFromMatrixPosition(this.matrixWorld);var r=e.ray.origin.distanceTo(t);this.getObjectForDistance(r).raycast(e,n)}}(),update:function(){var t=new Fe,e=new Fe;return function(n){var r=this.levels;if(r.length>1){t.setFromMatrixPosition(n.matrixWorld),e.setFromMatrixPosition(this.matrixWorld);var i=t.distanceTo(e);r[0].object.visible=!0;for(var o=1,s=r.length;o<s&&i>=r[o].distance;o++)r[o-1].object.visible=!1,r[o].object.visible=!0;for(;o<s;o++)r[o].object.visible=!1}}}(),toJSON:function(t){var e=an.prototype.toJSON.call(this,t);e.object.levels=[];for(var n=this.levels,r=0,i=n.length;r<i;r++){var o=n[r];e.object.levels.push({object:o.object.uuid,distance:o.distance})}return e}}),Object.assign(Kr.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var n=new Ue;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},pose:function(){var t,e,n;for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){var t=new Ue,e=new Ue;return function(){for(var n=this.bones,r=this.boneInverses,i=this.boneMatrices,o=this.boneTexture,s=0,a=n.length;s<a;s++)t.multiplyMatrices(n[s]?n[s].matrixWorld:e,r[s]),t.toArray(i,16*s);void 0!==o&&(o.needsUpdate=!0)}}(),clone:function(){return new Kr(this.bones,this.boneInverses)},getBoneByName:function(t){for(var e=0,n=this.bones.length;e<n;e++){var r=this.bones[e];if(r.name===t)return r}}}),ti.prototype=Object.assign(Object.create(an.prototype),{constructor:ti,isBone:!0}),ei.prototype=Object.assign(Object.create(zn.prototype),{constructor:ei,isSkinnedMesh:!0,initBones:function(){var t,e,n,r,i=[];if(this.geometry&&void 0!==this.geometry.bones){for(n=0,r=this.geometry.bones.length;n<r;n++)e=this.geometry.bones[n],t=new ti,i.push(t),t.name=e.name,t.position.fromArray(e.pos),t.quaternion.fromArray(e.rotq),void 0!==e.scl&&t.scale.fromArray(e.scl);for(n=0,r=this.geometry.bones.length;n<r;n++)-1!==(e=this.geometry.bones[n]).parent&&null!==e.parent&&void 0!==i[e.parent]?i[e.parent].add(i[n]):this.add(i[n])}return this.updateMatrixWorld(!0),i},bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var t,e;if(this.geometry&&this.geometry.isGeometry)for(e=0;e<this.geometry.skinWeights.length;e++){var n=this.geometry.skinWeights[e];(t=1/n.manhattanLength())!=1/0?n.multiplyScalar(t):n.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var r=new je,i=this.geometry.attributes.skinWeight;for(e=0;e<i.count;e++)r.x=i.getX(e),r.y=i.getY(e),r.z=i.getZ(e),r.w=i.getW(e),(t=1/r.manhattanLength())!=1/0?r.multiplyScalar(t):r.set(1,0,0,0),i.setXYZW(e,r.x,r.y,r.z,r.w)}},updateMatrixWorld:function(t){zn.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),(ni.prototype=Object.create(In.prototype)).constructor=ni,ni.prototype.isLineBasicMaterial=!0,ni.prototype.copy=function(t){return In.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this},ri.prototype=Object.assign(Object.create(an.prototype),{constructor:ri,isLine:!0,computeLineDistances:function(){var t=new Fe,e=new Fe;return function(){var n=this.geometry;if(n.isBufferGeometry)if(null===n.index){for(var r=n.attributes.position,i=[0],o=1,s=r.count;o<s;o++)t.fromBufferAttribute(r,o-1),e.fromBufferAttribute(r,o),i[o]=i[o-1],i[o]+=t.distanceTo(e);n.addAttribute("lineDistance",new THREE.Float32BufferAttribute(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(n.isGeometry){var a=n.vertices;for((i=n.lineDistances)[0]=0,o=1,s=a.length;o<s;o++)i[o]=i[o-1],i[o]+=a[o-1].distanceTo(a[o])}return this}}(),raycast:function(){var t=new Ue,e=new Dn,n=new Ye;return function(r,i){var o=r.linePrecision,s=o*o,a=this.geometry,l=this.matrixWorld;if(null===a.boundingSphere&&a.computeBoundingSphere(),n.copy(a.boundingSphere),n.applyMatrix4(l),!1!==r.ray.intersectsSphere(n)){t.getInverse(l),e.copy(r.ray).applyMatrix4(t);var u=new Fe,c=new Fe,h=new Fe,d=new Fe,p=this&&this.isLineSegments?2:1;if(a.isBufferGeometry){var f=a.index,m=a.attributes.position.array;if(null!==f)for(var g=f.array,v=0,y=g.length-1;v<y;v+=p){var w=g[v+1];u.fromArray(m,3*g[v]),c.fromArray(m,3*w),e.distanceSqToSegment(u,c,d,h)>s||(d.applyMatrix4(this.matrixWorld),(_=r.ray.origin.distanceTo(d))<r.near||_>r.far||i.push({distance:_,point:h.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this}))}else for(v=0,y=m.length/3-1;v<y;v+=p)u.fromArray(m,3*v),c.fromArray(m,3*v+3),e.distanceSqToSegment(u,c,d,h)>s||(d.applyMatrix4(this.matrixWorld),(_=r.ray.origin.distanceTo(d))<r.near||_>r.far||i.push({distance:_,point:h.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this}))}else if(a.isGeometry){var b=a.vertices,x=b.length;for(v=0;v<x-1;v+=p){var _;e.distanceSqToSegment(b[v],b[v+1],d,h)>s||(d.applyMatrix4(this.matrixWorld),(_=r.ray.origin.distanceTo(d))<r.near||_>r.far||i.push({distance:_,point:h.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this}))}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),ii.prototype=Object.assign(Object.create(ri.prototype),{constructor:ii,isLineSegments:!0,computeLineDistances:function(){var t=new Fe,e=new Fe;return function(){var n=this.geometry;if(n.isBufferGeometry)if(null===n.index){for(var r=n.attributes.position,i=[],o=0,s=r.count;o<s;o+=2)t.fromBufferAttribute(r,o),e.fromBufferAttribute(r,o+1),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+t.distanceTo(e);n.addAttribute("lineDistance",new THREE.Float32BufferAttribute(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(n.isGeometry){var a=n.vertices;for(i=n.lineDistances,o=0,s=a.length;o<s;o+=2)t.copy(a[o]),e.copy(a[o+1]),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+t.distanceTo(e)}return this}}()}),oi.prototype=Object.assign(Object.create(ri.prototype),{constructor:oi,isLineLoop:!0}),(si.prototype=Object.create(In.prototype)).constructor=si,si.prototype.isPointsMaterial=!0,si.prototype.copy=function(t){return In.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this},ai.prototype=Object.assign(Object.create(an.prototype),{constructor:ai,isPoints:!0,raycast:function(){var t=new Ue,e=new Dn,n=new Ye;return function(r,i){var o=this,s=this.geometry,a=this.matrixWorld,l=r.params.Points.threshold;if(null===s.boundingSphere&&s.computeBoundingSphere(),n.copy(s.boundingSphere),n.applyMatrix4(a),n.radius+=l,!1!==r.ray.intersectsSphere(n)){t.getInverse(a),e.copy(r.ray).applyMatrix4(t);var u=l/((this.scale.x+this.scale.y+this.scale.z)/3),c=u*u,h=new Fe,d=new Fe;if(s.isBufferGeometry){var p=s.index,f=s.attributes.position.array;if(null!==p)for(var m=p.array,g=0,v=m.length;g<v;g++){var y=m[g];h.fromArray(f,3*y),x(h,y)}else{g=0;for(var w=f.length/3;g<w;g++)h.fromArray(f,3*g),x(h,g)}}else{var b=s.vertices;for(g=0,w=b.length;g<w;g++)x(b[g],g)}}function x(t,n){var s=e.distanceSqToPoint(t);if(s<c){e.closestPointToPoint(t,d),d.applyMatrix4(a);var l=r.ray.origin.distanceTo(d);if(l<r.near||l>r.far)return;i.push({distance:l,distanceToRay:Math.sqrt(s),point:d.clone(),index:n,face:null,object:o})}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),li.prototype=Object.assign(Object.create(an.prototype),{constructor:li,isGroup:!0}),ui.prototype=Object.assign(Object.create(Ge.prototype),{constructor:ui,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),(ci.prototype=Object.create(Ge.prototype)).constructor=ci,ci.prototype.isCompressedTexture=!0,(hi.prototype=Object.create(Ge.prototype)).constructor=hi,hi.prototype.isDepthTexture=!0,(di.prototype=Object.create(Tn.prototype)).constructor=di,(pi.prototype=Object.create(dn.prototype)).constructor=pi,(fi.prototype=Object.create(Tn.prototype)).constructor=fi,(mi.prototype=Object.create(dn.prototype)).constructor=mi,(gi.prototype=Object.create(Tn.prototype)).constructor=gi,(vi.prototype=Object.create(dn.prototype)).constructor=vi,(yi.prototype=Object.create(gi.prototype)).constructor=yi,(wi.prototype=Object.create(dn.prototype)).constructor=wi,(bi.prototype=Object.create(gi.prototype)).constructor=bi,(xi.prototype=Object.create(dn.prototype)).constructor=xi,(_i.prototype=Object.create(gi.prototype)).constructor=_i,(Ei.prototype=Object.create(dn.prototype)).constructor=Ei,(Si.prototype=Object.create(gi.prototype)).constructor=Si,(Mi.prototype=Object.create(dn.prototype)).constructor=Mi,(Ti.prototype=Object.create(Tn.prototype)).constructor=Ti,(Ci.prototype=Object.create(dn.prototype)).constructor=Ci,(Ai.prototype=Object.create(Tn.prototype)).constructor=Ai,(Ri.prototype=Object.create(dn.prototype)).constructor=Ri,(Pi.prototype=Object.create(Tn.prototype)).constructor=Pi;var Ji={area:function(t){for(var e=t.length,n=0,r=e-1,i=0;i<e;r=i++)n+=t[r].x*t[i].y-t[i].x*t[r].y;return.5*n},isClockWise:function(t){return Ji.area(t)<0},triangulateShape:function(t,e){var n=[],r=[],i=[];Ki(t),to(n,t);var o=t.length;e.forEach(Ki);for(var s=0;s<e.length;s++)r.push(o),o+=e[s].length,to(n,e[s]);var a=function(t,e,n){n=n||2;var r,i,o,s,a,l,u,c=e&&e.length,h=c?e[0]*n:t.length,d=Li(t,0,h,n,!0),p=[];if(!d)return p;if(c&&(d=function(t,e,n,r){var i,o,s,a=[];for(i=0,o=e.length;i<o;i++)(s=Li(t,e[i]*r,i<o-1?e[i+1]*r:t.length,r,!1))===s.next&&(s.steiner=!0),a.push(Vi(s));for(a.sort(zi),i=0;i<a.length;i++)Fi(a[i],n),n=Ii(n,n.next);return n}(t,e,d,n)),t.length>80*n){r=o=t[0],i=s=t[1];for(var f=n;f<h;f+=n)l=t[f+1],(a=t[f])<r&&(r=a),l<i&&(i=l),a>o&&(o=a),l>s&&(s=l);u=0!==(u=Math.max(o-r,s-i))?1/u:0}return Ni(d,p,n,r,i,u),p}(n,r);for(s=0;s<a.length;s+=3)i.push(a.slice(s,s+3));return i}};function Ki(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function to(t,e){for(var n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}function eo(t,e){dn.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new no(t,e)),this.mergeVertices()}function no(t,e){void 0!==t&&(Tn.call(this),this.type="ExtrudeBufferGeometry",t=Array.isArray(t)?t:[t],this.addShapeList(t,e),this.computeVertexNormals())}function ro(t,e){dn.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new io(t,e)),this.mergeVertices()}function io(t,e){var n=(e=e||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new dn;var r=n.generateShapes(t,e.size,e.curveSegments);e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),no.call(this,r,e),this.type="TextBufferGeometry"}function oo(t,e,n,r,i,o,s){dn.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new so(t,e,n,r,i,o,s)),this.mergeVertices()}function so(t,e,n,r,i,o,s){Tn.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:s},t=t||1,e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6),r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI;var a,l,u=(o=void 0!==o?o:0)+(s=void 0!==s?s:Math.PI),c=0,h=[],d=new Fe,p=new Fe,f=[],m=[],g=[],v=[];for(l=0;l<=n;l++){var y=[],w=l/n;for(a=0;a<=e;a++){var b=a/e;d.x=-t*Math.cos(r+b*i)*Math.sin(o+w*s),d.y=t*Math.cos(o+w*s),d.z=t*Math.sin(r+b*i)*Math.sin(o+w*s),m.push(d.x,d.y,d.z),p.set(d.x,d.y,d.z).normalize(),g.push(p.x,p.y,p.z),v.push(b,1-w),y.push(c++)}h.push(y)}for(l=0;l<n;l++)for(a=0;a<e;a++){var x=h[l][a],_=h[l+1][a],E=h[l+1][a+1];(0!==l||o>0)&&f.push(h[l][a+1],x,E),(l!==n-1||u<Math.PI)&&f.push(x,_,E)}this.setIndex(f),this.addAttribute("position",new xn(m,3)),this.addAttribute("normal",new xn(g,3)),this.addAttribute("uv",new xn(v,2))}function ao(t,e,n,r,i,o){dn.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},this.fromBufferGeometry(new lo(t,e,n,r,i,o)),this.mergeVertices()}function lo(t,e,n,r,i,o){Tn.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},t=t||.5,e=e||1,i=void 0!==i?i:0,o=void 0!==o?o:2*Math.PI,n=void 0!==n?Math.max(3,n):8;var s,a,l,u=[],c=[],h=[],d=[],p=t,f=(e-t)/(r=void 0!==r?Math.max(1,r):1),m=new Fe,g=new Be;for(a=0;a<=r;a++){for(l=0;l<=n;l++)s=i+l/n*o,m.x=p*Math.cos(s),m.y=p*Math.sin(s),c.push(m.x,m.y,m.z),h.push(0,0,1),g.x=(m.x/e+1)/2,g.y=(m.y/e+1)/2,d.push(g.x,g.y);p+=f}for(a=0;a<r;a++){var v=a*(n+1);for(l=0;l<n;l++){var y=(s=l+v)+n+1,w=s+n+2,b=s+1;u.push(s,y,b),u.push(y,w,b)}}this.setIndex(u),this.addAttribute("position",new xn(c,3)),this.addAttribute("normal",new xn(h,3)),this.addAttribute("uv",new xn(d,2))}function uo(t,e,n,r){dn.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},this.fromBufferGeometry(new co(t,e,n,r)),this.mergeVertices()}function co(t,e,n,r){Tn.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},e=Math.floor(e)||12,n=n||0,r=r||2*Math.PI,r=De.clamp(r,0,2*Math.PI);var i,o,s,a=[],l=[],u=[],c=1/e,h=new Fe,d=new Be;for(o=0;o<=e;o++){var p=n+o*c*r,f=Math.sin(p),m=Math.cos(p);for(s=0;s<=t.length-1;s++)h.x=t[s].x*f,h.y=t[s].y,h.z=t[s].x*m,l.push(h.x,h.y,h.z),d.x=o/e,d.y=s/(t.length-1),u.push(d.x,d.y)}for(o=0;o<e;o++)for(s=0;s<t.length-1;s++){var g=(i=s+o*t.length)+t.length,v=i+t.length+1,y=i+1;a.push(i,g,y),a.push(g,v,y)}if(this.setIndex(a),this.addAttribute("position",new xn(l,3)),this.addAttribute("uv",new xn(u,2)),this.computeVertexNormals(),r===2*Math.PI){var w=this.attributes.normal.array,b=new Fe,x=new Fe,_=new Fe;for(i=e*t.length*3,o=0,s=0;o<t.length;o++,s+=3)b.x=w[s+0],b.y=w[s+1],b.z=w[s+2],x.x=w[i+s+0],x.y=w[i+s+1],x.z=w[i+s+2],_.addVectors(b,x).normalize(),w[s+0]=w[i+s+0]=_.x,w[s+1]=w[i+s+1]=_.y,w[s+2]=w[i+s+2]=_.z}}function ho(t,e){dn.call(this),this.type="ShapeGeometry","object"==typeof e&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new po(t,e)),this.mergeVertices()}function po(t,e){Tn.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;var n=[],r=[],i=[],o=[],s=0,a=0;if(!1===Array.isArray(t))u(t);else for(var l=0;l<t.length;l++)u(t[l]),this.addGroup(s,a,l),s+=a,a=0;function u(t){var s,l,u,c=r.length/3,h=t.extractPoints(e),d=h.shape,p=h.holes;if(!1===Ji.isClockWise(d))for(d=d.reverse(),s=0,l=p.length;s<l;s++)!0===Ji.isClockWise(u=p[s])&&(p[s]=u.reverse());var f=Ji.triangulateShape(d,p);for(s=0,l=p.length;s<l;s++)d=d.concat(u=p[s]);for(s=0,l=d.length;s<l;s++){var m=d[s];r.push(m.x,m.y,0),i.push(0,0,1),o.push(m.x,m.y)}for(s=0,l=f.length;s<l;s++){var g=f[s];n.push(g[0]+c,g[1]+c,g[2]+c),a+=3}}this.setIndex(n),this.addAttribute("position",new xn(r,3)),this.addAttribute("normal",new xn(i,3)),this.addAttribute("uv",new xn(o,2))}function fo(t,e){if(e.shapes=[],Array.isArray(t))for(var n=0,r=t.length;n<r;n++)e.shapes.push(t[n].uuid);else e.shapes.push(t.uuid);return e}function mo(t,e){Tn.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e},e=void 0!==e?e:1;var n,r,i,o,s=[],a=Math.cos(De.DEG2RAD*e),l=[0,0],u={},c=["a","b","c"];t.isBufferGeometry?(o=new dn).fromBufferGeometry(t):o=t.clone(),o.mergeVertices(),o.computeFaceNormals();for(var h=o.vertices,d=o.faces,p=0,f=d.length;p<f;p++)for(var m=d[p],g=0;g<3;g++)n=m[c[g]],r=m[c[(g+1)%3]],l[0]=Math.min(n,r),l[1]=Math.max(n,r),void 0===u[i=l[0]+","+l[1]]?u[i]={index1:l[0],index2:l[1],face1:p,face2:void 0}:u[i].face2=p;for(i in u){var v=u[i];if(void 0===v.face2||d[v.face1].normal.dot(d[v.face2].normal)<=a){var y=h[v.index1];s.push(y.x,y.y,y.z),s.push((y=h[v.index2]).x,y.y,y.z)}}this.addAttribute("position",new xn(s,3))}function go(t,e,n,r,i,o,s,a){dn.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:s,thetaLength:a},this.fromBufferGeometry(new vo(t,e,n,r,i,o,s,a)),this.mergeVertices()}function vo(t,e,n,r,i,o,s,a){Tn.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:s,thetaLength:a};var l=this;t=void 0!==t?t:1,e=void 0!==e?e:1,n=n||1,r=Math.floor(r)||8,i=Math.floor(i)||1,o=void 0!==o&&o,s=void 0!==s?s:0,a=void 0!==a?a:2*Math.PI;var u=[],c=[],h=[],d=[],p=0,f=[],m=n/2,g=0;function v(n){var i,o,f,v=new Be,y=new Fe,w=0,b=!0===n?t:e,x=!0===n?1:-1;for(o=p,i=1;i<=r;i++)c.push(0,m*x,0),h.push(0,x,0),d.push(.5,.5),p++;for(f=p,i=0;i<=r;i++){var _=i/r*a+s,E=Math.cos(_),S=Math.sin(_);y.x=b*S,y.y=m*x,y.z=b*E,c.push(y.x,y.y,y.z),h.push(0,x,0),v.x=.5*E+.5,v.y=.5*S*x+.5,d.push(v.x,v.y),p++}for(i=0;i<r;i++){var M=o+i,T=f+i;!0===n?u.push(T,T+1,M):u.push(T+1,T,M),w+=3}l.addGroup(g,w,!0===n?1:2),g+=w}!function(){var o,v,y=new Fe,w=new Fe,b=0,x=(e-t)/n;for(v=0;v<=i;v++){var _=[],E=v/i,S=E*(e-t)+t;for(o=0;o<=r;o++){var M=o/r,T=M*a+s,C=Math.sin(T),A=Math.cos(T);w.x=S*C,w.y=-E*n+m,w.z=S*A,c.push(w.x,w.y,w.z),y.set(C,x,A).normalize(),h.push(y.x,y.y,y.z),d.push(M,1-E),_.push(p++)}f.push(_)}for(o=0;o<r;o++)for(v=0;v<i;v++){var R=f[v+1][o],P=f[v+1][o+1],L=f[v][o+1];u.push(f[v][o],R,L),u.push(R,P,L),b+=6}l.addGroup(g,b,0),g+=b}(),!1===o&&(t>0&&v(!0),e>0&&v(!1)),this.setIndex(u),this.addAttribute("position",new xn(c,3)),this.addAttribute("normal",new xn(h,3)),this.addAttribute("uv",new xn(d,2))}function yo(t,e,n,r,i,o,s){go.call(this,0,t,e,n,r,i,o,s),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:s}}function wo(t,e,n,r,i,o,s){vo.call(this,0,t,e,n,r,i,o,s),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:s}}function bo(t,e,n,r){dn.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new xo(t,e,n,r)),this.mergeVertices()}function xo(t,e,n,r){Tn.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},t=t||1,e=void 0!==e?Math.max(3,e):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var i,o,s=[],a=[],l=[],u=[],c=new Fe,h=new Be;for(a.push(0,0,0),l.push(0,0,1),u.push(.5,.5),o=0,i=3;o<=e;o++,i+=3){var d=n+o/e*r;c.x=t*Math.cos(d),c.y=t*Math.sin(d),a.push(c.x,c.y,c.z),l.push(0,0,1),h.x=(a[i]/t+1)/2,h.y=(a[i+1]/t+1)/2,u.push(h.x,h.y)}for(i=1;i<=e;i++)s.push(i,i+1,0);this.setIndex(s),this.addAttribute("position",new xn(a,3)),this.addAttribute("normal",new xn(l,3)),this.addAttribute("uv",new xn(u,2))}(eo.prototype=Object.create(dn.prototype)).constructor=eo,(no.prototype=Object.create(Tn.prototype)).constructor=no,no.prototype.getArrays=function(){var t=this.getAttribute("position"),e=t?Array.prototype.slice.call(t.array):[],n=this.getAttribute("uv"),r=n?Array.prototype.slice.call(n.array):[],i=this.index;return{position:e,uv:r,index:i?Array.prototype.slice.call(i.array):[]}},no.prototype.addShapeList=function(t,e){var n=t.length;e.arrays=this.getArrays();for(var r=0;r<n;r++)this.addShape(t[r],e);this.setIndex(e.arrays.index),this.addAttribute("position",new xn(e.arrays.position,3)),this.addAttribute("uv",new xn(e.arrays.uv,2))},no.prototype.addShape=function(t,e){var n,r,i,o,s,a,l,u,c=e.arrays?e.arrays:this.getArrays(),h=c.position,d=c.index,p=c.uv,f=[],m=void 0!==e.amount?e.amount:100,g=void 0!==e.bevelThickness?e.bevelThickness:6,v=void 0!==e.bevelSize?e.bevelSize:g-2,y=void 0!==e.bevelSegments?e.bevelSegments:3,w=void 0===e.bevelEnabled||e.bevelEnabled,b=void 0!==e.curveSegments?e.curveSegments:12,x=void 0!==e.steps?e.steps:1,_=e.extrudePath,E=!1,S=void 0!==e.UVGenerator?e.UVGenerator:eo.WorldUVGenerator;_&&(n=_.getSpacedPoints(x),E=!0,w=!1,r=void 0!==e.frames?e.frames:_.computeFrenetFrames(x,!1),i=new Fe,o=new Fe,s=new Fe),w||(y=0,g=0,v=0);var M=this,T=t.extractPoints(b),C=T.shape,A=T.holes;if(!Ji.isClockWise(C))for(C=C.reverse(),l=0,u=A.length;l<u;l++)Ji.isClockWise(a=A[l])&&(A[l]=a.reverse());var R=Ji.triangulateShape(C,A),P=C;for(l=0,u=A.length;l<u;l++)C=C.concat(a=A[l]);function L(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}var I,N,O,D,B,U,z=C.length,F=R.length;function k(t,e,n){var r,i,o,s=t.x-e.x,a=t.y-e.y,l=n.x-t.x,u=n.y-t.y,c=s*s+a*a;if(Math.abs(s*u-a*l)>Number.EPSILON){var h=Math.sqrt(c),d=Math.sqrt(l*l+u*u),p=e.x-a/h,f=e.y+s/h,m=((n.x-u/d-p)*u-(n.y+l/d-f)*l)/(s*u-a*l),g=(r=p+s*m-t.x)*r+(i=f+a*m-t.y)*i;if(g<=2)return new Be(r,i);o=Math.sqrt(g/2)}else{var v=!1;s>Number.EPSILON?l>Number.EPSILON&&(v=!0):s<-Number.EPSILON?l<-Number.EPSILON&&(v=!0):Math.sign(a)===Math.sign(u)&&(v=!0),v?(r=-a,i=s,o=Math.sqrt(c)):(r=s,i=a,o=Math.sqrt(c/2))}return new Be(r/o,i/o)}for(var V=[],G=0,j=P.length,H=j-1,W=G+1;G<j;G++,H++,W++)H===j&&(H=0),W===j&&(W=0),V[G]=k(P[G],P[H],P[W]);var q,X,Y=[],Z=V.concat();for(l=0,u=A.length;l<u;l++){for(q=[],H=(j=(a=A[l]).length)-1,W=1+(G=0);G<j;G++,H++,W++)H===j&&(H=0),W===j&&(W=0),q[G]=k(a[G],a[H],a[W]);Y.push(q),Z=Z.concat(q)}for(I=0;I<y;I++){for(O=I/y,D=g*Math.cos(O*Math.PI/2),N=v*Math.sin(O*Math.PI/2),G=0,j=P.length;G<j;G++)Q((B=L(P[G],V[G],N)).x,B.y,-D);for(l=0,u=A.length;l<u;l++)for(q=Y[l],G=0,j=(a=A[l]).length;G<j;G++)Q((B=L(a[G],q[G],N)).x,B.y,-D)}for(N=v,G=0;G<z;G++)B=w?L(C[G],Z[G],N):C[G],E?(o.copy(r.normals[0]).multiplyScalar(B.x),i.copy(r.binormals[0]).multiplyScalar(B.y),s.copy(n[0]).add(o).add(i),Q(s.x,s.y,s.z)):Q(B.x,B.y,0);for(X=1;X<=x;X++)for(G=0;G<z;G++)B=w?L(C[G],Z[G],N):C[G],E?(o.copy(r.normals[X]).multiplyScalar(B.x),i.copy(r.binormals[X]).multiplyScalar(B.y),s.copy(n[X]).add(o).add(i),Q(s.x,s.y,s.z)):Q(B.x,B.y,m/x*X);for(I=y-1;I>=0;I--){for(O=I/y,D=g*Math.cos(O*Math.PI/2),N=v*Math.sin(O*Math.PI/2),G=0,j=P.length;G<j;G++)Q((B=L(P[G],V[G],N)).x,B.y,m+D);for(l=0,u=A.length;l<u;l++)for(q=Y[l],G=0,j=(a=A[l]).length;G<j;G++)B=L(a[G],q[G],N),E?Q(B.x,B.y+n[x-1].y,n[x-1].x+D):Q(B.x,B.y,m+D)}function $(t,e){var n,r;for(G=t.length;--G>=0;){n=G,(r=G-1)<0&&(r=t.length-1);var i=0,o=x+2*y;for(i=0;i<o;i++){var s=z*i,a=z*(i+1);K(e+n+s,e+r+s,e+r+a,e+n+a)}}}function Q(t,e,n){f.push(t),f.push(e),f.push(n)}function J(t,e,n){tt(t),tt(e),tt(n);var r=h.length/3,i=S.generateTopUV(M,h,r-3,r-2,r-1);et(i[0]),et(i[1]),et(i[2])}function K(t,e,n,r){tt(t),tt(e),tt(r),tt(e),tt(n),tt(r);var i=h.length/3,o=S.generateSideWallUV(M,h,i-6,i-3,i-2,i-1);et(o[0]),et(o[1]),et(o[3]),et(o[1]),et(o[2]),et(o[3])}function tt(t){d.push(h.length/3),h.push(f[3*t+0]),h.push(f[3*t+1]),h.push(f[3*t+2])}function et(t){p.push(t.x),p.push(t.y)}!function(){var t=h.length/3;if(w){var e=0,n=z*e;for(G=0;G<F;G++)J((U=R[G])[2]+n,U[1]+n,U[0]+n);for(n=z*(e=x+2*y),G=0;G<F;G++)J((U=R[G])[0]+n,U[1]+n,U[2]+n)}else{for(G=0;G<F;G++)J((U=R[G])[2],U[1],U[0]);for(G=0;G<F;G++)J((U=R[G])[0]+z*x,U[1]+z*x,U[2]+z*x)}M.addGroup(t,h.length/3-t,0)}(),function(){var t=h.length/3,e=0;for($(P,e),e+=P.length,l=0,u=A.length;l<u;l++)$(a=A[l],e),e+=a.length;M.addGroup(t,h.length/3-t,1)}(),e.arrays||(this.setIndex(d),this.addAttribute("position",new xn(h,3)),this.addAttribute("uv",new xn(p,2)))},eo.WorldUVGenerator={generateTopUV:function(t,e,n,r,i){var o=e[3*r],s=e[3*r+1],a=e[3*i],l=e[3*i+1];return[new Be(e[3*n],e[3*n+1]),new Be(o,s),new Be(a,l)]},generateSideWallUV:function(t,e,n,r,i,o){var s=e[3*n],a=e[3*n+1],l=e[3*n+2],u=e[3*r],c=e[3*r+1],h=e[3*r+2],d=e[3*i],p=e[3*i+1],f=e[3*i+2],m=e[3*o],g=e[3*o+1],v=e[3*o+2];return Math.abs(a-c)<.01?[new Be(s,1-l),new Be(u,1-h),new Be(d,1-f),new Be(m,1-v)]:[new Be(a,1-l),new Be(c,1-h),new Be(p,1-f),new Be(g,1-v)]}},(ro.prototype=Object.create(dn.prototype)).constructor=ro,(io.prototype=Object.create(no.prototype)).constructor=io,(oo.prototype=Object.create(dn.prototype)).constructor=oo,(so.prototype=Object.create(Tn.prototype)).constructor=so,(ao.prototype=Object.create(dn.prototype)).constructor=ao,(lo.prototype=Object.create(Tn.prototype)).constructor=lo,(uo.prototype=Object.create(dn.prototype)).constructor=uo,(co.prototype=Object.create(Tn.prototype)).constructor=co,(ho.prototype=Object.create(dn.prototype)).constructor=ho,ho.prototype.toJSON=function(){var t=dn.prototype.toJSON.call(this);return fo(this.parameters.shapes,t)},(po.prototype=Object.create(Tn.prototype)).constructor=po,po.prototype.toJSON=function(){var t=Tn.prototype.toJSON.call(this);return fo(this.parameters.shapes,t)},(mo.prototype=Object.create(Tn.prototype)).constructor=mo,(go.prototype=Object.create(dn.prototype)).constructor=go,(vo.prototype=Object.create(Tn.prototype)).constructor=vo,(yo.prototype=Object.create(go.prototype)).constructor=yo,(wo.prototype=Object.create(vo.prototype)).constructor=wo,(bo.prototype=Object.create(dn.prototype)).constructor=bo,(xo.prototype=Object.create(Tn.prototype)).constructor=xo;var _o=Object.freeze({WireframeGeometry:di,ParametricGeometry:pi,ParametricBufferGeometry:fi,TetrahedronGeometry:vi,TetrahedronBufferGeometry:yi,OctahedronGeometry:wi,OctahedronBufferGeometry:bi,IcosahedronGeometry:xi,IcosahedronBufferGeometry:_i,DodecahedronGeometry:Ei,DodecahedronBufferGeometry:Si,PolyhedronGeometry:mi,PolyhedronBufferGeometry:gi,TubeGeometry:Mi,TubeBufferGeometry:Ti,TorusKnotGeometry:Ci,TorusKnotBufferGeometry:Ai,TorusGeometry:Ri,TorusBufferGeometry:Pi,TextGeometry:ro,TextBufferGeometry:io,SphereGeometry:oo,SphereBufferGeometry:so,RingGeometry:ao,RingBufferGeometry:lo,PlaneGeometry:Rn,PlaneBufferGeometry:Pn,LatheGeometry:uo,LatheBufferGeometry:co,ShapeGeometry:ho,ShapeBufferGeometry:po,ExtrudeGeometry:eo,ExtrudeBufferGeometry:no,EdgesGeometry:mo,ConeGeometry:yo,ConeBufferGeometry:wo,CylinderGeometry:go,CylinderBufferGeometry:vo,CircleGeometry:bo,CircleBufferGeometry:xo,BoxGeometry:Cn,BoxBufferGeometry:An});function Eo(t){In.call(this),this.type="ShadowMaterial",this.color=new tn(0),this.transparent=!0,this.setValues(t)}function So(t){On.call(this,t),this.type="RawShaderMaterial"}function Mo(t){In.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new tn(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new tn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function To(t){Mo.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(t)}function Co(t){In.call(this),this.type="MeshPhongMaterial",this.color=new tn(16777215),this.specular=new tn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new tn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=K,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Ao(t){Co.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(t)}function Ro(t){In.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Po(t){In.call(this),this.type="MeshLambertMaterial",this.color=new tn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new tn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=K,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Lo(t){ni.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}(Eo.prototype=Object.create(In.prototype)).constructor=Eo,Eo.prototype.isShadowMaterial=!0,Eo.prototype.copy=function(t){return In.prototype.copy.call(this,t),this.color.copy(t.color),this},(So.prototype=Object.create(On.prototype)).constructor=So,So.prototype.isRawShaderMaterial=!0,(Mo.prototype=Object.create(In.prototype)).constructor=Mo,Mo.prototype.isMeshStandardMaterial=!0,Mo.prototype.copy=function(t){return In.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(To.prototype=Object.create(Mo.prototype)).constructor=To,To.prototype.isMeshPhysicalMaterial=!0,To.prototype.copy=function(t){return Mo.prototype.copy.call(this,t),this.defines={PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearCoat=t.clearCoat,this.clearCoatRoughness=t.clearCoatRoughness,this},(Co.prototype=Object.create(In.prototype)).constructor=Co,Co.prototype.isMeshPhongMaterial=!0,Co.prototype.copy=function(t){return In.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(Ao.prototype=Object.create(Co.prototype)).constructor=Ao,Ao.prototype.isMeshToonMaterial=!0,Ao.prototype.copy=function(t){return Co.prototype.copy.call(this,t),this.gradientMap=t.gradientMap,this},(Ro.prototype=Object.create(In.prototype)).constructor=Ro,Ro.prototype.isMeshNormalMaterial=!0,Ro.prototype.copy=function(t){return In.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(Po.prototype=Object.create(In.prototype)).constructor=Po,Po.prototype.isMeshLambertMaterial=!0,Po.prototype.copy=function(t){return In.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(Lo.prototype=Object.create(ni.prototype)).constructor=Lo,Lo.prototype.isLineDashedMaterial=!0,Lo.prototype.copy=function(t){return ni.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var Io=Object.freeze({ShadowMaterial:Eo,SpriteMaterial:$r,RawShaderMaterial:So,ShaderMaterial:On,PointsMaterial:si,MeshPhysicalMaterial:To,MeshStandardMaterial:Mo,MeshPhongMaterial:Co,MeshToonMaterial:Ao,MeshNormalMaterial:Ro,MeshLambertMaterial:Po,MeshDepthMaterial:zr,MeshDistanceMaterial:Fr,MeshBasicMaterial:Nn,LineDashedMaterial:Lo,LineBasicMaterial:ni,Material:In}),No={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function Oo(t,e,n){var r=this,i=!1,o=0,s=0,a=void 0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){s++,!1===i&&void 0!==r.onStart&&r.onStart(t,o,s),i=!0},this.itemEnd=function(t){o++,void 0!==r.onProgress&&r.onProgress(t,o,s),o===s&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)},this.resolveURL=function(t){return a?a(t):t},this.setURLModifier=function(t){return a=t,this}}var Do=new Oo,Bo={};function Uo(t){this.manager=void 0!==t?t:Do}function zo(t){this.manager=void 0!==t?t:Do,this._parser=null}function Fo(t){this.manager=void 0!==t?t:Do,this._parser=null}function ko(t){this.manager=void 0!==t?t:Do}function Vo(t){this.manager=void 0!==t?t:Do}function Go(t){this.manager=void 0!==t?t:Do}function jo(){this.type="Curve",this.arcLengthDivisions=200}function Ho(t,e,n,r,i,o,s,a){jo.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=s||!1,this.aRotation=a||0}function Wo(t,e,n,r,i,o){Ho.call(this,t,e,n,n,r,i,o),this.type="ArcCurve"}function qo(){var t=0,e=0,n=0,r=0;function i(i,o,s,a){t=i,e=s,n=-3*i+3*o-2*s-a,r=2*i-2*o+s+a}return{initCatmullRom:function(t,e,n,r,o){i(e,n,o*(n-t),o*(r-e))},initNonuniformCatmullRom:function(t,e,n,r,o,s,a){var l=(e-t)/o-(n-t)/(o+s)+(n-e)/s,u=(n-e)/s-(r-e)/(s+a)+(r-n)/a;i(e,n,l*=s,u*=s)},calc:function(i){var o=i*i;return t+e*i+n*o+r*(o*i)}}}Object.assign(Uo.prototype,{load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=No.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout(function(){e&&e(o),i.manager.itemEnd(t)},0),o;if(void 0===Bo[t]){var s=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(s){var a=s[1],l=!!s[2],u=s[3];u=window.decodeURIComponent(u),l&&(u=window.atob(u));try{var c,h=(this.responseType||"").toLowerCase();switch(h){case"arraybuffer":case"blob":for(var d=new Uint8Array(u.length),p=0;p<u.length;p++)d[p]=u.charCodeAt(p);c="blob"===h?new Blob([d.buffer],{type:a}):d.buffer;break;case"document":var f=new DOMParser;c=f.parseFromString(u,a);break;case"json":c=JSON.parse(u);break;default:c=u}window.setTimeout(function(){e&&e(c),i.manager.itemEnd(t)},0)}catch(e){window.setTimeout(function(){r&&r(e),i.manager.itemEnd(t),i.manager.itemError(t)},0)}}else{Bo[t]=[],Bo[t].push({onLoad:e,onProgress:n,onError:r});var m=new XMLHttpRequest;for(var g in m.open("GET",t,!0),m.addEventListener("load",function(e){var n=this.response;No.add(t,n);var r=Bo[t];if(delete Bo[t],200===this.status){for(var o=0,s=r.length;o<s;o++)(a=r[o]).onLoad&&a.onLoad(n);i.manager.itemEnd(t)}else if(0===this.status){for(console.warn("THREE.FileLoader: HTTP Status 0 received."),o=0,s=r.length;o<s;o++)(a=r[o]).onLoad&&a.onLoad(n);i.manager.itemEnd(t)}else{for(o=0,s=r.length;o<s;o++){var a;(a=r[o]).onError&&a.onError(e)}i.manager.itemEnd(t),i.manager.itemError(t)}},!1),m.addEventListener("progress",function(e){for(var n=Bo[t],r=0,i=n.length;r<i;r++){var o=n[r];o.onProgress&&o.onProgress(e)}},!1),m.addEventListener("error",function(e){var n=Bo[t];delete Bo[t];for(var r=0,o=n.length;r<o;r++){var s=n[r];s.onError&&s.onError(e)}i.manager.itemEnd(t),i.manager.itemError(t)},!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(g,this.requestHeader[g]);m.send(null)}return i.manager.itemStart(t),m}Bo[t].push({onLoad:e,onProgress:n,onError:r})},setPath:function(t){return this.path=t,this},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}}),Object.assign(zo.prototype,{load:function(t,e,n,r){var i=this,o=[],s=new ci;s.image=o;var a=new Uo(this.manager);function l(l){a.load(t[l],function(t){var n=i._parser(t,!0);o[l]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(u+=1)&&(1===n.mipmapCount&&(s.minFilter=xt),s.format=n.format,s.needsUpdate=!0,e&&e(s))},n,r)}if(a.setPath(this.path),a.setResponseType("arraybuffer"),Array.isArray(t))for(var u=0,c=0,h=t.length;c<h;++c)l(c);else a.load(t,function(t){var n=i._parser(t,!0);if(n.isCubemap)for(var r=n.mipmaps.length/n.mipmapCount,a=0;a<r;a++){o[a]={mipmaps:[]};for(var l=0;l<n.mipmapCount;l++)o[a].mipmaps.push(n.mipmaps[a*n.mipmapCount+l]),o[a].format=n.format,o[a].width=n.width,o[a].height=n.height}else s.image.width=n.width,s.image.height=n.height,s.mipmaps=n.mipmaps;1===n.mipmapCount&&(s.minFilter=xt),s.format=n.format,s.needsUpdate=!0,e&&e(s)},n,r);return s},setPath:function(t){return this.path=t,this}}),Object.assign(Fo.prototype,{load:function(t,e,n,r){var i=this,o=new qe,s=new Uo(this.manager);return s.setResponseType("arraybuffer"),s.load(t,function(t){var n=i._parser(t);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:gt,o.wrapT=void 0!==n.wrapT?n.wrapT:gt,o.magFilter=void 0!==n.magFilter?n.magFilter:xt,o.minFilter=void 0!==n.minFilter?n.minFilter:Et,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps),1===n.mipmapCount&&(o.minFilter=xt),o.needsUpdate=!0,e&&e(o,n))},n,r),o}}),Object.assign(ko.prototype,{crossOrigin:"Anonymous",load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=No.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout(function(){e&&e(o),i.manager.itemEnd(t)},0),o;var s=document.createElementNS("http://www.w3.org/1999/xhtml","img");return s.addEventListener("load",function(){No.add(t,this),e&&e(this),i.manager.itemEnd(t)},!1),s.addEventListener("error",function(e){r&&r(e),i.manager.itemEnd(t),i.manager.itemError(t)},!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(s.crossOrigin=this.crossOrigin),i.manager.itemStart(t),s.src=t,s},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Vo.prototype,{crossOrigin:"Anonymous",load:function(t,e,n,r){var i=new kn,o=new ko(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var s=0;function a(n){o.load(t[n],function(t){i.images[n]=t,6==++s&&(i.needsUpdate=!0,e&&e(i))},void 0,r)}for(var l=0;l<t.length;++l)a(l);return i},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Go.prototype,{crossOrigin:"Anonymous",load:function(t,e,n,r){var i=new Ge,o=new ko(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,function(n){i.image=n;var r=t.search(/\.(jpg|jpeg)$/)>0||0===t.search(/^data\:image\/jpeg/);i.format=r?Ut:zt,i.needsUpdate=!0,void 0!==e&&e(i)},n,r),i},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(jo.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){var n=this.getUtoTmapping(t);return this.getPoint(n,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n,r=[],i=this.getPoint(0),o=0;for(r.push(0),n=1;n<=t;n++)o+=(e=this.getPoint(n/t)).distanceTo(i),r.push(o),i=e;return this.cacheArcLengths=r,r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var n,r=this.getLengths(),i=0,o=r.length;n=e||t*r[o-1];for(var s,a=0,l=o-1;a<=l;)if((s=r[i=Math.floor(a+(l-a)/2)]-n)<0)a=i+1;else{if(!(s>0)){l=i;break}l=i-1}if(r[i=l]===n)return i/(o-1);var u=r[i];return(i+(n-u)/(r[i+1]-u))/(o-1)},getTangent:function(t){var e=t-1e-4,n=t+1e-4;e<0&&(e=0),n>1&&(n=1);var r=this.getPoint(e);return this.getPoint(n).clone().sub(r).normalize()},getTangentAt:function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)},computeFrenetFrames:function(t,e){var n,r,i=new Fe,o=[],s=[],a=[],l=new Fe,u=new Ue;for(n=0;n<=t;n++)o[n]=this.getTangentAt(n/t),o[n].normalize();s[0]=new Fe,a[0]=new Fe;var c=Number.MAX_VALUE,h=Math.abs(o[0].x),d=Math.abs(o[0].y),p=Math.abs(o[0].z);for(h<=c&&(c=h,i.set(1,0,0)),d<=c&&(c=d,i.set(0,1,0)),p<=c&&i.set(0,0,1),l.crossVectors(o[0],i).normalize(),s[0].crossVectors(o[0],l),a[0].crossVectors(o[0],s[0]),n=1;n<=t;n++)s[n]=s[n-1].clone(),a[n]=a[n-1].clone(),l.crossVectors(o[n-1],o[n]),l.length()>Number.EPSILON&&(l.normalize(),r=Math.acos(De.clamp(o[n-1].dot(o[n]),-1,1)),s[n].applyMatrix4(u.makeRotationAxis(l,r))),a[n].crossVectors(o[n],s[n]);if(!0===e)for(r=Math.acos(De.clamp(s[0].dot(s[t]),-1,1)),r/=t,o[0].dot(l.crossVectors(s[0],s[t]))>0&&(r=-r),n=1;n<=t;n++)s[n].applyMatrix4(u.makeRotationAxis(o[n],r*n)),a[n].crossVectors(o[n],s[n]);return{tangents:o,normals:s,binormals:a}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),(Ho.prototype=Object.create(jo.prototype)).constructor=Ho,Ho.prototype.isEllipseCurve=!0,Ho.prototype.getPoint=function(t,e){for(var n=e||new Be,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,o=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=o?0:r),!0!==this.aClockwise||o||(i===r?i=-r:i-=r);var s=this.aStartAngle+t*i,a=this.aX+this.xRadius*Math.cos(s),l=this.aY+this.yRadius*Math.sin(s);if(0!==this.aRotation){var u=Math.cos(this.aRotation),c=Math.sin(this.aRotation),h=a-this.aX,d=l-this.aY;a=h*u-d*c+this.aX,l=h*c+d*u+this.aY}return n.set(a,l)},Ho.prototype.copy=function(t){return jo.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Ho.prototype.toJSON=function(){var t=jo.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},Ho.prototype.fromJSON=function(t){return jo.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},(Wo.prototype=Object.create(Ho.prototype)).constructor=Wo,Wo.prototype.isArcCurve=!0;var Xo=new Fe,Yo=new qo,Zo=new qo,$o=new qo;function Qo(t,e,n,r){jo.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=n||"centripetal",this.tension=r||.5}function Jo(t,e,n,r,i){var o=.5*(r-e),s=.5*(i-n),a=t*t;return(2*n-2*r+o+s)*(t*a)+(-3*n+3*r-2*o-s)*a+o*t+n}function Ko(t,e,n,r){return function(t,n){var r=1-t;return r*r*e}(t)+function(t,e){return 2*(1-t)*t*n}(t)+function(t,e){return t*t*r}(t)}function ts(t,e,n,r,i){return function(t,n){var r=1-t;return r*r*r*e}(t)+function(t,e){var r=1-t;return 3*r*r*t*n}(t)+function(t,e){return 3*(1-t)*t*t*r}(t)+function(t,e){return t*t*t*i}(t)}function es(t,e,n,r){jo.call(this),this.type="CubicBezierCurve",this.v0=t||new Be,this.v1=e||new Be,this.v2=n||new Be,this.v3=r||new Be}function ns(t,e,n,r){jo.call(this),this.type="CubicBezierCurve3",this.v0=t||new Fe,this.v1=e||new Fe,this.v2=n||new Fe,this.v3=r||new Fe}function rs(t,e){jo.call(this),this.type="LineCurve",this.v1=t||new Be,this.v2=e||new Be}function is(t,e){jo.call(this),this.type="LineCurve3",this.v1=t||new Fe,this.v2=e||new Fe}function os(t,e,n){jo.call(this),this.type="QuadraticBezierCurve",this.v0=t||new Be,this.v1=e||new Be,this.v2=n||new Be}function ss(t,e,n){jo.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new Fe,this.v1=e||new Fe,this.v2=n||new Fe}function as(t){jo.call(this),this.type="SplineCurve",this.points=t||[]}(Qo.prototype=Object.create(jo.prototype)).constructor=Qo,Qo.prototype.isCatmullRomCurve3=!0,Qo.prototype.getPoint=function(t,e){var n,r,i,o,s=e||new Fe,a=this.points,l=a.length,u=(l-(this.closed?0:1))*t,c=Math.floor(u),h=u-c;if(this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/a.length)+1)*a.length:0===h&&c===l-1&&(c=l-2,h=1),this.closed||c>0?n=a[(c-1)%l]:(Xo.subVectors(a[0],a[1]).add(a[0]),n=Xo),r=a[c%l],i=a[(c+1)%l],this.closed||c+2<l?o=a[(c+2)%l]:(Xo.subVectors(a[l-1],a[l-2]).add(a[l-1]),o=Xo),"centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25,p=Math.pow(n.distanceToSquared(r),d),f=Math.pow(r.distanceToSquared(i),d),m=Math.pow(i.distanceToSquared(o),d);f<1e-4&&(f=1),p<1e-4&&(p=f),m<1e-4&&(m=f),Yo.initNonuniformCatmullRom(n.x,r.x,i.x,o.x,p,f,m),Zo.initNonuniformCatmullRom(n.y,r.y,i.y,o.y,p,f,m),$o.initNonuniformCatmullRom(n.z,r.z,i.z,o.z,p,f,m)}else"catmullrom"===this.curveType&&(Yo.initCatmullRom(n.x,r.x,i.x,o.x,this.tension),Zo.initCatmullRom(n.y,r.y,i.y,o.y,this.tension),$o.initCatmullRom(n.z,r.z,i.z,o.z,this.tension));return s.set(Yo.calc(h),Zo.calc(h),$o.calc(h)),s},Qo.prototype.copy=function(t){jo.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++)this.points.push(t.points[e].clone());return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Qo.prototype.toJSON=function(){var t=jo.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++)t.points.push(this.points[e].toArray());return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},Qo.prototype.fromJSON=function(t){jo.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new Fe).fromArray(r))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},(es.prototype=Object.create(jo.prototype)).constructor=es,es.prototype.isCubicBezierCurve=!0,es.prototype.getPoint=function(t,e){var n=e||new Be,r=this.v0,i=this.v1,o=this.v2,s=this.v3;return n.set(ts(t,r.x,i.x,o.x,s.x),ts(t,r.y,i.y,o.y,s.y)),n},es.prototype.copy=function(t){return jo.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},es.prototype.toJSON=function(){var t=jo.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},es.prototype.fromJSON=function(t){return jo.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},(ns.prototype=Object.create(jo.prototype)).constructor=ns,ns.prototype.isCubicBezierCurve3=!0,ns.prototype.getPoint=function(t,e){var n=e||new Fe,r=this.v0,i=this.v1,o=this.v2,s=this.v3;return n.set(ts(t,r.x,i.x,o.x,s.x),ts(t,r.y,i.y,o.y,s.y),ts(t,r.z,i.z,o.z,s.z)),n},ns.prototype.copy=function(t){return jo.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},ns.prototype.toJSON=function(){var t=jo.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},ns.prototype.fromJSON=function(t){return jo.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},(rs.prototype=Object.create(jo.prototype)).constructor=rs,rs.prototype.isLineCurve=!0,rs.prototype.getPoint=function(t,e){var n=e||new Be;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},rs.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},rs.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},rs.prototype.copy=function(t){return jo.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},rs.prototype.toJSON=function(){var t=jo.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},rs.prototype.fromJSON=function(t){return jo.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(is.prototype=Object.create(jo.prototype)).constructor=is,is.prototype.isLineCurve3=!0,is.prototype.getPoint=function(t,e){var n=e||new Fe;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},is.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},is.prototype.copy=function(t){return jo.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},is.prototype.toJSON=function(){var t=jo.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},is.prototype.fromJSON=function(t){return jo.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(os.prototype=Object.create(jo.prototype)).constructor=os,os.prototype.isQuadraticBezierCurve=!0,os.prototype.getPoint=function(t,e){var n=e||new Be,r=this.v0,i=this.v1,o=this.v2;return n.set(Ko(t,r.x,i.x,o.x),Ko(t,r.y,i.y,o.y)),n},os.prototype.copy=function(t){return jo.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},os.prototype.toJSON=function(){var t=jo.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},os.prototype.fromJSON=function(t){return jo.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(ss.prototype=Object.create(jo.prototype)).constructor=ss,ss.prototype.isQuadraticBezierCurve3=!0,ss.prototype.getPoint=function(t,e){var n=e||new Fe,r=this.v0,i=this.v1,o=this.v2;return n.set(Ko(t,r.x,i.x,o.x),Ko(t,r.y,i.y,o.y),Ko(t,r.z,i.z,o.z)),n},ss.prototype.copy=function(t){return jo.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ss.prototype.toJSON=function(){var t=jo.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ss.prototype.fromJSON=function(t){return jo.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(as.prototype=Object.create(jo.prototype)).constructor=as,as.prototype.isSplineCurve=!0,as.prototype.getPoint=function(t,e){var n=e||new Be,r=this.points,i=(r.length-1)*t,o=Math.floor(i),s=i-o,a=r[0===o?o:o-1],l=r[o],u=r[o>r.length-2?r.length-1:o+1],c=r[o>r.length-3?r.length-1:o+2];return n.set(Jo(s,a.x,l.x,u.x,c.x),Jo(s,a.y,l.y,u.y,c.y)),n},as.prototype.copy=function(t){jo.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++)this.points.push(t.points[e].clone());return this},as.prototype.toJSON=function(){var t=jo.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++)t.points.push(this.points[e].toArray());return t},as.prototype.fromJSON=function(t){jo.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new Be).fromArray(r))}return this};var ls=Object.freeze({ArcCurve:Wo,CatmullRomCurve3:Qo,CubicBezierCurve:es,CubicBezierCurve3:ns,EllipseCurve:Ho,LineCurve:rs,LineCurve3:is,QuadraticBezierCurve:os,QuadraticBezierCurve3:ss,SplineCurve:as});function us(){jo.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function cs(t){us.call(this),this.type="Path",this.currentPoint=new Be,t&&this.setFromPoints(t)}function hs(t){cs.call(this,t),this.uuid=De.generateUUID(),this.type="Shape",this.holes=[]}function ds(t,e){an.call(this),this.type="Light",this.color=new tn(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function ps(t,e,n){ds.call(this,t,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(an.DefaultUp),this.updateMatrix(),this.groundColor=new tn(e)}function fs(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new Be(512,512),this.map=null,this.matrix=new Ue}function ms(){fs.call(this,new jr(50,1,.5,500))}function gs(t,e,n,r,i,o){ds.call(this,t,e),this.type="SpotLight",this.position.copy(an.DefaultUp),this.updateMatrix(),this.target=new an,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==o?o:1,this.shadow=new ms}function vs(t,e,n,r){ds.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new fs(new jr(90,1,.5,500))}function ys(){fs.call(this,new un(-5,5,5,-5,.5,500))}function ws(t,e){ds.call(this,t,e),this.type="DirectionalLight",this.position.copy(an.DefaultUp),this.updateMatrix(),this.target=new an,this.shadow=new ys}function bs(t,e){ds.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function xs(t,e,n,r){ds.call(this,t,e),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}function _s(t,e,n,r){Ns.call(this,t,e,n,r)}function Es(t,e,n){Ns.call(this,t,e,n)}function Ss(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function Ms(t,e,n,r){Ss.call(this,t,e,n,r)}function Ts(t,e,n,r){Ns.call(this,t,e,n,r)}function Cs(t,e,n,r){Ns.call(this,t,e,n,r)}function As(t,e,n,r){Ns.call(this,t,e,n,r)}function Rs(t,e,n,r){Ss.call(this,t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Ps(t,e,n,r){Ss.call(this,t,e,n,r)}function Ls(t,e,n,r){Ss.call(this,t,e,n,r)}us.prototype=Object.assign(Object.create(jo.prototype),{constructor:us,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new rs(e,t))},getPoint:function(t){for(var e=t*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=e){var i=n[r]-e,o=this.curves[r],s=o.getLength();return o.getPointAt(0===s?0:1-i/s)}r++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,n=[],r=0,i=this.curves;r<i.length;r++)for(var o=i[r],s=o.getPoints(o&&o.isEllipseCurve?2*t:o&&o.isLineCurve?1:o&&o.isSplineCurve?t*o.points.length:t),a=0;a<s.length;a++){var l=s[a];e&&e.equals(l)||(n.push(l),e=l)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(t){jo.prototype.copy.call(this,t),this.curves=[];for(var e=0,n=t.curves.length;e<n;e++)this.curves.push(t.curves[e].clone());return this.autoClose=t.autoClose,this},toJSON:function(){var t=jo.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,n=this.curves.length;e<n;e++)t.curves.push(this.curves[e].toJSON());return t},fromJSON:function(t){jo.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){var r=t.curves[e];this.curves.push((new ls[r.type]).fromJSON(r))}return this}}),cs.prototype=Object.assign(Object.create(us.prototype),{constructor:cs,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y)},moveTo:function(t,e){this.currentPoint.set(t,e)},lineTo:function(t,e){var n=new rs(this.currentPoint.clone(),new Be(t,e));this.curves.push(n),this.currentPoint.set(t,e)},quadraticCurveTo:function(t,e,n,r){var i=new os(this.currentPoint.clone(),new Be(t,e),new Be(n,r));this.curves.push(i),this.currentPoint.set(n,r)},bezierCurveTo:function(t,e,n,r,i,o){var s=new es(this.currentPoint.clone(),new Be(t,e),new Be(n,r),new Be(i,o));this.curves.push(s),this.currentPoint.set(i,o)},splineThru:function(t){var e=new as([this.currentPoint.clone()].concat(t));this.curves.push(e),this.currentPoint.copy(t[t.length-1])},arc:function(t,e,n,r,i,o){this.absarc(t+this.currentPoint.x,e+this.currentPoint.y,n,r,i,o)},absarc:function(t,e,n,r,i,o){this.absellipse(t,e,n,n,r,i,o)},ellipse:function(t,e,n,r,i,o,s,a){this.absellipse(t+this.currentPoint.x,e+this.currentPoint.y,n,r,i,o,s,a)},absellipse:function(t,e,n,r,i,o,s,a){var l=new Ho(t,e,n,r,i,o,s,a);if(this.curves.length>0){var u=l.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(l);var c=l.getPoint(1);this.currentPoint.copy(c)},copy:function(t){return us.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=us.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return us.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),hs.prototype=Object.assign(Object.create(cs.prototype),{constructor:hs,getPointsHoles:function(t){for(var e=[],n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){cs.prototype.copy.call(this,t),this.holes=[];for(var e=0,n=t.holes.length;e<n;e++)this.holes.push(t.holes[e].clone());return this},toJSON:function(){var t=cs.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,n=this.holes.length;e<n;e++)t.holes.push(this.holes[e].toJSON());return t},fromJSON:function(t){cs.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){var r=t.holes[e];this.holes.push((new cs).fromJSON(r))}return this}}),ds.prototype=Object.assign(Object.create(an.prototype),{constructor:ds,isLight:!0,copy:function(t){return an.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var e=an.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),ps.prototype=Object.assign(Object.create(ds.prototype),{constructor:ps,isHemisphereLight:!0,copy:function(t){return ds.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(fs.prototype,{copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),ms.prototype=Object.assign(Object.create(fs.prototype),{constructor:ms,isSpotLightShadow:!0,update:function(t){var e=this.camera,n=2*De.RAD2DEG*t.angle,r=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;n===e.fov&&r===e.aspect&&i===e.far||(e.fov=n,e.aspect=r,e.far=i,e.updateProjectionMatrix())}}),gs.prototype=Object.assign(Object.create(ds.prototype),{constructor:gs,isSpotLight:!0,copy:function(t){return ds.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),vs.prototype=Object.assign(Object.create(ds.prototype),{constructor:vs,isPointLight:!0,copy:function(t){return ds.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),ys.prototype=Object.assign(Object.create(fs.prototype),{constructor:ys}),ws.prototype=Object.assign(Object.create(ds.prototype),{constructor:ws,isDirectionalLight:!0,copy:function(t){return ds.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),bs.prototype=Object.assign(Object.create(ds.prototype),{constructor:bs,isAmbientLight:!0}),xs.prototype=Object.assign(Object.create(ds.prototype),{constructor:xs,isRectAreaLight:!0,copy:function(t){return ds.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){var e=ds.prototype.toJSON.call(this,t);return e.object.width=this.width,e.object.height=this.height,e}}),_s.prototype=Object.assign(Object.create(Ns.prototype),{constructor:_s,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:ge,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Es.prototype=Object.assign(Object.create(Ns.prototype),{constructor:Es,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:ge,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Object.assign(Ss.prototype,{evaluate:function(t){var e=this.parameterPositions,n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{var o;n:{r:if(!(t<r)){for(var s=n+2;;){if(void 0===r){if(t<i)break r;return this._cachedIndex=n=e.length,this.afterEnd_(n-1,t,i)}if(n===s)break;if(i=r,t<(r=e[++n]))break e}o=e.length;break n}if(t>=i)break t;var a=e[1];for(t<a&&(n=2,i=a),s=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===s)break;if(r=i,t>=(i=e[--n-1]))break e}o=n,n=0}for(;n<o;){var l=n+o>>>1;t<e[l]?o=l:n=l+1}if(r=e[n],void 0===(i=e[n-1]))return this._cachedIndex=0,this.beforeStart_(0,t,r);if(void 0===r)return this._cachedIndex=n=e.length,this.afterEnd_(n-1,i,t)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r,o=0;o!==r;++o)e[o]=n[i+o];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Ss.prototype,{beforeStart_:Ss.prototype.copySampleValue_,afterEnd_:Ss.prototype.copySampleValue_}),Ms.prototype=Object.assign(Object.create(Ss.prototype),{constructor:Ms,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=t*s,l=(n-e)/(r-e),u=a+s;a!==u;a+=4)ze.slerpFlat(i,0,o,a-s,o,a,l);return i}}),Ts.prototype=Object.assign(Object.create(Ns.prototype),{constructor:Ts,ValueTypeName:"quaternion",DefaultInterpolation:ve,InterpolantFactoryMethodLinear:function(t){return new Ms(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),Cs.prototype=Object.assign(Object.create(Ns.prototype),{constructor:Cs,ValueTypeName:"color"}),As.prototype=Object.assign(Object.create(Ns.prototype),{constructor:As,ValueTypeName:"number"}),Rs.prototype=Object.assign(Object.create(Ss.prototype),{constructor:Rs,DefaultSettings_:{endingStart:we,endingEnd:we},intervalChanged_:function(t,e,n){var r=this.parameterPositions,i=t-2,o=t+1,s=r[i],a=r[o];if(void 0===s)switch(this.getSettings_().endingStart){case be:i=t,s=2*e-n;break;case xe:s=e+r[i=r.length-2]-r[i+1];break;default:i=t,s=n}if(void 0===a)switch(this.getSettings_().endingEnd){case be:o=t,a=2*n-e;break;case xe:o=1,a=n+r[1]-r[0];break;default:o=t-1,a=e}var l=.5*(n-e),u=this.valueSize;this._weightPrev=l/(e-s),this._weightNext=l/(a-n),this._offsetPrev=i*u,this._offsetNext=o*u},interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=t*s,l=a-s,u=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(n-e)/(r-e),f=p*p,m=f*p,g=-h*m+2*h*f-h*p,v=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,w=d*m-d*f,b=0;b!==s;++b)i[b]=g*o[u+b]+v*o[l+b]+y*o[a+b]+w*o[c+b];return i}}),Ps.prototype=Object.assign(Object.create(Ss.prototype),{constructor:Ps,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=t*s,l=a-s,u=(n-e)/(r-e),c=1-u,h=0;h!==s;++h)i[h]=o[l+h]*c+o[a+h]*u;return i}}),Ls.prototype=Object.assign(Object.create(Ss.prototype),{constructor:Ls,interpolate_:function(t){return this.copySampleValue_(t-1)}});var Is={arraySlice:function(t,e,n){return Is.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,n=new Array(e),r=0;r!==e;++r)n[r]=r;return n.sort(function(e,n){return t[e]-t[n]}),n},sortedArray:function(t,e,n){for(var r=t.length,i=new t.constructor(r),o=0,s=0;s!==r;++o)for(var a=n[o]*e,l=0;l!==e;++l)i[s++]=t[a+l];return i},flattenJSON:function(t,e,n,r){for(var i=1,o=t[0];void 0!==o&&void 0===o[r];)o=t[i++];if(void 0!==o){var s=o[r];if(void 0!==s)if(Array.isArray(s))do{void 0!==(s=o[r])&&(e.push(o.time),n.push.apply(n,s)),o=t[i++]}while(void 0!==o);else if(void 0!==s.toArray)do{void 0!==(s=o[r])&&(e.push(o.time),s.toArray(n,n.length)),o=t[i++]}while(void 0!==o);else do{void 0!==(s=o[r])&&(e.push(o.time),n.push(s)),o=t[i++]}while(void 0!==o)}}};function Ns(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Is.convertArray(e,this.TimeBufferType),this.values=Is.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation),this.validate(),this.optimize()}function Os(t,e,n,r){Ns.call(this,t,e,n,r)}function Ds(t,e,n){this.name=t,this.tracks=n,this.duration=void 0!==e?e:-1,this.uuid=De.generateUUID(),this.duration<0&&this.resetDuration(),this.optimize()}function Bs(t){this.manager=void 0!==t?t:Do,this.textures={}}function Us(t){this.manager=void 0!==t?t:Do}Object.assign(Ns,{parse:function(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var e=Ns._getTrackTypeForValueTypeName(t.type);if(void 0===t.times){var n=[],r=[];Is.flattenJSON(t.keys,n,r,"value"),t.times=n,t.values=r}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)},toJSON:function(t){var e,n=t.constructor;if(void 0!==n.toJSON)e=n.toJSON(t);else{e={name:t.name,times:Is.convertArray(t.times,Array),values:Is.convertArray(t.values,Array)};var r=t.getInterpolation();r!==t.DefaultInterpolation&&(e.interpolation=r)}return e.type=t.ValueTypeName,e},_getTrackTypeForValueTypeName:function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return As;case"vector":case"vector2":case"vector3":case"vector4":return Os;case"color":return Cs;case"quaternion":return Ts;case"bool":case"boolean":return Es;case"string":return _s}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}}),Object.assign(Ns.prototype,{constructor:Ns,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:ve,InterpolantFactoryMethodDiscrete:function(t){return new Ls(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new Ps(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new Rs(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case ge:e=this.InterpolantFactoryMethodDiscrete;break;case ve:e=this.InterpolantFactoryMethodLinear;break;case ye:e=this.InterpolantFactoryMethodSmooth}if(void 0!==e)this.createInterpolant=e;else{var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrack:",n)}},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ge;case this.InterpolantFactoryMethodLinear:return ve;case this.InterpolantFactoryMethodSmooth:return ye}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]*=t;return this},trim:function(t,e){for(var n=this.times,r=n.length,i=0,o=r-1;i!==r&&n[i]<t;)++i;for(;-1!==o&&n[o]>e;)--o;if(++o,0!==i||o!==r){i>=o&&(i=(o=Math.max(o,1))-1);var s=this.getValueSize();this.times=Is.arraySlice(n,i,o),this.values=Is.arraySlice(this.values,i*s,o*s)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var o=null,s=0;s!==i;s++){var a=n[s];if("number"==typeof a&&isNaN(a)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,s,a),t=!1;break}if(null!==o&&o>a){console.error("THREE.KeyframeTrack: Out of order keys.",this,s,a,o),t=!1;break}o=a}if(void 0!==r&&Is.isTypedArray(r)){s=0;for(var l=r.length;s!==l;++s){var u=r[s];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,s,u),t=!1;break}}}return t},optimize:function(){for(var t=this.times,e=this.values,n=this.getValueSize(),r=this.getInterpolation()===ye,i=1,o=t.length-1,s=1;s<o;++s){var a=!1,l=t[s];if(l!==t[s+1]&&(1!==s||l!==l[0]))if(r)a=!0;else for(var u=s*n,c=u-n,h=u+n,d=0;d!==n;++d){var p=e[u+d];if(p!==e[c+d]||p!==e[h+d]){a=!0;break}}if(a){if(s!==i){t[i]=t[s];var f=s*n,m=i*n;for(d=0;d!==n;++d)e[m+d]=e[f+d]}++i}}if(o>0){for(t[i]=t[o],f=o*n,m=i*n,d=0;d!==n;++d)e[m+d]=e[f+d];++i}return i!==t.length&&(this.times=Is.arraySlice(t,0,i),this.values=Is.arraySlice(e,0,i*n)),this}}),Os.prototype=Object.assign(Object.create(Ns.prototype),{constructor:Os,ValueTypeName:"vector"}),Object.assign(Ds,{parse:function(t){for(var e=[],n=t.tracks,r=1/(t.fps||1),i=0,o=n.length;i!==o;++i)e.push(Ns.parse(n[i]).scale(r));return new Ds(t.name,t.duration,e)},toJSON:function(t){for(var e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e},i=0,o=n.length;i!==o;++i)e.push(Ns.toJSON(n[i]));return r},CreateFromMorphTargetSequence:function(t,e,n,r){for(var i=e.length,o=[],s=0;s<i;s++){var a=[],l=[];a.push((s+i-1)%i,s,(s+1)%i),l.push(0,1,0);var u=Is.getKeyframeOrder(a);a=Is.sortedArray(a,1,u),l=Is.sortedArray(l,1,u),r||0!==a[0]||(a.push(i),l.push(l[0])),o.push(new As(".morphTargetInfluences["+e[s].name+"]",a,l).scale(1/n))}return new Ds(t,-1,o)},findByName:function(t,e){var n=t;Array.isArray(t)||(n=t.geometry&&t.geometry.animations||t.animations);for(var r=0;r<n.length;r++)if(n[r].name===e)return n[r];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,o=0,s=t.length;o<s;o++){var a=t[o],l=a.name.match(i);if(l&&l.length>1){var u=r[h=l[1]];u||(r[h]=u=[]),u.push(a)}}var c=[];for(var h in r)c.push(Ds.CreateFromMorphTargetSequence(h,r[h],e,n));return c},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(t,e,n,r,i){if(0!==n.length){var o=[],s=[];Is.flattenJSON(n,o,s,r),0!==o.length&&i.push(new t(e,o,s))}},r=[],i=t.name||"default",o=t.length||-1,s=t.fps||30,a=t.hierarchy||[],l=0;l<a.length;l++){var u=a[l].keys;if(u&&0!==u.length)if(u[0].morphTargets){for(var c={},h=0;h<u.length;h++)if(u[h].morphTargets)for(var d=0;d<u[h].morphTargets.length;d++)c[u[h].morphTargets[d]]=-1;for(var p in c){var f=[],m=[];for(d=0;d!==u[h].morphTargets.length;++d){var g=u[h];f.push(g.time),m.push(g.morphTarget===p?1:0)}r.push(new As(".morphTargetInfluence["+p+"]",f,m))}o=c.length*(s||1)}else{var v=".bones["+e[l].name+"]";n(Os,v+".position",u,"pos",r),n(Ts,v+".quaternion",u,"rot",r),n(Os,v+".scale",u,"scl",r)}}return 0===r.length?null:new Ds(i,o,r)}}),Object.assign(Ds.prototype,{resetDuration:function(){for(var t=0,e=0,n=this.tracks.length;e!==n;++e){var r=this.tracks[e];t=Math.max(t,r.times[r.times.length-1])}this.duration=t},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}}),Object.assign(Bs.prototype,{load:function(t,e,n,r){var i=this;new Uo(i.manager).load(t,function(t){e(i.parse(JSON.parse(t)))},n,r)},setTextures:function(t){this.textures=t},parse:function(t){var e=this.textures;function n(t){return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]}var r=new Io[t.type];if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&r.specular.setHex(t.specular),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.clearCoat&&(r.clearCoat=t.clearCoat),void 0!==t.clearCoatRoughness&&(r.clearCoatRoughness=t.clearCoatRoughness),void 0!==t.uniforms&&(r.uniforms=t.uniforms),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(r.vertexColors=t.vertexColors),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.flatShading&&(r.flatShading=t.flatShading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.side&&(r.side=t.side),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(r.rotation=t.rotation),1!==t.linewidth&&(r.linewidth=t.linewidth),void 0!==t.dashSize&&(r.dashSize=t.dashSize),void 0!==t.gapSize&&(r.gapSize=t.gapSize),void 0!==t.scale&&(r.scale=t.scale),void 0!==t.polygonOffset&&(r.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(r.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(r.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(r.skinning=t.skinning),void 0!==t.morphTargets&&(r.morphTargets=t.morphTargets),void 0!==t.dithering&&(r.dithering=t.dithering),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.shading&&(r.flatShading=1===t.shading),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=n(t.map)),void 0!==t.alphaMap&&(r.alphaMap=n(t.alphaMap),r.transparent=!0),void 0!==t.bumpMap&&(r.bumpMap=n(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=n(t.normalMap)),void 0!==t.normalScale){var i=t.normalScale;!1===Array.isArray(i)&&(i=[i,i]),r.normalScale=(new Be).fromArray(i)}return void 0!==t.displacementMap&&(r.displacementMap=n(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=n(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=n(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=n(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=n(t.specularMap)),void 0!==t.envMap&&(r.envMap=n(t.envMap)),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.lightMap&&(r.lightMap=n(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=n(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(r.gradientMap=n(t.gradientMap)),r}}),Object.assign(Us.prototype,{load:function(t,e,n,r){var i=this;new Uo(i.manager).load(t,function(t){e(i.parse(JSON.parse(t)))},n,r)},parse:function(t){var e=new Tn,n=t.data.index;if(void 0!==n){var r=new zs[n.type](n.array);e.setIndex(new pn(r,1))}var i=t.data.attributes;for(var o in i){var s=i[o];r=new zs[s.type](s.array),e.addAttribute(o,new pn(r,s.itemSize,s.normalized))}var a=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==a)for(var l=0,u=a.length;l!==u;++l){var c=a[l];e.addGroup(c.start,c.count,c.materialIndex)}var h=t.data.boundingSphere;if(void 0!==h){var d=new Fe;void 0!==h.center&&d.fromArray(h.center),e.boundingSphere=new Ye(d,h.radius)}return e}});var zs={Int8Array,Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Fs(){}Fs.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=this.handlers,n=0,r=e.length;n<r;n+=2){var i=e[n+1];if(e[n].test(t))return i}return null}},Object.assign(Fs.prototype,{crossOrigin:void 0,onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(t,e,n){for(var r=[],i=0;i<t.length;++i)r[i]=this.createMaterial(t[i],e,n);return r},createMaterial:function(){var t={NoBlending:E,NormalBlending:S,AdditiveBlending:M,SubtractiveBlending:T,MultiplyBlending:C,CustomBlending:A},e=new tn,n=new Go,r=new Bs;return function(i,o,s){var a={};function l(t,e,r,i,l){var u,c=o+t,h=Fs.Handlers.get(c);null!==h?u=h.load(c):(n.setCrossOrigin(s),u=n.load(c)),void 0!==e&&(u.repeat.fromArray(e),1!==e[0]&&(u.wrapS=mt),1!==e[1]&&(u.wrapT=mt)),void 0!==r&&u.offset.fromArray(r),void 0!==i&&("repeat"===i[0]&&(u.wrapS=mt),"mirror"===i[0]&&(u.wrapS=vt),"repeat"===i[1]&&(u.wrapT=mt),"mirror"===i[1]&&(u.wrapT=vt)),void 0!==l&&(u.anisotropy=l);var d=De.generateUUID();return a[d]=u,d}var u={uuid:De.generateUUID(),type:"MeshLambertMaterial"};for(var c in i){var h=i[c];switch(c){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":u.name=h;break;case"blending":u.blending=t[h];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",c,"is no longer supported.");break;case"colorDiffuse":u.color=e.fromArray(h).getHex();break;case"colorSpecular":u.specular=e.fromArray(h).getHex();break;case"colorEmissive":u.emissive=e.fromArray(h).getHex();break;case"specularCoef":u.shininess=h;break;case"shading":"basic"===h.toLowerCase()&&(u.type="MeshBasicMaterial"),"phong"===h.toLowerCase()&&(u.type="MeshPhongMaterial"),"standard"===h.toLowerCase()&&(u.type="MeshStandardMaterial");break;case"mapDiffuse":u.map=l(h,i.mapDiffuseRepeat,i.mapDiffuseOffset,i.mapDiffuseWrap,i.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":u.emissiveMap=l(h,i.mapEmissiveRepeat,i.mapEmissiveOffset,i.mapEmissiveWrap,i.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":u.lightMap=l(h,i.mapLightRepeat,i.mapLightOffset,i.mapLightWrap,i.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":u.aoMap=l(h,i.mapAORepeat,i.mapAOOffset,i.mapAOWrap,i.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":u.bumpMap=l(h,i.mapBumpRepeat,i.mapBumpOffset,i.mapBumpWrap,i.mapBumpAnisotropy);break;case"mapBumpScale":u.bumpScale=h;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":u.normalMap=l(h,i.mapNormalRepeat,i.mapNormalOffset,i.mapNormalWrap,i.mapNormalAnisotropy);break;case"mapNormalFactor":u.normalScale=h;break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":u.specularMap=l(h,i.mapSpecularRepeat,i.mapSpecularOffset,i.mapSpecularWrap,i.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":u.metalnessMap=l(h,i.mapMetalnessRepeat,i.mapMetalnessOffset,i.mapMetalnessWrap,i.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":u.roughnessMap=l(h,i.mapRoughnessRepeat,i.mapRoughnessOffset,i.mapRoughnessWrap,i.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":u.alphaMap=l(h,i.mapAlphaRepeat,i.mapAlphaOffset,i.mapAlphaWrap,i.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":u.side=g;break;case"doubleSided":u.side=v;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),u.opacity=h;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":u[c]=h;break;case"vertexColors":!0===h&&(u.vertexColors=_),"face"===h&&(u.vertexColors=x);break;default:console.error("THREE.Loader.createMaterial: Unsupported",c,h)}}return"MeshBasicMaterial"===u.type&&delete u.emissive,"MeshPhongMaterial"!==u.type&&delete u.specular,u.opacity<1&&(u.transparent=!0),r.setTextures(a),r.parse(u)}}()});var ks={decodeText:function(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",n=0,r=t.length;n<r;n++)e+=String.fromCharCode(t[n]);return decodeURIComponent(escape(e))},extractUrlBase:function(t){var e=t.split("/");return 1===e.length?"./":(e.pop(),e.join("/")+"/")}};function Vs(t){"boolean"==typeof t&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),t=void 0),this.manager=void 0!==t?t:Do,this.withCredentials=!1}function Gs(t){this.manager=void 0!==t?t:Do,this.texturePath=""}Object.assign(Vs.prototype,{load:function(t,e,n,r){var i=this,o=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:ks.extractUrlBase(t),s=new Uo(this.manager);s.setWithCredentials(this.withCredentials),s.load(t,function(n){var r=JSON.parse(n),s=r.metadata;if(void 0!==s){var a=s.type;if(void 0!==a&&"object"===a.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.ObjectLoader instead.")}var l=i.parse(r,o);e(l.geometry,l.materials)},n,r)},setTexturePath:function(t){this.texturePath=t},parse:function(t,e){void 0!==t.data&&(t=t.data),t.scale=void 0!==t.scale?1/t.scale:1;var n=new dn;return function(t,e){function n(t,e){return t&1<<e}var r,i,o,s,a,l,u,c,h,d,p,f,m,g,v,y,w,b,x,_,E,S,M,T,C,A=t.faces,R=t.vertices,P=t.normals,L=t.colors,I=t.scale,N=0;if(void 0!==t.uvs){for(r=0;r<t.uvs.length;r++)t.uvs[r].length&&N++;for(r=0;r<N;r++)e.faceVertexUvs[r]=[]}for(s=0,a=R.length;s<a;)(b=new Fe).x=R[s++]*I,b.y=R[s++]*I,b.z=R[s++]*I,e.vertices.push(b);for(s=0,a=A.length;s<a;)if(p=n(d=A[s++],0),f=n(d,1),m=n(d,3),g=n(d,4),v=n(d,5),y=n(d,6),w=n(d,7),p){if((_=new cn).a=A[s],_.b=A[s+1],_.c=A[s+3],(E=new cn).a=A[s+1],E.b=A[s+2],E.c=A[s+3],s+=4,f&&(h=A[s++],_.materialIndex=h,E.materialIndex=h),o=e.faces.length,m)for(r=0;r<N;r++)for(T=t.uvs[r],e.faceVertexUvs[r][o]=[],e.faceVertexUvs[r][o+1]=[],i=0;i<4;i++)C=new Be(T[2*(c=A[s++])],T[2*c+1]),2!==i&&e.faceVertexUvs[r][o].push(C),0!==i&&e.faceVertexUvs[r][o+1].push(C);if(g&&(u=3*A[s++],_.normal.set(P[u++],P[u++],P[u]),E.normal.copy(_.normal)),v)for(r=0;r<4;r++)u=3*A[s++],M=new Fe(P[u++],P[u++],P[u]),2!==r&&_.vertexNormals.push(M),0!==r&&E.vertexNormals.push(M);if(y&&(l=A[s++],_.color.setHex(S=L[l]),E.color.setHex(S)),w)for(r=0;r<4;r++)S=L[l=A[s++]],2!==r&&_.vertexColors.push(new tn(S)),0!==r&&E.vertexColors.push(new tn(S));e.faces.push(_),e.faces.push(E)}else{if((x=new cn).a=A[s++],x.b=A[s++],x.c=A[s++],f&&(h=A[s++],x.materialIndex=h),o=e.faces.length,m)for(r=0;r<N;r++)for(T=t.uvs[r],e.faceVertexUvs[r][o]=[],i=0;i<3;i++)C=new Be(T[2*(c=A[s++])],T[2*c+1]),e.faceVertexUvs[r][o].push(C);if(g&&(u=3*A[s++],x.normal.set(P[u++],P[u++],P[u])),v)for(r=0;r<3;r++)u=3*A[s++],M=new Fe(P[u++],P[u++],P[u]),x.vertexNormals.push(M);if(y&&(l=A[s++],x.color.setHex(L[l])),w)for(r=0;r<3;r++)l=A[s++],x.vertexColors.push(new tn(L[l]));e.faces.push(x)}}(t,n),function(t,e){var n=void 0!==t.influencesPerVertex?t.influencesPerVertex:2;if(t.skinWeights)for(var r=0,i=t.skinWeights.length;r<i;r+=n)e.skinWeights.push(new je(t.skinWeights[r],n>1?t.skinWeights[r+1]:0,n>2?t.skinWeights[r+2]:0,n>3?t.skinWeights[r+3]:0));if(t.skinIndices)for(r=0,i=t.skinIndices.length;r<i;r+=n)e.skinIndices.push(new je(t.skinIndices[r],n>1?t.skinIndices[r+1]:0,n>2?t.skinIndices[r+2]:0,n>3?t.skinIndices[r+3]:0));e.bones=t.bones,e.bones&&e.bones.length>0&&(e.skinWeights.length!==e.skinIndices.length||e.skinIndices.length!==e.vertices.length)&&console.warn("When skinning, number of vertices ("+e.vertices.length+"), skinIndices ("+e.skinIndices.length+"), and skinWeights ("+e.skinWeights.length+") should match.")}(t,n),function(t,e){var n=t.scale;if(void 0!==t.morphTargets)for(var r=0,i=t.morphTargets.length;r<i;r++){e.morphTargets[r]={},e.morphTargets[r].name=t.morphTargets[r].name,e.morphTargets[r].vertices=[];for(var o=e.morphTargets[r].vertices,s=t.morphTargets[r].vertices,a=0,l=s.length;a<l;a+=3){var u=new Fe;u.x=s[a]*n,u.y=s[a+1]*n,u.z=s[a+2]*n,o.push(u)}}if(void 0!==t.morphColors&&t.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');var c=e.faces,h=t.morphColors[0].colors;for(r=0,i=c.length;r<i;r++)c[r].color.fromArray(h,3*r)}}(t,n),function(t,e){var n=[],r=[];void 0!==t.animation&&r.push(t.animation),void 0!==t.animations&&(t.animations.length?r=r.concat(t.animations):r.push(t.animations));for(var i=0;i<r.length;i++){var o=Ds.parseAnimation(r[i],e.bones);o&&n.push(o)}if(e.morphTargets){var s=Ds.CreateClipsFromMorphTargetSequences(e.morphTargets,10);n=n.concat(s)}n.length>0&&(e.animations=n)}(t,n),n.computeFaceNormals(),n.computeBoundingSphere(),void 0===t.materials||0===t.materials.length?{geometry:n}:{geometry:n,materials:Fs.prototype.initMaterials(t.materials,e,this.crossOrigin)}}}),Object.assign(Gs.prototype,{load:function(t,e,n,r){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var i=this;new Uo(i.manager).load(t,function(n){var o=null;try{o=JSON.parse(n)}catch(e){return void 0!==r&&r(e),void console.error("THREE:ObjectLoader: Can't parse "+t+".",e.message)}var s=o.metadata;void 0!==s&&void 0!==s.type&&"geometry"!==s.type.toLowerCase()?i.parse(o,e):console.error("THREE.ObjectLoader: Can't load "+t+". Use THREE.JSONLoader instead.")},n,r)},setTexturePath:function(t){this.texturePath=t},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){var n=this.parseShape(t.shapes),r=this.parseGeometries(t.geometries,n),i=this.parseImages(t.images,function(){void 0!==e&&e(a)}),o=this.parseTextures(t.textures,i),s=this.parseMaterials(t.materials,o),a=this.parseObject(t.object,r,s);return t.animations&&(a.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==e&&e(a),a},parseShape:function(t){var e={};if(void 0!==t)for(var n=0,r=t.length;n<r;n++){var i=(new hs).fromJSON(t[n]);e[i.uuid]=i}return e},parseGeometries:function(t,e){var n={};if(void 0!==t)for(var r=new Vs,i=new Us,o=0,s=t.length;o<s;o++){var a,l=t[o];switch(l.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new _o[l.type](l.width,l.height,l.widthSegments,l.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new _o[l.type](l.width,l.height,l.depth,l.widthSegments,l.heightSegments,l.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new _o[l.type](l.radius,l.segments,l.thetaStart,l.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new _o[l.type](l.radiusTop,l.radiusBottom,l.height,l.radialSegments,l.heightSegments,l.openEnded,l.thetaStart,l.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":a=new _o[l.type](l.radius,l.height,l.radialSegments,l.heightSegments,l.openEnded,l.thetaStart,l.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new _o[l.type](l.radius,l.widthSegments,l.heightSegments,l.phiStart,l.phiLength,l.thetaStart,l.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":a=new _o[l.type](l.radius,l.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new _o[l.type](l.innerRadius,l.outerRadius,l.thetaSegments,l.phiSegments,l.thetaStart,l.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new _o[l.type](l.radius,l.tube,l.radialSegments,l.tubularSegments,l.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new _o[l.type](l.radius,l.tube,l.tubularSegments,l.radialSegments,l.p,l.q);break;case"LatheGeometry":case"LatheBufferGeometry":a=new _o[l.type](l.points,l.segments,l.phiStart,l.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":a=new _o[l.type](l.vertices,l.indices,l.radius,l.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":var u=[];for(o=0,s=l.shapes.length;o<s;o++)u.push(e[l.shapes[o]]);a=new _o[l.type](u,l.curveSegments);break;case"BufferGeometry":a=i.parse(l);break;case"Geometry":a=r.parse(l,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+l.type+'"');continue}a.uuid=l.uuid,void 0!==l.name&&(a.name=l.name),n[l.uuid]=a}return n},parseMaterials:function(t,e){var n={};if(void 0!==t){var r=new Bs;r.setTextures(e);for(var i=0,o=t.length;i<o;i++){var s=t[i];if("MultiMaterial"===s.type){for(var a=[],l=0;l<s.materials.length;l++)a.push(r.parse(s.materials[l]));n[s.uuid]=a}else n[s.uuid]=r.parse(s)}}return n},parseAnimations:function(t){for(var e=[],n=0;n<t.length;n++){var r=Ds.parse(t[n]);e.push(r)}return e},parseImages:function(t,e){var n=this,r={};function i(t){return n.manager.itemStart(t),o.load(t,function(){n.manager.itemEnd(t)},void 0,function(){n.manager.itemEnd(t),n.manager.itemError(t)})}if(void 0!==t&&t.length>0){var o=new ko(new Oo(e));o.setCrossOrigin(this.crossOrigin);for(var s=0,a=t.length;s<a;s++){var l=t[s],u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l.url)?l.url:n.texturePath+l.url;r[l.uuid]=i(u)}}return r},parseTextures:function(t,e){function n(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var r={};if(void 0!==t)for(var i=0,o=t.length;i<o;i++){var s=t[i];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===e[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image);var a=new Ge(e[s.image]);a.needsUpdate=!0,a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),void 0!==s.mapping&&(a.mapping=n(s.mapping,Hs)),void 0!==s.offset&&a.offset.fromArray(s.offset),void 0!==s.repeat&&a.repeat.fromArray(s.repeat),void 0!==s.center&&a.center.fromArray(s.center),void 0!==s.rotation&&(a.rotation=s.rotation),void 0!==s.wrap&&(a.wrapS=n(s.wrap[0],Ws),a.wrapT=n(s.wrap[1],Ws)),void 0!==s.format&&(a.format=s.format),void 0!==s.minFilter&&(a.minFilter=n(s.minFilter,qs)),void 0!==s.magFilter&&(a.magFilter=n(s.magFilter,qs)),void 0!==s.anisotropy&&(a.anisotropy=s.anisotropy),void 0!==s.flipY&&(a.flipY=s.flipY),r[s.uuid]=a}return r},parseObject:function(t,e,n){var r;function i(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function o(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],r=0,i=t.length;r<i;r++){var o=t[r];void 0===n[o]&&console.warn("THREE.ObjectLoader: Undefined material",o),e.push(n[o])}return e}return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),n[t]}}switch(t.type){case"Scene":r=new Zr,void 0!==t.background&&Number.isInteger(t.background)&&(r.background=new tn(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?r.fog=new Yr(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(r.fog=new Xr(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":r=new jr(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(r.focus=t.focus),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.filmGauge&&(r.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(r.filmOffset=t.filmOffset),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"OrthographicCamera":r=new un(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"AmbientLight":r=new bs(t.color,t.intensity);break;case"DirectionalLight":r=new ws(t.color,t.intensity);break;case"PointLight":r=new vs(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":r=new xs(t.color,t.intensity,t.width,t.height);break;case"SpotLight":r=new gs(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":r=new ps(t.color,t.groundColor,t.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var s=i(t.geometry),a=o(t.material);r=s.bones&&s.bones.length>0?new ei(s,a):new zn(s,a);break;case"LOD":r=new Jr;break;case"Line":r=new ri(i(t.geometry),o(t.material),t.mode);break;case"LineLoop":r=new oi(i(t.geometry),o(t.material));break;case"LineSegments":r=new ii(i(t.geometry),o(t.material));break;case"PointCloud":case"Points":r=new ai(i(t.geometry),o(t.material));break;case"Sprite":r=new Qr(o(t.material));break;case"Group":r=new li;break;default:r=new an}if(r.uuid=t.uuid,void 0!==t.name&&(r.name=t.name),void 0!==t.matrix?(r.matrix.fromArray(t.matrix),r.matrix.decompose(r.position,r.quaternion,r.scale)):(void 0!==t.position&&r.position.fromArray(t.position),void 0!==t.rotation&&r.rotation.fromArray(t.rotation),void 0!==t.quaternion&&r.quaternion.fromArray(t.quaternion),void 0!==t.scale&&r.scale.fromArray(t.scale)),void 0!==t.castShadow&&(r.castShadow=t.castShadow),void 0!==t.receiveShadow&&(r.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(r.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(r.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&r.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(r.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.frustumCulled&&(r.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(r.renderOrder=t.renderOrder),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.children)for(var l=t.children,u=0;u<l.length;u++)r.add(this.parseObject(l[u],e,n));if("LOD"===t.type)for(var c=t.levels,h=0;h<c.length;h++){var d=c[h],p=r.getObjectByProperty("uuid",d.object);void 0!==p&&r.addLevel(p,d.distance)}return r}});var js,Hs={UVMapping:at,CubeReflectionMapping:lt,CubeRefractionMapping:ut,EquirectangularReflectionMapping:ct,EquirectangularRefractionMapping:ht,SphericalReflectionMapping:dt,CubeUVReflectionMapping:pt,CubeUVRefractionMapping:ft},Ws={RepeatWrapping:mt,ClampToEdgeWrapping:gt,MirroredRepeatWrapping:vt},qs={NearestFilter:yt,NearestMipMapNearestFilter:wt,NearestMipMapLinearFilter:bt,LinearFilter:xt,LinearMipMapNearestFilter:_t,LinearMipMapLinearFilter:Et};function Xs(t){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=void 0!==t?t:Do,this.options=void 0}function Ys(){this.type="ShapePath",this.subPaths=[],this.currentPath=null}function Zs(t){this.type="Font",this.data=t}function $s(t,e,n,r,i,o){var s=o.glyphs[t]||o.glyphs["?"];if(s){var a,l,u,c,h,d,p,f,m=new Ys;if(s.o)for(var g=s._cachedOutline||(s._cachedOutline=s.o.split(" ")),v=0,y=g.length;v<y;)switch(g[v++]){case"m":a=g[v++]*n+r,l=g[v++]*n+i,m.moveTo(a,l);break;case"l":a=g[v++]*n+r,l=g[v++]*n+i,m.lineTo(a,l);break;case"q":u=g[v++]*n+r,c=g[v++]*n+i,h=g[v++]*n+r,d=g[v++]*n+i,m.quadraticCurveTo(h,d,u,c);break;case"b":u=g[v++]*n+r,c=g[v++]*n+i,h=g[v++]*n+r,d=g[v++]*n+i,p=g[v++]*n+r,f=g[v++]*n+i,m.bezierCurveTo(h,d,p,f,u,c)}return{offsetX:s.ha*n,path:m}}}function Qs(t){this.manager=void 0!==t?t:Do}Xs.prototype={constructor:Xs,setOptions:function(t){return this.options=t,this},load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t);var i=this,o=No.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout(function(){e&&e(o),i.manager.itemEnd(t)},0),o;fetch(t).then(function(t){return t.blob()}).then(function(t){return createImageBitmap(t,i.options)}).then(function(n){No.add(t,n),e&&e(n),i.manager.itemEnd(t)}).catch(function(e){r&&r(e),i.manager.itemEnd(t),i.manager.itemError(t)})},setCrossOrigin:function(){return this},setPath:function(t){return this.path=t,this}},Object.assign(Ys.prototype,{moveTo:function(t,e){this.currentPath=new cs,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e)},lineTo:function(t,e){this.currentPath.lineTo(t,e)},quadraticCurveTo:function(t,e,n,r){this.currentPath.quadraticCurveTo(t,e,n,r)},bezierCurveTo:function(t,e,n,r,i,o){this.currentPath.bezierCurveTo(t,e,n,r,i,o)},splineThru:function(t){this.currentPath.splineThru(t)},toShapes:function(t,e){function n(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n],o=new hs;o.curves=i.curves,e.push(o)}return e}function r(t,e){for(var n=e.length,r=!1,i=n-1,o=0;o<n;i=o++){var s=e[i],a=e[o],l=a.x-s.x,u=a.y-s.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(s=e[o],l=-l,a=e[i],u=-u),t.y<s.y||t.y>a.y)continue;if(t.y===s.y){if(t.x===s.x)return!0}else{var c=u*(t.x-s.x)-l*(t.y-s.y);if(0===c)return!0;if(c<0)continue;r=!r}}else{if(t.y!==s.y)continue;if(a.x<=t.x&&t.x<=s.x||s.x<=t.x&&t.x<=a.x)return!0}}return r}var i=Ji.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===e)return n(o);var s,a,l,u=[];if(1===o.length)return a=o[0],(l=new hs).curves=a.curves,u.push(l),u;var c=!i(o[0].getPoints());c=t?!c:c;var h,d,p=[],f=[],m=[],g=0;f[g]=void 0,m[g]=[];for(var v=0,y=o.length;v<y;v++)s=i(h=(a=o[v]).getPoints()),(s=t?!s:s)?(!c&&f[g]&&g++,f[g]={s:new hs,p:h},f[g].s.curves=a.curves,c&&g++,m[g]=[]):m[g].push({h:a,p:h[0]});if(!f[0])return n(o);if(f.length>1){for(var w=!1,b=[],x=0,_=f.length;x<_;x++)p[x]=[];for(x=0,_=f.length;x<_;x++)for(var E=m[x],S=0;S<E.length;S++){for(var M=E[S],T=!0,C=0;C<f.length;C++)r(M.p,f[C].p)&&(x!==C&&b.push({froms:x,tos:C,hole:S}),T?(T=!1,p[C].push(M)):w=!0);T&&p[x].push(M)}b.length>0&&(w||(m=p))}v=0;for(var A=f.length;v<A;v++){u.push(l=f[v].s);for(var R=0,P=(d=m[v]).length;R<P;R++)l.holes.push(d[R].h)}return u}}),Object.assign(Zs.prototype,{isFont:!0,generateShapes:function(t,e,n){void 0===e&&(e=100),void 0===n&&(n=4);for(var r=[],i=function(t,e,n,r){for(var i=String(t).split(""),o=e/r.resolution,s=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*o,a=[],l=0,u=0,c=0;c<i.length;c++){var h=i[c];if("\n"===h)l=0,u-=s;else{var d=$s(h,0,o,l,u,r);l+=d.offsetX,a.push(d.path)}}return a}(t,e,0,this.data),o=0,s=i.length;o<s;o++)Array.prototype.push.apply(r,i[o].toShapes());return r}}),Object.assign(Qs.prototype,{load:function(t,e,n,r){var i=this,o=new Uo(this.manager);o.setPath(this.path),o.load(t,function(t){var n;try{n=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(t.substring(65,t.length-2))}var r=i.parse(n);e&&e(r)},n,r)},parse:function(t){return new Zs(t)},setPath:function(t){return this.path=t,this}});var Js,Ks,ta={getContext:function(){return void 0===js&&(js=new(window.AudioContext||window.webkitAudioContext)),js},setContext:function(t){js=t}};function ea(t){this.manager=void 0!==t?t:Do}function na(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new jr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new jr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function ra(t,e,n){an.call(this),this.type="CubeCamera";var r=new jr(90,1,t,e);r.up.set(0,-1,0),r.lookAt(new Fe(1,0,0)),this.add(r);var i=new jr(90,1,t,e);i.up.set(0,-1,0),i.lookAt(new Fe(-1,0,0)),this.add(i);var o=new jr(90,1,t,e);o.up.set(0,0,1),o.lookAt(new Fe(0,1,0)),this.add(o);var s=new jr(90,1,t,e);s.up.set(0,0,-1),s.lookAt(new Fe(0,-1,0)),this.add(s);var a=new jr(90,1,t,e);a.up.set(0,-1,0),a.lookAt(new Fe(0,0,1)),this.add(a);var l=new jr(90,1,t,e);l.up.set(0,-1,0),l.lookAt(new Fe(0,0,-1)),this.add(l),this.renderTarget=new We(n,n,{format:Ut,magFilter:xt,minFilter:xt}),this.renderTarget.texture.name="CubeCamera",this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,u=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,n.activeCubeFace=0,t.render(e,r,n),n.activeCubeFace=1,t.render(e,i,n),n.activeCubeFace=2,t.render(e,o,n),n.activeCubeFace=3,t.render(e,s,n),n.activeCubeFace=4,t.render(e,a,n),n.texture.generateMipmaps=u,n.activeCubeFace=5,t.render(e,l,n),t.setRenderTarget(null)},this.clear=function(t,e,n,r){for(var i=this.renderTarget,o=0;o<6;o++)i.activeCubeFace=o,t.setRenderTarget(i),t.clear(e,n,r);t.setRenderTarget(null)}}function ia(){an.call(this),this.type="AudioListener",this.context=ta.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function oa(t){an.call(this),this.type="Audio",this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function sa(t){oa.call(this,t),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function aa(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function la(t,e,n){this.binding=t,this.valueSize=n;var r,i=Float64Array;switch(e){case"quaternion":r=this._slerp;break;case"string":case"bool":i=Array,r=this._select;break;default:r=this._lerp}this.buffer=new i(4*n),this._mixBufferRegion=r,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function ua(t,e,n){var r=n||ca.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}function ca(t,e,n){this.path=e,this.parsedPath=n||ca.parseTrackName(e),this.node=ca.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function ha(){this.uuid=De.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,n=arguments.length;e!==n;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}function da(t,e,n){this._mixer=t,this._clip=e,this._localRoot=n||null;for(var r=e.tracks,i=r.length,o=new Array(i),s={endingStart:we,endingEnd:we},a=0;a!==i;++a){var l=r[a].createInterpolant(null);o[a]=l,l.settings=s}this._interpolantSettings=s,this._interpolants=o,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=fe,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function pa(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function fa(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}function ma(){Tn.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function ga(t,e,n,r){this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===r}function va(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function ya(t,e,n){va.call(this,t,e),this.meshPerAttribute=n||1}function wa(t,e,n){pn.call(this,t,e),this.meshPerAttribute=n||1}function ba(t,e,n,r){this.ray=new Dn(t,e),this.near=n||0,this.far=r||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function xa(t,e){return t.distance-e.distance}function _a(t,e,n,r){if(!1!==t.visible&&(t.raycast(e,n),!0===r))for(var i=t.children,o=0,s=i.length;o<s;o++)_a(i[o],e,n,!0)}function Ea(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function Sa(t,e,n){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==n?n:0,this}function Ma(t,e,n){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==n?n:0,this}function Ta(t,e){this.min=void 0!==t?t:new Be(1/0,1/0),this.max=void 0!==e?e:new Be(-1/0,-1/0)}function Ca(t){an.call(this),this.material=t,this.render=function(){}}function Aa(t,e,n,r){this.object=t,this.size=void 0!==e?e:1;var i=void 0!==n?n:16711680,o=void 0!==r?r:1,s=0,a=this.object.geometry;a&&a.isGeometry?s=3*a.faces.length:a&&a.isBufferGeometry&&(s=a.attributes.normal.count);var l=new Tn,u=new xn(2*s*3,3);l.addAttribute("position",u),ii.call(this,l,new ni({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Ra(t,e){an.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;for(var n=new Tn,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,o=1;i<32;i++,o++){var s=i/32*Math.PI*2,a=o/32*Math.PI*2;r.push(Math.cos(s),Math.sin(s),1,Math.cos(a),Math.sin(a),1)}n.addAttribute("position",new xn(r,3));var l=new ni({fog:!1});this.cone=new ii(n,l),this.add(this.cone),this.update()}function Pa(t){for(var e=function t(e){var n=[];e&&e.isBone&&n.push(e);for(var r=0;r<e.children.length;r++)n.push.apply(n,t(e.children[r]));return n}(t),n=new Tn,r=[],i=[],o=new tn(0,0,1),s=new tn(0,1,0),a=0;a<e.length;a++){var l=e[a];l.parent&&l.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(o.r,o.g,o.b),i.push(s.r,s.g,s.b))}n.addAttribute("position",new xn(r,3)),n.addAttribute("color",new xn(i,3));var u=new ni({vertexColors:_,depthTest:!1,depthWrite:!1,transparent:!0});ii.call(this,n,u),this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function La(t,e,n){this.light=t,this.light.updateMatrixWorld(),this.color=n;var r=new so(e,4,2),i=new Nn({wireframe:!0,fog:!1});zn.call(this,r,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Ia(t,e){an.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;var n=new ni({fog:!1}),r=new Tn;r.addAttribute("position",new pn(new Float32Array(15),3)),this.line=new ri(r,n),this.add(this.line),this.update()}function Na(t,e,n){an.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var r=new bi(e);r.rotateY(.5*Math.PI),this.material=new Nn({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=_);var i=r.getAttribute("position"),o=new Float32Array(3*i.count);r.addAttribute("color",new pn(o,3)),this.add(new zn(r,this.material)),this.update()}function Oa(t,e,n,r){t=t||10,e=e||10,n=new tn(void 0!==n?n:4473924),r=new tn(void 0!==r?r:8947848);for(var i=e/2,o=t/e,s=t/2,a=[],l=[],u=0,c=0,h=-s;u<=e;u++,h+=o){a.push(-s,0,h,s,0,h),a.push(h,0,-s,h,0,s);var d=u===i?n:r;d.toArray(l,c),d.toArray(l,c+=3),d.toArray(l,c+=3),d.toArray(l,c+=3),c+=3}var p=new Tn;p.addAttribute("position",new xn(a,3)),p.addAttribute("color",new xn(l,3));var f=new ni({vertexColors:_});ii.call(this,p,f)}function Da(t,e,n,r,i,o){t=t||10,e=e||16,n=n||8,r=r||64,i=new tn(void 0!==i?i:4473924),o=new tn(void 0!==o?o:8947848);var s,a,l,u,c,h,d,p=[],f=[];for(u=0;u<=e;u++)l=u/e*(2*Math.PI),s=Math.sin(l)*t,a=Math.cos(l)*t,p.push(0,0,0),p.push(s,0,a),f.push((d=1&u?i:o).r,d.g,d.b),f.push(d.r,d.g,d.b);for(u=0;u<=n;u++)for(d=1&u?i:o,h=t-t/n*u,c=0;c<r;c++)l=c/r*(2*Math.PI),s=Math.sin(l)*h,a=Math.cos(l)*h,p.push(s,0,a),f.push(d.r,d.g,d.b),l=(c+1)/r*(2*Math.PI),s=Math.sin(l)*h,a=Math.cos(l)*h,p.push(s,0,a),f.push(d.r,d.g,d.b);var m=new Tn;m.addAttribute("position",new xn(p,3)),m.addAttribute("color",new xn(f,3));var g=new ni({vertexColors:_});ii.call(this,m,g)}function Ba(t,e,n,r){this.object=t,this.size=void 0!==e?e:1;var i=void 0!==n?n:16776960,o=void 0!==r?r:1,s=0,a=this.object.geometry;a&&a.isGeometry?s=a.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var l=new Tn,u=new xn(2*s*3,3);l.addAttribute("position",u),ii.call(this,l,new ni({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Ua(t,e,n){an.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===e&&(e=1);var r=new Tn;r.addAttribute("position",new xn([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var i=new ni({fog:!1});this.lightPlane=new ri(r,i),this.add(this.lightPlane),(r=new Tn).addAttribute("position",new xn([0,0,0,0,0,1],3)),this.targetLine=new ri(r,i),this.add(this.targetLine),this.update()}function za(t){var e=new Tn,n=new ni({color:16777215,vertexColors:x}),r=[],i=[],o={},s=new tn(16755200),a=new tn(16711680),l=new tn(43775),u=new tn(16777215),c=new tn(3355443);function h(t,e,n){d(t,n),d(e,n)}function d(t,e){r.push(0,0,0),i.push(e.r,e.g,e.b),void 0===o[t]&&(o[t]=[]),o[t].push(r.length/3-1)}h("n1","n2",s),h("n2","n4",s),h("n4","n3",s),h("n3","n1",s),h("f1","f2",s),h("f2","f4",s),h("f4","f3",s),h("f3","f1",s),h("n1","f1",s),h("n2","f2",s),h("n3","f3",s),h("n4","f4",s),h("p","n1",a),h("p","n2",a),h("p","n3",a),h("p","n4",a),h("u1","u2",l),h("u2","u3",l),h("u3","u1",l),h("c","t",u),h("p","c",c),h("cn1","cn2",c),h("cn3","cn4",c),h("cf1","cf2",c),h("cf3","cf4",c),e.addAttribute("position",new xn(r,3)),e.addAttribute("color",new xn(i,3)),ii.call(this,e,n),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}function Fa(t,e){this.object=t,void 0===e&&(e=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new Tn;i.setIndex(new pn(n,1)),i.addAttribute("position",new pn(r,3)),ii.call(this,i,new ni({color:e})),this.matrixAutoUpdate=!1,this.update()}function ka(t,e){this.type="Box3Helper",this.box=t;var n=void 0!==e?e:16776960,r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Tn;i.setIndex(new pn(r,1)),i.addAttribute("position",new xn([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),ii.call(this,i,new ni({color:n})),this.geometry.computeBoundingSphere()}function Va(t,e,n){this.type="PlaneHelper",this.plane=t,this.size=void 0===e?1:e;var r=void 0!==n?n:16776960,i=new Tn;i.addAttribute("position",new xn([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),ri.call(this,i,new ni({color:r}));var o=new Tn;o.addAttribute("position",new xn([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),o.computeBoundingSphere(),this.add(new zn(o,new Nn({color:r,opacity:.2,transparent:!0,depthWrite:!1})))}function Ga(t,e,n,r,i,o){an.call(this),void 0===r&&(r=16776960),void 0===n&&(n=1),void 0===i&&(i=.2*n),void 0===o&&(o=.2*i),void 0===Js&&((Js=new Tn).addAttribute("position",new xn([0,0,0,0,1,0],3)),(Ks=new vo(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(e),this.line=new ri(Js,new ni({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new zn(Ks,new Nn({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,i,o)}function ja(t){var e=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=new Tn;n.addAttribute("position",new xn(e,3)),n.addAttribute("color",new xn([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var r=new ni({vertexColors:_});ii.call(this,n,r)}function Ha(t,e,n,r,i,o,s){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new cn(t,e,n,i,o,s)}Object.assign(ea.prototype,{load:function(t,e,n,r){var i=new Uo(this.manager);i.setResponseType("arraybuffer"),i.load(t,function(t){ta.getContext().decodeAudioData(t,function(t){e(t)})},n,r)}}),Object.assign(na.prototype,{update:function(){var t,e,n,r,i,o,s,a,l=new Ue,u=new Ue;return function(c){if(t!==this||e!==c.focus||n!==c.fov||r!==c.aspect*this.aspect||i!==c.near||o!==c.far||s!==c.zoom||a!==this.eyeSep){t=this,e=c.focus,n=c.fov,r=c.aspect*this.aspect,i=c.near,o=c.far,s=c.zoom;var h,d,p=c.projectionMatrix.clone(),f=(a=this.eyeSep/2)*i/e,m=i*Math.tan(De.DEG2RAD*n*.5)/s;u.elements[12]=-a,l.elements[12]=a,p.elements[0]=2*i/((d=m*r+f)-(h=-m*r+f)),p.elements[8]=(d+h)/(d-h),this.cameraL.projectionMatrix.copy(p),p.elements[0]=2*i/((d=m*r-f)-(h=-m*r-f)),p.elements[8]=(d+h)/(d-h),this.cameraR.projectionMatrix.copy(p)}this.cameraL.matrixWorld.copy(c.matrixWorld).multiply(u),this.cameraR.matrixWorld.copy(c.matrixWorld).multiply(l)}}()}),(ra.prototype=Object.create(an.prototype)).constructor=ra,ia.prototype=Object.assign(Object.create(an.prototype),{constructor:ia,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(t){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){this.gain.gain.value=t},updateMatrixWorld:function(){var t=new Fe,e=new ze,n=new Fe,r=new Fe;return function(i){an.prototype.updateMatrixWorld.call(this,i);var o=this.context.listener,s=this.up;this.matrixWorld.decompose(t,e,n),r.set(0,0,-1).applyQuaternion(e),o.positionX?(o.positionX.setValueAtTime(t.x,this.context.currentTime),o.positionY.setValueAtTime(t.y,this.context.currentTime),o.positionZ.setValueAtTime(t.z,this.context.currentTime),o.forwardX.setValueAtTime(r.x,this.context.currentTime),o.forwardY.setValueAtTime(r.y,this.context.currentTime),o.forwardZ.setValueAtTime(r.z,this.context.currentTime),o.upX.setValueAtTime(s.x,this.context.currentTime),o.upY.setValueAtTime(s.y,this.context.currentTime),o.upZ.setValueAtTime(s.z,this.context.currentTime)):(o.setPosition(t.x,t.y,t.z),o.setOrientation(r.x,r.y,r.z,s.x,s.y,s.z))}}()}),oa.prototype=Object.assign(Object.create(an.prototype),{constructor:oa,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.onended=this.onEnded.bind(this),t.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,t.start(this.startTime,this.offset),this.isPlaying=!0,this.source=t,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.value=t,this}}),sa.prototype=Object.assign(Object.create(oa.prototype),{constructor:sa,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){this.panner.refDistance=t},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){this.panner.rolloffFactor=t},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){this.panner.distanceModel=t},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){this.panner.maxDistance=t},updateMatrixWorld:function(){var t=new Fe;return function(e){an.prototype.updateMatrixWorld.call(this,e),t.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(t.x,t.y,t.z)}}()}),Object.assign(aa.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),n=0;n<e.length;n++)t+=e[n];return t/e.length}}),Object.assign(la.prototype,{accumulate:function(t,e){var n=this.buffer,r=this.valueSize,i=t*r+r,o=this.cumulativeWeight;if(0===o){for(var s=0;s!==r;++s)n[i+s]=n[s];o=e}else this._mixBufferRegion(n,i,0,e/(o+=e),r);this.cumulativeWeight=o},apply:function(t){var e=this.valueSize,n=this.buffer,r=t*e+e,i=this.cumulativeWeight,o=this.binding;this.cumulativeWeight=0,i<1&&this._mixBufferRegion(n,r,3*e,1-i,e);for(var s=e,a=e+e;s!==a;++s)if(n[s]!==n[s+e]){o.setValue(n,r);break}},saveOriginalState:function(){var t=this.buffer,e=this.valueSize,n=3*e;this.binding.getValue(t,n);for(var r=e,i=n;r!==i;++r)t[r]=t[n+r%e];this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_select:function(t,e,n,r,i){if(r>=.5)for(var o=0;o!==i;++o)t[e+o]=t[n+o]},_slerp:function(t,e,n,r){ze.slerpFlat(t,e,t,e,t,n,r)},_lerp:function(t,e,n,r,i){for(var o=1-r,s=0;s!==i;++s){var a=e+s;t[a]=t[a]*o+t[n+s]*r}}}),Object.assign(ua.prototype,{getValue:function(t,e){this.bind();var n=this._bindings[this._targetGroup.nCachedObjects_];void 0!==n&&n.getValue(t,e)},setValue:function(t,e){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}),Object.assign(ca,{Composite:ua,create:function(t,e,n){return t&&t.isAnimationObjectGroup?new ca.Composite(t,e,n):new ca(t,e,n)},sanitizeNodeName:function(){var t=new RegExp("[\\[\\]\\.:\\/]","g");return function(e){return e.replace(/\s/g,"_").replace(t,"")}}(),parseTrackName:function(){var t="[^\\[\\]\\.:\\/]",e="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",n=/((?:WC+[\/:])*)/.source.replace("WC",t),r=/(WCOD+)?/.source.replace("WCOD",e),i=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",t),o=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",t),s=new RegExp("^"+n+r+i+o+"$"),a=["material","materials","bones"];return function(t){var e=s.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==a.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}}(),findNode:function(t,e){if(!e||""===e||"root"===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){var r=function(t){for(var n=0;n<t.length;n++){var i=t[n];if(i.name===e||i.uuid===e)return i;var o=r(i.children);if(o)return o}return null},i=r(t.children);if(i)return i}return null}}),Object.assign(ca.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)t[e++]=n[r]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,n=e.objectName,r=e.propertyName,i=e.propertyIndex;if(t||(t=ca.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(n){var o=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var s=0;s<t.length;s++)if(t[s].name===o){o=s;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==o){if(void 0===t[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[o]}}var a=t[r];if(void 0!==a){var l=this.Versioning.None;void 0!==t.needsUpdate?(l=this.Versioning.NeedsUpdate,this.targetObject=t):void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=t);var u=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(s=0;s<this.node.geometry.morphAttributes.position.length;s++)if(t.geometry.morphAttributes.position[s].name===i){i=s;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(s=0;s<this.node.geometry.morphTargets.length;s++)if(t.geometry.morphTargets[s].name===i){i=s;break}}}u=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=i}else void 0!==a.fromArray&&void 0!==a.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(u=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=r;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][l]}else console.error("THREE.PropertyBinding: Trying to update property for track: "+e.nodeName+"."+r+" but it wasn't found.",t)}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(ca.prototype,{_getValue_unbound:ca.prototype.getValue,_setValue_unbound:ca.prototype.setValue}),Object.assign(ha.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,e=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._paths,o=this._parsedPaths,s=this._bindings,a=s.length,l=void 0,u=0,c=arguments.length;u!==c;++u){var h=arguments[u],d=h.uuid,p=r[d];if(void 0===p){p=e++,r[d]=p,t.push(h);for(var f=0,m=a;f!==m;++f)s[f].push(new ca(h,i[f],o[f]))}else if(p<n){l=t[p];var g=--n,v=t[g];for(r[v.uuid]=p,t[p]=v,r[d]=g,t[g]=h,f=0,m=a;f!==m;++f){var y=s[f],w=y[p];y[p]=y[g],void 0===w&&(w=new ca(h,i[f],o[f])),y[g]=w}}else t[p]!==l&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var t=this._objects,e=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,i=r.length,o=0,s=arguments.length;o!==s;++o){var a=arguments[o],l=a.uuid,u=n[l];if(void 0!==u&&u>=e){var c=e++,h=t[c];n[h.uuid]=u,t[u]=h,n[l]=c,t[c]=a;for(var d=0,p=i;d!==p;++d){var f=r[d],m=f[u];f[u]=f[c],f[c]=m}}}this.nCachedObjects_=e},uncache:function(){for(var t=this._objects,e=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._bindings,o=i.length,s=0,a=arguments.length;s!==a;++s){var l=arguments[s].uuid,u=r[l];if(void 0!==u)if(delete r[l],u<n){var c=--n,h=t[c],d=t[g=--e];r[h.uuid]=u,t[u]=h,r[d.uuid]=c,t[c]=d,t.pop();for(var p=0,f=o;p!==f;++p){var m=(v=i[p])[g];v[u]=v[c],v[c]=m,v.pop()}}else{var g;for(r[(d=t[g=--e]).uuid]=u,t[u]=d,t.pop(),p=0,f=o;p!==f;++p){var v;(v=i[p])[u]=v[g],v.pop()}}}this.nCachedObjects_=n},subscribe_:function(t,e){var n=this._bindingsIndicesByPath,r=n[t],i=this._bindings;if(void 0!==r)return i[r];var o=this._paths,s=this._parsedPaths,a=this._objects,l=this.nCachedObjects_,u=new Array(a.length);n[t]=r=i.length,o.push(t),s.push(e),i.push(u);for(var c=l,h=a.length;c!==h;++c)u[c]=new ca(a[c],t,e);return u},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){var r=this._paths,i=this._parsedPaths,o=this._bindings,s=o.length-1,a=o[s];e[t[s]]=n,o[n]=a,o.pop(),i[n]=i[s],i.pop(),r[n]=r[s],r.pop()}}}),Object.assign(da.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){var r=this._clip.duration,i=t._clip.duration,o=r/i;t.warp(1,i/r,e),this.warp(o,1,e)}return this},crossFadeTo:function(t,e,n){return t.crossFadeFrom(this,e,n)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,n){var r=this._mixer,i=r.time,o=this._timeScaleInterpolant,s=this.timeScale;null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);var a=o.parameterPositions,l=o.sampleValues;return a[0]=i,a[1]=i+n,l[0]=t/s,l[1]=e/s,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var o=(t-i)*n;if(o<0||0===n)return;this._startTime=null,e=n*o}e*=this._updateTimeScale(t);var s=this._updateTime(e),a=this._updateWeight(t);if(a>0)for(var l=this._interpolants,u=this._propertyBindings,c=0,h=l.length;c!==h;++c)l[c].evaluate(s),u[c].accumulate(r,a)}else this._updateWeight(t)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var n=this._timeScaleInterpolant;null!==n&&(e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e))}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t;if(0===t)return e;var n=this._clip.duration,r=this.loop,i=this._loopCount;if(r===pe){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(e>=n)e=n;else{if(!(e<0))break t;e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{var o=r===me;if(-1===i&&(t>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),e>=n||e<0){var s=Math.floor(e/n);e-=n*s,i+=Math.abs(s);var a=this.repetitions-i;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?n:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===a){var l=t<0;this._setEndings(l,!l,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:s})}}if(o&&1==(1&i))return this.time=e,n-e}return this.time=e,e},_setEndings:function(t,e,n){var r=this._interpolantSettings;n?(r.endingStart=be,r.endingEnd=be):(r.endingStart=t?this.zeroSlopeAtStart?be:we:xe,r.endingEnd=e?this.zeroSlopeAtEnd?be:we:xe)},_scheduleFading:function(t,e,n){var r=this._mixer,i=r.time,o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);var s=o.parameterPositions,a=o.sampleValues;return s[0]=i,a[0]=e,s[1]=i+t,a[1]=n,this}}),pa.prototype=Object.assign(Object.create(r.prototype),{constructor:pa,_bindAction:function(t,e){var n=t._localRoot||this._root,r=t._clip.tracks,i=r.length,o=t._propertyBindings,s=t._interpolants,a=n.uuid,l=this._bindingsByRootAndName,u=l[a];void 0===u&&(l[a]=u={});for(var c=0;c!==i;++c){var h=r[c],d=h.name,p=u[d];if(void 0!==p)o[c]=p;else{if(void 0!==(p=o[c])){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,a,d));continue}++(p=new la(ca.create(n,d,e&&e._propertyBindings[c].binding.parsedPath),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(p,a,d),o[c]=p}s[c].resultBuffer=p.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,e)}for(var i=t._propertyBindings,o=0,s=i.length;o!==s;++o){var a=i[o];0==a.useCount++&&(this._lendBinding(a),a.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,n){var r=this._actions,i=this._actionsByClip,o=i[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=o;else{var s=o.knownActions;t._byClipCacheIndex=s.length,s.push(t)}t._cacheIndex=r.length,r.push(t),o.actionByRoot[n]=t},_removeInactiveAction:function(t){var e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;var i=t._clip.uuid,o=this._actionsByClip,s=o[i],a=s.knownActions,l=a[a.length-1],u=t._byClipCacheIndex;l._byClipCacheIndex=u,a[u]=l,a.pop(),t._byClipCacheIndex=null,delete s.actionByRoot[(t._localRoot||this._root).uuid],0===a.length&&delete o[i],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(t){var e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackAction:function(t){var e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_addInactiveBinding:function(t,e,n){var r=this._bindingsByRootAndName,i=r[e],o=this._bindings;void 0===i&&(r[e]=i={}),i[n]=t,t._cacheIndex=o.length,o.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,n=t.binding,r=n.rootNode.uuid,i=n.path,o=this._bindingsByRootAndName,s=o[r],a=e[e.length-1],l=t._cacheIndex;a._cacheIndex=l,e[l]=a,e.pop(),delete s[i];t:{for(var u in s)break t;delete o[r]}},_lendBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,n=t[e];return void 0===n&&((n=new Ps(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,i=e[r];t.__cacheIndex=r,e[r]=t,i.__cacheIndex=n,e[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?Ds.findByName(n,t):t,o=null!==i?i.uuid:t,s=this._actionsByClip[o],a=null;if(void 0!==s){var l=s.actionByRoot[r];if(void 0!==l)return l;a=s.knownActions[0],null===i&&(i=a._clip)}if(null===i)return null;var u=new da(this,i,e);return this._bindAction(u,a),this._addInactiveAction(u,o,r),u},existingAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?Ds.findByName(n,t):t,o=this._actionsByClip[i?i.uuid:t];return void 0!==o&&o.actionByRoot[r]||null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,n=this._bindings,r=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==e;++i)t[i].reset();for(i=0;i!==r;++i)n[i].useCount=0;return this},update:function(t){for(var e=this._actions,n=this._nActiveActions,r=this.time+=t*=this.timeScale,i=Math.sign(t),o=this._accuIndex^=1,s=0;s!==n;++s)e[s]._update(r,t,i,o);var a=this._bindings,l=this._nActiveBindings;for(s=0;s!==l;++s)a[s].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,n=t.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var o=i.knownActions,s=0,a=o.length;s!==a;++s){var l=o[s];this._deactivateAction(l);var u=l._cacheIndex,c=e[e.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,c._cacheIndex=u,e[u]=c,e.pop(),this._removeInactiveBindingsForAction(l)}delete r[n]}},uncacheRoot:function(t){var e=t.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[e];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var o=this._bindingsByRootAndName[e];if(void 0!==o)for(var s in o){var a=o[s];a.restoreOriginalState(),this._removeInactiveBinding(a)}},uncacheAction:function(t,e){var n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),fa.prototype.clone=function(){return new fa(void 0===this.value.clone?this.value:this.value.clone())},ma.prototype=Object.assign(Object.create(Tn.prototype),{constructor:ma,isInstancedBufferGeometry:!0,copy:function(t){return Tn.prototype.copy.call(this,t),this.maxInstancedCount=t.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)}}),Object.defineProperties(ga.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(ga.prototype,{isInterleavedBufferAttribute:!0,setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return this.data.array[(t=t*this.data.stride+this.offset)+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,r){return this.data.array[(t=t*this.data.stride+this.offset)+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return this.data.array[(t=t*this.data.stride+this.offset)+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=i,this}}),Object.defineProperty(va.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(va.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.stride:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(var r=0,i=this.stride;r<i;r++)this.array[t+r]=e.array[n+r];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}}),ya.prototype=Object.assign(Object.create(va.prototype),{constructor:ya,isInstancedInterleavedBuffer:!0,copy:function(t){return va.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),wa.prototype=Object.assign(Object.create(pn.prototype),{constructor:wa,isInstancedBufferAttribute:!0,copy:function(t){return pn.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Object.assign(ba.prototype,{linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize()):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e,n){var r=n||[];return _a(t,this,r,e),r.sort(xa),r},intersectObjects:function(t,e,n){var r=n||[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var i=0,o=t.length;i<o;i++)_a(t[i],this,r,e);return r.sort(xa),r}}),Object.assign(Ea.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=("undefined"==typeof performance?Date:performance).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}}),Object.assign(Sa.prototype,{set:function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.radius=t.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t.x,t.z),this.phi=Math.acos(De.clamp(t.y/this.radius,-1,1))),this}}),Object.assign(Ma.prototype,{set:function(t,e,n){return this.radius=t,this.theta=e,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.radius=Math.sqrt(t.x*t.x+t.z*t.z),this.theta=Math.atan2(t.x,t.z),this.y=t.y,this}}),Object.assign(Ta.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new Be;return function(e,n){var r=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new Be),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new Be),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .getParameter() target is now required"),e=new Be),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .clampPoint() target is now required"),e=new Be),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new Be;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),(Ca.prototype=Object.create(an.prototype)).constructor=Ca,Ca.prototype.isImmediateRenderObject=!0,(Aa.prototype=Object.create(ii.prototype)).constructor=Aa,Aa.prototype.update=function(){var t=new Fe,e=new Fe,n=new ke;return function(){var r=["a","b","c"];this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);var i=this.object.matrixWorld,o=this.geometry.attributes.position,s=this.object.geometry;if(s&&s.isGeometry)for(var a=s.vertices,l=s.faces,u=0,c=0,h=l.length;c<h;c++)for(var d=l[c],p=0,f=d.vertexNormals.length;p<f;p++){var m=d.vertexNormals[p];t.copy(a[d[r[p]]]).applyMatrix4(i),e.copy(m).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),o.setXYZ(u,t.x,t.y,t.z),o.setXYZ(u+=1,e.x,e.y,e.z),u+=1}else if(s&&s.isBufferGeometry){var g=s.attributes.position,v=s.attributes.normal;for(u=0,p=0,f=g.count;p<f;p++)t.set(g.getX(p),g.getY(p),g.getZ(p)).applyMatrix4(i),e.set(v.getX(p),v.getY(p),v.getZ(p)),e.applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),o.setXYZ(u,t.x,t.y,t.z),o.setXYZ(u+=1,e.x,e.y,e.z),u+=1}o.needsUpdate=!0}}(),(Ra.prototype=Object.create(an.prototype)).constructor=Ra,Ra.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Ra.prototype.update=function(){var t=new Fe,e=new Fe;return function(){this.light.updateMatrixWorld();var n=this.light.distance?this.light.distance:1e3,r=n*Math.tan(this.light.angle);this.cone.scale.set(r,r,n),t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e.sub(t)),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}(),(Pa.prototype=Object.create(ii.prototype)).constructor=Pa,Pa.prototype.updateMatrixWorld=function(){var t=new Fe,e=new Ue,n=new Ue;return function(r){var i=this.bones,o=this.geometry,s=o.getAttribute("position");n.getInverse(this.root.matrixWorld);for(var a=0,l=0;a<i.length;a++){var u=i[a];u.parent&&u.parent.isBone&&(e.multiplyMatrices(n,u.matrixWorld),t.setFromMatrixPosition(e),s.setXYZ(l,t.x,t.y,t.z),e.multiplyMatrices(n,u.parent.matrixWorld),t.setFromMatrixPosition(e),s.setXYZ(l+1,t.x,t.y,t.z),l+=2)}o.getAttribute("position").needsUpdate=!0,an.prototype.updateMatrixWorld.call(this,r)}}(),(La.prototype=Object.create(zn.prototype)).constructor=La,La.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},La.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},(Ia.prototype=Object.create(an.prototype)).constructor=Ia,Ia.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Ia.prototype.update=function(){var t=.5*this.light.width,e=.5*this.light.height,n=this.line.geometry.attributes.position,r=n.array;r[0]=t,r[1]=-e,r[2]=0,r[3]=t,r[4]=e,r[5]=0,r[6]=-t,r[7]=e,r[8]=0,r[9]=-t,r[10]=-e,r[11]=0,r[12]=t,r[13]=-e,r[14]=0,n.needsUpdate=!0,void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)},(Na.prototype=Object.create(an.prototype)).constructor=Na,Na.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Na.prototype.update=function(){var t=new Fe,e=new tn,n=new tn;return function(){var r=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var i=r.geometry.getAttribute("color");e.copy(this.light.color),n.copy(this.light.groundColor);for(var o=0,s=i.count;o<s;o++){var a=o<s/2?e:n;i.setXYZ(o,a.r,a.g,a.b)}i.needsUpdate=!0}r.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),(Oa.prototype=Object.create(ii.prototype)).constructor=Oa,(Da.prototype=Object.create(ii.prototype)).constructor=Da,(Ba.prototype=Object.create(ii.prototype)).constructor=Ba,Ba.prototype.update=function(){var t=new Fe,e=new Fe,n=new ke;return function(){this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);for(var r=this.object.matrixWorld,i=this.geometry.attributes.position,o=this.object.geometry,s=o.vertices,a=o.faces,l=0,u=0,c=a.length;u<c;u++){var h=a[u],d=h.normal;t.copy(s[h.a]).add(s[h.b]).add(s[h.c]).divideScalar(3).applyMatrix4(r),e.copy(d).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),i.setXYZ(l,t.x,t.y,t.z),i.setXYZ(l+=1,e.x,e.y,e.z),l+=1}i.needsUpdate=!0}}(),(Ua.prototype=Object.create(an.prototype)).constructor=Ua,Ua.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Ua.prototype.update=function(){var t=new Fe,e=new Fe,n=new Fe;return function(){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(e,t),this.lightPlane.lookAt(n),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(n),this.targetLine.scale.z=n.length()}}(),(za.prototype=Object.create(ii.prototype)).constructor=za,za.prototype.update=function(){var t,e,n=new Fe,r=new ln;function i(i,o,s,a){n.set(o,s,a).unproject(r);var l=e[i];if(void 0!==l)for(var u=t.getAttribute("position"),c=0,h=l.length;c<h;c++)u.setXYZ(l[c],n.x,n.y,n.z)}return function(){t=this.geometry,e=this.pointMap,r.projectionMatrix.copy(this.camera.projectionMatrix),i("c",0,0,-1),i("t",0,0,1),i("n1",-1,-1,-1),i("n2",1,-1,-1),i("n3",-1,1,-1),i("n4",1,1,-1),i("f1",-1,-1,1),i("f2",1,-1,1),i("f3",-1,1,1),i("f4",1,1,1),i("u1",.7,1.1,-1),i("u2",-.7,1.1,-1),i("u3",0,2,-1),i("cf1",-1,0,1),i("cf2",1,0,1),i("cf3",0,-1,1),i("cf4",0,1,1),i("cn1",-1,0,-1),i("cn2",1,0,-1),i("cn3",0,-1,-1),i("cn4",0,1,-1),t.getAttribute("position").needsUpdate=!0}}(),(Fa.prototype=Object.create(ii.prototype)).constructor=Fa,Fa.prototype.update=function(){var t=new Xe;return function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&t.setFromObject(this.object),!t.isEmpty()){var n=t.min,r=t.max,i=this.geometry.attributes.position,o=i.array;o[0]=r.x,o[1]=r.y,o[2]=r.z,o[3]=n.x,o[4]=r.y,o[5]=r.z,o[6]=n.x,o[7]=n.y,o[8]=r.z,o[9]=r.x,o[10]=n.y,o[11]=r.z,o[12]=r.x,o[13]=r.y,o[14]=n.z,o[15]=n.x,o[16]=r.y,o[17]=n.z,o[18]=n.x,o[19]=n.y,o[20]=n.z,o[21]=r.x,o[22]=n.y,o[23]=n.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),Fa.prototype.setFromObject=function(t){return this.object=t,this.update(),this},(ka.prototype=Object.create(ii.prototype)).constructor=ka,ka.prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),an.prototype.updateMatrixWorld.call(this,t))},(Va.prototype=Object.create(ri.prototype)).constructor=Va,Va.prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.lookAt(this.plane.normal),an.prototype.updateMatrixWorld.call(this,t)},(Ga.prototype=Object.create(an.prototype)).constructor=Ga,Ga.prototype.setDirection=function(){var t,e=new Fe;return function(n){n.y>.99999?this.quaternion.set(0,0,0,1):n.y<-.99999?this.quaternion.set(1,0,0,0):(e.set(n.z,0,-n.x).normalize(),t=Math.acos(n.y),this.quaternion.setFromAxisAngle(e,t))}}(),Ga.prototype.setLength=function(t,e,n){void 0===e&&(e=.2*t),void 0===n&&(n=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()},Ga.prototype.setColor=function(t){this.line.material.color.copy(t),this.cone.material.color.copy(t)},(ja.prototype=Object.create(ii.prototype)).constructor=ja;var Wa=0,qa=1;function Xa(t){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),t}function Ya(t){return void 0===t&&(t=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),t.isMultiMaterial=!0,t.materials=t,t.clone=function(){return t.slice()},t}function Za(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new ai(t,e)}function $a(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Qr(t)}function Qa(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new ai(t,e)}function Ja(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new si(t)}function Ka(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new si(t)}function tl(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new si(t)}function el(t,e,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Fe(t,e,n)}function nl(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new pn(t,e).setDynamic(!0)}function rl(t,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new fn(t,e)}function il(t,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new mn(t,e)}function ol(t,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new gn(t,e)}function sl(t,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new vn(t,e)}function al(t,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new yn(t,e)}function ll(t,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new wn(t,e)}function ul(t,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new bn(t,e)}function cl(t,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new xn(t,e)}function hl(t,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new _n(t,e)}function dl(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Qo.call(this,t),this.type="catmullrom",this.closed=!0}function pl(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Qo.call(this,t),this.type="catmullrom"}function fl(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Qo.call(this,t),this.type="catmullrom"}function ml(t){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new ja(t)}function gl(t,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Fa(t,e)}function vl(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new ii(new mo(t.geometry),new ni({color:void 0!==e?e:16777215}))}function yl(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new ii(new di(t.geometry),new ni({color:void 0!==e?e:16777215}))}function wl(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Uo(t)}function bl(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Fo(t)}jo.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(jo.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Object.assign(us.prototype,{createPointsGeometry:function(t){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getPoints(t);return this.createGeometry(e)},createSpacedPointsGeometry:function(t){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getSpacedPoints(t);return this.createGeometry(e)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var e=new dn,n=0,r=t.length;n<r;n++){var i=t[n];e.vertices.push(new Fe(i.x,i.y,i.z||0))}return e}}),Object.assign(cs.prototype,{fromPoints:function(t){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),dl.prototype=Object.create(Qo.prototype),pl.prototype=Object.create(Qo.prototype),fl.prototype=Object.create(Qo.prototype),Object.assign(fl.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Oa.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Pa.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Fs.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),ks.extractUrlBase(t)}}),Object.assign(Ta.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(Xe.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),Bn.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(De,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),De.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),De.ceilPowerOfTwo(t)}}),Object.assign(ke.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(t){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(Ue.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){var t;return function(){return void 0===t&&(t=new Fe),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),t.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(t){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,n,r,i,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,r,n,i,o)}}),Ze.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},ze.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(Dn.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(Un.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Object.assign(Un,{barycoordFromPoint:function(t,e,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Un.getBarycoord(t,e,n,r,i)},normal:function(t,e,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Un.getNormal(t,e,n,r)}}),Object.assign(hs.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new eo(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new ho(this,t)}}),Object.assign(Be.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Fe.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(je.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(dn.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(an.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}}),Object.defineProperties(an.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(Jr.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Kr.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(jo.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),jr.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(ds.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(pn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")}}),Object.assign(Tn.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addDrawCall:function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(Tn.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(fa.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(In.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new tn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===y}}}),Object.defineProperties(Co.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(On.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(qr.prototype,{getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")}}),Object.defineProperties(qr.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(kr.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(He.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(Wr.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}}}),oa.prototype.load=function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this;return(new ea).load(t,function(t){e.setBuffer(t)}),this},aa.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},ra.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)};var xl={merge:function(t,e,n){var r;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),e.isMesh&&(e.matrixAutoUpdate&&e.updateMatrix(),r=e.matrix,e=e.geometry),t.merge(e,r,n)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},_l={crossOrigin:void 0,loadTexture:function(t,e,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new Go;i.setCrossOrigin(this.crossOrigin);var o=i.load(t,n,void 0,r);return e&&(o.mapping=e),o},loadTextureCube:function(t,e,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new Vo;i.setCrossOrigin(this.crossOrigin);var o=i.load(t,n,void 0,r);return e&&(o.mapping=e),o},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}};function El(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(t,e){console.warn("THREE.Projector: .projectVector() is now vector.project()."),t.project(e)},this.unprojectVector=function(t,e){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}}function Sl(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}}var Ml={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}};function Tl(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")}},YUnZ:function(t,e,n){(function(t){var n;(function(){var r,i,o,s,a,l,u,c,h,d,p,f,m,g,v,y,w,b,x,_,E,S,M,T,C,A,R,P,L,I,N,O,D,B,U,z,F,k,V,G,j,H,W,q,X,Y,Z,$,Q,J,K,tt,et,nt,rt,it,ot,st,at,lt,ut,ct,ht,dt,pt,ft,mt,gt,vt,yt,wt,bt,xt,_t,Et,St=[].slice;wt=function(){var t,e,n,r,i;for(t={},r=0,e=(i="Boolean Number String Function Array Date RegExp Undefined Null".split(" ")).length;r<e;r++)t["[object "+(n=i[r])+"]"]=n.toLowerCase();return function(e){var n;return n=Object.prototype.toString.call(e),t[n]||"object"}}(),W=function(t,e,n){return null==e&&(e=0),null==n&&(n=1),t<e&&(t=e),t>n&&(t=n),t},bt=function(t){return t.length>=3?Array.prototype.slice.call(t):t[0]},E=function(t){var e,n;for(t._clipped=!1,t._unclipped=t.slice(0),e=n=0;n<3;e=++n)e<3?((t[e]<0||t[e]>255)&&(t._clipped=!0),t[e]<0&&(t[e]=0),t[e]>255&&(t[e]=255)):3===e&&(t[e]<0&&(t[e]=0),t[e]>1&&(t[e]=1));return t._clipped||delete t._unclipped,t},s=Math.PI,ft=Math.round,M=Math.cos,P=Math.floor,J=Math.pow,q=Math.log,gt=Math.sin,vt=Math.sqrt,g=Math.atan2,Y=Math.max,m=Math.abs,u=2*s,a=s/3,i=s/180,l=180/s,(_=function(){return arguments[0]instanceof r?arguments[0]:function(t,e,n){n.prototype=t.prototype;var r=new n,i=t.apply(r,e);return Object(i)===i?i:r}(r,arguments,function(){})}).default=_,f=[],void 0!==t&&null!==t&&null!=t.exports&&(t.exports=_),void 0===(n=(function(){return _}).apply(e,[]))||(t.exports=n),_.version="1.3.7",p={},h=[],d=!1,r=function(){function t(){var t,e,n,r,i,o,s,a,l;for(o=this,e=[],a=0,r=arguments.length;a<r;a++)null!=(t=arguments[a])&&e.push(t);if(e.length>1&&(s=e[e.length-1]),null!=p[s])o._rgb=E(p[s](bt(e.slice(0,-1))));else{for(d||(h=h.sort(function(t,e){return e.p-t.p}),d=!0),l=0,i=h.length;l<i&&!(s=(n=h[l]).test.apply(n,e));l++);s&&(o._rgb=E(p[s].apply(p,e)))}null==o._rgb&&console.warn("unknown format: "+e),null==o._rgb&&(o._rgb=[0,0,0]),3===o._rgb.length&&o._rgb.push(1)}return t.prototype.toString=function(){return this.hex()},t.prototype.clone=function(){return _(me._rgb)},t}(),_._input=p,_.brewer=b={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},function(){var t,e;for(t in e=[],b)e.push(b[t.toLowerCase()]=b[t])}(),_.colors=xt={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},k=function(){var t,e,n,r,i,s;return t=(e=bt(arguments))[1],n=e[2],i=(e[0]+16)/116,r=isNaN(t)?i:i+t/500,s=isNaN(n)?i:i-n/200,i=o.Yn*V(i),r=o.Xn*V(r),s=o.Zn*V(s),[Et(3.2404542*r-1.5371385*i-.4985314*s),Et(-.969266*r+1.8760108*i+.041556*s),n=Et(.0556434*r-.2040259*i+1.0572252*s),e.length>3?e[3]:1]},Et=function(t){return 255*(t<=.00304?12.92*t:1.055*J(t,1/2.4)-.055)},V=function(t){return t>o.t1?t*t*t:o.t2*(t-o.t0)},o={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},st=function(){var t,e,n;return t=bt(arguments),[116*(n=(e=ht(t[0],t[1],t[2]))[1])-16,500*(e[0]-n),200*(n-e[2])]},dt=function(t){return(t/=255)<=.04045?t/12.92:J((t+.055)/1.055,2.4)},_t=function(t){return t>o.t3?J(t,1/3):t/o.t2+o.t0},ht=function(){var t,e,n,r;return e=(r=bt(arguments))[1],t=r[2],n=dt(n=r[0]),e=dt(e),t=dt(t),[_t((.4124564*n+.3575761*e+.1804375*t)/o.Xn),_t((.2126729*n+.7151522*e+.072175*t)/o.Yn),_t((.0193339*n+.119192*e+.9503041*t)/o.Zn)]},_.lab=function(){return function(t,e,n){n.prototype=t.prototype;var r=new n,i=t.apply(r,e);return Object(i)===i?i:r}(r,St.call(arguments).concat(["lab"]),function(){})},p.lab=k,r.prototype.lab=function(){return st(this._rgb)},v=function(t){var e,n,r,i,o,s,a,l,u,c;return 2===(t=function(){var e,n,r;for(r=[],n=0,e=t.length;n<e;n++)r.push(_(t[n]));return r}()).length?(l=function(){var e,n,r;for(r=[],n=0,e=t.length;n<e;n++)r.push(t[n].lab());return r}(),i=l[0],o=l[1],e=function(t){var e,n;return n=function(){var n,r;for(r=[],e=n=0;n<=2;e=++n)r.push(i[e]+t*(o[e]-i[e]));return r}(),_.lab.apply(_,n)}):3===t.length?(u=function(){var e,n,r;for(r=[],n=0,e=t.length;n<e;n++)r.push(t[n].lab());return r}(),i=u[0],o=u[1],s=u[2],e=function(t){var e,n;return n=function(){var n,r;for(r=[],e=n=0;n<=2;e=++n)r.push((1-t)*(1-t)*i[e]+2*(1-t)*t*o[e]+t*t*s[e]);return r}(),_.lab.apply(_,n)}):4===t.length?(c=function(){var e,n,r;for(r=[],n=0,e=t.length;n<e;n++)r.push(t[n].lab());return r}(),i=c[0],o=c[1],s=c[2],a=c[3],e=function(t){var e,n;return n=function(){var n,r;for(r=[],e=n=0;n<=2;e=++n)r.push((1-t)*(1-t)*(1-t)*i[e]+3*(1-t)*(1-t)*t*o[e]+3*(1-t)*t*t*s[e]+t*t*t*a[e]);return r}(),_.lab.apply(_,n)}):5===t.length&&(n=v(t.slice(0,3)),r=v(t.slice(2,5)),e=function(t){return t<.5?n(2*t):r(2*(t-.5))}),e},_.bezier=function(t){var e;return(e=v(t)).scale=function(){return _.scale(e)},e},_.cubehelix=function(t,e,n,r,i){var o,s,a;return null==t&&(t=300),null==e&&(e=-1.5),null==n&&(n=1),null==r&&(r=1),null==i&&(i=[0,1]),o=0,"array"===wt(i)?s=i[1]-i[0]:(s=0,i=[i,i]),(a=function(a){var l,c,h,d,p;return l=u*((t+120)/360+e*a),d=J(i[0]+s*a,r),c=(0!==o?n[0]+a*o:n)*d*(1-d)/2,h=M(l),p=gt(l),_(E([255*(d+c*(-.14861*h+1.78277*p)),255*(d+c*(-.29227*h-.90649*p)),255*(d+c*(1.97294*h))]))}).start=function(e){return null==e?t:(t=e,a)},a.rotations=function(t){return null==t?e:(e=t,a)},a.gamma=function(t){return null==t?r:(r=t,a)},a.hue=function(t){return null==t?n:("array"===wt(n=t)?0==(o=n[1]-n[0])&&(n=n[1]):o=0,a)},a.lightness=function(t){return null==t?i:("array"===wt(t)?(i=t,s=t[1]-t[0]):(i=[t,t],s=0),a)},a.scale=function(){return _.scale(a)},a.hue(n),a},_.random=function(){var t,e;for(t="#",e=0;e<6;++e)t+="0123456789abcdef".charAt(P(16*Math.random()));return new r(t)},f=[],_.interpolate=U=function(t,e,n,r){var i,o,s,a;for(null==n&&(n=.5),null==r&&(r="rgb"),"object"!==wt(t)&&(t=_(t)),"object"!==wt(e)&&(e=_(e)),s=0,o=f.length;s<o;s++)if(r===(i=f[s])[0]){a=i[1](t,e,n,r);break}if(null==a)throw"color mode "+r+" is not supported";return a.alpha(t.alpha()+n*(e.alpha()-t.alpha()))},r.prototype.interpolate=function(t,e,n){return U(this,t,e,n)},_.mix=U,r.prototype.mix=r.prototype.interpolate,p.rgb=function(){var t,e,n;for(t in n=[],e=bt(arguments))n.push(e[t]);return n},_.rgb=function(){return function(t,e,n){n.prototype=t.prototype;var r=new n,i=t.apply(r,e);return Object(i)===i?i:r}(r,St.call(arguments).concat(["rgb"]),function(){})},r.prototype.rgb=function(t){return null==t&&(t=!0),t?this._rgb.map(Math.round).slice(0,3):this._rgb.slice(0,3)},r.prototype.rgba=function(t){return null==t&&(t=!0),t?[Math.round(this._rgb[0]),Math.round(this._rgb[1]),Math.round(this._rgb[2]),this._rgb[3]]:this._rgb.slice(0)},h.push({p:3,test:function(t){var e;return e=bt(arguments),"array"===wt(e)&&3===e.length?"rgb":4===e.length&&"number"===wt(e[3])&&e[3]>=0&&e[3]<=1?"rgb":void 0}}),p.lrgb=p.rgb,c=function(t){var e,n,i,o,s;for(e=1/t.length,s=[0,0,0,0],i=0,n=t.length;i<n;i++)s[0]+=J((o=t[i]._rgb)[0],2)*e,s[1]+=J(o[1],2)*e,s[2]+=J(o[2],2)*e,s[3]+=o[3]*e;return s[0]=vt(s[0]),s[1]=vt(s[1]),s[2]=vt(s[2]),new r(s)},f.push(["lrgb",function(t,e,n,i){var o,s;return s=e._rgb,new r(vt(J((o=t._rgb)[0],2)*(1-n)+J(s[0],2)*n),vt(J(o[1],2)*(1-n)+J(s[1],2)*n),vt(J(o[2],2)*(1-n)+J(s[2],2)*n),i)}]),_.average=function(t,e){var n,r,i,o,a,l,u,h,d,p,f,m,v;if(null==e&&(e="rgb"),d=t.length,u=(t=t.map(function(t){return _(t)})).splice(0,1)[0],"lrgb"===e)return c(t);for(h in o=[],a=0,l=0,m=u.get(e))m[h]=m[h]||0,o.push(isNaN(m[h])?0:1),"h"!==e.charAt(h)||isNaN(m[h])||(a+=M(n=m[h]/180*s),l+=gt(n));for(r=u.alpha(),f=0,p=t.length;f<p;f++)for(h in v=(i=t[f]).get(e),r+=i.alpha(),m)isNaN(v[h])||(o[h]+=1,"h"===e.charAt(h)?(a+=M(n=v[h]/180*s),l+=gt(n)):m[h]+=v[h]);for(h in m)if("h"===e.charAt(h)){for(n=g(l/o[h],a/o[h])/s*180;n<0;)n+=360;for(;n>=360;)n-=360;m[h]=n}else m[h]=m[h]/o[h];return _(m,e).alpha(r/d)},I=function(t){var e,n;if(t.match(/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/))return 4!==t.length&&7!==t.length||(t=t.substr(1)),3===t.length&&(t=(t=t.split(""))[0]+t[0]+t[1]+t[1]+t[2]+t[2]),[(n=parseInt(t,16))>>16,n>>8&255,255&n,1];if(t.match(/^#?([A-Fa-f0-9]{8})$/))return 9===t.length&&(t=t.substr(1)),[(n=parseInt(t,16))>>24&255,n>>16&255,n>>8&255,ft((255&n)/255*100)/100];if(null!=p.css&&(e=p.css(t)))return e;throw"unknown color: "+t},nt=function(t,e){var n,r,i,o,s,a;return null==e&&(e="rgb"),s=t[0],i=t[1],r=t[2],n=t[3],s=Math.round(s),i=Math.round(i),r=Math.round(r),a=(a="000000"+(s<<16|i<<8|r).toString(16)).substr(a.length-6),o=(o="0"+ft(255*n).toString(16)).substr(o.length-2),"#"+function(){switch(e.toLowerCase()){case"rgba":return a+o;case"argb":return o+a;default:return a}}()},p.hex=function(t){return I(t)},_.hex=function(){return function(t,e,n){n.prototype=t.prototype;var r=new n,i=t.apply(r,e);return Object(i)===i?i:r}(r,St.call(arguments).concat(["hex"]),function(){})},r.prototype.hex=function(t){return null==t&&(t="rgb"),nt(this._rgb,t)},h.push({p:4,test:function(t){if(1===arguments.length&&"string"===wt(t))return"hex"}}),D=function(){var t,e,n,r,i,o,s,a,l,u,c,h,d,p;if(i=(t=bt(arguments))[0],s=t[2],0===(c=t[1]))l=r=e=255*s;else{for(p=[0,0,0],n=[0,0,0],h=2*s-(d=s<.5?s*(1+c):s+c-s*c),p[0]=(i/=360)+1/3,p[1]=i,p[2]=i-1/3,o=a=0;a<=2;o=++a)p[o]<0&&(p[o]+=1),p[o]>1&&(p[o]-=1),n[o]=6*p[o]<1?h+6*(d-h)*p[o]:2*p[o]<1?d:3*p[o]<2?h+(d-h)*(2/3-p[o])*6:h;l=(u=[ft(255*n[0]),ft(255*n[1]),ft(255*n[2])])[0],r=u[1],e=u[2]}return t.length>3?[l,r,e,t[3]]:[l,r,e]},it=function(t,e,n){var r,i,o,s,a;return void 0!==t&&t.length>=3&&(t=(s=t)[0],e=s[1],n=s[2]),t/=255,e/=255,n/=255,o=Math.min(t,e,n),i=((Y=Math.max(t,e,n))+o)/2,Y===o?(a=0,r=Number.NaN):a=i<.5?(Y-o)/(Y+o):(Y-o)/(2-Y-o),t===Y?r=(e-n)/(Y-o):e===Y?r=2+(n-t)/(Y-o):n===Y&&(r=4+(t-e)/(Y-o)),(r*=60)<0&&(r+=360),[r,a,i]},_.hsl=function(){return function(t,e,n){n.prototype=t.prototype;var r=new n,i=t.apply(r,e);return Object(i)===i?i:r}(r,St.call(arguments).concat(["hsl"]),function(){})},p.hsl=D,r.prototype.hsl=function(){return it(this._rgb)},B=function(){var t,e,n,r,i,o,s,a,l,u,c,h,d,p,f,m,g,v;if(i=(t=bt(arguments))[0],v=t[2],v*=255,0===(m=t[1]))l=r=e=v;else switch(360===i&&(i=0),i>360&&(i-=360),i<0&&(i+=360),s=v*(1-m),a=v*(1-m*(n=(i/=60)-(o=P(i)))),g=v*(1-m*(1-n)),o){case 0:l=(u=[v,g,s])[0],r=u[1],e=u[2];break;case 1:l=(c=[a,v,s])[0],r=c[1],e=c[2];break;case 2:l=(h=[s,v,g])[0],r=h[1],e=h[2];break;case 3:l=(d=[s,a,v])[0],r=d[1],e=d[2];break;case 4:l=(p=[g,s,v])[0],r=p[1],e=p[2];break;case 5:l=(f=[v,s,a])[0],r=f[1],e=f[2]}return[l,r,e,t.length>3?t[3]:1]},ot=function(){var t,e,n,r,i,o,s,a;return o=(s=bt(arguments))[0],n=s[1],t=s[2],i=Math.min(o,n,t),e=(Y=Math.max(o,n,t))-i,0===Y?(r=Number.NaN,a=0):(a=e/Y,o===Y&&(r=(n-t)/e),n===Y&&(r=2+(t-o)/e),t===Y&&(r=4+(o-n)/e),(r*=60)<0&&(r+=360)),[r,a,Y/255]},_.hsv=function(){return function(t,e,n){n.prototype=t.prototype;var r=new n,i=t.apply(r,e);return Object(i)===i?i:r}(r,St.call(arguments).concat(["hsv"]),function(){})},p.hsv=B,r.prototype.hsv=function(){return ot(this._rgb)},$=function(t){return"number"===wt(t)&&t>=0&&t<=16777215?[t>>16,t>>8&255,255&t,1]:(console.warn("unknown num color: "+t),[0,0,0,1])},ut=function(){var t;return((t=bt(arguments))[0]<<16)+(t[1]<<8)+t[2]},_.num=function(t){return new r(t,"num")},r.prototype.num=function(t){return null==t&&(t="rgb"),ut(this._rgb,t)},p.num=$,h.push({p:1,test:function(t){if(1===arguments.length&&"number"===wt(t)&&t>=0&&t<=16777215)return"num"}}),L=function(){var t,e,n,r,i,o,s,a,l,u,c,h,d,p,f,m,g,v,y,w;if(a=(n=bt(arguments))[0],i=n[1],e=n[2],s=s/100*255,t=255*(i/=100),0===i)h=s=r=e;else switch(360===a&&(a=0),a>360&&(a-=360),a<0&&(a+=360),c=(u=e*(1-i))+t*(1-(o=(a/=60)-(l=P(a)))),y=u+t*o,w=u+t,l){case 0:h=(d=[w,y,u])[0],s=d[1],r=d[2];break;case 1:h=(p=[c,w,u])[0],s=p[1],r=p[2];break;case 2:h=(f=[u,w,y])[0],s=f[1],r=f[2];break;case 3:h=(m=[u,c,w])[0],s=m[1],r=m[2];break;case 4:h=(g=[y,u,w])[0],s=g[1],r=g[2];break;case 5:h=(v=[w,u,c])[0],s=v[1],r=v[2]}return[h,s,r,n.length>3?n[3]:1]},et=function(){var t,e,n,r,i,o,s;return o=(s=bt(arguments))[0],n=s[1],t=s[2],i=Math.min(o,n,t),0==(e=(Y=Math.max(o,n,t))-i)?r=Number.NaN:(o===Y&&(r=(n-t)/e),n===Y&&(r=2+(t-o)/e),t===Y&&(r=4+(o-n)/e),(r*=60)<0&&(r+=360)),[r,100*e/255,i/(255-e)*100]},_.hcg=function(){return function(t,e,n){n.prototype=t.prototype;var r=new n,i=t.apply(r,e);return Object(i)===i?i:r}(r,St.call(arguments).concat(["hcg"]),function(){})},p.hcg=L,r.prototype.hcg=function(){return et(this._rgb)},T=function(t){var e,n,r,i,o,s,a,l;if(t=t.toLowerCase(),null!=_.colors&&_.colors[t])return I(_.colors[t]);if(o=t.match(/rgb\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*\)/)){for(a=o.slice(1,4),i=s=0;s<=2;i=++s)a[i]=+a[i];a[3]=1}else if(o=t.match(/rgba\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*,\s*([01]|[01]?\.\d+)\)/))for(a=o.slice(1,5),i=l=0;l<=3;i=++l)a[i]=+a[i];else if(o=t.match(/rgb\(\s*(\-?\d+(?:\.\d+)?)%,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*\)/)){for(a=o.slice(1,4),i=e=0;e<=2;i=++e)a[i]=ft(2.55*a[i]);a[3]=1}else if(o=t.match(/rgba\(\s*(\-?\d+(?:\.\d+)?)%,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)/)){for(a=o.slice(1,5),i=n=0;n<=2;i=++n)a[i]=ft(2.55*a[i]);a[3]=+a[3]}else(o=t.match(/hsl\(\s*(\-?\d+(?:\.\d+)?),\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*\)/))?((r=o.slice(1,4))[1]*=.01,r[2]*=.01,(a=D(r))[3]=1):(o=t.match(/hsla\(\s*(\-?\d+(?:\.\d+)?),\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)/))&&((r=o.slice(1,4))[1]*=.01,r[2]*=.01,(a=D(r))[3]=+o[4]);return a},tt=function(t){var e;return"rgb"==(e=t[3]<1?"rgba":"rgb")?e+"("+t.slice(0,3).map(ft).join(",")+")":"rgba"===e?e+"("+t.slice(0,3).map(ft).join(",")+","+t[3]+")":void 0},pt=function(t){return ft(100*t)/100},O=function(t,e){var n;return n=e<1?"hsla":"hsl",t[0]=pt(t[0]||0),t[1]=pt(100*t[1])+"%",t[2]=pt(100*t[2])+"%","hsla"===n&&(t[3]=e),n+"("+t.join(",")+")"},p.css=function(t){return T(t)},_.css=function(){return function(t,e,n){n.prototype=t.prototype;var r=new n,i=t.apply(r,e);return Object(i)===i?i:r}(r,St.call(arguments).concat(["css"]),function(){})},r.prototype.css=function(t){return null==t&&(t="rgb"),"rgb"===t.slice(0,3)?tt(this._rgb):"hsl"===t.slice(0,3)?O(this.hsl(),this.alpha()):void 0},p.named=function(t){return I(xt[t])},h.push({p:5,test:function(t){if(1===arguments.length&&null!=xt[t])return"named"}}),r.prototype.name=function(t){var e,n;for(n in arguments.length&&(xt[t]&&(this._rgb=I(xt[t])),this._rgb[3]=1),e=this.hex(),xt)if(e===xt[n])return n;return e},G=function(){var t,e,n;return t=(n=bt(arguments))[1],e=n[2],[n[0],M(e*=i)*t,gt(e)*t]},j=function(){var t,e,n;return t=bt(arguments),e=G(t[0],t[1],t[2]),[(n=k(e[0],e[1],e[2]))[0],n[1],n[2],t.length>3?t[3]:1]},F=function(){var t,e,n,r,i,o;return i=(o=bt(arguments))[0],n=vt((t=o[1])*t+(e=o[2])*e),r=(g(e,t)*l+360)%360,0===ft(1e4*n)&&(r=Number.NaN),[i,n,r]},at=function(){var t,e;return t=bt(arguments),e=st(t[0],t[1],t[2]),F(e[0],e[1],e[2])},_.lch=function(){var t;return t=bt(arguments),new r(t,"lch")},_.hcl=function(){var t;return t=bt(arguments),new r(t,"hcl")},p.lch=j,p.hcl=function(){var t;return t=bt(arguments),j([t[2],t[1],t[0]])},r.prototype.lch=function(){return at(this._rgb)},r.prototype.hcl=function(){return at(this._rgb).reverse()},K=function(t){var e,n,r,i,o,s;return null==t&&(t="rgb"),o=(s=bt(arguments))[0],r=s[1],e=s[2],r/=255,e/=255,[(1-(o/=255)-(i=1-Math.max(o,Math.max(r,e))))*(n=i<1?1/(1-i):0),(1-r-i)*n,(1-e-i)*n,i]},S=function(){var t,e,n,r,i,o;return n=(e=bt(arguments))[0],i=e[1],o=e[2],r=e[3],t=e.length>4?e[4]:1,1===r?[0,0,0,t]:[n>=1?0:255*(1-n)*(1-r),i>=1?0:255*(1-i)*(1-r),o>=1?0:255*(1-o)*(1-r),t]},p.cmyk=function(){return S(bt(arguments))},_.cmyk=function(){return function(t,e,n){n.prototype=t.prototype;var r=new n,i=t.apply(r,e);return Object(i)===i?i:r}(r,St.call(arguments).concat(["cmyk"]),function(){})},r.prototype.cmyk=function(){return K(this._rgb)},p.gl=function(){var t,e,n,r;for(r=(function(){var t,n;for(e in n=[],t=bt(arguments))n.push(t[e]);return n}).apply(this,arguments),t=n=0;n<=2;t=++n)r[t]*=255;return r},_.gl=function(){return function(t,e,n){n.prototype=t.prototype;var r=new n,i=t.apply(r,e);return Object(i)===i?i:r}(r,St.call(arguments).concat(["gl"]),function(){})},r.prototype.gl=function(){var t;return[(t=this._rgb)[0]/255,t[1]/255,t[2]/255,t[3]]},lt=function(t,e,n){var r;return e=(r=bt(arguments))[1],n=r[2],.2126*X(r[0])+.7152*(e=X(e))+.0722*X(n)},X=function(t){return(t/=255)<=.03928?t/12.92:J((t+.055)/1.055,2.4)},f.push(["rgb",function(t,e,n,i){var o,s;return new r((o=t._rgb)[0]+n*((s=e._rgb)[0]-o[0]),o[1]+n*(s[1]-o[1]),o[2]+n*(s[2]-o[2]),i)}]),r.prototype.luminance=function(t,e){var n,r,i,o,s;return null==e&&(e="rgb"),arguments.length?(o=this._rgb,0===t?o=[0,0,0,this._rgb[3]]:1===t?o=[255,255,255,this[3]]:(n=lt(this._rgb),r=1e-7,i=20,s=function(n,o){var a,l;return a=(l=n.interpolate(o,.5,e)).luminance(),Math.abs(t-a)<r||!i--?l:a>t?s(n,l):s(l,o)},o=n>t?s(_("black"),this).rgba():s(this,_("white")).rgba()),_(o).alpha(this.alpha())):lt(this._rgb)},yt=function(t){var e,n,r,i;return(i=t/100)<66?(r=255,n=-155.25485562709179-.44596950469579133*(n=i-2)+104.49216199393888*q(n),e=i<20?0:.8274096064007395*(e=i-10)-254.76935184120902+115.67994401066147*q(e)):(r=351.97690566805693+.114206453784165*(r=i-55)-40.25366309332127*q(r),n=325.4494125711974+.07943456536662342*(n=i-50)-28.0852963507957*q(n),e=255),[r,n,e]},ct=function(){var t,e,n,r,i,o,s;for(r=(i=bt(arguments))[0],t=i[2],n=1e3,e=4e4;e-n>.4;)(o=yt(s=.5*(e+n)))[2]/o[0]>=t/r?e=s:n=s;return ft(s)},_.temperature=_.kelvin=function(){return function(t,e,n){n.prototype=t.prototype;var r=new n,i=t.apply(r,e);return Object(i)===i?i:r}(r,St.call(arguments).concat(["temperature"]),function(){})},p.temperature=p.kelvin=p.K=yt,r.prototype.temperature=function(){return ct(this._rgb)},r.prototype.kelvin=r.prototype.temperature,_.contrast=function(t,e){var n,i,o,s;return"string"!==(o=wt(t))&&"number"!==o||(t=new r(t)),"string"!==(s=wt(e))&&"number"!==s||(e=new r(e)),(n=t.luminance())>(i=e.luminance())?(n+.05)/(i+.05):(i+.05)/(n+.05)},_.distance=function(t,e,n){var i,o,s,a,l,u,c;for(o in null==n&&(n="lab"),"string"!==(l=wt(t))&&"number"!==l||(t=new r(t)),"string"!==(u=wt(e))&&"number"!==u||(e=new r(e)),s=t.get(n),a=e.get(n),c=0,s)c+=(i=(s[o]||0)-(a[o]||0))*i;return Math.sqrt(c)},_.deltaE=function(t,e,n,i){var o,a,l,u,c,h,d,p,f,v,y,w,b,x,_,E,S,T,C,A,R,P,L,I;for(null==n&&(n=1),null==i&&(i=1),"string"!==(_=wt(t))&&"number"!==_||(t=new r(t)),"string"!==(E=wt(e))&&"number"!==E||(e=new r(e)),o=(S=t.lab())[0],l=S[1],c=S[2],a=(T=e.lab())[0],u=T[1],h=T[2],d=vt(l*l+c*c),p=vt(u*u+h*h),A=o<16?.511:.040975*o/(1+.01765*o),C=.0638*d/(1+.0131*d)+.638,x=d<1e-6?0:180*g(c,l)/s;x<0;)x+=360;for(;x>=360;)x-=360;return R=x>=164&&x<=345?.56+m(.2*M(s*(x+168)/180)):.36+m(.4*M(s*(x+35)/180)),b=vt((f=d*d*d*d)/(f+1900)),vt((P=(o-a)/(n*A))*P+(L=(w=d-p)/(i*C))*L+((v=l-u)*v+(y=c-h)*y-w*w)/((I=C*(b*R+1-b))*I))},r.prototype.get=function(t){var e,n,r,i,o;return e=(i=t.split("."))[1],o=this[r=i[0]](),e?(n=r.indexOf(e))>-1?o[n]:console.warn("unknown channel "+e+" in mode "+r):o},r.prototype.set=function(t,e){var n,r,i,o,s;if(i=(o=t.split("."))[0],n=o[1])if(s=this[i](),(r=i.indexOf(n))>-1)if("string"===wt(e))switch(e.charAt(0)){case"+":case"-":s[r]+=+e;break;case"*":s[r]*=+e.substr(1);break;case"/":s[r]/=+e.substr(1);break;default:s[r]=+e}else s[r]=e;else console.warn("unknown channel "+n+" in mode "+i);else s=e;return _(s,i).alpha(this.alpha())},r.prototype.clipped=function(){return this._rgb._clipped||!1},r.prototype.alpha=function(t){return arguments.length?_.rgb([this._rgb[0],this._rgb[1],this._rgb[2],t]):this._rgb[3]},r.prototype.darken=function(t){var e;return null==t&&(t=1),(e=this.lab())[0]-=o.Kn*t,_.lab(e).alpha(this.alpha())},r.prototype.brighten=function(t){return null==t&&(t=1),this.darken(-t)},r.prototype.darker=r.prototype.darken,r.prototype.brighter=r.prototype.brighten,r.prototype.saturate=function(t){var e;return null==t&&(t=1),(e=this.lch())[1]+=t*o.Kn,e[1]<0&&(e[1]=0),_.lch(e).alpha(this.alpha())},r.prototype.desaturate=function(t){return null==t&&(t=1),this.saturate(-t)},r.prototype.premultiply=function(){var t,e;return e=this.rgb(),t=this.alpha(),_(e[0]*t,e[1]*t,e[2]*t,t)},Z=function(t,e){return t*e/255},C=function(t,e){return t>e?e:t},H=function(t,e){return t>e?t:e},mt=function(t,e){return 255*(1-(1-t/255)*(1-e/255))},Q=function(t,e){return e<128?2*t*e/255:255*(1-2*(1-t/255)*(1-e/255))},x=function(t,e){return 255*(1-(1-e/255)/(t/255))},A=function(t,e){return 255===t?255:(t=e/255*255/(1-t/255))>255?255:t},(y=function(t,e,n){if(!y[n])throw"unknown blend mode "+n;return y[n](t,e)}).normal=(w=function(t){return function(e,n){var r,i;return r=_(n).rgb(),i=_(e).rgb(),_(t(r,i),"rgb")}})((R=function(t){return function(e,n){var r,i,o;for(o=[],r=i=0;i<=3;r=++i)o[r]=t(e[r],n[r]);return o}})(function(t,e){return t})),y.multiply=w(R(Z)),y.screen=w(R(mt)),y.overlay=w(R(Q)),y.darken=w(R(C)),y.lighten=w(R(H)),y.dodge=w(R(A)),y.burn=w(R(x)),_.blend=y,_.analyze=function(t){var e,n,r,i;for(r={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0},n=0,e=t.length;n<e;n++)null==(i=t[n])||isNaN(i)||(r.values.push(i),r.sum+=i,i<r.min&&(r.min=i),i>r.max&&(r.max=i),r.count+=1);return r.domain=[r.min,r.max],r.limits=function(t,e){return _.limits(r,t,e)},r},_.scale=function(t,e){var n,r,i,o,s,a,l,u,c,h,d,p,f,m,g,v,y,w,b,x,E;return c="rgb",h=_("#ccc"),m=0,s=[0,1],f=[],p=[0,0],n=!1,i=[],d=!1,u=0,l=1,o=!1,r={},g=!0,a=1,x=function(t){var e,n,r,o,s,a;if(null==t&&(t=["#fff","#000"]),null!=t&&"string"===wt(t)&&null!=_.brewer&&(t=_.brewer[t]||_.brewer[t.toLowerCase()]||t),"array"===wt(t)){for(e=r=0,o=(t=t.slice(0)).length-1;0<=o?r<=o:r>=o;e=0<=o?++r:--r)"string"===wt(n=t[e])&&(t[e]=_(n));for(f.length=0,e=a=0,s=t.length-1;0<=s?a<=s:a>=s;e=0<=s?++a:--a)f.push(e/(t.length-1))}return b(),i=t},y=function(t){var e,r;if(null!=n){for(r=n.length-1,e=0;e<r&&t>=n[e];)e++;return e-1}return 0},E=function(t){return t},w=function(t,e){var o,s,d,m,v,w,b;if(null==e&&(e=!1),isNaN(t))return h;if(b=e?t:n&&n.length>2?y(t)/(n.length-2):l!==u?(t-u)/(l-u):1,e||(b=E(b)),1!==a&&(b=J(b,a)),b=p[0]+b*(1-p[0]-p[1]),b=Math.min(1,Math.max(0,b)),d=Math.floor(1e4*b),g&&r[d])o=r[d];else{if("array"===wt(i))for(s=m=0,w=f.length-1;0<=w?m<=w:m>=w;s=0<=w?++m:--m){if(b<=(v=f[s])){o=i[s];break}if(b>=v&&s===f.length-1){o=i[s];break}if(b>v&&b<f[s+1]){o=_.interpolate(i[s],i[s+1],b=(b-v)/(f[s+1]-v),c);break}}else"function"===wt(i)&&(o=i(b));g&&(r[d]=o)}return o},b=function(){return r={}},x(t),(v=function(t){var e;return e=_(w(t)),d&&e[d]?e[d]():e}).classes=function(t){var e;return null!=t?("array"===wt(t)?(n=t,s=[t[0],t[t.length-1]]):(e=_.analyze(s),n=0===t?[e.min,e.max]:_.limits(e,"e",t)),v):n},v.domain=function(t){var e,n,r,o,a,c;if(!arguments.length)return s;if(u=t[0],l=t[t.length-1],f=[],t.length===(n=i.length)&&u!==l)for(o=0,r=t.length;o<r;o++)f.push((t[o]-u)/(l-u));else for(e=c=0,a=n-1;0<=a?c<=a:c>=a;e=0<=a?++c:--c)f.push(e/(n-1));return s=[u,l],v},v.mode=function(t){return arguments.length?(c=t,b(),v):c},v.range=function(t,e){return x(t),v},v.out=function(t){return d=t,v},v.spread=function(t){return arguments.length?(m=t,v):m},v.correctLightness=function(t){return null==t&&(t=!0),o=t,b(),E=o?function(t){var e,n,r,i,o,s,a,l;for(s=(e=w(0,!0).lab()[0])>(n=w(1,!0).lab()[0]),r=w(t,!0).lab()[0]-(i=e+(n-e)*t),a=0,l=1,o=20;Math.abs(r)>.01&&o-- >0;)s&&(r*=-1),r<0?(a=t,t+=.5*(l-t)):(l=t,t+=.5*(a-t)),r=w(t,!0).lab()[0]-i;return t}:function(t){return t},v},v.padding=function(t){return null!=t?("number"===wt(t)&&(t=[t,t]),p=t,v):p},v.colors=function(e,r){var o,a,l,u,c,h,d,p;if(arguments.length<2&&(r="hex"),c=[],0===arguments.length)c=i.slice(0);else if(1===e)c=[v(.5)];else if(e>1)o=s[1]-(a=s[0]),c=(function(){h=[];for(var t=0;0<=e?t<e:t>e;0<=e?t++:t--)h.push(t);return h}).apply(this).map(function(t){return v(a+t/(e-1)*o)});else{if(t=[],d=[],n&&n.length>2)for(l=p=1,u=n.length;1<=u?p<u:p>u;l=1<=u?++p:--p)d.push(.5*(n[l-1]+n[l]));else d=s;c=d.map(function(t){return v(t)})}return _[r]&&(c=c.map(function(t){return t[r]()})),c},v.cache=function(t){return null!=t?(g=t,v):g},v.gamma=function(t){return null!=t?(a=t,v):a},v},null==_.scales&&(_.scales={}),_.scales.cool=function(){return _.scale([_.hsl(180,1,.9),_.hsl(250,.7,.4)])},_.scales.hot=function(){return _.scale(["#000","#f00","#ff0","#fff"],[0,.25,.75,1]).mode("rgb")},_.analyze=function(t,e,n){var r,i,o,s,a,l;if(a={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0},null==n&&(n=function(){return!0}),r=function(t){null==t||isNaN(t)||(a.values.push(t),a.sum+=t,t<a.min&&(a.min=t),t>a.max&&(a.max=t),a.count+=1)},l=function(t,i){if(n(t,i))return null!=e&&"function"===wt(e)?r(e(t)):null!=e&&"string"===wt(e)||"number"===wt(e)?r(t[e]):r(t)},"array"===wt(t))for(s=0,o=t.length;s<o;s++)l(t[s]);else for(i in t)l(t[i],i);return a.domain=[a.min,a.max],a.limits=function(t,e){return _.limits(a,t,e)},a},_.limits=function(t,e,n){var r,i,o,s,a,l,u,c,h,d,p,f,g,v,y,w,b,x,E,S,M,T,C,A,R,L,I,N,O,D,B,U,z,F,k,V,G,j,H,W,X,Z,$,Q,K,tt,et,nt,rt,it,ot,st,at,lt,ut;if(null==e&&(e="equal"),null==n&&(n=7),"array"===wt(t)&&(t=_.analyze(t)),R=t.min,Y=t.max,lt=t.values.sort(function(t,e){return t-e}),1===n)return[R,Y];if(C=[],"c"===e.substr(0,1)&&(C.push(R),C.push(Y)),"e"===e.substr(0,1)){for(C.push(R),S=B=1,k=n-1;1<=k?B<=k:B>=k;S=1<=k?++B:--B)C.push(R+S/n*(Y-R));C.push(Y)}else if("l"===e.substr(0,1)){if(R<=0)throw"Logarithmic scales are only possible for values > 0";for(L=Math.LOG10E*q(R),A=Math.LOG10E*q(Y),C.push(R),S=ut=1,V=n-1;1<=V?ut<=V:ut>=V;S=1<=V?++ut:--ut)C.push(J(10,L+S/n*(A-L)));C.push(Y)}else if("q"===e.substr(0,1)){for(C.push(R),S=r=1,Z=n-1;1<=Z?r<=Z:r>=Z;S=1<=Z?++r:--r)z=P(U=(lt.length-1)*S/n),C.push(z===U?lt[z]:lt[z]*(1-(F=U-z))+lt[z+1]*F);C.push(Y)}else if("k"===e.substr(0,1)){for(N=lt.length,v=new Array(N),x=new Array(n),it=!0,O=0,w=null,(w=[]).push(R),S=i=1,$=n-1;1<=$?i<=$:i>=$;S=1<=$?++i:--i)w.push(R+S/n*(Y-R));for(w.push(Y);it;){for(M=o=0,Q=n-1;0<=Q?o<=Q:o>=Q;M=0<=Q?++o:--o)x[M]=0;for(S=s=0,K=N-1;0<=K?s<=K:s>=K;S=0<=K?++s:--s){for(at=lt[S],I=Number.MAX_VALUE,M=a=0,tt=n-1;0<=tt?a<=tt:a>=tt;M=0<=tt?++a:--a)(E=m(w[M]-at))<I&&(I=E,y=M);x[y]++,v[S]=y}for(D=new Array(n),M=l=0,et=n-1;0<=et?l<=et:l>=et;M=0<=et?++l:--l)D[M]=null;for(S=u=0,nt=N-1;0<=nt?u<=nt:u>=nt;S=0<=nt?++u:--u)null===D[b=v[S]]?D[b]=lt[S]:D[b]+=lt[S];for(M=c=0,rt=n-1;0<=rt?c<=rt:c>=rt;M=0<=rt?++c:--c)D[M]*=1/x[M];for(it=!1,M=h=0,G=n-1;0<=G?h<=G:h>=G;M=0<=G?++h:--h)if(D[M]!==w[S]){it=!0;break}w=D,++O>200&&(it=!1)}for(T={},M=d=0,j=n-1;0<=j?d<=j:d>=j;M=0<=j?++d:--d)T[M]=[];for(S=p=0,H=N-1;0<=H?p<=H:p>=H;S=0<=H?++p:--p)T[b=v[S]].push(lt[S]);for(ot=[],M=f=0,W=n-1;0<=W?f<=W:f>=W;M=0<=W?++f:--f)ot.push(T[M][0]),ot.push(T[M][T[M].length-1]);for(ot=ot.sort(function(t,e){return t-e}),C.push(ot[0]),S=g=1,X=ot.length-1;g<=X;S=g+=2)st=ot[S],isNaN(st)||-1!==C.indexOf(st)||C.push(st)}return C},N=function(t,e,n){var r,i,o,s;return t=(r=bt(arguments))[0],e=r[1],n=r[2],isNaN(t)&&(t=0),(t/=360)<1/3?o=1-((i=(1-e)/3)+(s=(1+e*M(u*t)/M(a-u*t))/3)):t<2/3?i=1-((s=(1-e)/3)+(o=(1+e*M(u*(t-=1/3))/M(a-u*t))/3)):s=1-((o=(1-e)/3)+(i=(1+e*M(u*(t-=2/3))/M(a-u*t))/3)),[255*(s=W(n*s*3)),255*(o=W(n*o*3)),255*(i=W(n*i*3)),r.length>3?r[3]:1]},rt=function(){var t,e,n,r,i,o,s;return i=(o=bt(arguments))[0],e=o[1],t=o[2],u=2*Math.PI,i/=255,e/=255,t/=255,0==(s=1-Math.min(i,e,t)/(r=(i+e+t)/3))?n=0:(n=(i-e+(i-t))/2,n/=Math.sqrt((i-e)*(i-e)+(i-t)*(e-t)),n=Math.acos(n),t>e&&(n=u-n),n/=u),[360*n,s,r]},_.hsi=function(){return function(t,e,n){n.prototype=t.prototype;var r=new n,i=t.apply(r,e);return Object(i)===i?i:r}(r,St.call(arguments).concat(["hsi"]),function(){})},p.hsi=N,r.prototype.hsi=function(){return rt(this._rgb)},z=function(t,e,n,r){var i,o,s,a,l,u,c,h,d,p;return"hsl"===r?(d=t.hsl(),p=e.hsl()):"hsv"===r?(d=t.hsv(),p=e.hsv()):"hcg"===r?(d=t.hcg(),p=e.hcg()):"hsi"===r?(d=t.hsi(),p=e.hsi()):"lch"!==r&&"hcl"!==r||(r="hcl",d=t.hcl(),p=e.hcl()),"h"===r.substr(0,1)&&(o=d[0],c=d[1],a=d[2],s=p[0],h=p[1],l=p[2]),isNaN(o)||isNaN(s)?isNaN(o)?isNaN(s)?i=Number.NaN:(i=s,1!==a&&0!==a||"hsv"===r||(u=h)):(i=o,1!==l&&0!==l||"hsv"===r||(u=c)):i=o+n*(s>o&&s-o>180?s-(o+360):s<o&&o-s>180?s+360-o:s-o),null==u&&(u=c+n*(h-c)),_[r](i,u,a+n*(l-a))},(f=f.concat(function(){var t,e,n,r;for(r=[],e=0,t=(n=["hsv","hsl","hsi","hcl","lch","hcg"]).length;e<t;e++)r.push([n[e],z]);return r}())).push(["num",function(t,e,n,r){var i,o;return i=t.num(),o=e.num(),_.num(i+(o-i)*n,"num")}]),f.push(["lab",function(t,e,n,i){var o,s;return o=t.lab(),s=e.lab(),new r(o[0]+n*(s[0]-o[0]),o[1]+n*(s[1]-o[1]),o[2]+n*(s[2]-o[2]),i)}])}).call(this)}).call(this,n("YuTi")(t))},YuTi:function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},b0Xh:function(t,e,r){var i;(function(){var r=!1,o=function(t){return t instanceof o?t:this instanceof o?void(this.EXIFwrapped=t):new o(t)};void 0!==t&&t.exports&&(e=t.exports=o),e.EXIF=o;var s=o.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},a=o.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},l=o.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},u=o.IFD1Tags={256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",296:"ResolutionUnit",513:"JpegIFOffset",514:"JpegIFByteCount",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite"},c=o.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}};function h(t){return!!t.exifdata}function d(t){var e=new DataView(t);if(r&&console.log("Got file of length "+t.byteLength),255!=e.getUint8(0)||216!=e.getUint8(1))return r&&console.log("Not a valid JPEG"),!1;for(var n,i=2,o=t.byteLength;i<o;){if(255!=e.getUint8(i))return r&&console.log("Not a valid marker at offset "+i+", found: "+e.getUint8(i)),!1;if(n=e.getUint8(i+1),r&&console.log(n),225==n)return r&&console.log("Found 0xFFE1 marker"),y(e,i+4,e.getUint16(i+2));i+=2+e.getUint16(i+2)}}var p={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};function f(t,e,n){for(var r,i,o,s,a=new DataView(t),l={},u=e;u<e+n;)28===a.getUint8(u)&&2===a.getUint8(u+1)&&(s=a.getUint8(u+2))in p&&(o=a.getInt16(u+3),i=p[s],r=v(a,u+5,o),l.hasOwnProperty(i)?l[i]instanceof Array?l[i].push(r):l[i]=[l[i],r]:l[i]=r),u++;return l}function m(t,e,n,i,o){var s,a,l,u=t.getUint16(n,!o),c={};for(l=0;l<u;l++)!(a=i[t.getUint16(s=n+12*l+2,!o)])&&r&&console.log("Unknown tag: "+t.getUint16(s,!o)),c[a]=g(t,s,e,0,o);return c}function g(t,e,n,r,i){var o,s,a,l,u,c,h=t.getUint16(e+2,!i),d=t.getUint32(e+4,!i),p=t.getUint32(e+8,!i)+n;switch(h){case 1:case 7:if(1==d)return t.getUint8(e+8,!i);for(o=d>4?p:e+8,s=[],l=0;l<d;l++)s[l]=t.getUint8(o+l);return s;case 2:return v(t,o=d>4?p:e+8,d-1);case 3:if(1==d)return t.getUint16(e+8,!i);for(o=d>2?p:e+8,s=[],l=0;l<d;l++)s[l]=t.getUint16(o+2*l,!i);return s;case 4:if(1==d)return t.getUint32(e+8,!i);for(s=[],l=0;l<d;l++)s[l]=t.getUint32(p+4*l,!i);return s;case 5:if(1==d)return u=t.getUint32(p,!i),c=t.getUint32(p+4,!i),(a=new Number(u/c)).numerator=u,a.denominator=c,a;for(s=[],l=0;l<d;l++)u=t.getUint32(p+8*l,!i),c=t.getUint32(p+4+8*l,!i),s[l]=new Number(u/c),s[l].numerator=u,s[l].denominator=c;return s;case 9:if(1==d)return t.getInt32(e+8,!i);for(s=[],l=0;l<d;l++)s[l]=t.getInt32(p+4*l,!i);return s;case 10:if(1==d)return t.getInt32(p,!i)/t.getInt32(p+4,!i);for(s=[],l=0;l<d;l++)s[l]=t.getInt32(p+8*l,!i)/t.getInt32(p+4+8*l,!i);return s}}function v(t,e,r){var i="";for(n=e;n<e+r;n++)i+=String.fromCharCode(t.getUint8(n));return i}function y(t,e){if("Exif"!=v(t,e,4))return r&&console.log("Not valid EXIF data! "+v(t,e,4)),!1;var n,i,o,h,d,p=e+6;if(18761==t.getUint16(p))n=!1;else{if(19789!=t.getUint16(p))return r&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),!1;n=!0}if(42!=t.getUint16(p+2,!n))return r&&console.log("Not valid TIFF data! (no 0x002A)"),!1;var f=t.getUint32(p+4,!n);if(f<8)return r&&console.log("Not valid TIFF data! (First offset less than 8)",t.getUint32(p+4,!n)),!1;if((i=m(t,p,p+f,a,n)).ExifIFDPointer)for(o in h=m(t,p,p+i.ExifIFDPointer,s,n)){switch(o){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":h[o]=c[o][h[o]];break;case"ExifVersion":case"FlashpixVersion":h[o]=String.fromCharCode(h[o][0],h[o][1],h[o][2],h[o][3]);break;case"ComponentsConfiguration":h[o]=c.Components[h[o][0]]+c.Components[h[o][1]]+c.Components[h[o][2]]+c.Components[h[o][3]]}i[o]=h[o]}if(i.GPSInfoIFDPointer)for(o in d=m(t,p,p+i.GPSInfoIFDPointer,l,n)){switch(o){case"GPSVersionID":d[o]=d[o][0]+"."+d[o][1]+"."+d[o][2]+"."+d[o][3]}i[o]=d[o]}return i.thumbnail=function(t,e,n,r){var i=function(t,e,n){var r=t.getUint16(e,!n);return t.getUint32(e+2+12*r,!n)}(t,e+n,r);if(!i)return{};if(i>t.byteLength)return{};var o=m(t,e,e+i,u,r);if(o.Compression)switch(o.Compression){case 6:o.JpegIFOffset&&o.JpegIFByteCount&&(o.blob=new Blob([new Uint8Array(t.buffer,e+o.JpegIFOffset,o.JpegIFByteCount)],{type:"image/jpeg"}));break;case 1:console.log("Thumbnail image format is TIFF, which is not implemented.");break;default:console.log("Unknown thumbnail image format '%s'",o.Compression)}else 2==o.PhotometricInterpretation&&console.log("Thumbnail image format is RGB, which is not implemented.");return o}(t,p,f,n),i}function w(t){var e={};if(1==t.nodeType){if(t.attributes.length>0){e["@attributes"]={};for(var n=0;n<t.attributes.length;n++){var r=t.attributes.item(n);e["@attributes"][r.nodeName]=r.nodeValue}}}else if(3==t.nodeType)return t.nodeValue;if(t.hasChildNodes())for(var i=0;i<t.childNodes.length;i++){var o=t.childNodes.item(i),s=o.nodeName;if(null==e[s])e[s]=w(o);else{if(null==e[s].push){var a=e[s];e[s]=[],e[s].push(a)}e[s].push(w(o))}}return e}function b(t){try{var e={};if(t.children.length>0)for(var n=0;n<t.children.length;n++){var r=t.children.item(n),i=r.attributes;for(var o in i){var s=i[o],a=s.nodeName;void 0!==a&&(e[a]=s.nodeValue)}var l=r.nodeName;if(void 0===e[l])e[l]=w(r);else{if(void 0===e[l].push){var u=e[l];e[l]=[],e[l].push(u)}e[l].push(w(r))}}else e=t.textContent;return e}catch(t){console.log(t.message)}}o.enableXmp=function(){o.isXmpEnabled=!0},o.disableXmp=function(){o.isXmpEnabled=!1},o.getData=function(t,e){return!((self.Image&&t instanceof self.Image||self.HTMLImageElement&&t instanceof self.HTMLImageElement)&&!t.complete||(h(t)?e&&e.call(t):function(t,e){function n(n){var i=d(n);t.exifdata=i||{};var s=function(t){var e=new DataView(t);if(r&&console.log("Got file of length "+t.byteLength),255!=e.getUint8(0)||216!=e.getUint8(1))return r&&console.log("Not a valid JPEG"),!1;for(var n=2,i=t.byteLength,o=function(t,e){return 56===t.getUint8(e)&&66===t.getUint8(e+1)&&73===t.getUint8(e+2)&&77===t.getUint8(e+3)&&4===t.getUint8(e+4)&&4===t.getUint8(e+5)};n<i;){if(o(e,n)){var s=e.getUint8(n+7);return s%2!=0&&(s+=1),0===s&&(s=4),f(t,n+8+s,e.getUint16(n+6+s))}n++}}(n);if(t.iptcdata=s||{},o.isXmpEnabled){var a=function(t){if("DOMParser"in self){var e=new DataView(t);if(r&&console.log("Got file of length "+t.byteLength),255!=e.getUint8(0)||216!=e.getUint8(1))return r&&console.log("Not a valid JPEG"),!1;for(var n=2,i=t.byteLength,o=new DOMParser;n<i-4;){if("http"==v(e,n,4)){var s=v(e,n-1,e.getUint16(n-2)-1),a=s.indexOf("xmpmeta>")+8,l=(s=s.substring(s.indexOf("<x:xmpmeta"),a)).indexOf("x:xmpmeta")+10;return s=s.slice(0,l)+'xmlns:Iptc4xmpCore="http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:tiff="http://ns.adobe.com/tiff/1.0/" xmlns:plus="http://schemas.android.com/apk/lib/com.google.android.gms.plus" xmlns:ext="http://www.gettyimages.com/xsltExtension/1.0" xmlns:exif="http://ns.adobe.com/exif/1.0/" xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#" xmlns:stRef="http://ns.adobe.com/xap/1.0/sType/ResourceRef#" xmlns:crs="http://ns.adobe.com/camera-raw-settings/1.0/" xmlns:xapGImg="http://ns.adobe.com/xap/1.0/g/img/" xmlns:Iptc4xmpExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/" '+s.slice(l),b(o.parseFromString(s,"text/xml"))}n++}}}(n);t.xmpdata=a||{}}e&&e.call(t)}if(t.src)if(/^data\:/i.test(t.src))n(function(t,e){e=e||t.match(/^data\:([^\;]+)\;base64,/im)[1]||"",t=t.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var n=atob(t),r=n.length,i=new ArrayBuffer(r),o=new Uint8Array(i),s=0;s<r;s++)o[s]=n.charCodeAt(s);return i}(t.src));else if(/^blob\:/i.test(t.src))(s=new FileReader).onload=function(t){n(t.target.result)},function(t,e){var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="blob",n.onload=function(t){200!=this.status&&0!==this.status||function(t){s.readAsArrayBuffer(t)}(this.response)},n.send()}(t.src);else{var i=new XMLHttpRequest;i.onload=function(){if(200!=this.status&&0!==this.status)throw"Could not load image";n(i.response),i=null},i.open("GET",t.src,!0),i.responseType="arraybuffer",i.send(null)}else if(self.FileReader&&(t instanceof self.Blob||t instanceof self.File)){var s;(s=new FileReader).onload=function(t){r&&console.log("Got file of length "+t.target.result.byteLength),n(t.target.result)},s.readAsArrayBuffer(t)}}(t,e),0))},o.getTag=function(t,e){if(h(t))return t.exifdata[e]},o.getIptcTag=function(t,e){if(h(t))return t.iptcdata[e]},o.getAllTags=function(t){if(!h(t))return{};var e,n=t.exifdata,r={};for(e in n)n.hasOwnProperty(e)&&(r[e]=n[e]);return r},o.getAllIptcTags=function(t){if(!h(t))return{};var e,n=t.iptcdata,r={};for(e in n)n.hasOwnProperty(e)&&(r[e]=n[e]);return r},o.pretty=function(t){if(!h(t))return"";var e,n=t.exifdata,r="";for(e in n)n.hasOwnProperty(e)&&("object"==typeof n[e]?n[e]instanceof Number?r+=e+" : "+n[e]+" ["+n[e].numerator+"/"+n[e].denominator+"]\r\n":r+=e+" : ["+n[e].length+" values]\r\n":r+=e+" : "+n[e]+"\r\n");return r},o.readFromBinaryFile=function(t){return d(t)},void 0===(i=(function(){return o}).apply(e,[]))||(t.exports=i)}).call(this)},crnd:function(t,e){function n(t){return Promise.resolve().then(function(){var e=new Error('Cannot find module "'+t+'".');throw e.code="MODULE_NOT_FOUND",e})}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="crnd"},pdRg:function(t,e,n){var r,i=window.THREE||n("Womt");t.exports=r=function(t,e){var n=this,r={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.noPitch=!1,this.noYaw=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.target=new i.Vector3;var o=new i.Vector3,s=r.NONE,a=r.NONE,l=new i.Vector3,u=new i.Vector2,c=new i.Vector2,h=new i.Vector3,d=0,p=new i.Vector2,f=new i.Vector2,m=0,g=0,v=new i.Vector2,y=new i.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone();var w={type:"change"},b={type:"start"},x={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var t=this.domElement.getBoundingClientRect(),e=this.domElement.ownerDocument.documentElement;this.screen.left=t.left+window.pageXOffset-e.clientLeft,this.screen.top=t.top+window.pageYOffset-e.clientTop,this.screen.width=t.width,this.screen.height=t.height}},this.handleEvent=function(t){"function"==typeof this[t.type]&&this[t.type](t)};var _=function(){var t=new i.Vector2;return function(e,r){return t.set((e-n.screen.left)/n.screen.width,(r-n.screen.top)/n.screen.height),t}}(),E=function(){var t=new i.Vector2;return function(e,r){return n.noPitch&&(r=0),n.noYaw&&(e=0),t.set((e-.5*n.screen.width-n.screen.left)/(.5*n.screen.width),(n.screen.height+2*(n.screen.top-r))/n.screen.width),t}}();function S(t,e){return Array.isArray(t)?-1!==t.indexOf(e):t===e}function M(t){!1!==n.enabled&&(window.removeEventListener("keydown",M),a=s,s===r.NONE&&(S(n.keys[r.ROTATE],t.keyCode)&&!n.noRotate?s=r.ROTATE:S(n.keys[r.ZOOM],t.keyCode)&&!n.noZoom?s=r.ZOOM:S(n.keys[r.PAN],t.keyCode)&&!n.noPan&&(s=r.PAN)))}function T(t){!1!==n.enabled&&(s=a,window.addEventListener("keydown",M,!1))}function C(t){!1!==n.enabled&&(t.preventDefault(),t.stopPropagation(),s===r.NONE&&(s=t.button),s!==r.ROTATE||n.noRotate?s!==r.ZOOM||n.noZoom?s!==r.PAN||n.noPan||(v.copy(_(t.pageX,t.pageY)),y.copy(v)):(p.copy(_(t.pageX,t.pageY)),f.copy(p)):(c.copy(E(t.pageX,t.pageY)),u.copy(c)),document.addEventListener("mousemove",A,!1),document.addEventListener("mouseup",R,!1),n.dispatchEvent(b))}function A(t){!1!==n.enabled&&(t.preventDefault(),t.stopPropagation(),s!==r.ROTATE||n.noRotate?s!==r.ZOOM||n.noZoom?s!==r.PAN||n.noPan||y.copy(_(t.pageX,t.pageY)):f.copy(_(t.pageX,t.pageY)):(u.copy(c),c.copy(E(t.pageX,t.pageY))))}function R(t){!1!==n.enabled&&(t.preventDefault(),t.stopPropagation(),s=r.NONE,document.removeEventListener("mousemove",A),document.removeEventListener("mouseup",R),n.dispatchEvent(x))}function P(t){if(!1!==n.enabled){switch(t.preventDefault(),t.stopPropagation(),t.deltaMode){case 2:p.y-=.025*t.deltaY;break;case 1:p.y-=.01*t.deltaY;break;default:p.y-=25e-5*t.deltaY}n.dispatchEvent(b),n.dispatchEvent(x)}}function L(t){if(!1!==n.enabled){switch(t.touches.length){case 1:s=r.TOUCH_ROTATE,c.copy(E(t.touches[0].pageX,t.touches[0].pageY)),u.copy(c);break;default:s=r.TOUCH_ZOOM_PAN;var e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY;g=m=Math.sqrt(e*e+i*i),v.copy(_((t.touches[0].pageX+t.touches[1].pageX)/2,(t.touches[0].pageY+t.touches[1].pageY)/2)),y.copy(v)}n.dispatchEvent(b)}}function I(t){if(!1!==n.enabled)switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:u.copy(c),c.copy(E(t.touches[0].pageX,t.touches[0].pageY));break;default:var e=t.touches[0].pageX-t.touches[1].pageX,r=t.touches[0].pageY-t.touches[1].pageY;g=Math.sqrt(e*e+r*r),y.copy(_((t.touches[0].pageX+t.touches[1].pageX)/2,(t.touches[0].pageY+t.touches[1].pageY)/2))}}function N(t){if(!1!==n.enabled){switch(t.touches.length){case 0:s=r.NONE;break;case 1:s=r.TOUCH_ROTATE,c.copy(E(t.touches[0].pageX,t.touches[0].pageY)),u.copy(c)}n.dispatchEvent(x)}}function O(t){!1!==n.enabled&&t.preventDefault()}this.rotateCamera=function(){var t,e=new i.Vector3,r=new i.Quaternion,o=new i.Vector3,s=new i.Vector3,a=new i.Vector3,p=new i.Vector3;return function(){p.set(c.x-u.x,c.y-u.y,0),(t=p.length())?(l.copy(n.object.position).sub(n.target),o.copy(l).normalize(),s.copy(n.object.up).normalize(),a.crossVectors(s,o).normalize(),s.setLength(c.y-u.y),a.setLength(c.x-u.x),p.copy(s.add(a)),e.crossVectors(p,l).normalize(),r.setFromAxisAngle(e,t*=n.rotateSpeed),l.applyQuaternion(r),n.object.up.applyQuaternion(r),h.copy(e),d=t):!n.staticMoving&&d&&(d*=Math.sqrt(1-n.dynamicDampingFactor),l.copy(n.object.position).sub(n.target),r.setFromAxisAngle(h,d),l.applyQuaternion(r),n.object.up.applyQuaternion(r)),u.copy(c)}}(),this.zoomCamera=function(){var t;s===r.TOUCH_ZOOM_PAN?(t=m/g,m=g,l.multiplyScalar(t)):(1!=(t=1+(f.y-p.y)*n.zoomSpeed)&&t>0&&l.multiplyScalar(t),n.staticMoving?p.copy(f):p.y+=(f.y-p.y)*this.dynamicDampingFactor)},this.panCamera=function(){var t=new i.Vector2,e=new i.Vector3,r=new i.Vector3;return function(){t.copy(y).sub(v),t.lengthSq()&&(t.multiplyScalar(l.length()*n.panSpeed),r.copy(l).cross(n.object.up).setLength(t.x),r.add(e.copy(n.object.up).setLength(t.y)),n.object.position.add(r),n.target.add(r),n.staticMoving?v.copy(y):v.add(t.subVectors(y,v).multiplyScalar(n.dynamicDampingFactor)))}}(),this.checkDistances=function(){n.noZoom&&n.noPan||(l.lengthSq()>n.maxDistance*n.maxDistance&&(n.object.position.addVectors(n.target,l.setLength(n.maxDistance)),p.copy(f)),l.lengthSq()<n.minDistance*n.minDistance&&(n.object.position.addVectors(n.target,l.setLength(n.minDistance)),p.copy(f)))},this.update=function(){l.subVectors(n.object.position,n.target),n.noRotate||n.rotateCamera(),n.noZoom||n.zoomCamera(),n.noPan||n.panCamera(),n.object.position.addVectors(n.target,l),n.checkDistances(),n.object.lookAt(n.target),o.distanceToSquared(n.object.position)>1e-6&&(n.dispatchEvent(w),o.copy(n.object.position))},this.reset=function(){s=r.NONE,a=r.NONE,n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.up.copy(n.up0),l.subVectors(n.object.position,n.target),n.object.lookAt(n.target),n.dispatchEvent(w),o.copy(n.object.position)},this.dispose=function(){this.domElement.removeEventListener("contextmenu",O,!1),this.domElement.removeEventListener("mousedown",C,!1),this.domElement.removeEventListener("wheel",P,!1),this.domElement.removeEventListener("touchstart",L,!1),this.domElement.removeEventListener("touchend",N,!1),this.domElement.removeEventListener("touchmove",I,!1),document.removeEventListener("mousemove",A,!1),document.removeEventListener("mouseup",R,!1),window.removeEventListener("keydown",M,!1),window.removeEventListener("keyup",T,!1)},this.domElement.addEventListener("contextmenu",O,!1),this.domElement.addEventListener("mousedown",C,!1),this.domElement.addEventListener("wheel",P,!1),this.domElement.addEventListener("touchstart",L,!1),this.domElement.addEventListener("touchend",N,!1),this.domElement.addEventListener("touchmove",I,!1),window.addEventListener("keydown",M,!1),window.addEventListener("keyup",T,!1),this.handleResize(),this.update()},r.prototype=Object.create(i.EventDispatcher.prototype)},zUnb:function(t,e,n){"use strict";n.r(e);const r="undefined"!=typeof window&&window,i="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,o="undefined"!=typeof global&&global,s=r||o||i;function a(t){return"function"==typeof t}!function(){if(!s)throw new Error("RxJS could not find any global context (window, self, global)")}();const l=Array.isArray||(t=>t&&"number"==typeof t.length);function u(t){return null!=t&&"object"==typeof t}const c={e:{}};let h;function d(){try{return h.apply(this,arguments)}catch(t){return c.e=t,c}}function p(t){return h=t,d}class f extends Error{constructor(t){super(),this.errors=t;const e=Error.call(this,t?`${t.length} errors occurred during unsubscription:\n  ${t.map((t,e)=>`${e+1}) ${t.toString()}`).join("\n  ")}`:"");this.name=e.name="UnsubscriptionError",this.stack=e.stack,this.message=e.message}}class m{constructor(t){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}unsubscribe(){let t,e=!1;if(this.closed)return;let{_parent:n,_parents:r,_unsubscribe:i,_subscriptions:o}=this;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;let s=-1,h=r?r.length:0;for(;n;)n.remove(this),n=++s<h&&r[s]||null;if(a(i)&&p(i).call(this)===c&&(e=!0,t=t||(c.e instanceof f?g(c.e.errors):[c.e])),l(o))for(s=-1,h=o.length;++s<h;){const n=o[s];if(u(n)&&p(n.unsubscribe).call(n)===c){e=!0,t=t||[];let n=c.e;n instanceof f?t=t.concat(g(n.errors)):t.push(n)}}if(e)throw new f(t)}add(t){if(!t||t===m.EMPTY)return m.EMPTY;if(t===this)return this;let e=t;switch(typeof t){case"function":e=new m(t);case"object":if(e.closed||"function"!=typeof e.unsubscribe)return e;if(this.closed)return e.unsubscribe(),e;if("function"!=typeof e._addParent){const t=e;(e=new m)._subscriptions=[t]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(e),e._addParent(this),e}remove(t){const e=this._subscriptions;if(e){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}}_addParent(t){let{_parent:e,_parents:n}=this;e&&e!==t?n?-1===n.indexOf(t)&&n.push(t):this._parents=[t]:this._parent=t}}function g(t){return t.reduce((t,e)=>t.concat(e instanceof f?e.errors:e),[])}m.EMPTY=function(t){return t.closed=!0,t}(new m);const v={closed:!0,next(t){},error(t){throw t},complete(){}},y=s.Symbol,w="function"==typeof y&&"function"==typeof y.for?y.for("rxSubscriber"):"@@rxSubscriber";class b extends m{constructor(t,e,n){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=v;break;case 1:if(!t){this.destination=v;break}if("object"==typeof t){if(t instanceof b||"syncErrorThrowable"in t&&t[w]){const e=t[w]();this.syncErrorThrowable=e.syncErrorThrowable,this.destination=e,e.add(this)}else this.syncErrorThrowable=!0,this.destination=new x(this,t);break}default:this.syncErrorThrowable=!0,this.destination=new x(this,t,e,n)}}[w](){return this}static create(t,e,n){const r=new b(t,e,n);return r.syncErrorThrowable=!1,r}next(t){this.isStopped||this._next(t)}error(t){this.isStopped||(this.isStopped=!0,this._error(t))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(t){this.destination.next(t)}_error(t){this.destination.error(t),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parent:t,_parents:e}=this;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=e,this}}class x extends b{constructor(t,e,n,r){let i;super(),this._parentSubscriber=t;let o=this;a(e)?i=e:e&&(i=e.next,n=e.error,r=e.complete,e!==v&&(a((o=Object.create(e)).unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=i,this._error=n,this._complete=r}next(t){if(!this.isStopped&&this._next){const{_parentSubscriber:e}=this;e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}}error(t){if(!this.isStopped){const{_parentSubscriber:e}=this;if(this._error)e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else{if(!e.syncErrorThrowable)throw this.unsubscribe(),t;e.syncErrorValue=t,e.syncErrorThrown=!0,this.unsubscribe()}}}complete(){if(!this.isStopped){const{_parentSubscriber:t}=this;if(this._complete){const e=()=>this._complete.call(this._context);t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(t,e){try{t.call(this._context,e)}catch(t){throw this.unsubscribe(),t}}__tryOrSetError(t,e,n){try{e.call(this._context,n)}catch(e){return t.syncErrorValue=e,t.syncErrorThrown=!0,!0}return!1}_unsubscribe(){const{_parentSubscriber:t}=this;this._context=null,this._parentSubscriber=null,t.unsubscribe()}}const _=function(t){let e,n=s.Symbol;return"function"==typeof n?n.observable?e=n.observable:(e=n("observable"),n.observable=e):e="@@observable",e}();function E(){}function S(...t){return M(t)}function M(t){return t?1===t.length?t[0]:function(e){return t.reduce((t,e)=>e(t),e)}:E}class T{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(t){const e=new T;return e.source=this,e.operator=t,e}subscribe(t,e,n){const{operator:r}=this,i=function(t,e,n){if(t){if(t instanceof b)return t;if(t[w])return t[w]()}return t||e||n?new b(t,e,n):new b(v)}(t,e,n);if(r?r.call(i,this.source):i.add(this.source||!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i}_trySubscribe(t){try{return this._subscribe(t)}catch(e){t.syncErrorThrown=!0,t.syncErrorValue=e,t.error(e)}}forEach(t,e){if(e||(s.Rx&&s.Rx.config&&s.Rx.config.Promise?e=s.Rx.config.Promise:s.Promise&&(e=s.Promise)),!e)throw new Error("no Promise impl found");return new e((e,n)=>{let r;r=this.subscribe(e=>{if(r)try{t(e)}catch(t){n(t),r.unsubscribe()}else t(e)},n,e)})}_subscribe(t){return this.source.subscribe(t)}[_](){return this}pipe(...t){return 0===t.length?this:M(t)(this)}toPromise(t){if(t||(s.Rx&&s.Rx.config&&s.Rx.config.Promise?t=s.Rx.config.Promise:s.Promise&&(t=s.Promise)),!t)throw new Error("no Promise impl found");return new t((t,e)=>{let n;this.subscribe(t=>n=t,t=>e(t),()=>t(n))})}}T.create=(t=>new T(t));class C extends T{constructor(t,e){super(),this.value=t,this.scheduler=e,this._isScalar=!0,e&&(this._isScalar=!1)}static create(t,e){return new C(t,e)}static dispatch(t){const{done:e,value:n,subscriber:r}=t;e?r.complete():(r.next(n),r.closed||(t.done=!0,this.schedule(t)))}_subscribe(t){const e=this.value,n=this.scheduler;if(n)return n.schedule(C.dispatch,0,{done:!1,value:e,subscriber:t});t.next(e),t.closed||t.complete()}}class A extends T{constructor(t){super(),this.scheduler=t}static create(t){return new A(t)}static dispatch(t){const{subscriber:e}=t;e.complete()}_subscribe(t){const e=this.scheduler;if(e)return e.schedule(A.dispatch,0,{subscriber:t});t.complete()}}function R(t){return t&&"function"==typeof t.schedule}class P extends T{constructor(t,e){super(),this.array=t,this.scheduler=e,e||1!==t.length||(this._isScalar=!0,this.value=t[0])}static create(t,e){return new P(t,e)}static of(...t){let e=t[t.length-1];R(e)?t.pop():e=null;const n=t.length;return n>1?new P(t,e):1===n?new C(t[0],e):new A(e)}static dispatch(t){const{array:e,index:n,count:r,subscriber:i}=t;n>=r?i.complete():(i.next(e[n]),i.closed||(t.index=n+1,this.schedule(t)))}_subscribe(t){const e=this.array,n=e.length,r=this.scheduler;if(r)return r.schedule(P.dispatch,0,{array:e,index:0,count:n,subscriber:t});for(let i=0;i<n&&!t.closed;i++)t.next(e[i]);t.complete()}}const L=t=>t&&"number"==typeof t.length;function I(t){return t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}const N=function(t){const e=t.Symbol;if("function"==typeof e)return e.iterator||(e.iterator=e("iterator polyfill")),e.iterator;{const{Set:e}=t;if(e&&"function"==typeof(new e)["@@iterator"])return"@@iterator";const{Map:n}=t;if(n){let t=Object.getOwnPropertyNames(n.prototype);for(let e=0;e<t.length;++e){let r=t[e];if("entries"!==r&&"size"!==r&&n.prototype[r]===n.prototype.entries)return r}}return"@@iterator"}}(s);class O extends b{constructor(t,e,n){super(),this.parent=t,this.outerValue=e,this.outerIndex=n,this.index=0}_next(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)}_error(t){this.parent.notifyError(t,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}function D(t,e,n,r){let i=new O(t,n,r);if(i.closed)return null;if(e instanceof T)return e._isScalar?(i.next(e.value),i.complete(),null):(i.syncErrorThrowable=!0,e.subscribe(i));if(L(e)){for(let t=0,n=e.length;t<n&&!i.closed;t++)i.next(e[t]);i.closed||i.complete()}else{if(I(e))return e.then(t=>{i.closed||(i.next(t),i.complete())},t=>i.error(t)).then(null,t=>{s.setTimeout(()=>{throw t})}),i;if(e&&"function"==typeof e[N]){const t=e[N]();for(;;){let e=t.next();if(e.done){i.complete();break}if(i.next(e.value),i.closed)break}}else if(e&&"function"==typeof e[_]){const o=e[_]();if("function"==typeof o.subscribe)return o.subscribe(new O(t,n,r));i.error(new TypeError("Provided object does not correctly implement Symbol.observable"))}else{const t=`You provided ${u(e)?"an invalid object":`'${e}'`} where a stream was expected.`+" You can provide an Observable, Promise, Array, or Iterable.";i.error(new TypeError(t))}}return null}class B extends b{notifyNext(t,e,n,r,i){this.destination.next(e)}notifyError(t,e){this.destination.error(t)}notifyComplete(t){this.destination.complete()}}function U(t,e,n=Number.POSITIVE_INFINITY){return function(r){return"number"==typeof e&&(n=e,e=null),r.lift(new z(t,e,n))}}class z{constructor(t,e,n=Number.POSITIVE_INFINITY){this.project=t,this.resultSelector=e,this.concurrent=n}call(t,e){return e.subscribe(new F(t,this.project,this.resultSelector,this.concurrent))}}class F extends B{constructor(t,e,n,r=Number.POSITIVE_INFINITY){super(t),this.project=e,this.resultSelector=n,this.concurrent=r,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)}_tryNext(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(e,t,n)}_innerSub(t,e,n){this.add(D(this,t,e,n))}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete()}notifyNext(t,e,n,r,i){this.resultSelector?this._notifyResultSelector(t,e,n,r):this.destination.next(e)}_notifyResultSelector(t,e,n,r){let i;try{i=this.resultSelector(t,e,n,r)}catch(t){return void this.destination.error(t)}this.destination.next(i)}notifyComplete(t){const e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function k(t){return t}function V(t=Number.POSITIVE_INFINITY){return U(k,null,t)}class G extends Error{constructor(){const t=super("object unsubscribed");this.name=t.name="ObjectUnsubscribedError",this.stack=t.stack,this.message=t.message}}class j extends m{constructor(t,e){super(),this.subject=t,this.subscriber=e,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const t=this.subject,e=t.observers;if(this.subject=null,!e||0===e.length||t.isStopped||t.closed)return;const n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}class H extends b{constructor(t){super(t),this.destination=t}}class W extends T{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[w](){return new H(this)}lift(t){const e=new q(this,this);return e.operator=t,e}next(t){if(this.closed)throw new G;if(!this.isStopped){const{observers:e}=this,n=e.length,r=e.slice();for(let i=0;i<n;i++)r[i].next(t)}}error(t){if(this.closed)throw new G;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:e}=this,n=e.length,r=e.slice();for(let i=0;i<n;i++)r[i].error(t);this.observers.length=0}complete(){if(this.closed)throw new G;this.isStopped=!0;const{observers:t}=this,e=t.length,n=t.slice();for(let r=0;r<e;r++)n[r].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new G;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new G;return this.hasError?(t.error(this.thrownError),m.EMPTY):this.isStopped?(t.complete(),m.EMPTY):(this.observers.push(t),new j(this,t))}asObservable(){const t=new T;return t.source=this,t}}W.create=((t,e)=>new q(t,e));class q extends W{constructor(t,e){super(),this.destination=t,this.source=e}next(t){const{destination:e}=this;e&&e.next&&e.next(t)}error(t){const{destination:e}=this;e&&e.error&&this.destination.error(t)}complete(){const{destination:t}=this;t&&t.complete&&this.destination.complete()}_subscribe(t){const{source:e}=this;return e?this.source.subscribe(t):m.EMPTY}}function X(){return function(t){return t.lift(new Y(t))}}class Y{constructor(t){this.connectable=t}call(t,e){const{connectable:n}=this;n._refCount++;const r=new Z(t,n),i=e.subscribe(r);return r.closed||(r.connection=n.connect()),i}}class Z extends b{constructor(t,e){super(t),this.connectable=e}_unsubscribe(){const{connectable:t}=this;if(!t)return void(this.connection=null);this.connectable=null;const e=t._refCount;if(e<=0)return void(this.connection=null);if(t._refCount=e-1,e>1)return void(this.connection=null);const{connection:n}=this,r=t._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}const $=class extends T{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._refCount=0,this._isComplete=!1}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new m).add(this.source.subscribe(new class extends H{constructor(t,e){super(t),this.connectable=e}_error(t){this._unsubscribe(),super._error(t)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const t=this.connectable;if(t){this.connectable=null;const e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}}}(this.getSubject(),this))),t.closed?(this._connection=null,t=m.EMPTY):this._connection=t),t}refCount(){return X()(this)}}.prototype,Q={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:$._subscribe},_isComplete:{value:$._isComplete,writable:!0},getSubject:{value:$.getSubject},connect:{value:$.connect},refCount:{value:$.refCount}};function J(){return new W}class K{constructor(t){this._desc=t,this.ngMetadataName="InjectionToken"}toString(){return`InjectionToken ${this._desc}`}}const tt="__annotations__",et="__paramaters__",nt="__prop__metadata__";function rt(t,e,n,r){const i=it(e);function o(t){if(this instanceof o)return i.call(this,t),this;const e=new o(t),n=function(t){return(t.hasOwnProperty(tt)?t[tt]:Object.defineProperty(t,tt,{value:[]})[tt]).push(e),t};return r&&r(n),n}return n&&(o.prototype=Object.create(n.prototype)),o.prototype.ngMetadataName=t,o.annotationCls=o,o}function it(t){return function(...e){if(t){const n=t(...e);for(const t in n)this[t]=n[t]}}}function ot(t,e,n){const r=it(e);function i(...t){if(this instanceof i)return r.apply(this,t),this;const e=new i(...t);return n.annotation=e,n;function n(t,n,r){const i=t.hasOwnProperty(et)?t[et]:Object.defineProperty(t,et,{value:[]})[et];for(;i.length<=r;)i.push(null);return(i[r]=i[r]||[]).push(e),t}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i}function st(t,e,n){const r=it(e);function i(...t){if(this instanceof i)return r.apply(this,t),this;const e=new i(...t);return function(t,n){const r=t.constructor,i=r.hasOwnProperty(nt)?r[nt]:Object.defineProperty(r,nt,{value:{}})[nt];i[n]=i.hasOwnProperty(n)&&i[n]||[],i[n].unshift(e)}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i}const at=new K("AnalyzeForEntryComponents");ot("Attribute",t=>({attributeName:t}));class lt{}st("ContentChildren",(t,e={})=>Object.assign({selector:t,first:!1,isViewQuery:!1,descendants:!1},e),lt),st("ContentChild",(t,e={})=>Object.assign({selector:t,first:!0,isViewQuery:!1,descendants:!0},e),lt),st("ViewChildren",(t,e={})=>Object.assign({selector:t,first:!1,isViewQuery:!0,descendants:!0},e),lt),st("ViewChild",(t,e)=>Object.assign({selector:t,first:!0,isViewQuery:!0,descendants:!0},e),lt);const ut=function(){var t={OnPush:0,Default:1};return t[t.OnPush]="OnPush",t[t.Default]="Default",t}();rt("Component",(t={})=>Object.assign({changeDetection:ut.Default},t),rt("Directive",(t={})=>t)),rt("Pipe",t=>Object.assign({pure:!0},t)),st("Input",t=>({bindingPropertyName:t})),st("Output",t=>({bindingPropertyName:t})),st("HostBinding",t=>({hostPropertyName:t})),st("HostListener",(t,e)=>({eventName:t,args:e})),rt("NgModule",t=>t);const ct=function(){var t={Emulated:0,Native:1,None:2};return t[t.Emulated]="Emulated",t[t.Native]="Native",t[t.None]="None",t}();class ht{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const dt=new ht("5.2.0"),pt=ot("Inject",t=>({token:t})),ft=ot("Optional"),mt=(rt("Injectable"),ot("Self")),gt=ot("SkipSelf"),vt=(ot("Host"),"undefined"!=typeof window&&window),yt="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,wt="undefined"!=typeof global&&global,bt=vt||wt||yt;let xt=null;function _t(){if(!xt){const t=bt.Symbol;if(t&&t.iterator)xt=t.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const n=t[e];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(xt=n)}}}return xt}function Et(t){Zone.current.scheduleMicroTask("scheduleMicrotask",t)}function St(t,e){return t===e||"number"==typeof t&&"number"==typeof e&&isNaN(t)&&isNaN(e)}function Mt(t){if("string"==typeof t)return t;if(t instanceof Array)return"["+t.map(Mt).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function Tt(t){return t.__forward_ref__=Tt,t.toString=function(){return Mt(this())},t}function Ct(t){return"function"==typeof t&&t.hasOwnProperty("__forward_ref__")&&t.__forward_ref__===Tt?t():t}const At="__source",Rt=new Object,Pt=Rt;class Lt{static create(t,e){return Array.isArray(t)?new jt(t,e):new jt(t.providers,t.parent,t.name||null)}}Lt.THROW_IF_NOT_FOUND=Rt,Lt.NULL=new class{get(t,e=Rt){if(e===Rt)throw new Error(`NullInjectorError: No provider for ${Mt(t)}!`);return e}};const It=function(t){return t},Nt=[],Ot=It,Dt=function(){return Array.prototype.slice.call(arguments)},Bt={},Ut=function(t){for(let e in t)if(t[e]===Bt)return e;throw Error("!prop")}({provide:String,useValue:Bt}),zt="ngTokenPath",Ft="ngTempTokenPath",kt=Lt.NULL,Vt=/\n/gm,Gt="\u0275";class jt{constructor(t,e=kt,n=null){this.parent=e,this.source=n;const r=this._records=new Map;r.set(Lt,{token:Lt,fn:It,deps:Nt,value:this,useNew:!1}),function t(e,n){if(n)if((n=Ct(n))instanceof Array)for(let r=0;r<n.length;r++)t(e,n[r]);else{if("function"==typeof n)throw qt("Function/Class not supported",n);if(!n||"object"!=typeof n||!n.provide)throw qt("Unexpected provider",n);{let t=Ct(n.provide);const r=function(t){const e=function(t){let e=Nt;const n=t.deps;if(n&&n.length){e=[];for(let t=0;t<n.length;t++){let r=6,i=Ct(n[t]);if(i instanceof Array)for(let t=0,e=i;t<e.length;t++){const n=e[t];n instanceof ft||n==ft?r|=1:n instanceof gt||n==gt?r&=-3:n instanceof mt||n==mt?r&=-5:i=n instanceof pt?n.token:Ct(n)}e.push({token:i,options:r})}}else if(t.useExisting)e=[{token:Ct(t.useExisting),options:6}];else if(!(n||Ut in t))throw qt("'deps' required",t);return e}(t);let n=It,r=Nt,i=!1,o=Ct(t.provide);if(Ut in t)r=t.useValue;else if(t.useFactory)n=t.useFactory;else if(t.useExisting);else if(t.useClass)i=!0,n=Ct(t.useClass);else{if("function"!=typeof o)throw qt("StaticProvider does not have [useValue|useFactory|useExisting|useClass] or [provide] is not newable",t);i=!0,n=o}return{deps:e,fn:n,useNew:i,value:r}}(n);if(!0===n.multi){let r=e.get(t);if(r){if(r.fn!==Dt)throw Ht(t)}else e.set(t,r={token:n.provide,deps:[],useNew:!1,fn:Dt,value:Nt});r.deps.push({token:t=n,options:6})}const i=e.get(t);if(i&&i.fn==Dt)throw Ht(t);e.set(t,r)}}}(r,t)}get(t,e){const n=this._records.get(t);try{return function t(e,n,r,i,o){try{return function(e,n,r,i,o){let s;if(n){if((s=n.value)==Ot)throw Error(Gt+"Circular dependency");if(s===Nt){n.value=Ot;let e=void 0,o=n.useNew,a=n.fn,l=n.deps,u=Nt;if(l.length){u=[];for(let e=0;e<l.length;e++){const n=l[e],o=n.options,s=2&o?r.get(n.token):void 0;u.push(t(n.token,s,r,s||4&o?i:kt,1&o?null:Lt.THROW_IF_NOT_FOUND))}}n.value=s=o?new a(...u):a.apply(e,u)}}else s=i.get(e,o);return s}(e,n,r,i,o)}catch(t){throw t instanceof Error||(t=new Error(t)),(t[Ft]=t[Ft]||[]).unshift(e),n&&n.value==Ot&&(n.value=Nt),t}}(t,n,this._records,this.parent,e)}catch(e){const n=e[Ft];throw t[At]&&n.unshift(t[At]),e.message=Wt("\n"+e.message,n,this.source),e[zt]=n,e[Ft]=null,e}}toString(){const t=[];return this._records.forEach((e,n)=>t.push(Mt(n))),`StaticInjector[${t.join(", ")}]`}}function Ht(t){return qt("Cannot mix multi providers and regular providers",t)}function Wt(t,e,n=null){t=t&&"\n"===t.charAt(0)&&t.charAt(1)==Gt?t.substr(2):t;let r=Mt(e);if(e instanceof Array)r=e.map(Mt).join(" -> ");else if("object"==typeof e){let t=[];for(let n in e)if(e.hasOwnProperty(n)){let r=e[n];t.push(n+":"+("string"==typeof r?JSON.stringify(r):Mt(r)))}r=`{${t.join(", ")}}`}return`StaticInjectorError${n?"("+n+")":""}[${r}]: ${t.replace(Vt,"\n  ")}`}function qt(t,e){return new Error(Wt(t,e))}const Xt="ngDebugContext",Yt="ngOriginalError",Zt="ngErrorLogger";function $t(t){return t[Xt]}function Qt(t){return t[Yt]}function Jt(t,...e){t.error(...e)}class Kt{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t),n=this._findContext(t),r=function(t){return t[Zt]||Jt}(t);r(this._console,"ERROR",t),e&&r(this._console,"ORIGINAL ERROR",e),n&&r(this._console,"ERROR CONTEXT",n)}_findContext(t){return t?$t(t)?$t(t):this._findContext(Qt(t)):null}_findOriginalError(t){let e=Qt(t);for(;e&&Qt(e);)e=Qt(e);return e}}function te(t){return t.length>1?" ("+function(t){const e=[];for(let n=0;n<t.length;++n){if(e.indexOf(t[n])>-1)return e.push(t[n]),e;e.push(t[n])}return e}(t.slice().reverse()).map(t=>Mt(t.token)).join(" -> ")+")":""}function ee(t,e,n,r){const i=[e],o=n(i),s=r?function(t,e){const n=`${o} caused by: ${e instanceof Error?e.message:e}`,r=Error(n);return r[Yt]=e,r}(0,r):Error(o);return s.addKey=ne,s.keys=i,s.injectors=[t],s.constructResolvingMessage=n,s[Yt]=r,s}function ne(t,e){this.injectors.push(t),this.keys.push(e),this.message=this.constructResolvingMessage(this.keys)}function re(t,e){const n=[];for(let r=0,i=e.length;r<i;r++){const t=e[r];n.push(t&&0!=t.length?t.map(Mt).join(" "):"?")}return Error("Cannot resolve all parameters for '"+Mt(t)+"'("+n.join(", ")+"). Make sure that all the parameters are decorated with Inject or have valid type annotations and that '"+Mt(t)+"' is decorated with Injectable.")}function ie(t,e){return Error(`Cannot mix multi providers and regular providers, got: ${t} ${e}`)}class oe{constructor(t,e){if(this.token=t,this.id=e,!t)throw new Error("Token must be defined!");this.displayName=Mt(this.token)}static get(t){return se.get(Ct(t))}static get numberOfKeys(){return se.numberOfKeys}}const se=new class{constructor(){this._allKeys=new Map}get(t){if(t instanceof oe)return t;if(this._allKeys.has(t))return this._allKeys.get(t);const e=new oe(t,oe.numberOfKeys);return this._allKeys.set(t,e),e}get numberOfKeys(){return this._allKeys.size}},ae=Function;function le(t){return"function"==typeof t}const ue=/^function\s+\S+\(\)\s*{[\s\S]+\.apply\(this,\s*arguments\)/;function ce(t){return t?t.map(t=>new(0,t.type.annotationCls)(...t.args?t.args:[])):[]}function he(t){const e=Object.getPrototypeOf(t.prototype);return(e?e.constructor:null)||Object}const de=new class{constructor(t){this.reflectionCapabilities=t}updateCapabilities(t){this.reflectionCapabilities=t}factory(t){return this.reflectionCapabilities.factory(t)}parameters(t){return this.reflectionCapabilities.parameters(t)}annotations(t){return this.reflectionCapabilities.annotations(t)}propMetadata(t){return this.reflectionCapabilities.propMetadata(t)}hasLifecycleHook(t,e){return this.reflectionCapabilities.hasLifecycleHook(t,e)}getter(t){return this.reflectionCapabilities.getter(t)}setter(t){return this.reflectionCapabilities.setter(t)}method(t){return this.reflectionCapabilities.method(t)}importUri(t){return this.reflectionCapabilities.importUri(t)}resourceUri(t){return this.reflectionCapabilities.resourceUri(t)}resolveIdentifier(t,e,n,r){return this.reflectionCapabilities.resolveIdentifier(t,e,n,r)}resolveEnum(t,e){return this.reflectionCapabilities.resolveEnum(t,e)}}(new class{constructor(t){this._reflect=t||bt.Reflect}isReflectionEnabled(){return!0}factory(t){return(...e)=>new t(...e)}_zipTypesAndAnnotations(t,e){let n;n=void 0===t?new Array(e.length):new Array(t.length);for(let r=0;r<n.length;r++)n[r]=void 0===t?[]:t[r]!=Object?[t[r]]:[],e&&null!=e[r]&&(n[r]=n[r].concat(e[r]));return n}_ownParameters(t,e){if(ue.exec(t.toString()))return null;if(t.parameters&&t.parameters!==e.parameters)return t.parameters;const n=t.ctorParameters;if(n&&n!==e.ctorParameters){const t="function"==typeof n?n():n,e=t.map(t=>t&&t.type),r=t.map(t=>t&&ce(t.decorators));return this._zipTypesAndAnnotations(e,r)}const r=t.hasOwnProperty(et)&&t[et],i=this._reflect&&this._reflect.getOwnMetadata&&this._reflect.getOwnMetadata("design:paramtypes",t);return i||r?this._zipTypesAndAnnotations(i,r):new Array(t.length).fill(void 0)}parameters(t){if(!le(t))return[];const e=he(t);let n=this._ownParameters(t,e);return n||e===Object||(n=this.parameters(e)),n||[]}_ownAnnotations(t,e){if(t.annotations&&t.annotations!==e.annotations){let e=t.annotations;return"function"==typeof e&&e.annotations&&(e=e.annotations),e}return t.decorators&&t.decorators!==e.decorators?ce(t.decorators):t.hasOwnProperty(tt)?t[tt]:null}annotations(t){if(!le(t))return[];const e=he(t),n=this._ownAnnotations(t,e)||[];return(e!==Object?this.annotations(e):[]).concat(n)}_ownPropMetadata(t,e){if(t.propMetadata&&t.propMetadata!==e.propMetadata){let e=t.propMetadata;return"function"==typeof e&&e.propMetadata&&(e=e.propMetadata),e}if(t.propDecorators&&t.propDecorators!==e.propDecorators){const e=t.propDecorators,n={};return Object.keys(e).forEach(t=>{n[t]=ce(e[t])}),n}return t.hasOwnProperty(nt)?t[nt]:null}propMetadata(t){if(!le(t))return{};const e=he(t),n={};if(e!==Object){const t=this.propMetadata(e);Object.keys(t).forEach(e=>{n[e]=t[e]})}const r=this._ownPropMetadata(t,e);return r&&Object.keys(r).forEach(t=>{const e=[];n.hasOwnProperty(t)&&e.push(...n[t]),e.push(...r[t]),n[t]=e}),n}hasLifecycleHook(t,e){return t instanceof ae&&e in t.prototype}guards(t){return{}}getter(t){return new Function("o","return o."+t+";")}setter(t){return new Function("o","v","return o."+t+" = v;")}method(t){const e=`if (!o.${t}) throw new Error('"${t}" is undefined');\n        return o.${t}.apply(o, args);`;return new Function("o","args",e)}importUri(t){return"object"==typeof t&&t.filePath?t.filePath:`./${Mt(t)}`}resourceUri(t){return`./${Mt(t)}`}resolveIdentifier(t,e,n,r){return r}resolveEnum(t,e){return t[e]}});class pe{constructor(t,e,n){this.key=t,this.optional=e,this.visibility=n}static fromKey(t){return new pe(t,!1,null)}}const fe=[];class me{constructor(t,e,n){this.key=t,this.resolvedFactories=e,this.multiProvider=n,this.resolvedFactory=this.resolvedFactories[0]}}class ge{constructor(t,e){this.factory=t,this.dependencies=e}}function ve(t){return new me(oe.get(t.provide),[function(t){let e,n;if(t.useClass){const r=Ct(t.useClass);e=de.factory(r),n=ye(r)}else t.useExisting?(e=(t=>t),n=[pe.fromKey(oe.get(t.useExisting))]):t.useFactory?(e=t.useFactory,n=function(t,e){if(e){const n=e.map(t=>[t]);return e.map(e=>we(t,e,n))}return ye(t)}(t.useFactory,t.deps)):(e=(()=>t.useValue),n=fe);return new ge(e,n)}(t)],t.multi||!1)}function ye(t){const e=de.parameters(t);if(!e)return[];if(e.some(t=>null==t))throw re(t,e);return e.map(n=>we(t,n,e))}function we(t,e,n){let r=null,i=!1;if(!Array.isArray(e))return be(e instanceof pt?e.token:e,i,null);let o=null;for(let s=0;s<e.length;++s){const t=e[s];t instanceof ae?r=t:t instanceof pt?r=t.token:t instanceof ft?i=!0:t instanceof mt||t instanceof gt?o=t:t instanceof K&&(r=t)}if(null!=(r=Ct(r)))return be(r,i,o);throw re(t,n)}function be(t,e,n){return new pe(oe.get(t),e,n)}const xe=new Object;class _e{static resolve(t){return function(t){const e=function(t,e){for(let n=0;n<t.length;n++){const r=t[n],i=e.get(r.key.id);if(i){if(r.multiProvider!==i.multiProvider)throw ie(i,r);if(r.multiProvider)for(let t=0;t<r.resolvedFactories.length;t++)i.resolvedFactories.push(r.resolvedFactories[t]);else e.set(r.key.id,r)}else{let t;t=r.multiProvider?new me(r.key,r.resolvedFactories.slice(),r.multiProvider):r,e.set(r.key.id,t)}}return e}(function t(e,n){return e.forEach(e=>{if(e instanceof ae)n.push({provide:e,useClass:e});else if(e&&"object"==typeof e&&void 0!==e.provide)n.push(e);else{if(!(e instanceof Array))throw Error(`Invalid provider - only instances of Provider and Type are allowed, got: ${e}`);t(e,n)}}),n}(t,[]).map(ve),new Map);return Array.from(e.values())}(t)}static resolveAndCreate(t,e){const n=_e.resolve(t);return _e.fromResolvedProviders(n,e)}static fromResolvedProviders(t,e){return new Ee(t,e)}}class Ee{constructor(t,e){this._constructionCounter=0,this._providers=t,this.parent=e||null;const n=t.length;this.keyIds=new Array(n),this.objs=new Array(n);for(let r=0;r<n;r++)this.keyIds[r]=t[r].key.id,this.objs[r]=xe}get(t,e=Pt){return this._getByKey(oe.get(t),null,e)}resolveAndCreateChild(t){const e=_e.resolve(t);return this.createChildFromResolved(e)}createChildFromResolved(t){const e=new Ee(t);return e.parent=this,e}resolveAndInstantiate(t){return this.instantiateResolved(_e.resolve([t])[0])}instantiateResolved(t){return this._instantiateProvider(t)}getProviderAtIndex(t){if(t<0||t>=this._providers.length)throw function(t){return Error(`Index ${t} is out-of-bounds.`)}(t);return this._providers[t]}_new(t){if(this._constructionCounter++>this._getMaxNumberOfObjects())throw function(e,n){return ee(e,t.key,function(t){return`Cannot instantiate cyclic dependency!${te(t)}`})}(this);return this._instantiateProvider(t)}_getMaxNumberOfObjects(){return this.objs.length}_instantiateProvider(t){if(t.multiProvider){const e=new Array(t.resolvedFactories.length);for(let n=0;n<t.resolvedFactories.length;++n)e[n]=this._instantiate(t,t.resolvedFactories[n]);return e}return this._instantiate(t,t.resolvedFactories[0])}_instantiate(t,e){const n=e.factory;let r,i;try{r=e.dependencies.map(t=>this._getByReflectiveDependency(t))}catch(e){throw e.addKey&&e.addKey(this,t.key),e}try{i=n(...r)}catch(e){throw function(e,n,r,i){return ee(e,t.key,function(t){const e=Mt(t[0].token);return`${n.message}: Error during instantiation of ${e}!${te(t)}.`},n)}(this,e)}return i}_getByReflectiveDependency(t){return this._getByKey(t.key,t.visibility,t.optional?null:Pt)}_getByKey(t,e,n){return t===Ee.INJECTOR_KEY?this:e instanceof mt?this._getByKeySelf(t,n):this._getByKeyDefault(t,n,e)}_getObjByKeyId(t){for(let e=0;e<this.keyIds.length;e++)if(this.keyIds[e]===t)return this.objs[e]===xe&&(this.objs[e]=this._new(this._providers[e])),this.objs[e];return xe}_throwOrNull(t,e){if(e!==Pt)return e;throw function(t,e){return ee(t,e,function(t){return`No provider for ${Mt(t[0].token)}!${te(t)}`})}(this,t)}_getByKeySelf(t,e){const n=this._getObjByKeyId(t.id);return n!==xe?n:this._throwOrNull(t,e)}_getByKeyDefault(t,e,n){let r;for(r=n instanceof gt?this.parent:this;r instanceof Ee;){const e=r,n=e._getObjByKeyId(t.id);if(n!==xe)return n;r=e.parent}return null!==r?r.get(t.token,e):this._throwOrNull(t,e)}get displayName(){return`ReflectiveInjector(providers: [${function(t,e){const n=new Array(t._providers.length);for(let r=0;r<t._providers.length;++r)n[r]=e(t.getProviderAtIndex(r));return n}(this,t=>' "'+t.key.displayName+'" ').join(", ")}])`}toString(){return this.displayName}}function Se(t){return!!t&&"function"==typeof t.then}function Me(t){return!!t&&"function"==typeof t.subscribe}Ee.INJECTOR_KEY=oe.get(Lt);const Te=new K("Application Initializer");class Ce{constructor(t){this.appInits=t,this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}runInitializers(){if(this.initialized)return;const t=[],e=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let n=0;n<this.appInits.length;n++){const e=this.appInits[n]();Se(e)&&t.push(e)}Promise.all(t).then(()=>{e()}).catch(t=>{this.reject(t)}),0===t.length&&e(),this.initialized=!0}}const Ae=new K("AppId");function Re(){return`${Pe()}${Pe()}${Pe()}`}function Pe(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Le=new K("Platform Initializer"),Ie=new K("Platform ID"),Ne=new K("appBootstrapListener");new K("Application Packages Root URL");class Oe{log(t){console.log(t)}warn(t){console.warn(t)}}function De(){throw new Error("Runtime compiler is not loaded")}Oe.ctorParameters=(()=>[]);class Be{compileModuleSync(t){throw De()}compileModuleAsync(t){throw De()}compileModuleAndAllComponentsSync(t){throw De()}compileModuleAndAllComponentsAsync(t){throw De()}clearCache(){}clearCacheFor(t){}}new K("compilerOptions");class Ue{}class ze{}class Fe{}function ke(t){const e=Error(`No component factory found for ${Mt(t)}. Did you add it to @NgModule.entryComponents?`);return e[Ve]=t,e}const Ve="ngComponent";class Ge{}Ge.NULL=new class{resolveComponentFactory(t){throw ke(t)}};class je{constructor(t,e,n){this._parent=e,this._ngModule=n,this._factories=new Map;for(let r=0;r<t.length;r++){const e=t[r];this._factories.set(e.componentType,e)}}resolveComponentFactory(t){let e=this._factories.get(t);if(!e&&this._parent&&(e=this._parent.resolveComponentFactory(t)),!e)throw ke(t);return new He(e,this._ngModule)}}class He extends Fe{constructor(t,e){super(),this.factory=t,this.ngModule=e,this.selector=t.selector,this.componentType=t.componentType,this.ngContentSelectors=t.ngContentSelectors,this.inputs=t.inputs,this.outputs=t.outputs}create(t,e,n,r){return this.factory.create(t,e,n,r||this.ngModule)}}class We{}class qe{}let Xe,Ye;const Ze=function(){const t=bt.wtf;return!(!t||!(Xe=t.trace)||(Ye=Xe.events,0))}(),$e=Ze?function(t,e=null){return Ye.createScope(t,e)}:(t,e)=>(function(t,e){return null}),Qe=Ze?function(t,e){return Xe.leaveScope(t,e),e}:(t,e)=>e;class Je extends W{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,n){let r,i=t=>null,o=()=>null;return t&&"object"==typeof t?(r=this.__isAsync?e=>{setTimeout(()=>t.next(e))}:e=>{t.next(e)},t.error&&(i=this.__isAsync?e=>{setTimeout(()=>t.error(e))}:e=>{t.error(e)}),t.complete&&(o=this.__isAsync?()=>{setTimeout(()=>t.complete())}:()=>{t.complete()})):(r=this.__isAsync?e=>{setTimeout(()=>t(e))}:e=>{t(e)},e&&(i=this.__isAsync?t=>{setTimeout(()=>e(t))}:t=>{e(t)}),n&&(o=this.__isAsync?()=>{setTimeout(()=>n())}:()=>{n()})),super.subscribe(r,i,o)}}class Ke{constructor({enableLongStackTrace:t=!1}){if(this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Je(!1),this.onMicrotaskEmpty=new Je(!1),this.onStable=new Je(!1),this.onError=new Je(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),function(t){t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,n,r,i,o,s)=>{try{return rn(t),e.invokeTask(r,i,o,s)}finally{on(t)}},onInvoke:(e,n,r,i,o,s,a)=>{try{return rn(t),e.invoke(r,i,o,s,a)}finally{on(t)}},onHasTask:(e,n,r,i)=>{e.hasTask(r,i),n===r&&("microTask"==i.change?(t.hasPendingMicrotasks=i.microTask,nn(t)):"macroTask"==i.change&&(t.hasPendingMacrotasks=i.macroTask))},onHandleError:(e,n,r,i)=>(e.handleError(r,i),t.runOutsideAngular(()=>t.onError.emit(i)),!1)})}(this)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Ke.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Ke.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,e,n){return this._inner.run(t,e,n)}runTask(t,e,n,r){const i=this._inner,o=i.scheduleEventTask("NgZoneEvent: "+r,t,en,tn,tn);try{return i.runTask(o,e,n)}finally{i.cancelTask(o)}}runGuarded(t,e,n){return this._inner.runGuarded(t,e,n)}runOutsideAngular(t){return this._outer.run(t)}}function tn(){}const en={};function nn(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function rn(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function on(t){t._nesting--,nn(t)}class sn{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Je,this.onMicrotaskEmpty=new Je,this.onStable=new Je,this.onError=new Je}run(t){return t()}runGuarded(t){return t()}runOutsideAngular(t){return t()}runTask(t){return t()}}class an{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this._watchAngularEvents()}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Ke.assertNotInAngularZone(),Et(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0==this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){this.isStable()?Et(()=>{for(;0!==this._callbacks.length;)this._callbacks.pop()(this._didWork);this._didWork=!1}):this._didWork=!0}whenStable(t){this._callbacks.push(t),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,e,n){return[]}}class ln{constructor(){this._applications=new Map,cn.addToWindow(this)}registerApplication(t,e){this._applications.set(t,e)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,e=!0){return cn.findTestabilityInTree(this,t,e)}}ln.ctorParameters=(()=>[]);let un,cn=new class{addToWindow(t){}findTestabilityInTree(t,e,n){return null}},hn=!0,dn=!1;const pn=new K("AllowMultipleToken");function fn(){return dn=!0,hn}class mn{constructor(t,e){this.name=t,this.token=e}}function gn(t,e,n=[]){const r=`Platform: ${e}`,i=new K(r);return(e=[])=>{let o=vn();if(!o||o.injector.get(pn,!1))if(t)t(n.concat(e).concat({provide:i,useValue:!0}));else{const t=n.concat(e).concat({provide:i,useValue:!0});!function(t){if(un&&!un.destroyed&&!un.injector.get(pn,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");un=t.get(yn);const e=t.get(Le,null);e&&e.forEach(t=>t())}(Lt.create({providers:t,name:r}))}return function(t){const e=vn();if(!e)throw new Error("No platform exists!");if(!e.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(i)}}function vn(){return un&&!un.destroyed?un:null}class yn{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,e){const n=function(t){return"noop"===t?new sn:("zone.js"===t?void 0:t)||new Ke({enableLongStackTrace:fn()})}(e?e.ngZone:void 0),r=[{provide:Ke,useValue:n}];return n.run(()=>{const e=Lt.create({providers:r,parent:this.injector,name:t.moduleType.name}),i=t.create(e),o=i.injector.get(Kt,null);if(!o)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return i.onDestroy(()=>xn(this._modules,i)),n.runOutsideAngular(()=>n.onError.subscribe({next:t=>{o.handleError(t)}})),function(t,e,n){try{const r=n();return Se(r)?r.catch(n=>{throw e.runOutsideAngular(()=>t.handleError(n)),n}):r}catch(n){throw e.runOutsideAngular(()=>t.handleError(n)),n}}(o,n,()=>{const t=i.injector.get(Ce);return t.runInitializers(),t.donePromise.then(()=>(this._moduleDoBootstrap(i),i))})})}bootstrapModule(t,e=[]){const n=this.injector.get(Ue),r=wn({},e);return n.createCompiler([r]).compileModuleAsync(t).then(t=>this.bootstrapModuleFactory(t,r))}_moduleDoBootstrap(t){const e=t.injector.get(bn);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(t=>e.bootstrap(t));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${Mt(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. `+"Please define one of these.");t.instance.ngDoBootstrap(e)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}function wn(t,e){return Array.isArray(e)?e.reduce(wn,t):Object.assign({},t,e)}class bn{constructor(t,e,n,r,i,o){this._zone=t,this._console=e,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=i,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=fn(),this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new T(t=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{t.next(this._stable),t.complete()})}),a=new T(t=>{let e;this._zone.runOutsideAngular(()=>{e=this._zone.onStable.subscribe(()=>{Ke.assertNotInAngularZone(),Et(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,t.next(!0))})})});const n=this._zone.onUnstable.subscribe(()=>{Ke.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{t.next(!1)}))});return()=>{e.unsubscribe(),n.unsubscribe()}});this.isStable=function(...t){let e=Number.POSITIVE_INFINITY,n=null,r=t[t.length-1];return R(r)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof r&&(e=t.pop()),null===n&&1===t.length&&t[0]instanceof T?t[0]:V(e)(new P(t,n))}(s,(function(){return(t=>X()(function(t,e){return function(e){let n;n="function"==typeof t?t:function(){return t};const r=Object.create(e,Q);return r.source=e,r.subjectFactory=n,r}}(J)(t)))(this)}).call(a))}bootstrap(t,e){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let n;n=t instanceof Fe?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(n.componentType);const r=n instanceof He?null:this._injector.get(We),i=n.create(Lt.NULL,[],e||n.selector,r);i.onDestroy(()=>{this._unloadComponent(i)});const o=i.injector.get(an,null);return o&&i.injector.get(ln).registerApplication(i.location.nativeElement,o),this._loadComponent(i),fn()&&this._console.log("Angular is running in the development mode. Call enableProdMode() to enable the production mode."),i}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");const t=bn._tickScope();try{this._runningTick=!0,this._views.forEach(t=>t.detectChanges()),this._enforceNoNewChanges&&this._views.forEach(t=>t.checkNoChanges())}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1,Qe(t)}}attachView(t){const e=t;this._views.push(e),e.attachToAppRef(this)}detachView(t){const e=t;xn(this._views,e),e.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(Ne,[]).concat(this._bootstrapListeners).forEach(e=>e(t))}_unloadComponent(t){this.detachView(t.hostView),xn(this.components,t)}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy())}get viewCount(){return this._views.length}}function xn(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}bn._tickScope=$e("ApplicationRef#tick()"),new K("Renderer2Interceptor");class _n{}const En=function(){var t={Important:1,DashCase:2};return t[t.Important]="Important",t[t.DashCase]="DashCase",t}();class Sn{}class Mn{constructor(t){this.nativeElement=t}}class Tn{}new Map;class Cn{constructor(){this.dirty=!0,this._results=[],this.changes=new Je}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}[_t()](){return this._results[_t()]()}toString(){return this._results.toString()}reset(t){this._results=function t(e){return e.reduce((e,n)=>{const r=Array.isArray(n)?t(n):n;return e.concat(r)},[])}(t),this.dirty=!1,this.length=this._results.length,this.last=this._results[this.length-1],this.first=this._results[0]}notifyOnChanges(){this.changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}const An="#",Rn="NgFactory";class Pn{}const Ln={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};class In{constructor(t,e){this._compiler=t,this._config=e||Ln}load(t){return this._compiler instanceof Be?this.loadFactory(t):this.loadAndCompile(t)}loadAndCompile(t){let[e,r]=t.split(An);return void 0===r&&(r="default"),n("crnd")(e).then(t=>t[r]).then(t=>Nn(t,e,r)).then(t=>this._compiler.compileModuleAsync(t))}loadFactory(t){let[e,r]=t.split(An),i=Rn;return void 0===r&&(r="default",i=""),n("crnd")(this._config.factoryPathPrefix+e+this._config.factoryPathSuffix).then(t=>t[r+i]).then(t=>Nn(t,e,r))}}function Nn(t,e,n){if(!t)throw new Error(`Cannot find '${n}' in '${e}'`);return t}class On{}class Dn{}class Bn{}class Un{constructor(t,e){this.name=t,this.callback=e}}class zn{constructor(t,e,n){this._debugContext=n,this.nativeNode=t,e&&e instanceof Fn?e.addChild(this):this.parent=null,this.listeners=[]}get injector(){return this._debugContext.injector}get componentInstance(){return this._debugContext.component}get context(){return this._debugContext.context}get references(){return this._debugContext.references}get providerTokens(){return this._debugContext.providerTokens}}class Fn extends zn{constructor(t,e,n){super(t,e,n),this.properties={},this.attributes={},this.classes={},this.styles={},this.childNodes=[],this.nativeElement=t}addChild(t){t&&(this.childNodes.push(t),t.parent=this)}removeChild(t){const e=this.childNodes.indexOf(t);-1!==e&&(t.parent=null,this.childNodes.splice(e,1))}insertChildrenAfter(t,e){const n=this.childNodes.indexOf(t);-1!==n&&(this.childNodes.splice(n+1,0,...e),e.forEach(t=>{t.parent&&t.parent.removeChild(t),t.parent=this}))}insertBefore(t,e){const n=this.childNodes.indexOf(t);-1===n?this.addChild(e):(e.parent&&e.parent.removeChild(e),e.parent=this,this.childNodes.splice(n,0,e))}query(t){return this.queryAll(t)[0]||null}queryAll(t){const e=[];return function t(e,n,r){e.childNodes.forEach(e=>{e instanceof Fn&&(n(e)&&r.push(e),t(e,n,r))})}(this,t,e),e}queryAllNodes(t){const e=[];return function t(e,n,r){e instanceof Fn&&e.childNodes.forEach(e=>{n(e)&&r.push(e),e instanceof Fn&&t(e,n,r)})}(this,t,e),e}get children(){return this.childNodes.filter(t=>t instanceof Fn)}triggerEventHandler(t,e){this.listeners.forEach(n=>{n.name==t&&n.callback(e)})}}const kn=new Map;function Vn(t){return kn.get(t)||null}function Gn(t){kn.set(t.nativeNode,t)}function jn(t,e){const n=qn(t),r=qn(e);return n&&r?function(t,e,n){const r=t[_t()](),i=e[_t()]();for(;;){const t=r.next(),e=i.next();if(t.done&&e.done)return!0;if(t.done||e.done)return!1;if(!n(t.value,e.value))return!1}}(t,e,jn):!(n||!t||"object"!=typeof t&&"function"!=typeof t||r||!e||"object"!=typeof e&&"function"!=typeof e)||St(t,e)}class Hn{constructor(t){this.wrapped=t}static wrap(t){return new Hn(t)}}class Wn{constructor(t,e,n){this.previousValue=t,this.currentValue=e,this.firstChange=n}isFirstChange(){return this.firstChange}}function qn(t){return!!Xn(t)&&(Array.isArray(t)||!(t instanceof Map)&&_t()in t)}function Xn(t){return null!==t&&("function"==typeof t||"object"==typeof t)}const Yn=(t,e)=>e;class Zn{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===e||e<=n.currentIndex)&&St(n.trackById,t))return n;return null}remove(t){const e=t._prevDup,n=t._nextDup;return null===e?this._head=n:e._nextDup=n,null===n?this._tail=e:n._prevDup=e,null===this._head}}class $n{constructor(){this.map=new Map}put(t){const e=t.trackById;let n=this.map.get(e);n||(n=new Zn,this.map.set(e,n)),n.add(t)}get(t,e){const n=this.map.get(t);return n?n.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Qn(t,e,n){const r=t.previousIndex;if(null===r)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}class Jn{constructor(t){this.factories=t}static create(t,e){if(null!=e){const n=e.factories.slice();return t=t.concat(n),new Jn(t)}return new Jn(t)}static extend(t){return{provide:Jn,useFactory:e=>{if(!e)throw new Error("Cannot extend IterableDiffers without a parent injector");return Jn.create(t,e)},deps:[[Jn,new gt,new ft]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(null!=e)return e;throw new Error(`Cannot find a differ supporting object '${t}' of type '${t.name||typeof t}'`)}}class Kn{constructor(t){this.factories=t}static create(t,e){if(e){const n=e.factories.slice();t=t.concat(n)}return new Kn(t)}static extend(t){return{provide:Kn,useFactory:e=>{if(!e)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return Kn.create(t,e)},deps:[[Kn,new gt,new ft]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(e)return e;throw new Error(`Cannot find a differ supporting object '${t}'`)}}const tr=[new class{constructor(){}supports(t){return t instanceof Map||Xn(t)}create(){return new class{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||Xn(t)))throw new Error(`Error trying to diff '${Mt(t)}'. Only maps and objects are allowed`)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(t,n)=>{if(e&&e.key===n)this._maybeAddToChanges(e,t),this._appendAfter=e,e=e._next;else{const r=this._getOrCreateRecordForKey(n,t);e=this._insertBeforeOrAppend(e,r)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let t=e;null!==t;t=t._nextRemoved)t===this._mapHead&&(this._mapHead=null),this._records.delete(t.key),t._nextRemoved=t._next,t.previousValue=t.currentValue,t.currentValue=null,t._prev=null,t._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const n=t._prev;return e._next=t,e._prev=n,t._prev=e,n&&(n._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const n=this._records.get(t);this._maybeAddToChanges(n,e);const r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}const n=new class{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}(t);return this._records.set(t,n),n.currentValue=e,this._addToAdditions(n),n}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){St(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(n=>e(t[n],n))}}}}],er=[new class{constructor(){}supports(t){return qn(t)}create(t){return new class{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||Yn}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,n=this._removalsHead,r=0,i=null;for(;e||n;){const o=!n||e&&e.currentIndex<Qn(n,r,i)?e:n,s=Qn(o,r,i),a=o.currentIndex;if(o===n)r--,n=n._nextRemoved;else if(e=e._next,null==o.previousIndex)r++;else{i||(i=[]);const t=s-r,e=a-r;if(t!=e){for(let n=0;n<t;n++){const r=n<i.length?i[n]:i[n]=0,o=r+n;e<=o&&o<t&&(i[n]=r+1)}i[o.previousIndex]=e-t}}s!==a&&t(o,s,a)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!qn(t))throw new Error(`Error trying to diff '${Mt(t)}'. Only arrays and iterables are allowed`);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e,n,r,i=this._itHead,o=!1;if(Array.isArray(t)){this.length=t.length;for(let e=0;e<this.length;e++)r=this._trackByFn(e,n=t[e]),null!==i&&St(i.trackById,r)?(o&&(i=this._verifyReinsertion(i,n,r,e)),St(i.item,n)||this._addIdentityChange(i,n)):(i=this._mismatch(i,n,r,e),o=!0),i=i._next}else e=0,function(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[_t()]();let r;for(;!(r=n.next()).done;)e(r.value)}}(t,t=>{r=this._trackByFn(e,t),null!==i&&St(i.trackById,r)?(o&&(i=this._verifyReinsertion(i,t,r,e)),St(i.item,t)||this._addIdentityChange(i,t)):(i=this._mismatch(i,t,r,e),o=!0),i=i._next,e++}),this.length=e;return this._truncate(i),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t,e;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=e)t.previousIndex=t.currentIndex,e=t._nextMoved;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,n,r){let i;return null===t?i=this._itTail:(i=t._prev,this._remove(t)),null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(St(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,i,r)):null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(St(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,i,r)):t=this._addAfter(new class{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}(e,n),i,r),t}_verifyReinsertion(t,e,n,r){let i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?t=this._reinsertAfter(i,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const r=t._prevRemoved,i=t._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(t,e,n),this._addToMoves(t,n),t}_moveAfter(t,e,n){return this._unlink(t),this._insertAfter(t,e,n),this._addToMoves(t,n),t}_addAfter(t,e,n){return this._insertAfter(t,e,n),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,n){const r=null===e?this._itHead:e._next;return t._next=r,t._prev=e,null===r?this._itTail=t:r._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new $n),this._linkedRecords.put(t),t.currentIndex=n,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,n=t._next;return null===e?this._itHead=n:e._next=n,null===n?this._itTail=e:n._prev=e,t}_addToMoves(t,e){return t.previousIndex===e?t:(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t,t)}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new $n),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}(t)}}],nr=new Jn(er),rr=new Kn(tr),ir=gn(null,"core",[{provide:Ie,useValue:"unknown"},{provide:yn,deps:[Lt]},{provide:ln,deps:[]},{provide:Oe,deps:[]}]),or=new K("LocaleId");function sr(){return nr}function ar(){return rr}function lr(t){return t||"en-US"}new K("Translations"),new K("TranslationsFormat");class ur{constructor(t){}}const cr=function(){var t={NONE:0,HTML:1,STYLE:2,SCRIPT:3,URL:4,RESOURCE_URL:5};return t[t.NONE]="NONE",t[t.HTML]="HTML",t[t.STYLE]="STYLE",t[t.SCRIPT]="SCRIPT",t[t.URL]="URL",t[t.RESOURCE_URL]="RESOURCE_URL",t}();class hr{}function dr(t,e,n){const r=t.state,i=1792&r;return i===e?(t.state=-1793&r|n,t.initIndex=-1,!0):i===n}function pr(t,e,n){return(1792&t.state)===e&&t.initIndex<=n&&(t.initIndex=n+1,!0)}function fr(t,e){return t.nodes[e]}function mr(t,e){return t.nodes[e]}function gr(t,e){return t.nodes[e]}function vr(t,e){return t.nodes[e]}function yr(t,e){return t.nodes[e]}const wr={setCurrentNode:void 0,createRootView:void 0,createEmbeddedView:void 0,createComponentView:void 0,createNgModuleRef:void 0,overrideProvider:void 0,overrideComponentView:void 0,clearOverrides:void 0,checkAndUpdateView:void 0,checkNoChangesView:void 0,destroyView:void 0,resolveDep:void 0,createDebugContext:void 0,handleEvent:void 0,updateDirectives:void 0,updateRenderer:void 0,dirtyParentQueries:void 0};function br(t,e,n,r){let i=`ExpressionChangedAfterItHasBeenCheckedError: Expression has changed after it was checked. Previous value: '${e}'. Current value: '${n}'.`;return r&&(i+=" It seems like the view has been created after its parent and its children have been dirty checked. Has it been created in a change detection hook ?"),function(t,e){const n=new Error(t);return xr(n,e),n}(i,t)}function xr(t,e){t[Xt]=e,t[Zt]=e.logError.bind(e)}function _r(t){return new Error(`ViewDestroyedError: Attempt to use a destroyed view: ${t}`)}const Er=()=>{},Sr=new Map;function Mr(t){let e=Sr.get(t);return e||(e=Mt(t)+"_"+Sr.size,Sr.set(t,e)),e}const Tr="$$undefined",Cr="$$empty";function Ar(t){return{id:Tr,styles:t.styles,encapsulation:t.encapsulation,data:t.data}}let Rr=0;function Pr(t,e,n,r){return!(!(2&t.state)&&St(t.oldValues[e.bindingIndex+n],r))}function Lr(t,e,n,r){return!!Pr(t,e,n,r)&&(t.oldValues[e.bindingIndex+n]=r,!0)}function Ir(t,e,n,r){const i=t.oldValues[e.bindingIndex+n];if(1&t.state||!jn(i,r))throw br(wr.createDebugContext(t,e.nodeIndex),i,r,0!=(1&t.state))}function Nr(t){let e=t;for(;e;)2&e.def.flags&&(e.state|=8),e=e.viewContainerParent||e.parent}function Or(t,e){let n=t;for(;n&&n!==e;)n.state|=64,n=n.viewContainerParent||n.parent}function Dr(t,e,n,r){try{return Nr(33554432&t.def.nodes[e].flags?mr(t,e).componentView:t),wr.handleEvent(t,e,n,r)}catch(e){t.root.errorHandler.handleError(e)}}function Br(t){return t.parent?mr(t.parent,t.parentNodeDef.nodeIndex):null}function Ur(t){return t.parent?t.parentNodeDef.parent:null}function zr(t,e){switch(201347067&e.flags){case 1:return mr(t,e.nodeIndex).renderElement;case 2:return fr(t,e.nodeIndex).renderText}}function Fr(t,e){return t?`${t}:${e}`:e}function kr(t){return!!t.parent&&!!(32768&t.parentNodeDef.flags)}function Vr(t){return!(!t.parent||32768&t.parentNodeDef.flags)}function Gr(t){return 1<<t%32}function jr(t){const e={};let n=0;const r={};return t&&t.forEach(([t,i])=>{"number"==typeof t?(e[t]=i,n|=Gr(t)):r[t]=i}),{matchedQueries:e,references:r,matchedQueryIds:n}}function Hr(t,e){return t.map(t=>{let n,r;return Array.isArray(t)?[r,n]=t:(r=0,n=t),n&&("function"==typeof n||"object"==typeof n)&&e&&Object.defineProperty(n,At,{value:e,configurable:!0}),{flags:r,token:n,tokenKey:Mr(n)}})}function Wr(t,e,n){let r=n.renderParent;return r?0==(1&r.flags)||0==(33554432&r.flags)||r.element.componentRendererType&&r.element.componentRendererType.encapsulation===ct.Native?mr(t,n.renderParent.nodeIndex).renderElement:void 0:e}const qr=new WeakMap;function Xr(t){let e=qr.get(t);return e||((e=t(()=>Er)).factory=t,qr.set(t,e)),e}function Yr(t,e,n,r,i){3===e&&(n=t.renderer.parentNode(zr(t,t.def.lastRenderRootNode))),Zr(t,e,0,t.def.nodes.length-1,n,r,i)}function Zr(t,e,n,r,i,o,s){for(let a=n;a<=r;a++){const n=t.def.nodes[a];11&n.flags&&Qr(t,n,e,i,o,s),a+=n.childCount}}function $r(t,e,n,r,i,o){let s=t;for(;s&&!kr(s);)s=s.parent;const a=s.parent,l=Ur(s),u=l.nodeIndex+l.childCount;for(let c=l.nodeIndex+1;c<=u;c++){const t=a.def.nodes[c];t.ngContentIndex===e&&Qr(a,t,n,r,i,o),c+=t.childCount}if(!a.parent){const s=t.root.projectableNodes[e];if(s)for(let e=0;e<s.length;e++)Jr(t,s[e],n,r,i,o)}}function Qr(t,e,n,r,i,o){if(8&e.flags)$r(t,e.ngContent.index,n,r,i,o);else{const s=zr(t,e);if(3===n&&33554432&e.flags&&48&e.bindingFlags?(16&e.bindingFlags&&Jr(t,s,n,r,i,o),32&e.bindingFlags&&Jr(mr(t,e.nodeIndex).componentView,s,n,r,i,o)):Jr(t,s,n,r,i,o),16777216&e.flags){const s=mr(t,e.nodeIndex).viewContainer._embeddedViews;for(let t=0;t<s.length;t++)Yr(s[t],n,r,i,o)}1&e.flags&&!e.element.name&&Zr(t,n,e.nodeIndex+1,e.nodeIndex+e.childCount,r,i,o)}}function Jr(t,e,n,r,i,o){const s=t.renderer;switch(n){case 1:s.appendChild(r,e);break;case 2:s.insertBefore(r,e,i);break;case 3:s.removeChild(r,e);break;case 0:o.push(e)}}const Kr=/^:([^:]+):(.+)$/;function ti(t){if(":"===t[0]){const e=t.match(Kr);return[e[1],e[2]]}return["",t]}function ei(t){let e=0;for(let n=0;n<t.length;n++)e|=t[n].flags;return e}function ni(t,e,n,r,i,o,s=[],a,l,u,c,h){u||(u=Er);const{matchedQueries:d,references:p,matchedQueryIds:f}=jr(n);let m=null,g=null;o&&([m,g]=ti(o)),a=a||[];const v=new Array(a.length);for(let b=0;b<a.length;b++){const[t,e,n]=a[b],[r,i]=ti(e);let o=void 0,s=void 0;switch(15&t){case 4:s=n;break;case 1:case 8:o=n}v[b]={flags:t,ns:r,name:i,nonMinifiedName:i,securityContext:o,suffix:s}}l=l||[];const y=new Array(l.length);for(let b=0;b<l.length;b++){const[t,e]=l[b];y[b]={type:0,target:t,eventName:e,propName:null}}const w=(s=s||[]).map(([t,e])=>{const[n,r]=ti(t);return[n,r,e]});return h=function(t){if(t&&t.id===Tr){const e=null!=t.encapsulation&&t.encapsulation!==ct.None||t.styles.length||Object.keys(t.data).length;t.id=e?`c${Rr++}`:Cr}return t&&t.id===Cr&&(t=null),t||null}(h),c&&(e|=33554432),{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:t,flags:e|=1,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:d,matchedQueryIds:f,references:p,ngContentIndex:r,childCount:i,bindings:v,bindingFlags:ei(v),outputs:y,element:{ns:m,name:g,attrs:w,template:null,componentProvider:null,componentView:c||null,componentRendererType:h,publicProviders:null,allProviders:null,handleEvent:u||Er},provider:null,text:null,query:null,ngContent:null}}function ri(t,e,n){const r=n.element,i=t.root.selectorOrNode,o=t.renderer;let s;if(t.parent||!i){s=r.name?o.createElement(r.name,r.ns):o.createComment("");const i=Wr(t,e,n);i&&o.appendChild(i,s)}else s=o.selectRootElement(i);if(r.attrs)for(let a=0;a<r.attrs.length;a++){const[t,e,n]=r.attrs[a];o.setAttribute(s,e,n,t)}return s}function ii(t,e,n,r){for(let i=0;i<n.outputs.length;i++){const o=n.outputs[i],s=oi(t,n.nodeIndex,Fr(o.target,o.eventName));let a=o.target,l=t;"component"===o.target&&(a=null,l=e);const u=l.renderer.listen(a||r,o.eventName,s);t.disposables[n.outputIndex+i]=u}}function oi(t,e,n){return r=>Dr(t,e,n,r)}function si(t,e,n,r){if(!Lr(t,e,n,r))return!1;const i=e.bindings[n],o=mr(t,e.nodeIndex),s=o.renderElement,a=i.name;switch(15&i.flags){case 1:!function(t,e,n,r,i,o){const s=e.securityContext;let a=s?t.root.sanitizer.sanitize(s,o):o;a=null!=a?a.toString():null;const l=t.renderer;null!=o?l.setAttribute(n,i,a,r):l.removeAttribute(n,i,r)}(t,i,s,i.ns,a,r);break;case 2:!function(t,e,n,r){const i=t.renderer;r?i.addClass(e,n):i.removeClass(e,n)}(t,s,a,r);break;case 4:!function(t,e,n,r,i){let o=t.root.sanitizer.sanitize(cr.STYLE,i);if(null!=o){o=o.toString();const t=e.suffix;null!=t&&(o+=t)}else o=null;const s=t.renderer;null!=o?s.setStyle(n,r,o):s.removeStyle(n,r)}(t,i,s,a,r);break;case 8:!function(t,e,n,r,i){const o=e.securityContext;let s=o?t.root.sanitizer.sanitize(o,i):i;t.renderer.setProperty(n,r,s)}(33554432&e.flags&&32&i.flags?o.componentView:t,i,s,a,r)}return!0}const ai=new Object,li=Mr(Lt),ui=Mr(We);function ci(t,e,n,r){return n=Ct(n),{index:-1,deps:Hr(r,Mt(e)),flags:t,token:e,value:n}}function hi(t,e,n=Lt.THROW_IF_NOT_FOUND){if(8&e.flags)return e.token;if(2&e.flags&&(n=null),1&e.flags)return t._parent.get(e.token,n);const r=e.tokenKey;switch(r){case li:case ui:return t}const i=t._def.providersByKey[r];if(i){let e=t._providers[i.index];return void 0===e&&(e=t._providers[i.index]=di(t,i)),e===ai?void 0:e}return t._parent.get(e.token,n)}function di(t,e){let n;switch(201347067&e.flags){case 512:n=function(t,e,n){const r=n.length;switch(r){case 0:return new e;case 1:return new e(hi(t,n[0]));case 2:return new e(hi(t,n[0]),hi(t,n[1]));case 3:return new e(hi(t,n[0]),hi(t,n[1]),hi(t,n[2]));default:const i=new Array(r);for(let e=0;e<r;e++)i[e]=hi(t,n[e]);return new e(...i)}}(t,e.value,e.deps);break;case 1024:n=function(t,e,n){const r=n.length;switch(r){case 0:return e();case 1:return e(hi(t,n[0]));case 2:return e(hi(t,n[0]),hi(t,n[1]));case 3:return e(hi(t,n[0]),hi(t,n[1]),hi(t,n[2]));default:const i=Array(r);for(let e=0;e<r;e++)i[e]=hi(t,n[e]);return e(...i)}}(t,e.value,e.deps);break;case 2048:n=hi(t,e.deps[0]);break;case 256:n=e.value}return void 0===n?ai:n}function pi(t,e){const n=t.viewContainer._embeddedViews;if((null==e||e>=n.length)&&(e=n.length-1),e<0)return null;const r=n[e];return r.viewContainerParent=null,vi(n,e),wr.dirtyParentQueries(r),mi(r),r}function fi(t,e,n){const r=e?zr(e,e.def.lastRenderRootNode):t.renderElement;Yr(n,2,n.renderer.parentNode(r),n.renderer.nextSibling(r),void 0)}function mi(t){Yr(t,3,null,null,void 0)}function gi(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function vi(t,e){e>=t.length-1?t.pop():t.splice(e,1)}const yi=new Object;function wi(t,e,n,r,i,o){return new bi(t,e,n,r,i,o)}class bi extends Fe{constructor(t,e,n,r,i,o){super(),this.selector=t,this.componentType=e,this._inputs=r,this._outputs=i,this.ngContentSelectors=o,this.viewDefFactory=n}get inputs(){const t=[],e=this._inputs;for(let n in e)t.push({propName:n,templateName:e[n]});return t}get outputs(){const t=[];for(let e in this._outputs)t.push({propName:e,templateName:this._outputs[e]});return t}create(t,e,n,r){if(!r)throw new Error("ngModule should be provided");const i=Xr(this.viewDefFactory),o=i.nodes[0].element.componentProvider.nodeIndex,s=wr.createRootView(t,e||[],n,i,r,yi),a=gr(s,o).instance;return n&&s.renderer.setAttribute(mr(s,0).renderElement,"ng-version",dt.full),new xi(s,new Mi(s),a)}}class xi extends ze{constructor(t,e,n){super(),this._view=t,this._viewRef=e,this._component=n,this._elDef=this._view.def.nodes[0],this.hostView=e,this.changeDetectorRef=e,this.instance=n}get location(){return new Mn(mr(this._view,this._elDef.nodeIndex).renderElement)}get injector(){return new Ri(this._view,this._elDef)}get componentType(){return this._component.constructor}destroy(){this._viewRef.destroy()}onDestroy(t){this._viewRef.onDestroy(t)}}function _i(t,e,n){return new Ei(t,e,n)}class Ei{constructor(t,e,n){this._view=t,this._elDef=e,this._data=n,this._embeddedViews=[]}get element(){return new Mn(this._data.renderElement)}get injector(){return new Ri(this._view,this._elDef)}get parentInjector(){let t=this._view,e=this._elDef.parent;for(;!e&&t;)e=Ur(t),t=t.parent;return t?new Ri(t,e):new Ri(this._view,null)}clear(){for(let t=this._embeddedViews.length-1;t>=0;t--){const e=pi(this._data,t);wr.destroyView(e)}}get(t){const e=this._embeddedViews[t];if(e){const t=new Mi(e);return t.attachToViewContainerRef(this),t}return null}get length(){return this._embeddedViews.length}createEmbeddedView(t,e,n){const r=t.createEmbeddedView(e||{});return this.insert(r,n),r}createComponent(t,e,n,r,i){const o=n||this.parentInjector;i||t instanceof He||(i=o.get(We));const s=t.create(o,r,void 0,i);return this.insert(s.hostView,e),s}insert(t,e){if(t.destroyed)throw new Error("Cannot insert a destroyed View in a ViewContainer!");const n=t;return function(t,e,n,r){let i=e.viewContainer._embeddedViews;null!==n&&void 0!==n||(n=i.length),r.viewContainerParent=t,gi(i,n,r),function(t,e){const n=Br(e);if(!n||n===t||16&e.state)return;e.state|=16;let r=n.template._projectedViews;r||(r=n.template._projectedViews=[]),r.push(e),function(t,e){if(4&e.flags)return;t.nodeFlags|=4,e.flags|=4;let n=e.parent;for(;n;)n.childFlags|=4,n=n.parent}(e.parent.def,e.parentNodeDef)}(e,r),wr.dirtyParentQueries(r),fi(e,n>0?i[n-1]:null,r)}(this._view,this._data,e,n._view),n.attachToViewContainerRef(this),t}move(t,e){if(t.destroyed)throw new Error("Cannot move a destroyed View in a ViewContainer!");const n=this._embeddedViews.indexOf(t._view);return function(t,e,r){const i=t.viewContainer._embeddedViews,o=i[n];vi(i,n),null==r&&(r=i.length),gi(i,r,o),wr.dirtyParentQueries(o),mi(o),fi(t,r>0?i[r-1]:null,o)}(this._data,0,e),t}indexOf(t){return this._embeddedViews.indexOf(t._view)}remove(t){const e=pi(this._data,t);e&&wr.destroyView(e)}detach(t){const e=pi(this._data,t);return e?new Mi(e):null}}function Si(t){return new Mi(t)}class Mi{constructor(t){this._view=t,this._viewContainerRef=null,this._appRef=null}get rootNodes(){return function(t){const e=[];return Yr(t,0,void 0,void 0,e),e}(this._view)}get context(){return this._view.context}get destroyed(){return 0!=(128&this._view.state)}markForCheck(){Nr(this._view)}detach(){this._view.state&=-5}detectChanges(){const t=this._view.root.rendererFactory;t.begin&&t.begin();try{wr.checkAndUpdateView(this._view)}finally{t.end&&t.end()}}checkNoChanges(){wr.checkNoChangesView(this._view)}reattach(){this._view.state|=4}onDestroy(t){this._view.disposables||(this._view.disposables=[]),this._view.disposables.push(t)}destroy(){this._appRef?this._appRef.detachView(this):this._viewContainerRef&&this._viewContainerRef.detach(this._viewContainerRef.indexOf(this)),wr.destroyView(this._view)}detachFromAppRef(){this._appRef=null,mi(this._view),wr.dirtyParentQueries(this._view)}attachToAppRef(t){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=t}attachToViewContainerRef(t){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=t}}function Ti(t,e){return new Ci(t,e)}class Ci extends On{constructor(t,e){super(),this._parentView=t,this._def=e}createEmbeddedView(t){return new Mi(wr.createEmbeddedView(this._parentView,this._def,this._def.element.template,t))}get elementRef(){return new Mn(mr(this._parentView,this._def.nodeIndex).renderElement)}}function Ai(t,e){return new Ri(t,e)}class Ri{constructor(t,e){this.view=t,this.elDef=e}get(t,e=Lt.THROW_IF_NOT_FOUND){return wr.resolveDep(this.view,this.elDef,!!this.elDef&&0!=(33554432&this.elDef.flags),{flags:0,token:t,tokenKey:Mr(t)},e)}}function Pi(t,e){const n=t.def.nodes[e];if(1&n.flags){const e=mr(t,n.nodeIndex);return n.element.template?e.template:e.renderElement}if(2&n.flags)return fr(t,n.nodeIndex).renderText;if(20240&n.flags)return gr(t,n.nodeIndex).instance;throw new Error(`Illegal state: read nodeValue for node index ${e}`)}function Li(t){return new Ii(t.renderer)}class Ii{constructor(t){this.delegate=t}selectRootElement(t){return this.delegate.selectRootElement(t)}createElement(t,e){const[n,r]=ti(e),i=this.delegate.createElement(r,n);return t&&this.delegate.appendChild(t,i),i}createViewRoot(t){return t}createTemplateAnchor(t){const e=this.delegate.createComment("");return t&&this.delegate.appendChild(t,e),e}createText(t,e){const n=this.delegate.createText(e);return t&&this.delegate.appendChild(t,n),n}projectNodes(t,e){for(let n=0;n<e.length;n++)this.delegate.appendChild(t,e[n])}attachViewAfter(t,e){const n=this.delegate.parentNode(t),r=this.delegate.nextSibling(t);for(let i=0;i<e.length;i++)this.delegate.insertBefore(n,e[i],r)}detachView(t){for(let e=0;e<t.length;e++){const n=t[e],r=this.delegate.parentNode(n);this.delegate.removeChild(r,n)}}destroyView(t,e){for(let n=0;n<e.length;n++)this.delegate.destroyNode(e[n])}listen(t,e,n){return this.delegate.listen(t,e,n)}listenGlobal(t,e,n){return this.delegate.listen(t,e,n)}setElementProperty(t,e,n){this.delegate.setProperty(t,e,n)}setElementAttribute(t,e,n){const[r,i]=ti(e);null!=n?this.delegate.setAttribute(t,i,n,r):this.delegate.removeAttribute(t,i,r)}setBindingDebugInfo(t,e,n){}setElementClass(t,e,n){n?this.delegate.addClass(t,e):this.delegate.removeClass(t,e)}setElementStyle(t,e,n){null!=n?this.delegate.setStyle(t,e,n):this.delegate.removeStyle(t,e)}invokeElementMethod(t,e,n){t[e].apply(t,n)}setText(t,e){this.delegate.setValue(t,e)}animate(){throw new Error("Renderer.animate is no longer supported!")}}function Ni(t,e,n,r){return new Oi(t,e,n,r)}class Oi{constructor(t,e,n,r){this._moduleType=t,this._parent=e,this._bootstrapComponents=n,this._def=r,this._destroyListeners=[],this._destroyed=!1,this.injector=this,function(t){const e=t._def,n=t._providers=new Array(e.providers.length);for(let r=0;r<e.providers.length;r++){const i=e.providers[r];4096&i.flags||(n[r]=di(t,i))}}(this)}get(t,e=Lt.THROW_IF_NOT_FOUND){return hi(this,{token:t,tokenKey:Mr(t),flags:0},e)}get instance(){return this.get(this._moduleType)}get componentFactoryResolver(){return this.get(Ge)}destroy(){if(this._destroyed)throw new Error(`The ng module ${Mt(this.instance.constructor)} has already been destroyed.`);this._destroyed=!0,function(t,e){const n=t._def;for(let r=0;r<n.providers.length;r++)if(131072&n.providers[r].flags){const e=t._providers[r];e&&e!==ai&&e.ngOnDestroy()}}(this),this._destroyListeners.forEach(t=>t())}onDestroy(t){this._destroyListeners.push(t)}}const Di=Mr(class{}),Bi=Mr(Sn),Ui=Mr(Mn),zi=Mr(Dn),Fi=Mr(On),ki=Mr(Bn),Vi=Mr(Lt);function Gi(t,e,n,r,i,o,s,a){const l=[];if(s)for(let c in s){const[t,e]=s[c];l[t]={flags:8,name:c,nonMinifiedName:e,ns:null,securityContext:null,suffix:null}}const u=[];if(a)for(let c in a)u.push({type:1,propName:c,target:null,eventName:a[c]});return Hi(t,e|=16384,n,r,i,i,o,l,u)}function ji(t,e,n,r,i){return Hi(-1,t,e,0,n,r,i)}function Hi(t,e,n,r,i,o,s,a,l){const{matchedQueries:u,references:c,matchedQueryIds:h}=jr(n);l||(l=[]),a||(a=[]),o=Ct(o);const d=Hr(s,Mt(i));return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:t,flags:e,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:u,matchedQueryIds:h,references:c,ngContentIndex:-1,childCount:r,bindings:a,bindingFlags:ei(a),outputs:l,element:null,provider:{token:i,value:o,deps:d},text:null,query:null,ngContent:null}}function Wi(t,e){return Zi(t,e)}function qi(t,e){let n=t;for(;n.parent&&!kr(n);)n=n.parent;return $i(n.parent,Ur(n),!0,e.provider.value,e.provider.deps)}function Xi(t,e){const n=$i(t,e.parent,(32768&e.flags)>0,e.provider.value,e.provider.deps);if(e.outputs.length)for(let r=0;r<e.outputs.length;r++){const i=e.outputs[r],o=n[i.propName].subscribe(Yi(t,e.parent.nodeIndex,i.eventName));t.disposables[e.outputIndex+r]=o.unsubscribe.bind(o)}return n}function Yi(t,e,n){return r=>Dr(t,e,n,r)}function Zi(t,e){const n=(8192&e.flags)>0,r=e.provider;switch(201347067&e.flags){case 512:return $i(t,e.parent,n,r.value,r.deps);case 1024:return function(t,e,n,r,i){const o=i.length;switch(o){case 0:return r();case 1:return r(Ji(t,e,n,i[0]));case 2:return r(Ji(t,e,n,i[0]),Ji(t,e,n,i[1]));case 3:return r(Ji(t,e,n,i[0]),Ji(t,e,n,i[1]),Ji(t,e,n,i[2]));default:const s=Array(o);for(let r=0;r<o;r++)s[r]=Ji(t,e,n,i[r]);return r(...s)}}(t,e.parent,n,r.value,r.deps);case 2048:return Ji(t,e.parent,n,r.deps[0]);case 256:return r.value}}function $i(t,e,n,r,i){const o=i.length;switch(o){case 0:return new r;case 1:return new r(Ji(t,e,n,i[0]));case 2:return new r(Ji(t,e,n,i[0]),Ji(t,e,n,i[1]));case 3:return new r(Ji(t,e,n,i[0]),Ji(t,e,n,i[1]),Ji(t,e,n,i[2]));default:const s=new Array(o);for(let r=0;r<o;r++)s[r]=Ji(t,e,n,i[r]);return new r(...s)}}const Qi={};function Ji(t,e,n,r,i=Lt.THROW_IF_NOT_FOUND){if(8&r.flags)return r.token;const o=t;2&r.flags&&(i=null);const s=r.tokenKey;for(s===ki&&(n=!(!e||!e.element.componentView)),e&&1&r.flags&&(n=!1,e=e.parent);t;){if(e)switch(s){case Di:return Li(Ki(t,e,n));case Bi:return Ki(t,e,n).renderer;case Ui:return new Mn(mr(t,e.nodeIndex).renderElement);case zi:return mr(t,e.nodeIndex).viewContainer;case Fi:if(e.element.template)return mr(t,e.nodeIndex).template;break;case ki:return Si(Ki(t,e,n));case Vi:return Ai(t,e);default:const r=(n?e.element.allProviders:e.element.publicProviders)[s];if(r){let e=gr(t,r.nodeIndex);return e||(e={instance:Zi(t,r)},t.nodes[r.nodeIndex]=e),e.instance}}n=kr(t),e=Ur(t),t=t.parent}const a=o.root.injector.get(r.token,Qi);return a!==Qi||i===Qi?a:o.root.ngModule.injector.get(r.token,i)}function Ki(t,e,n){let r;if(n)r=mr(t,e.nodeIndex).componentView;else for(r=t;r.parent&&!kr(r);)r=r.parent;return r}function to(t,e,n,r,i,o){if(32768&n.flags){const e=mr(t,n.parent.nodeIndex).componentView;2&e.def.flags&&(e.state|=8)}if(e.instance[n.bindings[r].name]=i,524288&n.flags){o=o||{};let e=t.oldValues[n.bindingIndex+r];e instanceof Hn&&(e=e.wrapped),o[n.bindings[r].nonMinifiedName]=new Wn(e,i,0!=(2&t.state))}return t.oldValues[n.bindingIndex+r]=i,o}function eo(t,e){if(!(t.def.nodeFlags&e))return;const n=t.def.nodes;let r=0;for(let i=0;i<n.length;i++){const o=n[i];let s=o.parent;for(!s&&o.flags&e&&ro(t,i,o.flags&e,r++),0==(o.childFlags&e)&&(i+=o.childCount);s&&1&s.flags&&i===s.nodeIndex+s.childCount;)s.directChildFlags&e&&(r=no(t,s,e,r)),s=s.parent}}function no(t,e,n,r){for(let i=e.nodeIndex+1;i<=e.nodeIndex+e.childCount;i++){const e=t.def.nodes[i];e.flags&n&&ro(t,i,e.flags&n,r++),i+=e.childCount}return r}function ro(t,e,n,r){const i=gr(t,e);if(!i)return;const o=i.instance;o&&(wr.setCurrentNode(t,e),1048576&n&&pr(t,512,r)&&o.ngAfterContentInit(),2097152&n&&o.ngAfterContentChecked(),4194304&n&&pr(t,768,r)&&o.ngAfterViewInit(),8388608&n&&o.ngAfterViewChecked(),131072&n&&o.ngOnDestroy())}function io(t,e,n){let r=[];for(let i in n)r.push({propName:i,bindingType:n[i]});return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:-1,flags:t,childFlags:0,directChildFlags:0,childMatchedQueries:0,ngContentIndex:-1,matchedQueries:{},matchedQueryIds:0,references:{},childCount:0,bindings:[],bindingFlags:0,outputs:[],element:null,provider:null,text:null,query:{id:e,filterId:Gr(e),bindings:r},ngContent:null}}function oo(t){const e=t.def.nodeMatchedQueries;for(;t.parent&&Vr(t);){let n=t.parentNodeDef;t=t.parent;const r=n.nodeIndex+n.childCount;for(let i=0;i<=r;i++){const r=t.def.nodes[i];67108864&r.flags&&536870912&r.flags&&(r.query.filterId&e)===r.query.filterId&&yr(t,i).setDirty(),!(1&r.flags&&i+r.childCount<n.nodeIndex)&&67108864&r.childFlags&&536870912&r.childFlags||(i+=r.childCount)}}if(134217728&t.def.nodeFlags)for(let n=0;n<t.def.nodes.length;n++){const e=t.def.nodes[n];134217728&e.flags&&536870912&e.flags&&yr(t,n).setDirty(),n+=e.childCount}}function so(t,e){const n=yr(t,e.nodeIndex);if(!n.dirty)return;let r,i=void 0;if(67108864&e.flags){const n=e.parent.parent;i=ao(t,n.nodeIndex,n.nodeIndex+n.childCount,e.query,[]),r=gr(t,e.parent.nodeIndex).instance}else 134217728&e.flags&&(i=ao(t,0,t.def.nodes.length-1,e.query,[]),r=t.component);n.reset(i);const o=e.query.bindings;let s=!1;for(let a=0;a<o.length;a++){const t=o[a];let e;switch(t.bindingType){case 0:e=n.first;break;case 1:e=n,s=!0}r[t.propName]=e}s&&n.notifyOnChanges()}function ao(t,e,n,r,i){for(let o=e;o<=n;o++){const e=t.def.nodes[o],n=e.matchedQueries[r.id];if(null!=n&&i.push(lo(t,e,n)),1&e.flags&&e.element.template&&(e.element.template.nodeMatchedQueries&r.filterId)===r.filterId){const n=mr(t,o);if((e.childMatchedQueries&r.filterId)===r.filterId&&(ao(t,o+1,o+e.childCount,r,i),o+=e.childCount),16777216&e.flags){const t=n.viewContainer._embeddedViews;for(let e=0;e<t.length;e++){const o=t[e],s=Br(o);s&&s===n&&ao(o,0,o.def.nodes.length-1,r,i)}}const s=n.template._projectedViews;if(s)for(let t=0;t<s.length;t++){const e=s[t];ao(e,0,e.def.nodes.length-1,r,i)}}(e.childMatchedQueries&r.filterId)!==r.filterId&&(o+=e.childCount)}return i}function lo(t,e,n){if(null!=n)switch(n){case 1:return mr(t,e.nodeIndex).renderElement;case 0:return new Mn(mr(t,e.nodeIndex).renderElement);case 2:return mr(t,e.nodeIndex).template;case 3:return mr(t,e.nodeIndex).viewContainer;case 4:return gr(t,e.nodeIndex).instance}}function uo(t,e,n){const r=Wr(t,e,n);r&&$r(t,n.ngContent.index,1,r,null,void 0)}function co(t,e,n){const r=new Array(n.length-1);for(let i=1;i<n.length;i++)r[i-1]={flags:8,name:null,ns:null,nonMinifiedName:null,securityContext:null,suffix:n[i]};return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:t,flags:2,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:{},matchedQueryIds:0,references:{},ngContentIndex:e,childCount:0,bindings:r,bindingFlags:8,outputs:[],element:null,provider:null,text:{prefix:n[0]},query:null,ngContent:null}}function ho(t,e,n){let r;const i=t.renderer;r=i.createText(n.text.prefix);const o=Wr(t,e,n);return o&&i.appendChild(o,r),{renderText:r}}function po(t,e){return(null!=t?t.toString():"")+e.suffix}function fo(t,e,n,r){let i=0,o=0,s=0,a=0,l=0,u=null,c=null,h=!1,d=!1,p=null;for(let f=0;f<e.length;f++){const t=e[f];if(t.nodeIndex=f,t.parent=u,t.bindingIndex=i,t.outputIndex=o,t.renderParent=c,s|=t.flags,l|=t.matchedQueryIds,t.element){const e=t.element;e.publicProviders=u?u.element.publicProviders:Object.create(null),e.allProviders=e.publicProviders,h=!1,d=!1,t.element.template&&(l|=t.element.template.nodeMatchedQueries)}if(go(u,t,e.length),i+=t.bindings.length,o+=t.outputs.length,!c&&3&t.flags&&(p=t),20224&t.flags){h||(h=!0,u.element.publicProviders=Object.create(u.element.publicProviders),u.element.allProviders=u.element.publicProviders);const e=0!=(32768&t.flags);0==(8192&t.flags)||e?u.element.publicProviders[Mr(t.provider.token)]=t:(d||(d=!0,u.element.allProviders=Object.create(u.element.publicProviders)),u.element.allProviders[Mr(t.provider.token)]=t),e&&(u.element.componentProvider=t)}if(u?(u.childFlags|=t.flags,u.directChildFlags|=t.flags,u.childMatchedQueries|=t.matchedQueryIds,t.element&&t.element.template&&(u.childMatchedQueries|=t.element.template.nodeMatchedQueries)):a|=t.flags,t.childCount>0)u=t,mo(t)||(c=t);else for(;u&&f===u.nodeIndex+u.childCount;){const t=u.parent;t&&(t.childFlags|=u.childFlags,t.childMatchedQueries|=u.childMatchedQueries),c=(u=t)&&mo(u)?u.renderParent:u}}return{factory:null,nodeFlags:s,rootNodeFlags:a,nodeMatchedQueries:l,flags:t,nodes:e,updateDirectives:n||Er,updateRenderer:r||Er,handleEvent:(t,n,r,i)=>e[n].element.handleEvent(t,r,i),bindingCount:i,outputCount:o,lastRenderRootNode:p}}function mo(t){return 0!=(1&t.flags)&&null===t.element.name}function go(t,e,n){const r=e.element&&e.element.template;if(r){if(!r.lastRenderRootNode)throw new Error("Illegal State: Embedded templates without nodes are not allowed!");if(r.lastRenderRootNode&&16777216&r.lastRenderRootNode.flags)throw new Error(`Illegal State: Last root node of a template can't have embedded views, at index ${e.nodeIndex}!`)}if(20224&e.flags&&0==(1&(t?t.flags:0)))throw new Error(`Illegal State: StaticProvider/Directive nodes need to be children of elements or anchors, at index ${e.nodeIndex}!`);if(e.query){if(67108864&e.flags&&(!t||0==(16384&t.flags)))throw new Error(`Illegal State: Content Query nodes need to be children of directives, at index ${e.nodeIndex}!`);if(134217728&e.flags&&t)throw new Error(`Illegal State: View Query nodes have to be top level nodes, at index ${e.nodeIndex}!`)}if(e.childCount){const r=t?t.nodeIndex+t.childCount:n-1;if(e.nodeIndex<=r&&e.nodeIndex+e.childCount>r)throw new Error(`Illegal State: childCount of node leads outside of parent, at index ${e.nodeIndex}!`)}}function vo(t,e,n,r){const i=bo(t.root,t.renderer,t,e,n);return xo(i,t.component,r),_o(i),i}function yo(t,e,n){const r=bo(t,t.renderer,null,null,e);return xo(r,n,n),_o(r),r}function wo(t,e,n,r){const i=e.element.componentRendererType;let o;return o=i?t.root.rendererFactory.createRenderer(r,i):t.root.renderer,bo(t.root,o,t,e.element.componentProvider,n)}function bo(t,e,n,r,i){const o=new Array(i.nodes.length),s=i.outputCount?new Array(i.outputCount):null;return{def:i,parent:n,viewContainerParent:null,parentNodeDef:r,context:null,component:null,nodes:o,state:13,root:t,renderer:e,oldValues:new Array(i.bindingCount),disposables:s,initIndex:-1}}function xo(t,e,n){t.component=e,t.context=n}function _o(t){let e;kr(t)&&(e=mr(t.parent,t.parentNodeDef.parent.nodeIndex).renderElement);const n=t.def,r=t.nodes;for(let i=0;i<n.nodes.length;i++){const o=n.nodes[i];let s;switch(wr.setCurrentNode(t,i),201347067&o.flags){case 1:const n=ri(t,e,o);let a=void 0;if(33554432&o.flags){const e=Xr(o.element.componentView);a=wr.createComponentView(t,o,e,n)}ii(t,a,o,n),s={renderElement:n,componentView:a,viewContainer:null,template:o.element.template?Ti(t,o):void 0},16777216&o.flags&&(s.viewContainer=_i(t,o,s));break;case 2:s=ho(t,e,o);break;case 512:case 1024:case 2048:case 256:(s=r[i])||4096&o.flags||(s={instance:Wi(t,o)});break;case 16:s={instance:qi(t,o)};break;case 16384:(s=r[i])||(s={instance:Xi(t,o)}),32768&o.flags&&xo(mr(t,o.parent.nodeIndex).componentView,s.instance,s.instance);break;case 32:case 64:case 128:s={value:void 0};break;case 67108864:case 134217728:s=new Cn;break;case 8:uo(t,e,o),s=void 0}r[i]=s}Lo(t,Po.CreateViewNodes),Do(t,201326592,268435456,0)}function Eo(t){To(t),wr.updateDirectives(t,1),Io(t,Po.CheckNoChanges),wr.updateRenderer(t,1),Lo(t,Po.CheckNoChanges),t.state&=-97}function So(t){1&t.state?(t.state&=-2,t.state|=2):t.state&=-3,dr(t,0,256),To(t),wr.updateDirectives(t,0),Io(t,Po.CheckAndUpdate),Do(t,67108864,536870912,0);let e=dr(t,256,512);eo(t,2097152|(e?1048576:0)),wr.updateRenderer(t,0),Lo(t,Po.CheckAndUpdate),Do(t,134217728,536870912,0),eo(t,8388608|((e=dr(t,512,768))?4194304:0)),2&t.def.flags&&(t.state&=-9),t.state&=-97,dr(t,768,1024)}function Mo(t,e,n,r,i,o,s,a,l,u,c,h,d){return 0===n?function(t,e,n,r,i,o,s,a,l,u,c,h){switch(201347067&e.flags){case 1:return function(t,e,n,r,i,o,s,a,l,u,c,h){const d=e.bindings.length;let p=!1;return d>0&&si(t,e,0,n)&&(p=!0),d>1&&si(t,e,1,r)&&(p=!0),d>2&&si(t,e,2,i)&&(p=!0),d>3&&si(t,e,3,o)&&(p=!0),d>4&&si(t,e,4,s)&&(p=!0),d>5&&si(t,e,5,a)&&(p=!0),d>6&&si(t,e,6,l)&&(p=!0),d>7&&si(t,e,7,u)&&(p=!0),d>8&&si(t,e,8,c)&&(p=!0),d>9&&si(t,e,9,h)&&(p=!0),p}(t,e,n,r,i,o,s,a,l,u,c,h);case 2:return function(t,e,n,r,i,o,s,a,l,u,c,h){let d=!1;const p=e.bindings,f=p.length;if(f>0&&Lr(t,e,0,n)&&(d=!0),f>1&&Lr(t,e,1,r)&&(d=!0),f>2&&Lr(t,e,2,i)&&(d=!0),f>3&&Lr(t,e,3,o)&&(d=!0),f>4&&Lr(t,e,4,s)&&(d=!0),f>5&&Lr(t,e,5,a)&&(d=!0),f>6&&Lr(t,e,6,l)&&(d=!0),f>7&&Lr(t,e,7,u)&&(d=!0),f>8&&Lr(t,e,8,c)&&(d=!0),f>9&&Lr(t,e,9,h)&&(d=!0),d){let d=e.text.prefix;f>0&&(d+=po(n,p[0])),f>1&&(d+=po(r,p[1])),f>2&&(d+=po(i,p[2])),f>3&&(d+=po(o,p[3])),f>4&&(d+=po(s,p[4])),f>5&&(d+=po(a,p[5])),f>6&&(d+=po(l,p[6])),f>7&&(d+=po(u,p[7])),f>8&&(d+=po(c,p[8])),f>9&&(d+=po(h,p[9]));const m=fr(t,e.nodeIndex).renderText;t.renderer.setValue(m,d)}return d}(t,e,n,r,i,o,s,a,l,u,c,h);case 16384:return function(t,e,n,r,i,o,s,a,l,u,c,h){const d=gr(t,e.nodeIndex),p=d.instance;let f=!1,m=void 0;const g=e.bindings.length;return g>0&&Pr(t,e,0,n)&&(f=!0,m=to(t,d,e,0,n,m)),g>1&&Pr(t,e,1,r)&&(f=!0,m=to(t,d,e,1,r,m)),g>2&&Pr(t,e,2,i)&&(f=!0,m=to(t,d,e,2,i,m)),g>3&&Pr(t,e,3,o)&&(f=!0,m=to(t,d,e,3,o,m)),g>4&&Pr(t,e,4,s)&&(f=!0,m=to(t,d,e,4,s,m)),g>5&&Pr(t,e,5,a)&&(f=!0,m=to(t,d,e,5,a,m)),g>6&&Pr(t,e,6,l)&&(f=!0,m=to(t,d,e,6,l,m)),g>7&&Pr(t,e,7,u)&&(f=!0,m=to(t,d,e,7,u,m)),g>8&&Pr(t,e,8,c)&&(f=!0,m=to(t,d,e,8,c,m)),g>9&&Pr(t,e,9,h)&&(f=!0,m=to(t,d,e,9,h,m)),m&&p.ngOnChanges(m),65536&e.flags&&pr(t,256,e.nodeIndex)&&p.ngOnInit(),262144&e.flags&&p.ngDoCheck(),f}(t,e,n,r,i,o,s,a,l,u,c,h);case 32:case 64:case 128:return function(t,e,n,r,i,o,s,a,l,u,c,h){const d=e.bindings;let p=!1;const f=d.length;if(f>0&&Lr(t,e,0,n)&&(p=!0),f>1&&Lr(t,e,1,r)&&(p=!0),f>2&&Lr(t,e,2,i)&&(p=!0),f>3&&Lr(t,e,3,o)&&(p=!0),f>4&&Lr(t,e,4,s)&&(p=!0),f>5&&Lr(t,e,5,a)&&(p=!0),f>6&&Lr(t,e,6,l)&&(p=!0),f>7&&Lr(t,e,7,u)&&(p=!0),f>8&&Lr(t,e,8,c)&&(p=!0),f>9&&Lr(t,e,9,h)&&(p=!0),p){const p=vr(t,e.nodeIndex);let m;switch(201347067&e.flags){case 32:m=new Array(d.length),f>0&&(m[0]=n),f>1&&(m[1]=r),f>2&&(m[2]=i),f>3&&(m[3]=o),f>4&&(m[4]=s),f>5&&(m[5]=a),f>6&&(m[6]=l),f>7&&(m[7]=u),f>8&&(m[8]=c),f>9&&(m[9]=h);break;case 64:m={},f>0&&(m[d[0].name]=n),f>1&&(m[d[1].name]=r),f>2&&(m[d[2].name]=i),f>3&&(m[d[3].name]=o),f>4&&(m[d[4].name]=s),f>5&&(m[d[5].name]=a),f>6&&(m[d[6].name]=l),f>7&&(m[d[7].name]=u),f>8&&(m[d[8].name]=c),f>9&&(m[d[9].name]=h);break;case 128:const t=n;switch(f){case 1:m=t.transform(n);break;case 2:m=t.transform(r);break;case 3:m=t.transform(r,i);break;case 4:m=t.transform(r,i,o);break;case 5:m=t.transform(r,i,o,s);break;case 6:m=t.transform(r,i,o,s,a);break;case 7:m=t.transform(r,i,o,s,a,l);break;case 8:m=t.transform(r,i,o,s,a,l,u);break;case 9:m=t.transform(r,i,o,s,a,l,u,c);break;case 10:m=t.transform(r,i,o,s,a,l,u,c,h)}}p.value=m}return p}(t,e,n,r,i,o,s,a,l,u,c,h);default:throw"unreachable"}}(t,e,r,i,o,s,a,l,u,c,h,d):function(t,e,n){switch(201347067&e.flags){case 1:return function(t,e,n){let r=!1;for(let i=0;i<n.length;i++)si(t,e,i,n[i])&&(r=!0);return r}(t,e,n);case 2:return function(t,e,n){const r=e.bindings;let i=!1;for(let o=0;o<n.length;o++)Lr(t,e,o,n[o])&&(i=!0);if(i){let i="";for(let t=0;t<n.length;t++)i+=po(n[t],r[t]);i=e.text.prefix+i;const o=fr(t,e.nodeIndex).renderText;t.renderer.setValue(o,i)}return i}(t,e,n);case 16384:return function(t,e,n){const r=gr(t,e.nodeIndex),i=r.instance;let o=!1,s=void 0;for(let a=0;a<n.length;a++)Pr(t,e,a,n[a])&&(o=!0,s=to(t,r,e,a,n[a],s));return s&&i.ngOnChanges(s),65536&e.flags&&pr(t,256,e.nodeIndex)&&i.ngOnInit(),262144&e.flags&&i.ngDoCheck(),o}(t,e,n);case 32:case 64:case 128:return function(t,e,n){const r=e.bindings;let i=!1;for(let o=0;o<n.length;o++)Lr(t,e,o,n[o])&&(i=!0);if(i){const i=vr(t,e.nodeIndex);let o;switch(201347067&e.flags){case 32:o=n;break;case 64:o={};for(let e=0;e<n.length;e++)o[r[e].name]=n[e];break;case 128:const t=n[0],i=n.slice(1);o=t.transform(...i)}i.value=o}return i}(t,e,n);default:throw"unreachable"}}(t,e,r)}function To(t){const e=t.def;if(4&e.nodeFlags)for(let n=0;n<e.nodes.length;n++){const r=e.nodes[n];if(4&r.flags){const e=mr(t,n).template._projectedViews;if(e)for(let n=0;n<e.length;n++){const r=e[n];r.state|=32,Or(r,t)}}else 0==(4&r.childFlags)&&(n+=r.childCount)}}function Co(t,e,n,r,i,o,s,a,l,u,c,h,d){return 0===n?function(t,e,n,r,i,o,s,a,l,u,c,h){const d=e.bindings.length;d>0&&Ir(t,e,0,n),d>1&&Ir(t,e,1,r),d>2&&Ir(t,e,2,i),d>3&&Ir(t,e,3,o),d>4&&Ir(t,e,4,s),d>5&&Ir(t,e,5,a),d>6&&Ir(t,e,6,l),d>7&&Ir(t,e,7,u),d>8&&Ir(t,e,8,c),d>9&&Ir(t,e,9,h)}(t,e,r,i,o,s,a,l,u,c,h,d):function(t,e,n){for(let r=0;r<n.length;r++)Ir(t,e,r,n[r])}(t,e,r),!1}function Ao(t,e){if(yr(t,e.nodeIndex).dirty)throw br(wr.createDebugContext(t,e.nodeIndex),`Query ${e.query.id} not dirty`,`Query ${e.query.id} dirty`,0!=(1&t.state))}function Ro(t){if(!(128&t.state)){if(Io(t,Po.Destroy),Lo(t,Po.Destroy),eo(t,131072),t.disposables)for(let e=0;e<t.disposables.length;e++)t.disposables[e]();!function(t){if(!(16&t.state))return;const e=Br(t);if(e){const n=e.template._projectedViews;n&&(vi(n,n.indexOf(t)),wr.dirtyParentQueries(t))}}(t),t.renderer.destroyNode&&function(t){const e=t.def.nodes.length;for(let n=0;n<e;n++){const e=t.def.nodes[n];1&e.flags?t.renderer.destroyNode(mr(t,n).renderElement):2&e.flags?t.renderer.destroyNode(fr(t,n).renderText):(67108864&e.flags||134217728&e.flags)&&yr(t,n).destroy()}}(t),kr(t)&&t.renderer.destroy(),t.state|=128}}const Po=function(){var t={CreateViewNodes:0,CheckNoChanges:1,CheckNoChangesProjectedViews:2,CheckAndUpdate:3,CheckAndUpdateProjectedViews:4,Destroy:5};return t[t.CreateViewNodes]="CreateViewNodes",t[t.CheckNoChanges]="CheckNoChanges",t[t.CheckNoChangesProjectedViews]="CheckNoChangesProjectedViews",t[t.CheckAndUpdate]="CheckAndUpdate",t[t.CheckAndUpdateProjectedViews]="CheckAndUpdateProjectedViews",t[t.Destroy]="Destroy",t}();function Lo(t,e){const n=t.def;if(33554432&n.nodeFlags)for(let r=0;r<n.nodes.length;r++){const i=n.nodes[r];33554432&i.flags?No(mr(t,r).componentView,e):0==(33554432&i.childFlags)&&(r+=i.childCount)}}function Io(t,e){const n=t.def;if(16777216&n.nodeFlags)for(let r=0;r<n.nodes.length;r++){const i=n.nodes[r];if(16777216&i.flags){const n=mr(t,r).viewContainer._embeddedViews;for(let t=0;t<n.length;t++)No(n[t],e)}else 0==(16777216&i.childFlags)&&(r+=i.childCount)}}function No(t,e){const n=t.state;switch(e){case Po.CheckNoChanges:0==(128&n)&&(12==(12&n)?Eo(t):64&n&&Oo(t,Po.CheckNoChangesProjectedViews));break;case Po.CheckNoChangesProjectedViews:0==(128&n)&&(32&n?Eo(t):64&n&&Oo(t,e));break;case Po.CheckAndUpdate:0==(128&n)&&(12==(12&n)?So(t):64&n&&Oo(t,Po.CheckAndUpdateProjectedViews));break;case Po.CheckAndUpdateProjectedViews:0==(128&n)&&(32&n?So(t):64&n&&Oo(t,e));break;case Po.Destroy:Ro(t);break;case Po.CreateViewNodes:_o(t)}}function Oo(t,e){Io(t,e),Lo(t,e)}function Do(t,e,n,r){if(!(t.def.nodeFlags&e&&t.def.nodeFlags&n))return;const i=t.def.nodes.length;for(let o=0;o<i;o++){const i=t.def.nodes[o];if(i.flags&e&&i.flags&n)switch(wr.setCurrentNode(t,i.nodeIndex),r){case 0:so(t,i);break;case 1:Ao(t,i)}i.childFlags&e&&i.childFlags&n||(o+=i.childCount)}}let Bo=!1;function Uo(t,e,n,r,i,o){return yo(Fo(t,i,i.injector.get(_n),e,n),r,o)}function zo(t,e,n,r,i,o){const s=i.injector.get(_n),a=Fo(t,i,new ws(s),e,n),l=Yo(r);return vs(ts.create,yo,null,[a,l,o])}function Fo(t,e,n,r,i){const o=e.injector.get(hr),s=e.injector.get(Kt);return{ngModule:e,injector:t,projectableNodes:r,selectorOrNode:i,sanitizer:o,rendererFactory:n,renderer:n.createRenderer(null,null),errorHandler:s}}function ko(t,e,n,r){const i=Yo(n);return vs(ts.create,vo,null,[t,e,i,r])}function Vo(t,e,n,r){return n=Ho.get(e.element.componentProvider.provider.token)||Yo(n),vs(ts.create,wo,null,[t,e,n,r])}function Go(t,e,n,r){return Ni(t,e,n,function(t){const{hasOverrides:e,hasDeprecatedOverrides:n}=function(t){let e=!1,n=!1;return 0===jo.size?{hasOverrides:e,hasDeprecatedOverrides:n}:(t.providers.forEach(t=>{const r=jo.get(t.token);3840&t.flags&&r&&(e=!0,n=n||r.deprecatedBehavior)}),{hasOverrides:e,hasDeprecatedOverrides:n})}(t);return e?(function(t){for(let e=0;e<t.providers.length;e++){const r=t.providers[e];n&&(r.flags|=4096);const i=jo.get(r.token);i&&(r.flags=-3841&r.flags|i.flags,r.deps=Hr(i.deps),r.value=i.value)}}(t=t.factory(()=>Er)),t):t}(r))}const jo=new Map,Ho=new Map;function Wo(t){jo.set(t.token,t)}function qo(t,e){const n=Xr(Xr(e.viewDefFactory).nodes[0].element.componentView);Ho.set(t,n)}function Xo(){jo.clear(),Ho.clear()}function Yo(t){if(0===jo.size)return t;const e=function(t){const e=[];let n=null;for(let r=0;r<t.nodes.length;r++){const i=t.nodes[r];1&i.flags&&(n=i),n&&3840&i.flags&&jo.has(i.provider.token)&&(e.push(n.nodeIndex),n=null)}return e}(t);if(0===e.length)return t;t=t.factory(()=>Er);for(let r=0;r<e.length;r++)n(t,e[r]);return t;function n(t,e){for(let n=e+1;n<t.nodes.length;n++){const e=t.nodes[n];if(1&e.flags)return;if(3840&e.flags){const t=e.provider,n=jo.get(t.token);n&&(e.flags=-3841&e.flags|n.flags,t.deps=Hr(n.deps),t.value=n.value)}}}}function Zo(t,e,n,r,i,o,s,a,l,u,c,h,d){const p=t.def.nodes[e];return Mo(t,p,n,r,i,o,s,a,l,u,c,h,d),224&p.flags?vr(t,e).value:void 0}function $o(t,e,n,r,i,o,s,a,l,u,c,h,d){const p=t.def.nodes[e];return Co(t,p,n,r,i,o,s,a,l,u,c,h,d),224&p.flags?vr(t,e).value:void 0}function Qo(t){return vs(ts.detectChanges,So,null,[t])}function Jo(t){return vs(ts.checkNoChanges,Eo,null,[t])}function Ko(t){return vs(ts.destroy,Ro,null,[t])}const ts=function(){var t={create:0,detectChanges:1,checkNoChanges:2,destroy:3,handleEvent:4};return t[t.create]="create",t[t.detectChanges]="detectChanges",t[t.checkNoChanges]="checkNoChanges",t[t.destroy]="destroy",t[t.handleEvent]="handleEvent",t}();let es,ns,rs;function is(t,e){ns=t,rs=e}function os(t,e,n,r){return is(t,e),vs(ts.handleEvent,t.def.handleEvent,null,[t,e,n,r])}function ss(t,e){if(128&t.state)throw _r(ts[es]);return is(t,ps(t,0)),t.def.updateDirectives(function(t,n,r,...i){const o=t.def.nodes[n];return 0===e?ls(t,o,r,i):us(t,o,r,i),16384&o.flags&&is(t,ps(t,n)),224&o.flags?vr(t,o.nodeIndex).value:void 0},t)}function as(t,e){if(128&t.state)throw _r(ts[es]);return is(t,fs(t,0)),t.def.updateRenderer(function(t,n,r,...i){const o=t.def.nodes[n];return 0===e?ls(t,o,r,i):us(t,o,r,i),3&o.flags&&is(t,fs(t,n)),224&o.flags?vr(t,o.nodeIndex).value:void 0},t)}function ls(t,e,n,r){if(Mo(t,e,n,...r)){const i=1===n?r[0]:r;if(16384&e.flags){const n={};for(let t=0;t<e.bindings.length;t++){const r=e.bindings[t],o=i[t];8&r.flags&&(n[cs(r.nonMinifiedName)]=ds(o))}const r=e.parent,o=mr(t,r.nodeIndex).renderElement;if(r.element.name)for(let e in n){const r=n[e];null!=r?t.renderer.setAttribute(o,e,r):t.renderer.removeAttribute(o,e)}else t.renderer.setValue(o,`bindings=${JSON.stringify(n,null,2)}`)}}}function us(t,e,n,r){Co(t,e,n,...r)}function cs(t){return`ng-reflect-${t=t.replace(/[$@]/g,"_").replace(hs,(...t)=>"-"+t[1].toLowerCase())}`}const hs=/([A-Z])/g;function ds(t){try{return null!=t?t.toString().slice(0,30):t}catch(t){return"[ERROR] Exception while trying to serialize the value"}}function ps(t,e){for(let n=e;n<t.def.nodes.length;n++){const e=t.def.nodes[n];if(16384&e.flags&&e.bindings&&e.bindings.length)return n}return null}function fs(t,e){for(let n=e;n<t.def.nodes.length;n++){const e=t.def.nodes[n];if(3&e.flags&&e.bindings&&e.bindings.length)return n}return null}class ms{constructor(t,e){this.view=t,this.nodeIndex=e,null==e&&(this.nodeIndex=e=0),this.nodeDef=t.def.nodes[e];let n=this.nodeDef,r=t;for(;n&&0==(1&n.flags);)n=n.parent;if(!n)for(;!n&&r;)n=Ur(r),r=r.parent;this.elDef=n,this.elView=r}get elOrCompView(){return mr(this.elView,this.elDef.nodeIndex).componentView||this.view}get injector(){return Ai(this.elView,this.elDef)}get component(){return this.elOrCompView.component}get context(){return this.elOrCompView.context}get providerTokens(){const t=[];if(this.elDef)for(let e=this.elDef.nodeIndex+1;e<=this.elDef.nodeIndex+this.elDef.childCount;e++){const n=this.elView.def.nodes[e];20224&n.flags&&t.push(n.provider.token),e+=n.childCount}return t}get references(){const t={};if(this.elDef){gs(this.elView,this.elDef,t);for(let e=this.elDef.nodeIndex+1;e<=this.elDef.nodeIndex+this.elDef.childCount;e++){const n=this.elView.def.nodes[e];20224&n.flags&&gs(this.elView,n,t),e+=n.childCount}}return t}get componentRenderElement(){const t=function(t){for(;t&&!kr(t);)t=t.parent;return t.parent?mr(t.parent,Ur(t).nodeIndex):null}(this.elOrCompView);return t?t.renderElement:void 0}get renderNode(){return 2&this.nodeDef.flags?zr(this.view,this.nodeDef):zr(this.elView,this.elDef)}logError(t,...e){let n,r;2&this.nodeDef.flags?(n=this.view.def,r=this.nodeDef.nodeIndex):(n=this.elView.def,r=this.elDef.nodeIndex);const i=function(t,e){let n=-1;for(let r=0;r<=e;r++)3&t.nodes[r].flags&&n++;return n}(n,r);let o=-1;n.factory(()=>++o===i?t.error.bind(t,...e):Er),o<i&&(t.error("Illegal state: the ViewDefinitionFactory did not call the logger!"),t.error(...e))}}function gs(t,e,n){for(let r in e.references)n[r]=lo(t,e,e.references[r])}function vs(t,e,n,r){const i=es,o=ns,s=rs;try{es=t;const a=e.apply(n,r);return ns=o,rs=s,es=i,a}catch(t){if($t(t)||!ns)throw t;throw function(t,e){return t instanceof Error||(t=new Error(t.toString())),xr(t,e),t}(t,ys())}}function ys(){return ns?new ms(ns,rs):null}class ws{constructor(t){this.delegate=t}createRenderer(t,e){return new bs(this.delegate.createRenderer(t,e))}begin(){this.delegate.begin&&this.delegate.begin()}end(){this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.delegate.whenRenderingDone?this.delegate.whenRenderingDone():Promise.resolve(null)}}class bs{constructor(t){this.delegate=t,this.data=this.delegate.data}destroyNode(t){!function(t){kn.delete(t.nativeNode)}(Vn(t)),this.delegate.destroyNode&&this.delegate.destroyNode(t)}destroy(){this.delegate.destroy()}createElement(t,e){const n=this.delegate.createElement(t,e),r=ys();if(r){const e=new Fn(n,null,r);e.name=t,Gn(e)}return n}createComment(t){const e=this.delegate.createComment(t),n=ys();return n&&Gn(new zn(e,null,n)),e}createText(t){const e=this.delegate.createText(t),n=ys();return n&&Gn(new zn(e,null,n)),e}appendChild(t,e){const n=Vn(t),r=Vn(e);n&&r&&n instanceof Fn&&n.addChild(r),this.delegate.appendChild(t,e)}insertBefore(t,e,n){const r=Vn(t),i=Vn(e),o=Vn(n);r&&i&&r instanceof Fn&&r.insertBefore(o,i),this.delegate.insertBefore(t,e,n)}removeChild(t,e){const n=Vn(t),r=Vn(e);n&&r&&n instanceof Fn&&n.removeChild(r),this.delegate.removeChild(t,e)}selectRootElement(t){const e=this.delegate.selectRootElement(t),n=ys();return n&&Gn(new Fn(e,null,n)),e}setAttribute(t,e,n,r){const i=Vn(t);i&&i instanceof Fn&&(i.attributes[r?r+":"+e:e]=n),this.delegate.setAttribute(t,e,n,r)}removeAttribute(t,e,n){const r=Vn(t);r&&r instanceof Fn&&(r.attributes[n?n+":"+e:e]=null),this.delegate.removeAttribute(t,e,n)}addClass(t,e){const n=Vn(t);n&&n instanceof Fn&&(n.classes[e]=!0),this.delegate.addClass(t,e)}removeClass(t,e){const n=Vn(t);n&&n instanceof Fn&&(n.classes[e]=!1),this.delegate.removeClass(t,e)}setStyle(t,e,n,r){const i=Vn(t);i&&i instanceof Fn&&(i.styles[e]=n),this.delegate.setStyle(t,e,n,r)}removeStyle(t,e,n){const r=Vn(t);r&&r instanceof Fn&&(r.styles[e]=null),this.delegate.removeStyle(t,e,n)}setProperty(t,e,n){const r=Vn(t);r&&r instanceof Fn&&(r.properties[e]=n),this.delegate.setProperty(t,e,n)}listen(t,e,n){if("string"!=typeof t){const r=Vn(t);r&&r.listeners.push(new Un(e,n))}return this.delegate.listen(t,e,n)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setValue(t,e){return this.delegate.setValue(t,e)}}let xs;"undefined"==typeof ngDevMode&&("undefined"!=typeof window&&(window.ngDevMode=!0),"undefined"!=typeof self&&(self.ngDevMode=!0),"undefined"!=typeof global&&(global.ngDevMode=!0)),xs={parent:xs,id:null,node:null,data:[],ngStaticData:[],cleanup:null,renderer:null,child:null,tail:null,next:null,bindingStartIndex:null,creationMode:!0,viewHookStartIndex:null};class _s{}class Es{constructor(){this.test="app"}}class Ss{}const Ms=new K("Location Initialized");class Ts{}const Cs=new K("appBaseHref");class As{constructor(t){this._subject=new Je,this._platformStrategy=t;const e=this._platformStrategy.getBaseHref();this._baseHref=As.stripTrailingSlash(Rs(e)),this._platformStrategy.onPopState(t=>{this._subject.emit({url:this.path(!0),pop:!0,type:t.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}isCurrentPathEqualTo(t,e=""){return this.path()==this.normalize(t+As.normalizeQueryParams(e))}normalize(t){return As.stripTrailingSlash(function(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,Rs(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,e=""){this._platformStrategy.pushState(null,"",t,e)}replaceState(t,e=""){this._platformStrategy.replaceState(null,"",t,e)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}subscribe(t,e,n){return this._subject.subscribe({next:t,error:e,complete:n})}static normalizeQueryParams(t){return t&&"?"!==t[0]?"?"+t:t}static joinWithSlash(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}static stripTrailingSlash(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}}function Rs(t){return t.replace(/\/index.html$/,"")}class Ps extends Ts{constructor(t,e){super(),this._platformLocation=t,this._baseHref="",null!=e&&(this._baseHref=e)}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}path(t=!1){let e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}prepareExternalUrl(t){const e=As.joinWithSlash(this._baseHref,t);return e.length>0?"#"+e:e}pushState(t,e,n,r){let i=this.prepareExternalUrl(n+As.normalizeQueryParams(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(t,e,i)}replaceState(t,e,n,r){let i=this.prepareExternalUrl(n+As.normalizeQueryParams(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(t,e,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}class Ls extends Ts{constructor(t,e){if(super(),this._platformLocation=t,null==e&&(e=this._platformLocation.getBaseHrefFromDOM()),null==e)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=e}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return As.joinWithSlash(this._baseHref,t)}path(t=!1){const e=this._platformLocation.pathname+As.normalizeQueryParams(this._platformLocation.search),n=this._platformLocation.hash;return n&&t?`${e}${n}`:e}pushState(t,e,n,r){const i=this.prepareExternalUrl(n+As.normalizeQueryParams(r));this._platformLocation.pushState(t,e,i)}replaceState(t,e,n,r){const i=this.prepareExternalUrl(n+As.normalizeQueryParams(r));this._platformLocation.replaceState(t,e,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}var Is=["en",[["a","p"],["AM","PM"]],[["AM","PM"],,],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",,"{1} 'at' {0}"],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"$","US Dollar",function(t){let e=Math.floor(Math.abs(t)),n=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===n?1:5}];const Ns={},Os=function(){var t={Zero:0,One:1,Two:2,Few:3,Many:4,Other:5};return t[t.Zero]="Zero",t[t.One]="One",t[t.Two]="Two",t[t.Few]="Few",t[t.Many]="Many",t[t.Other]="Other",t}(),Ds=new K("UseV4Plurals");class Bs{}class Us extends Bs{constructor(t,e){super(),this.locale=t,this.deprecatedPluralFn=e}getPluralCategory(t,e){switch(this.deprecatedPluralFn?this.deprecatedPluralFn(e||this.locale,t):function(t){return function(t){const e=t.toLowerCase().replace(/_/g,"-");let n=Ns[e];if(n)return n;const r=e.split("-")[0];if(n=Ns[r])return n;if("en"===r)return Is;throw new Error(`Missing locale data for the locale "${t}".`)}(t)[17]}(e||this.locale)(t)){case Os.Zero:return"zero";case Os.One:return"one";case Os.Two:return"two";case Os.Few:return"few";case Os.Many:return"many";default:return"other"}}}const zs=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Fs=/((?:[^yMLdHhmsazZEwGjJ']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|L+|d+|H+|h+|J+|j+|m+|s+|a|z|Z|G+|w+))(.*)/,ks={yMMMdjms:$s(Zs([Xs("year",1),Ys("month",3),Xs("day",1),Xs("hour",1),Xs("minute",1),Xs("second",1)])),yMdjm:$s(Zs([Xs("year",1),Xs("month",1),Xs("day",1),Xs("hour",1),Xs("minute",1)])),yMMMMEEEEd:$s(Zs([Xs("year",1),Ys("month",4),Ys("weekday",4),Xs("day",1)])),yMMMMd:$s(Zs([Xs("year",1),Ys("month",4),Xs("day",1)])),yMMMd:$s(Zs([Xs("year",1),Ys("month",3),Xs("day",1)])),yMd:$s(Zs([Xs("year",1),Xs("month",1),Xs("day",1)])),jms:$s(Zs([Xs("hour",1),Xs("second",1),Xs("minute",1)])),jm:$s(Zs([Xs("hour",1),Xs("minute",1)]))},Vs={yyyy:$s(Xs("year",4)),yy:$s(Xs("year",2)),y:$s(Xs("year",1)),MMMM:$s(Ys("month",4)),MMM:$s(Ys("month",3)),MM:$s(Xs("month",2)),M:$s(Xs("month",1)),LLLL:$s(Ys("month",4)),L:$s(Ys("month",1)),dd:$s(Xs("day",2)),d:$s(Xs("day",1)),HH:Gs(js($s(qs(Xs("hour",2),!1)))),H:js($s(qs(Xs("hour",1),!1))),hh:Gs(js($s(qs(Xs("hour",2),!0)))),h:js($s(qs(Xs("hour",1),!0))),jj:$s(Xs("hour",2)),j:$s(Xs("hour",1)),mm:Gs($s(Xs("minute",2))),m:$s(Xs("minute",1)),ss:Gs($s(Xs("second",2))),s:$s(Xs("second",1)),sss:$s(Xs("second",3)),EEEE:$s(Ys("weekday",4)),EEE:$s(Ys("weekday",3)),EE:$s(Ys("weekday",2)),E:$s(Ys("weekday",1)),a:function(t){return function(e,n){return t(e,n).split(" ")[1]}}($s(qs(Xs("hour",1),!0))),Z:Ws("short"),z:Ws("long"),ww:$s({}),w:$s({}),G:$s(Ys("era",1)),GG:$s(Ys("era",2)),GGG:$s(Ys("era",3)),GGGG:$s(Ys("era",4))};function Gs(t){return function(e,n){const r=t(e,n);return 1==r.length?"0"+r:r}}function js(t){return function(e,n){return t(e,n).split(" ")[0]}}function Hs(t,e,n){return new Intl.DateTimeFormat(e,n).format(t).replace(/[\u200e\u200f]/g,"")}function Ws(t){const e={hour:"2-digit",hour12:!1,timeZoneName:t};return function(t,n){const r=Hs(t,n,e);return r?r.substring(3):""}}function qs(t,e){return t.hour12=e,t}function Xs(t,e){return function(){var n={};return n[t]=2===e?"2-digit":"numeric",n}()}function Ys(t,e){const n={};return n[t]=e<4?e>1?"short":"narrow":"long",n}function Zs(t){return t.reduce((t,e)=>Object.assign({},t,e),{})}function $s(t){return(e,n)=>Hs(e,n,t)}const Qs=new Map;class Js{static format(t,e,n){return function(t,e,n){const r=ks[t];if(r)return r(e,n);const i=t;let o=Qs.get(i);if(!o){let e;o=[],Fs.exec(t);let n=t;for(;n;)(e=Fs.exec(n))?n=(o=o.concat(e.slice(1))).pop():(o.push(n),n=null);Qs.set(i,o)}return o.reduce((t,r)=>{const i=Vs[r];return t+(i?i(e,n):function(t){return"''"===t?"'":t.replace(/(^'|'$)/g,"").replace(/''/g,"'")}(r))},"")}(n,t,e)}}class Ks{constructor(t){this._locale=t}transform(t,e="mediumDate"){if(null==t||""===t||t!=t)return null;let n;if("string"==typeof t&&(t=t.trim()),ta(t))n=t;else if(isNaN(t-parseFloat(t)))if("string"==typeof t&&/^(\d{4}-\d{1,2}-\d{1,2})$/.test(t)){const[e,r,i]=t.split("-").map(t=>parseInt(t,10));n=new Date(e,r-1,i)}else n=new Date(t);else n=new Date(parseFloat(t));if(!ta(n)){let e;if("string"!=typeof t||!(e=t.match(zs)))throw function(t,e){return Error(`InvalidPipeArgument: '${e}' for pipe '${Mt(Ks)}'`)}(0,t);n=function(t){const e=new Date(0);let n=0,r=0;const i=t[8]?e.setUTCHours:e.setHours;t[9]&&(n=+(t[9]+t[10]),r=+(t[9]+t[11])),(t[8]?e.setUTCFullYear:e.setFullYear).call(e,+t[1],+t[2]-1,+t[3]);const o=+(t[4]||"0")-n,s=+(t[5]||"0")-r,a=+(t[6]||"0"),l=Math.round(1e3*parseFloat("0."+(t[7]||0)));return i.call(e,o,s,a,l),e}(e)}return Js.format(n,this._locale,Ks._ALIASES[e]||e)}}function ta(t){return t instanceof Date&&!isNaN(t.valueOf())}Ks._ALIASES={medium:"yMMMdjms",short:"yMdjm",fullDate:"yMMMMEEEEd",longDate:"yMMMMd",mediumDate:"yMMMd",shortDate:"yMd",mediumTime:"jms",shortTime:"jm"},new class{createSubscription(t,e){return t.then(e,t=>{throw t})}dispose(t){}onDestroy(t){}},new class{createSubscription(t,e){return t.subscribe({next:e,error:t=>{throw t}})}dispose(t){t.unsubscribe()}onDestroy(t){t.unsubscribe()}};class ea{}const na=new K("DocumentToken");new ht("5.2.0");class ra extends W{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return e&&!e.closed&&t.next(this._value),e}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new G;return this._value}next(t){super.next(this._value=t)}}const ia=P.of;function oa(t,e){return function(t,e){return U(t,e,1)}(t,e)(this)}class sa{constructor(t,e){this.project=t,this.thisArg=e}call(t,e){return e.subscribe(new aa(t,this.project,this.thisArg))}}class aa extends b{constructor(t,e,n){super(t),this.project=e,this.count=0,this.thisArg=n||this}_next(t){let e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)}}function la(t,e){return function(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new sa(t,e))}}(t,e)(this)}function ua(t,e,n=Number.POSITIVE_INFINITY){return U(t,e,n)(this)}class ca extends T{constructor(t,e){super(),this.promise=t,this.scheduler=e}static create(t,e){return new ca(t,e)}_subscribe(t){const e=this.promise,n=this.scheduler;if(null==n)this._isScalar?t.closed||(t.next(this.value),t.complete()):e.then(e=>{this.value=e,this._isScalar=!0,t.closed||(t.next(e),t.complete())},e=>{t.closed||t.error(e)}).then(null,t=>{s.setTimeout(()=>{throw t})});else if(this._isScalar){if(!t.closed)return n.schedule(ha,0,{value:this.value,subscriber:t})}else e.then(e=>{this.value=e,this._isScalar=!0,t.closed||t.add(n.schedule(ha,0,{value:e,subscriber:t}))},e=>{t.closed||t.add(n.schedule(da,0,{err:e,subscriber:t}))}).then(null,t=>{s.setTimeout(()=>{throw t})})}}function ha(t){const{value:e,subscriber:n}=t;n.closed||(n.next(e),n.complete())}function da(t){const{err:e,subscriber:n}=t;n.closed||n.error(e)}class pa extends T{constructor(t,e){if(super(),this.scheduler=e,null==t)throw new Error("iterator cannot be null.");this.iterator=function(t){const e=t[N];if(!e&&"string"==typeof t)return new fa(t);if(!e&&void 0!==t.length)return new ma(t);if(!e)throw new TypeError("object is not iterable");return t[N]()}(t)}static create(t,e){return new pa(t,e)}static dispatch(t){const{index:e,hasError:n,iterator:r,subscriber:i}=t;if(n)return void i.error(t.error);let o=r.next();o.done?i.complete():(i.next(o.value),t.index=e+1,i.closed?"function"==typeof r.return&&r.return():this.schedule(t))}_subscribe(t){const{iterator:e,scheduler:n}=this;if(n)return n.schedule(pa.dispatch,0,{index:0,iterator:e,subscriber:t});for(;;){let n=e.next();if(n.done){t.complete();break}if(t.next(n.value),t.closed){"function"==typeof e.return&&e.return();break}}}}class fa{constructor(t,e=0,n=t.length){this.str=t,this.idx=e,this.len=n}[N](){return this}next(){return this.idx<this.len?{done:!1,value:this.str.charAt(this.idx++)}:{done:!0,value:void 0}}}class ma{constructor(t,e=0,n=function(e){let n=+t.length;return isNaN(n)?0:0!==n&&"number"==typeof n&&s.isFinite(n)?(n=function(t){let e=+n;return 0===e?e:isNaN(e)?e:e<0?-1:1}()*Math.floor(Math.abs(n)))<=0?0:n>ga?ga:n:n}()){this.arr=t,this.idx=e,this.len=n}[N](){return this}next(){return this.idx<this.len?{done:!1,value:this.arr[this.idx++]}:{done:!0,value:void 0}}}const ga=Math.pow(2,53)-1;class va extends T{constructor(t,e){super(),this.arrayLike=t,this.scheduler=e,e||1!==t.length||(this._isScalar=!0,this.value=t[0])}static create(t,e){const n=t.length;return 0===n?new A:1===n?new C(t[0],e):new va(t,e)}static dispatch(t){const{arrayLike:e,index:n,length:r,subscriber:i}=t;i.closed||(n>=r?i.complete():(i.next(e[n]),t.index=n+1,this.schedule(t)))}_subscribe(t){const{arrayLike:e,scheduler:n}=this,r=e.length;if(n)return n.schedule(va.dispatch,0,{arrayLike:e,index:0,length:r,subscriber:t});for(let i=0;i<r&&!t.closed;i++)t.next(e[i]);t.complete()}}class ya{constructor(t,e,n){this.kind=t,this.value=e,this.error=n,this.hasValue="N"===t}observe(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}}do(t,e,n){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return n&&n()}}accept(t,e,n){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,n)}toObservable(){switch(this.kind){case"N":return T.of(this.value);case"E":return T.throw(this.error);case"C":return T.empty()}throw new Error("unexpected notification kind value")}static createNext(t){return void 0!==t?new ya("N",t):ya.undefinedValueNotification}static createError(t){return new ya("E",void 0,t)}static createComplete(){return ya.completeNotification}}ya.completeNotification=new ya("C"),ya.undefinedValueNotification=new ya("N",void 0);class wa extends b{constructor(t,e,n=0){super(t),this.scheduler=e,this.delay=n}static dispatch(t){const{notification:e,destination:n}=t;e.observe(n),this.unsubscribe()}scheduleMessage(t){this.add(this.scheduler.schedule(wa.dispatch,this.delay,new ba(t,this.destination)))}_next(t){this.scheduleMessage(ya.createNext(t))}_error(t){this.scheduleMessage(ya.createError(t))}_complete(){this.scheduleMessage(ya.createComplete())}}class ba{constructor(t,e){this.notification=t,this.destination=e}}class xa extends T{constructor(t,e){super(null),this.ish=t,this.scheduler=e}static create(t,e){if(null!=t){if("function"==typeof t[_])return t instanceof T&&!e?t:new xa(t,e);if(l(t))return new P(t,e);if(I(t))return new ca(t,e);if("function"==typeof t[N]||"string"==typeof t)return new pa(t,e);if(L(t))return new va(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}_subscribe(t){const e=this.ish,n=this.scheduler;return null==n?e[_]().subscribe(t):e[_]().subscribe(new wa(t,n,0))}}const _a=xa.create;class Ea{constructor(t){this.selector=t}call(t,e){return e.subscribe(new Sa(t,this.selector,this.caught))}}class Sa extends B{constructor(t,e,n){super(t),this.selector=e,this.caught=n}error(t){if(!this.isStopped){let e;try{e=this.selector(t,this.caught)}catch(t){return void super.error(t)}this._unsubscribeAndRecycle(),this.add(D(this,e))}}}function Ma(t){return function(t){return function(e){const n=new Ea(t),r=e.lift(n);return n.caught=r}}(t)(this)}function Ta(){return V(1)(this)}class Ca extends Error{constructor(){const t=super("no elements in sequence");this.name=t.name="EmptyError",this.stack=t.stack,this.message=t.message}}class Aa{constructor(t,e,n,r){this.predicate=t,this.resultSelector=e,this.defaultValue=n,this.source=r}call(t,e){return e.subscribe(new Ra(t,this.predicate,this.resultSelector,this.defaultValue,this.source))}}class Ra extends b{constructor(t,e,n,r,i){super(t),this.predicate=e,this.resultSelector=n,this.defaultValue=r,this.source=i,this.index=0,this.hasCompleted=!1,this._emitted=!1}_next(t){const e=this.index++;this.predicate?this._tryPredicate(t,e):this._emit(t,e)}_tryPredicate(t,e){let n;try{n=this.predicate(t,e,this.source)}catch(t){return void this.destination.error(t)}n&&this._emit(t,e)}_emit(t,e){this.resultSelector?this._tryResultSelector(t,e):this._emitFinal(t)}_tryResultSelector(t,e){let n;try{n=this.resultSelector(t,e)}catch(t){return void this.destination.error(t)}this._emitFinal(n)}_emitFinal(t){const e=this.destination;this._emitted||(this._emitted=!0,e.next(t),e.complete(),this.hasCompleted=!0)}_complete(){const t=this.destination;this.hasCompleted||void 0===this.defaultValue?this.hasCompleted||t.error(new Ca):(t.next(this.defaultValue),t.complete())}}function Pa(t,e,n){return function(t,e,n){return r=>r.lift(new Aa(t,e,n,r))}(t,e,n)(this)}const La=ca.create;class Ia{constructor(t,e,n){this.predicate=t,this.thisArg=e,this.source=n}call(t,e){return e.subscribe(new Na(t,this.predicate,this.thisArg,this.source))}}class Na extends b{constructor(t,e,n,r){super(t),this.predicate=e,this.thisArg=n,this.source=r,this.index=0,this.thisArg=n||this}notifyComplete(t){this.destination.next(t),this.destination.complete()}_next(t){let e=!1;try{e=this.predicate.call(this.thisArg,t,this.index++,this.source)}catch(t){return void this.destination.error(t)}e||this.notifyComplete(!1)}_complete(){this.notifyComplete(!0)}}function Oa(t,e){return function(t,e){return n=>n.lift(new Ia(t,e,n))}(t,e)(this)}class Da{constructor(t,e,n,r){this.predicate=t,this.resultSelector=e,this.defaultValue=n,this.source=r}call(t,e){return e.subscribe(new Ba(t,this.predicate,this.resultSelector,this.defaultValue,this.source))}}class Ba extends b{constructor(t,e,n,r,i){super(t),this.predicate=e,this.resultSelector=n,this.defaultValue=r,this.source=i,this.hasValue=!1,this.index=0,void 0!==r&&(this.lastValue=r,this.hasValue=!0)}_next(t){const e=this.index++;if(this.predicate)this._tryPredicate(t,e);else{if(this.resultSelector)return void this._tryResultSelector(t,e);this.lastValue=t,this.hasValue=!0}}_tryPredicate(t,e){let n;try{n=this.predicate(t,e,this.source)}catch(t){return void this.destination.error(t)}if(n){if(this.resultSelector)return void this._tryResultSelector(t,e);this.lastValue=t,this.hasValue=!0}}_tryResultSelector(t,e){let n;try{n=this.resultSelector(t,e)}catch(t){return void this.destination.error(t)}this.lastValue=n,this.hasValue=!0}_complete(){const t=this.destination;this.hasValue?(t.next(this.lastValue),t.complete()):t.error(new Ca)}}function Ua(t,e,n){return function(t,e,n){return r=>r.lift(new Da(t,e,n,r))}(t,e,n)(this)}function za(t=Number.POSITIVE_INFINITY){return V(t)(this)}function Fa(t,e){let n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new ka(t,e,n))}}class ka{constructor(t,e,n=!1){this.accumulator=t,this.seed=e,this.hasSeed=n}call(t,e){return e.subscribe(new Va(t,this.accumulator,this.seed,this.hasSeed))}}class Va extends b{constructor(t,e,n,r){super(t),this.accumulator=e,this._seed=n,this.hasSeed=r,this.index=0}get seed(){return this._seed}set seed(t){this.hasSeed=!0,this._seed=t}_next(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)}_tryNext(t){const e=this.index++;let n;try{n=this.accumulator(this.seed,t,e)}catch(t){this.destination.error(t)}this.seed=n,this.destination.next(n)}}class Ga extends Error{constructor(){const t=super("argument out of range");this.name=t.name="ArgumentOutOfRangeError",this.stack=t.stack,this.message=t.message}}function ja(t){return function(e){return 0===t?new A:e.lift(new Ha(t))}}class Ha{constructor(t){if(this.total=t,this.total<0)throw new Ga}call(t,e){return e.subscribe(new Wa(t,this.total))}}class Wa extends b{constructor(t,e){super(t),this.total=e,this.ring=new Array,this.count=0}_next(t){const e=this.ring,n=this.total,r=this.count++;e.length<n?e.push(t):e[r%n]=t}_complete(){const t=this.destination;let e=this.count;if(e>0){const n=this.count>=this.total?this.total:this.count,r=this.ring;for(let i=0;i<n;i++){const i=e++%n;t.next(r[i])}}t.complete()}}class qa{constructor(t){this.defaultValue=t}call(t,e){return e.subscribe(new Xa(t,this.defaultValue))}}class Xa extends b{constructor(t,e){super(t),this.defaultValue=e,this.isEmpty=!0}_next(t){this.isEmpty=!1,this.destination.next(t)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function Ya(t,e){return arguments.length>=2?function(n){return S(Fa(t,e),ja(1),function(t=null){return e=>e.lift(new qa(t))}(e))(n)}:function(e){return S(Fa((e,n,r)=>t(e,n,r+1)),ja(1))(e)}}let Za=null;function $a(){return Za}class Qa{constructor(){this.resourceLoaderType=null}get attrToPropMap(){return this._attrToPropMap}set attrToPropMap(t){this._attrToPropMap=t}}class Ja extends Qa{constructor(){super(),this._animationPrefix=null,this._transitionEnd=null;try{const t=this.createElement("div",document);if(null!=this.getStyle(t,"animationName"))this._animationPrefix="";else{const e=["Webkit","Moz","O","ms"];for(let n=0;n<e.length;n++)if(null!=this.getStyle(t,e[n]+"AnimationName")){this._animationPrefix="-"+e[n].toLowerCase()+"-";break}}const e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};Object.keys(e).forEach(n=>{null!=this.getStyle(t,n)&&(this._transitionEnd=e[n])})}catch(t){this._animationPrefix=null,this._transitionEnd=null}}getDistributedNodes(t){return t.getDistributedNodes()}resolveAndSetHref(t,e,n){t.href=null==n?e:e+"/../"+n}supportsDOMEvents(){return!0}supportsNativeShadowDOM(){return"function"==typeof document.body.createShadowRoot}getAnimationPrefix(){return this._animationPrefix?this._animationPrefix:""}getTransitionEnd(){return this._transitionEnd?this._transitionEnd:""}supportsAnimation(){return null!=this._animationPrefix&&null!=this._transitionEnd}}const Ka={class:"className",innerHtml:"innerHTML",readonly:"readOnly",tabindex:"tabIndex"},tl=3,el={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},nl={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"};let rl;bt.Node&&(rl=bt.Node.prototype.contains||function(t){return!!(16&this.compareDocumentPosition(t))});class il extends Ja{parse(t){throw new Error("parse not implemented")}static makeCurrent(){!function(t){Za||(Za=t)}(new il)}hasProperty(t,e){return e in t}setProperty(t,e,n){t[e]=n}getProperty(t,e){return t[e]}invoke(t,e,n){t[e](...n)}logError(t){window.console&&(console.error?console.error(t):console.log(t))}log(t){window.console&&window.console.log&&window.console.log(t)}logGroup(t){window.console&&window.console.group&&window.console.group(t)}logGroupEnd(){window.console&&window.console.groupEnd&&window.console.groupEnd()}get attrToPropMap(){return Ka}contains(t,e){return rl.call(t,e)}querySelector(t,e){return t.querySelector(e)}querySelectorAll(t,e){return t.querySelectorAll(e)}on(t,e,n){t.addEventListener(e,n,!1)}onAndCancel(t,e,n){return t.addEventListener(e,n,!1),()=>{t.removeEventListener(e,n,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}createMouseEvent(t){const e=this.getDefaultDocument().createEvent("MouseEvent");return e.initEvent(t,!0,!0),e}createEvent(t){const e=this.getDefaultDocument().createEvent("Event");return e.initEvent(t,!0,!0),e}preventDefault(t){t.preventDefault(),t.returnValue=!1}isPrevented(t){return t.defaultPrevented||null!=t.returnValue&&!t.returnValue}getInnerHTML(t){return t.innerHTML}getTemplateContent(t){return"content"in t&&this.isTemplateElement(t)?t.content:null}getOuterHTML(t){return t.outerHTML}nodeName(t){return t.nodeName}nodeValue(t){return t.nodeValue}type(t){return t.type}content(t){return this.hasProperty(t,"content")?t.content:t}firstChild(t){return t.firstChild}nextSibling(t){return t.nextSibling}parentElement(t){return t.parentNode}childNodes(t){return t.childNodes}childNodesAsList(t){const e=t.childNodes,n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=e[r];return n}clearNodes(t){for(;t.firstChild;)t.removeChild(t.firstChild)}appendChild(t,e){t.appendChild(e)}removeChild(t,e){t.removeChild(e)}replaceChild(t,e,n){t.replaceChild(e,n)}remove(t){return t.parentNode&&t.parentNode.removeChild(t),t}insertBefore(t,e,n){t.insertBefore(n,e)}insertAllBefore(t,e,n){n.forEach(n=>t.insertBefore(n,e))}insertAfter(t,e,n){t.insertBefore(n,e.nextSibling)}setInnerHTML(t,e){t.innerHTML=e}getText(t){return t.textContent}setText(t,e){t.textContent=e}getValue(t){return t.value}setValue(t,e){t.value=e}getChecked(t){return t.checked}setChecked(t,e){t.checked=e}createComment(t){return this.getDefaultDocument().createComment(t)}createTemplate(t){const e=this.getDefaultDocument().createElement("template");return e.innerHTML=t,e}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createElementNS(t,e,n){return(n=n||this.getDefaultDocument()).createElementNS(t,e)}createTextNode(t,e){return(e=e||this.getDefaultDocument()).createTextNode(t)}createScriptTag(t,e,n){const r=(n=n||this.getDefaultDocument()).createElement("SCRIPT");return r.setAttribute(t,e),r}createStyleElement(t,e){const n=(e=e||this.getDefaultDocument()).createElement("style");return this.appendChild(n,this.createTextNode(t,e)),n}createShadowRoot(t){return t.createShadowRoot()}getShadowRoot(t){return t.shadowRoot}getHost(t){return t.host}clone(t){return t.cloneNode(!0)}getElementsByClassName(t,e){return t.getElementsByClassName(e)}getElementsByTagName(t,e){return t.getElementsByTagName(e)}classList(t){return Array.prototype.slice.call(t.classList,0)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}hasClass(t,e){return t.classList.contains(e)}setStyle(t,e,n){t.style[e]=n}removeStyle(t,e){t.style[e]=""}getStyle(t,e){return t.style[e]}hasStyle(t,e,n){const r=this.getStyle(t,e)||"";return n?r==n:r.length>0}tagName(t){return t.tagName}attributeMap(t){const e=new Map,n=t.attributes;for(let r=0;r<n.length;r++){const t=n.item(r);e.set(t.name,t.value)}return e}hasAttribute(t,e){return t.hasAttribute(e)}hasAttributeNS(t,e,n){return t.hasAttributeNS(e,n)}getAttribute(t,e){return t.getAttribute(e)}getAttributeNS(t,e,n){return t.getAttributeNS(e,n)}setAttribute(t,e,n){t.setAttribute(e,n)}setAttributeNS(t,e,n,r){t.setAttributeNS(e,n,r)}removeAttribute(t,e){t.removeAttribute(e)}removeAttributeNS(t,e,n){t.removeAttributeNS(e,n)}templateAwareRoot(t){return this.isTemplateElement(t)?this.content(t):t}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}getBoundingClientRect(t){try{return t.getBoundingClientRect()}catch(t){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}}getTitle(t){return t.title}setTitle(t,e){t.title=e||""}elementMatches(t,e){return!!this.isElementNode(t)&&(t.matches&&t.matches(e)||t.msMatchesSelector&&t.msMatchesSelector(e)||t.webkitMatchesSelector&&t.webkitMatchesSelector(e))}isTemplateElement(t){return this.isElementNode(t)&&"TEMPLATE"===t.nodeName}isTextNode(t){return t.nodeType===Node.TEXT_NODE}isCommentNode(t){return t.nodeType===Node.COMMENT_NODE}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}hasShadowRoot(t){return null!=t.shadowRoot&&t instanceof HTMLElement}isShadowRoot(t){return t instanceof DocumentFragment}importIntoDoc(t){return document.importNode(this.templateAwareRoot(t),!0)}adoptNode(t){return document.adoptNode(t)}getHref(t){return t.getAttribute("href")}getEventKey(t){let e=t.key;if(null==e){if(null==(e=t.keyIdentifier))return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),t.location===tl&&nl.hasOwnProperty(e)&&(e=nl[e]))}return el[e]||e}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getHistory(){return window.history}getLocation(){return window.location}getBaseHref(t){const e=sl||(sl=document.querySelector("base"))?sl.getAttribute("href"):null;return null==e?null:function(t){return ol||(ol=document.createElement("a")),ol.setAttribute("href",t),"/"===ol.pathname.charAt(0)?ol.pathname:"/"+ol.pathname}(e)}resetBaseElement(){sl=null}getUserAgent(){return window.navigator.userAgent}setData(t,e,n){this.setAttribute(t,"data-"+e,n)}getData(t,e){return this.getAttribute(t,"data-"+e)}getComputedStyle(t){return getComputedStyle(t)}supportsWebAnimation(){return"function"==typeof Element.prototype.animate}performanceNow(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}supportsCookies(){return!0}getCookie(t){return function(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const t=n.indexOf("="),[r,i]=-1==t?[n,""]:[n.slice(0,t),n.slice(t+1)];if(r.trim()===e)return decodeURIComponent(i)}return null}(document.cookie,t)}setCookie(t,e){document.cookie=encodeURIComponent(t)+"="+encodeURIComponent(e)}}let ol,sl=null;const al=na;function ll(){return!!window.history.pushState}class ul extends Ss{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=$a().getLocation(),this._history=$a().getHistory()}getBaseHrefFromDOM(){return $a().getBaseHref(this._doc)}onPopState(t){$a().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",t,!1)}onHashChange(t){$a().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",t,!1)}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,e,n){ll()?this._history.pushState(t,e,n):this.location.hash=n}replaceState(t,e,n){ll()?this._history.replaceState(t,e,n):this.location.hash=n}forward(){this._history.forward()}back(){this._history.back()}}ul.ctorParameters=(()=>[{type:void 0,decorators:[{type:pt,args:[al]}]}]);class cl{constructor(t){this._doc=t,this._dom=$a()}addTag(t,e=!1){return t?this._getOrCreateElement(t,e):null}addTags(t,e=!1){return t?t.reduce((t,n)=>(n&&t.push(this._getOrCreateElement(n,e)),t),[]):[]}getTag(t){return t&&this._dom.querySelector(this._doc,`meta[${t}]`)||null}getTags(t){if(!t)return[];const e=this._dom.querySelectorAll(this._doc,`meta[${t}]`);return e?[].slice.call(e):[]}updateTag(t,e){if(!t)return null;e=e||this._parseSelector(t);const n=this.getTag(e);return n?this._setMetaElementAttributes(t,n):this._getOrCreateElement(t,!0)}removeTag(t){this.removeTagElement(this.getTag(t))}removeTagElement(t){t&&this._dom.remove(t)}_getOrCreateElement(t,e=!1){if(!e){const e=this._parseSelector(t),n=this.getTag(e);if(n&&this._containsAttributes(t,n))return n}const n=this._dom.createElement("meta");this._setMetaElementAttributes(t,n);const r=this._dom.getElementsByTagName(this._doc,"head")[0];return this._dom.appendChild(r,n),n}_setMetaElementAttributes(t,e){return Object.keys(t).forEach(n=>this._dom.setAttribute(e,n,t[n])),e}_parseSelector(t){const e=t.name?"name":"property";return`${e}="${t[e]}"`}_containsAttributes(t,e){return Object.keys(t).every(n=>this._dom.getAttribute(e,n)===t[n])}}const hl=new K("TRANSITION_ID"),dl=[{provide:Te,useFactory:function(t,e,n){return()=>{n.get(Ce).donePromise.then(()=>{const n=$a();Array.prototype.slice.apply(n.querySelectorAll(e,"style[ng-transition]")).filter(e=>n.getAttribute(e,"ng-transition")===t).forEach(t=>n.remove(t))})}},deps:[hl,al,Lt],multi:!0}];class pl{static init(){!function(t){cn=t}(new pl)}addToWindow(t){bt.getAngularTestability=((e,n=!0)=>{const r=t.findTestabilityInTree(e,n);if(null==r)throw new Error("Could not find testability for element.");return r}),bt.getAllAngularTestabilities=(()=>t.getAllTestabilities()),bt.getAllAngularRootElements=(()=>t.getAllRootElements()),bt.frameworkStabilizers||(bt.frameworkStabilizers=[]),bt.frameworkStabilizers.push(t=>{const e=bt.getAllAngularTestabilities();let n=e.length,r=!1;const i=function(e){r=r||e,0==--n&&t(r)};e.forEach(function(t){t.whenStable(i)})})}findTestabilityInTree(t,e,n){if(null==e)return null;const r=t.getTestability(e);return null!=r?r:n?$a().isShadowRoot(e)?this.findTestabilityInTree(t,$a().getHost(e),!0):this.findTestabilityInTree(t,$a().parentElement(e),!0):null}}class fl{constructor(t){this._doc=t}getTitle(){return $a().getTitle(this._doc)}setTitle(t){$a().setTitle(this._doc,t)}}function ml(t,e){"undefined"!=typeof COMPILED&&COMPILED||((bt.ng=bt.ng||{})[t]=e)}const gl={ApplicationRef:bn,NgZone:Ke};function vl(t){return Vn(t)}new ft;const yl=new K("EventManagerPlugins");class wl{constructor(t,e){this._zone=e,this._eventNameToPlugin=new Map,t.forEach(t=>t.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,e,n){return this._findPluginFor(e).addEventListener(t,e,n)}addGlobalEventListener(t,e,n){return this._findPluginFor(e).addGlobalEventListener(t,e,n)}getZone(){return this._zone}_findPluginFor(t){const e=this._eventNameToPlugin.get(t);if(e)return e;const n=this._plugins;for(let r=0;r<n.length;r++){const e=n[r];if(e.supports(t))return this._eventNameToPlugin.set(t,e),e}throw new Error(`No event manager plugin found for event ${t}`)}}class bl{constructor(t){this._doc=t}addGlobalEventListener(t,e,n){const r=$a().getGlobalEventTarget(this._doc,t);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,n)}}class xl{constructor(){this._stylesSet=new Set}addStyles(t){const e=new Set;t.forEach(t=>{this._stylesSet.has(t)||(this._stylesSet.add(t),e.add(t))}),this.onStylesAdded(e)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}class _l extends xl{constructor(t){super(),this._doc=t,this._hostNodes=new Set,this._styleNodes=new Set,this._hostNodes.add(t.head)}_addStylesToHost(t,e){t.forEach(t=>{const n=this._doc.createElement("style");n.textContent=t,this._styleNodes.add(e.appendChild(n))})}addHost(t){this._addStylesToHost(this._stylesSet,t),this._hostNodes.add(t)}removeHost(t){this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach(e=>this._addStylesToHost(t,e))}ngOnDestroy(){this._styleNodes.forEach(t=>$a().remove(t))}}const El={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Sl=/%COMP%/g,Ml="_nghost-%COMP%",Tl="_ngcontent-%COMP%";function Cl(t,e,n){for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?Cl(t,i,n):(i=i.replace(Sl,t),n.push(i))}return n}function Al(t){return e=>{!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}class Rl{constructor(t,e){this.eventManager=t,this.sharedStylesHost=e,this.rendererByCompId=new Map,this.defaultRenderer=new Pl(t)}createRenderer(t,e){if(!t||!e)return this.defaultRenderer;switch(e.encapsulation){case ct.Emulated:{let n=this.rendererByCompId.get(e.id);return n||(n=new Nl(this.eventManager,this.sharedStylesHost,e),this.rendererByCompId.set(e.id,n)),n.applyToHost(t),n}case ct.Native:return new Ol(this.eventManager,this.sharedStylesHost,t,e);default:if(!this.rendererByCompId.has(e.id)){const t=Cl(e.id,e.styles,[]);this.sharedStylesHost.addStyles(t),this.rendererByCompId.set(e.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}class Pl{constructor(t){this.eventManager=t,this.data=Object.create(null)}destroy(){}createElement(t,e){return e?document.createElementNS(El[e],t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){t.appendChild(e)}insertBefore(t,e,n){t&&t.insertBefore(e,n)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t){let e="string"==typeof t?document.querySelector(t):t;if(!e)throw new Error(`The selector "${t}" did not match any elements`);return e.textContent="",e}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,n,r){if(r){e=`${r}:${e}`;const i=El[r];i?t.setAttributeNS(i,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)}removeAttribute(t,e,n){if(n){const r=El[n];r?t.removeAttributeNS(r,e):t.removeAttribute(`${n}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,n,r){r&En.DashCase?t.style.setProperty(e,n,r&En.Important?"important":""):t.style[e]=n}removeStyle(t,e,n){n&En.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,n){Il(e,"property"),t[e]=n}setValue(t,e){t.nodeValue=e}listen(t,e,n){return Il(e,"listener"),"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,Al(n)):this.eventManager.addEventListener(t,e,Al(n))}}const Ll="@".charCodeAt(0);function Il(t,e){if(t.charCodeAt(0)===Ll)throw new Error(`Found the synthetic ${e} ${t}. Please include either "BrowserAnimationsModule" or "NoopAnimationsModule" in your application.`)}class Nl extends Pl{constructor(t,e,n){super(t),this.component=n;const r=Cl(n.id,n.styles,[]);e.addStyles(r),this.contentAttr=Tl.replace(Sl,n.id),this.hostAttr=Ml.replace(Sl,n.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const n=super.createElement(t,e);return super.setAttribute(n,this.contentAttr,""),n}}class Ol extends Pl{constructor(t,e,n,r){super(t),this.sharedStylesHost=e,this.hostEl=n,this.component=r,this.shadowRoot=n.createShadowRoot(),this.sharedStylesHost.addHost(this.shadowRoot);const i=Cl(r.id,r.styles,[]);for(let o=0;o<i.length;o++){const t=document.createElement("style");t.textContent=i[o],this.shadowRoot.appendChild(t)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,n){return super.insertBefore(this.nodeOrShadowRoot(t),e,n)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}const Dl="undefined"!=typeof Zone&&Zone.__symbol__||function(t){return"__zone_symbol__"+t},Bl=Dl("addEventListener"),Ul=Dl("removeEventListener"),zl={},Fl="__zone_symbol__propagationStopped",kl="undefined"!=typeof Zone&&Zone[Dl("BLACK_LISTED_EVENTS")];let Vl;kl&&(Vl={},kl.forEach(t=>{Vl[t]=t}));const Gl=function(t){return!!Vl&&Vl.hasOwnProperty(t)},jl=function(t){const e=zl[t.type];if(!e)return;const n=this[e];if(!n)return;const r=[t];if(1===n.length){const t=n[0];return t.zone!==Zone.current?t.zone.run(t.handler,this,r):t.handler.apply(this,r)}{const e=n.slice();for(let n=0;n<e.length&&!0!==t[Fl];n++){const t=e[n];t.zone!==Zone.current?t.zone.run(t.handler,this,r):t.handler.apply(this,r)}}},Hl={pan:!0,panstart:!0,panmove:!0,panend:!0,pancancel:!0,panleft:!0,panright:!0,panup:!0,pandown:!0,pinch:!0,pinchstart:!0,pinchmove:!0,pinchend:!0,pinchcancel:!0,pinchin:!0,pinchout:!0,press:!0,pressup:!0,rotate:!0,rotatestart:!0,rotatemove:!0,rotateend:!0,rotatecancel:!0,swipe:!0,swipeleft:!0,swiperight:!0,swipeup:!0,swipedown:!0,tap:!0},Wl=new K("HammerGestureConfig");class ql{constructor(){this.events=[],this.overrides={}}buildHammer(t){const e=new Hammer(t);e.get("pinch").set({enable:!0}),e.get("rotate").set({enable:!0});for(const n in this.overrides)e.get(n).set(this.overrides[n]);return e}}const Xl=["alt","control","meta","shift"],Yl={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};class Zl extends bl{constructor(t){super(t)}supports(t){return null!=Zl.parseEventName(t)}addEventListener(t,e,n){const r=Zl.parseEventName(e),i=Zl.eventCallback(r.fullKey,n,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>$a().onAndCancel(t,r.domEventName,i))}static parseEventName(t){const e=t.toLowerCase().split("."),n=e.shift();if(0===e.length||"keydown"!==n&&"keyup"!==n)return null;const r=Zl._normalizeKey(e.pop());let i="";if(Xl.forEach(t=>{const n=e.indexOf(t);n>-1&&(e.splice(n,1),i+=t+".")}),i+=r,0!=e.length||0===r.length)return null;const o={};return o.domEventName=n,o.fullKey=i,o}static getEventFullKey(t){let e="",n=$a().getEventKey(t);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),Xl.forEach(r=>{r!=n&&(0,Yl[r])(t)&&(e+=r+".")}),e+=n}static eventCallback(t,e,n){return r=>{Zl.getEventFullKey(r)===t&&n.runGuarded(()=>e(r))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}const $l=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,Ql=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Jl(t){return(t=String(t)).match($l)||t.match(Ql)?t:(fn()&&$a().log(`WARNING: sanitizing unsafe URL value ${t} (see http://g.co/ng/security#xss)`),"unsafe:"+t)}let Kl=null,tu=null;function eu(t){const e={};for(const n of t.split(","))e[n]=!0;return e}function nu(...t){const e={};for(const n of t)for(const t in n)n.hasOwnProperty(t)&&(e[t]=!0);return e}const ru=eu("area,br,col,hr,img,wbr"),iu=eu("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),ou=eu("rp,rt"),su=nu(ou,iu),au=nu(iu,eu("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),lu=nu(ou,eu("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),uu=nu(ru,au,lu,su),cu=eu("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),hu=eu("srcset"),du=eu("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),pu=nu(cu,hu,du);class fu{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild;for(;e;)if(tu.isElementNode(e)?this.startElement(e):tu.isTextNode(e)?this.chars(tu.nodeValue(e)):this.sanitizedSomething=!0,tu.firstChild(e))e=tu.firstChild(e);else for(;e;){tu.isElementNode(e)&&this.endElement(e);let t=mu(e,tu.nextSibling(e));if(t){e=t;break}e=mu(e,tu.parentElement(e))}return this.buf.join("")}startElement(t){const e=tu.nodeName(t).toLowerCase();uu.hasOwnProperty(e)?(this.buf.push("<"),this.buf.push(e),tu.attributeMap(t).forEach((t,e)=>{const n=e.toLowerCase();pu.hasOwnProperty(n)?(cu[n]&&(t=Jl(t)),hu[n]&&(t=String(t).split(",").map(t=>Jl(t.trim())).join(", ")),this.buf.push(" "),this.buf.push(e),this.buf.push('="'),this.buf.push(yu(t)),this.buf.push('"')):this.sanitizedSomething=!0}),this.buf.push(">")):this.sanitizedSomething=!0}endElement(t){const e=tu.nodeName(t).toLowerCase();uu.hasOwnProperty(e)&&!ru.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(yu(t))}}function mu(t,e){if(e&&tu.contains(t,e))throw new Error(`Failed to sanitize html because the element is clobbered: ${tu.getOuterHTML(t)}`);return e}const gu=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,vu=/([^\#-~ |!])/g;function yu(t){return t.replace(/&/g,"&amp;").replace(gu,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(vu,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function wu(t){tu.attributeMap(t).forEach((e,n)=>{"xmlns:ns1"!==n&&0!==n.indexOf("ns1:")||tu.removeAttribute(t,n)});for(const e of tu.childNodesAsList(t))tu.isElementNode(e)&&wu(e)}const bu=new RegExp("^([-,.\"'%_!# a-zA-Z0-9]+|(?:(?:matrix|translate|scale|rotate|skew|perspective)(?:X|Y|3d)?|(?:rgb|hsl)a?|(?:repeating-)?(?:linear|radial)-gradient|(?:calc|attr))\\([-0-9.%, #a-zA-Z]+\\))$","g"),xu=/^url\(([^)]+)\)$/;class _u{}class Eu extends _u{constructor(t){super(),this._doc=t}sanitize(t,e){if(null==e)return null;switch(t){case cr.NONE:return e;case cr.HTML:return e instanceof Mu?e.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(e,"HTML"),function(t,e){try{const n=function(){if(Kl)return Kl;const t=(tu=$a()).createElement("template");if("content"in t)return t;const e=tu.createHtmlDocument();if(null==(Kl=tu.querySelector(e,"body"))){const t=tu.createElement("html",e);Kl=tu.createElement("body",e),tu.appendChild(t,Kl),tu.appendChild(e,t)}return Kl}();let r=e?String(e):"",i=5,o=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,tu.setInnerHTML(n,r=o),t.documentMode&&wu(n),o=tu.getInnerHTML(n)}while(r!==o);const s=new fu,a=s.sanitizeChildren(tu.getTemplateContent(n)||n),l=tu.getTemplateContent(n)||n;for(const t of tu.childNodesAsList(l))tu.removeChild(l,t);return fn()&&s.sanitizedSomething&&tu.log("WARNING: sanitizing HTML stripped some content (see http://g.co/ng/security#xss)."),a}catch(t){throw Kl=null,t}}(this._doc,String(e)));case cr.STYLE:return e instanceof Tu?e.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(e,"Style"),function(t){if(!(t=String(t).trim()))return"";const e=t.match(xu);return e&&Jl(e[1])===e[1]||t.match(bu)&&function(t){let e=!0,n=!0;for(let r=0;r<t.length;r++){const i=t.charAt(r);"'"===i&&n?e=!e:'"'===i&&e&&(n=!n)}return e&&n}(t)?t:(fn()&&$a().log(`WARNING: sanitizing unsafe style value ${t} (see http://g.co/ng/security#xss).`),"unsafe")}(e));case cr.SCRIPT:if(e instanceof Cu)return e.changingThisBreaksApplicationSecurity;throw this.checkNotSafeValue(e,"Script"),new Error("unsafe value used in a script context");case cr.URL:return e instanceof Ru||e instanceof Au?e.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(e,"URL"),Jl(String(e)));case cr.RESOURCE_URL:if(e instanceof Ru)return e.changingThisBreaksApplicationSecurity;throw this.checkNotSafeValue(e,"ResourceURL"),new Error("unsafe value used in a resource URL context (see http://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${t} (see http://g.co/ng/security#xss)`)}}checkNotSafeValue(t,e){if(t instanceof Su)throw new Error(`Required a safe ${e}, got a ${t.getTypeName()} `+"(see http://g.co/ng/security#xss)")}bypassSecurityTrustHtml(t){return new Mu(t)}bypassSecurityTrustStyle(t){return new Tu(t)}bypassSecurityTrustScript(t){return new Cu(t)}bypassSecurityTrustUrl(t){return new Au(t)}bypassSecurityTrustResourceUrl(t){return new Ru(t)}}class Su{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity}`+" (see http://g.co/ng/security#xss)"}}class Mu extends Su{getTypeName(){return"HTML"}}class Tu extends Su{getTypeName(){return"Style"}}class Cu extends Su{getTypeName(){return"Script"}}class Au extends Su{getTypeName(){return"URL"}}class Ru extends Su{getTypeName(){return"ResourceURL"}}const Pu=gn(ir,"browser",[{provide:Ie,useValue:"browser"},{provide:Le,useValue:function(){il.makeCurrent(),pl.init()},multi:!0},{provide:Ss,useClass:ul,deps:[al]},{provide:al,useFactory:function(){return document},deps:[]}]);function Lu(){return new Kt}class Iu{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:Iu,providers:[{provide:Ae,useValue:t.appId},{provide:hl,useExisting:Ae},dl]}}}"undefined"!=typeof window&&window,new ht("5.2.0");class Nu{constructor(t,e){this.predicate=t,this.thisArg=e}call(t,e){return e.subscribe(new Ou(t,this.predicate,this.thisArg))}}class Ou extends b{constructor(t,e,n){super(t),this.predicate=e,this.thisArg=n,this.count=0}_next(t){let e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)}}class Du{constructor(t,e){this.id=t,this.url=e}}class Bu extends Du{toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Uu extends Du{constructor(t,e,n){super(t,e),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class zu extends Du{constructor(t,e,n){super(t,e),this.reason=n}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Fu extends Du{constructor(t,e,n){super(t,e),this.error=n}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class ku extends Du{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Vu extends Du{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Gu extends Du{constructor(t,e,n,r,i){super(t,e),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=i}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class ju extends Du{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Hu extends Du{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Wu{constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class qu{constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Xu{constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Yu{constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Zu{constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class $u{constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}const Qu="primary";class Ju{constructor(t){this.params=t||{}}has(t){return this.params.hasOwnProperty(t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function Ku(t){return new Ju(t)}const tc="ngNavigationCancelingError";function ec(t,e,n){const r=n.path.split("/");if(r.length>t.length)return null;if("full"===n.pathMatch&&(e.hasChildren()||r.length<t.length))return null;const i={};for(let o=0;o<r.length;o++){const e=r[o],n=t[o];if(e.startsWith(":"))i[e.substring(1)]=n;else if(e!==n.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}class nc{constructor(t,e){this.routes=t,this.module=e}}function rc(t,e=""){for(let n=0;n<t.length;n++){const r=t[n];ic(r,oc(e,r))}}function ic(t,e){if(!t)throw new Error(`\n      Invalid configuration of route '${e}': Encountered undefined route.\n      The reason might be an extra comma.\n\n      Example:\n      const routes: Routes = [\n        { path: '', redirectTo: '/dashboard', pathMatch: 'full' },\n        { path: 'dashboard',  component: DashboardComponent },, << two commas\n        { path: 'detail/:id', component: HeroDetailComponent }\n      ];\n    `);if(Array.isArray(t))throw new Error(`Invalid configuration of route '${e}': Array cannot be specified`);if(!t.component&&t.outlet&&t.outlet!==Qu)throw new Error(`Invalid configuration of route '${e}': a componentless route cannot have a named outlet set`);if(t.redirectTo&&t.children)throw new Error(`Invalid configuration of route '${e}': redirectTo and children cannot be used together`);if(t.redirectTo&&t.loadChildren)throw new Error(`Invalid configuration of route '${e}': redirectTo and loadChildren cannot be used together`);if(t.children&&t.loadChildren)throw new Error(`Invalid configuration of route '${e}': children and loadChildren cannot be used together`);if(t.redirectTo&&t.component)throw new Error(`Invalid configuration of route '${e}': redirectTo and component cannot be used together`);if(t.path&&t.matcher)throw new Error(`Invalid configuration of route '${e}': path and matcher cannot be used together`);if(void 0===t.redirectTo&&!t.component&&!t.children&&!t.loadChildren)throw new Error(`Invalid configuration of route '${e}'. One of the following must be provided: component, redirectTo, children or loadChildren`);if(void 0===t.path&&void 0===t.matcher)throw new Error(`Invalid configuration of route '${e}': routes must have either a path or a matcher specified`);if("string"==typeof t.path&&"/"===t.path.charAt(0))throw new Error(`Invalid configuration of route '${e}': path cannot start with a slash`);if(""===t.path&&void 0!==t.redirectTo&&void 0===t.pathMatch)throw new Error(`Invalid configuration of route '{path: "${e}", redirectTo: "${t.redirectTo}"}': please provide 'pathMatch'. The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'.`);if(void 0!==t.pathMatch&&"full"!==t.pathMatch&&"prefix"!==t.pathMatch)throw new Error(`Invalid configuration of route '${e}': pathMatch can only be set to 'prefix' or 'full'`);t.children&&rc(t.children,e)}function oc(t,e){return e?t||e.path?t&&!e.path?`${t}/`:!t&&e.path?e.path:`${t}/${e.path}`:"":t}function sc(t,e){const n=Object.keys(t),r=Object.keys(e);if(n.length!=r.length)return!1;let i;for(let o=0;o<n.length;o++)if(t[i=n[o]]!==e[i])return!1;return!0}function ac(t){return Array.prototype.concat.apply([],t)}function lc(t){return t.length>0?t[t.length-1]:null}function uc(t,e){for(const n in t)t.hasOwnProperty(n)&&e(t[n],n)}function cc(t){const e=za.call(t);return Oa.call(e,t=>!0===t)}function hc(t){return Me(t)?t:Se(t)?La(Promise.resolve(t)):ia(t)}function dc(t,e,n){return n?function(t,e){return sc(t,e)}(t.queryParams,e.queryParams)&&function t(e,n){if(!gc(e.segments,n.segments))return!1;if(e.numberOfChildren!==n.numberOfChildren)return!1;for(const r in n.children){if(!e.children[r])return!1;if(!t(e.children[r],n.children[r]))return!1}return!0}(t.root,e.root):function(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>e[n]===t[n])}(t.queryParams,e.queryParams)&&function t(e,n){return function e(n,r,i){if(n.segments.length>i.length){return!!gc(n.segments.slice(0,i.length),i)&&!r.hasChildren()}if(n.segments.length===i.length){if(!gc(n.segments,i))return!1;for(const e in r.children){if(!n.children[e])return!1;if(!t(n.children[e],r.children[e]))return!1}return!0}{const t=i.slice(0,n.segments.length),o=i.slice(n.segments.length);return!!gc(n.segments,t)&&!!n.children[Qu]&&e(n.children[Qu],r,o)}}(e,n,n.segments)}(t.root,e.root)}class pc{constructor(t,e,n){this.root=t,this.queryParams=e,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Ku(this.queryParams)),this._queryParamMap}toString(){return bc.serialize(this)}}class fc{constructor(t,e){this.segments=t,this.children=e,this.parent=null,uc(e,(t,e)=>t.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return xc(this)}}class mc{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=Ku(this.parameters)),this._parameterMap}toString(){return Sc(this)}}function gc(t,e){return t.length===e.length&&t.every((t,n)=>t.path===e[n].path)}function vc(t,e){let n=[];return uc(t.children,(t,r)=>{r===Qu&&(n=n.concat(e(t,r)))}),uc(t.children,(t,r)=>{r!==Qu&&(n=n.concat(e(t,r)))}),n}class yc{}class wc{parse(t){const e=new Rc(t);return new pc(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){return`${`/${function t(e,n){if(!e.hasChildren())return xc(e);if(n){const n=e.children[Qu]?t(e.children[Qu],!1):"",r=[];return uc(e.children,(e,n)=>{n!==Qu&&r.push(`${n}:${t(e,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}{const n=vc(e,(n,r)=>r===Qu?[t(e.children[Qu],!1)]:[`${r}:${t(n,!1)}`]);return`${xc(e)}/(${n.join("//")})`}}(t.root,!0)}`}${function(t){const e=Object.keys(t).map(e=>{const n=t[e];return Array.isArray(n)?n.map(t=>`${_c(e)}=${_c(t)}`).join("&"):`${_c(e)}=${_c(n)}`});return e.length?`?${e.join("&")}`:""}(t.queryParams)}${"string"==typeof t.fragment?`#${encodeURI(t.fragment)}`:""}`}}const bc=new wc;function xc(t){return t.segments.map(t=>Sc(t)).join("/")}function _c(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";")}function Ec(t){return decodeURIComponent(t)}function Sc(t){return`${_c(t.path)}${function(t){return Object.keys(t).map(e=>`;${_c(e)}=${_c(t[e])}`).join("")}(t.parameters)}`}const Mc=/^[^\/()?;=&#]+/;function Tc(t){const e=t.match(Mc);return e?e[0]:""}const Cc=/^[^=?&#]+/,Ac=/^[^?&#]+/;class Rc{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new fc([],{}):new fc([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURI(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(n[Qu]=new fc(t,e)),n}parseSegment(){const t=Tc(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(t),new mc(Ec(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=Tc(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=Tc(this.remaining);t&&this.capture(n=t)}t[Ec(e)]=Ec(n)}parseQueryParam(t){const e=function(t){const e=t.match(Cc);return e?e[0]:""}(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=function(t){const e=t.match(Ac);return e?e[0]:""}(this.remaining);t&&this.capture(n=t)}const r=Ec(e),i=Ec(n);if(t.hasOwnProperty(r)){let e=t[r];Array.isArray(e)||(t[r]=e=[e]),e.push(i)}else t[r]=i}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=Tc(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let i=void 0;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):t&&(i=Qu);const o=this.parseChildren();e[i]=1===Object.keys(o).length?o[Qu]:new fc([],o),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Error(`Expected "${t}".`)}}class Pc{constructor(t){this.segmentGroup=t||null}}class Lc{constructor(t){this.urlTree=t}}function Ic(t){return new T(e=>e.error(new Pc(t)))}function Nc(t){return new T(e=>e.error(new Lc(t)))}function Oc(t){return new T(e=>e.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t}'`)))}class Dc{constructor(t,e,n,r,i){this.configLoader=e,this.urlSerializer=n,this.urlTree=r,this.config=i,this.allowRedirects=!0,this.ngModule=t.get(We)}apply(){const t=this.expandSegmentGroup(this.ngModule,this.config,this.urlTree.root,Qu),e=la.call(t,t=>this.createUrlTree(t,this.urlTree.queryParams,this.urlTree.fragment));return Ma.call(e,t=>{if(t instanceof Lc)return this.allowRedirects=!1,this.match(t.urlTree);if(t instanceof Pc)throw this.noMatchError(t);throw t})}match(t){const e=this.expandSegmentGroup(this.ngModule,this.config,t.root,Qu),n=la.call(e,e=>this.createUrlTree(e,t.queryParams,t.fragment));return Ma.call(n,t=>{if(t instanceof Pc)throw this.noMatchError(t);throw t})}noMatchError(t){return new Error(`Cannot match any routes. URL Segment: '${t.segmentGroup}'`)}createUrlTree(t,e,n){const r=t.segments.length>0?new fc([],{[Qu]:t}):t;return new pc(r,e,n)}expandSegmentGroup(t,e,n,r){return 0===n.segments.length&&n.hasChildren()?la.call(this.expandChildren(t,e,n),t=>new fc([],t)):this.expandSegment(t,n,e,n.segments,r,!0)}expandChildren(t,e,n){return function(t,e){if(0===Object.keys(t).length)return ia({});const n=[],r=[],i={};uc(t,(t,o)=>{const s=la.call(e(o,t),t=>i[o]=t);o===Qu?n.push(s):r.push(s)});const o=Ta.call(ia(...n,...r)),s=Ua.call(o);return la.call(s,()=>i)}(n.children,(n,r)=>this.expandSegmentGroup(t,e,r,n))}expandSegment(t,e,n,r,i,o){const s=ia(...n),a=la.call(s,s=>{const a=this.expandSegmentAgainstRoute(t,e,n,s,r,i,o);return Ma.call(a,t=>{if(t instanceof Pc)return ia(null);throw t})}),l=Ta.call(a),u=Pa.call(l,t=>!!t);return Ma.call(u,(t,n)=>{if(t instanceof Ca||"EmptyError"===t.name){if(this.noLeftoversInUrl(e,r,i))return ia(new fc([],{}));throw new Pc(e)}throw t})}noLeftoversInUrl(t,e,n){return 0===e.length&&!t.children[n]}expandSegmentAgainstRoute(t,e,n,r,i,o,s){return Fc(r)!==o?Ic(e):void 0===r.redirectTo?this.matchSegmentAgainstRoute(t,e,r,i):s&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,n,r,i,o):Ic(e)}expandSegmentAgainstRouteUsingRedirect(t,e,n,r,i,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,r,i,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,n,r){const i=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?Nc(i):ua.call(this.lineralizeSegments(n,i),n=>{const i=new fc(n,{});return this.expandSegment(t,i,e,n,r,!1)})}expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,r,i,o){const{matched:s,consumedSegments:a,lastChild:l,positionalParamSegments:u}=Bc(e,r,i);if(!s)return Ic(e);const c=this.applyRedirectCommands(a,r.redirectTo,u);return r.redirectTo.startsWith("/")?Nc(c):ua.call(this.lineralizeSegments(r,c),r=>this.expandSegment(t,e,n,r.concat(i.slice(l)),o,!1))}matchSegmentAgainstRoute(t,e,n,r){if("**"===n.path)return n.loadChildren?la.call(this.configLoader.load(t.injector,n),t=>(n._loadedConfig=t,new fc(r,{}))):ia(new fc(r,{}));const{matched:i,consumedSegments:o,lastChild:s}=Bc(e,n,r);if(!i)return Ic(e);const a=r.slice(s),l=this.getChildConfig(t,n);return ua.call(l,t=>{const n=t.module,r=t.routes,{segmentGroup:i,slicedSegments:s}=function(t,e,n,r){return n.length>0&&function(t,e,n){return r.some(n=>zc(t,e,n)&&Fc(n)!==Qu)}(t,n)?{segmentGroup:Uc(new fc(e,function(t,e){const n={};n[Qu]=e;for(const r of t)""===r.path&&Fc(r)!==Qu&&(n[Fc(r)]=new fc([],{}));return n}(r,new fc(n,t.children)))),slicedSegments:[]}:0===n.length&&function(t,e,n){return r.some(n=>zc(t,e,n))}(t,n)?{segmentGroup:Uc(new fc(t.segments,function(t,e,n,r){const i={};for(const o of n)zc(t,e,o)&&!r[Fc(o)]&&(i[Fc(o)]=new fc([],{}));return Object.assign({},r,i)}(t,n,r,t.children))),slicedSegments:n}:{segmentGroup:t,slicedSegments:n}}(e,o,a,r);if(0===s.length&&i.hasChildren()){const t=this.expandChildren(n,r,i);return la.call(t,t=>new fc(o,t))}if(0===r.length&&0===s.length)return ia(new fc(o,{}));const l=this.expandSegment(n,i,r,s,Qu,!0);return la.call(l,t=>new fc(o.concat(t.segments),t.children))})}getChildConfig(t,e){return e.children?ia(new nc(e.children,t)):e.loadChildren?void 0!==e._loadedConfig?ia(e._loadedConfig):ua.call(function(t,e){const n=e.canLoad;return n&&0!==n.length?cc(la.call(_a(n),n=>{const r=t.get(n);return hc(r.canLoad?r.canLoad(e):r(e))})):ia(!0)}(t.injector,e),n=>n?la.call(this.configLoader.load(t.injector,e),t=>(e._loadedConfig=t,t)):function(t){return new T(e=>e.error(function(t){const e=Error("NavigationCancelingError: "+t);return e[tc]=!0,e}(`Cannot load children because the guard of the route "path: '${t.path}'" returned false`)))}(e)):ia(new nc([],t))}lineralizeSegments(t,e){let n=[],r=e.root;for(;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return ia(n);if(r.numberOfChildren>1||!r.children[Qu])return Oc(t.redirectTo);r=r.children[Qu]}}applyRedirectCommands(t,e,n){return this.applyRedirectCreatreUrlTree(e,this.urlSerializer.parse(e),t,n)}applyRedirectCreatreUrlTree(t,e,n,r){const i=this.createSegmentGroup(t,e.root,n,r);return new pc(i,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const n={};return uc(t,(t,r)=>{if("string"==typeof t&&t.startsWith(":")){const i=t.substring(1);n[r]=e[i]}else n[r]=t}),n}createSegmentGroup(t,e,n,r){const i=this.createSegments(t,e.segments,n,r);let o={};return uc(e.children,(e,i)=>{o[i]=this.createSegmentGroup(t,e,n,r)}),new fc(i,o)}createSegments(t,e,n,r){return e.map(e=>e.path.startsWith(":")?this.findPosParam(t,e,r):this.findOrReturn(e,n))}findPosParam(t,e,n){const r=n[e.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${t}'. Cannot find '${e.path}'.`);return r}findOrReturn(t,e){let n=0;for(const r of e){if(r.path===t.path)return e.splice(n),r;n++}return t}}function Bc(t,e,n){if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}:{matched:!0,consumedSegments:[],lastChild:0,positionalParamSegments:{}};const r=(e.matcher||ec)(n,t,e);return r?{matched:!0,consumedSegments:r.consumed,lastChild:r.consumed.length,positionalParamSegments:r.posParams}:{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}}function Uc(t){if(1===t.numberOfChildren&&t.children[Qu]){const e=t.children[Qu];return new fc(t.segments.concat(e.segments),e.children)}return t}function zc(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0!==n.redirectTo}function Fc(t){return t.outlet||Qu}class kc{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=Vc(t,this._root);return e?e.children.map(t=>t.value):[]}firstChild(t){const e=Vc(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=Gc(t,this._root);return e.length<2?[]:e[e.length-2].children.map(t=>t.value).filter(e=>e!==t)}pathFromRoot(t){return Gc(t,this._root).map(t=>t.value)}}function Vc(t,e){if(t===e.value)return e;for(const n of e.children){const e=Vc(t,n);if(e)return e}return null}function Gc(t,e){if(t===e.value)return[e];for(const n of e.children){const r=Gc(t,n);if(r.length)return r.unshift(e),r}return[]}class jc{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function Hc(t){const e={};return t&&t.children.forEach(t=>e[t.value.outlet]=t),e}class Wc extends kc{constructor(t,e){super(t),this.snapshot=e,Qc(this,t)}toString(){return this.snapshot.toString()}}function qc(t,e){const n=function(t,e){const n=new Zc([],{},{},"",{},Qu,e,null,t.root,-1,{});return new $c("",new jc(n,[]))}(t,e),r=new ra([new mc("",{})]),i=new ra({}),o=new ra({}),s=new ra({}),a=new ra(""),l=new Xc(r,i,s,a,o,Qu,e,n.root);return l.snapshot=n.root,new Wc(new jc(l,[]),n)}class Xc{constructor(t,e,n,r,i,o,s,a){this.url=t,this.params=e,this.queryParams=n,this.fragment=r,this.data=i,this.outlet=o,this.component=s,this._futureSnapshot=a}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=la.call(this.params,t=>Ku(t))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=la.call(this.queryParams,t=>Ku(t))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Yc(t,e="emptyOnly"){const n=t.pathFromRoot;let r=0;if("always"!==e)for(r=n.length-1;r>=1;){const t=n[r],e=n[r-1];if(t.routeConfig&&""===t.routeConfig.path)r--;else{if(e.component)break;r--}}return function(t){return t.reduce((t,e)=>({params:Object.assign({},t.params,e.params),data:Object.assign({},t.data,e.data),resolve:Object.assign({},t.resolve,e._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(r))}class Zc{constructor(t,e,n,r,i,o,s,a,l,u,c){this.url=t,this.params=e,this.queryParams=n,this.fragment=r,this.data=i,this.outlet=o,this.component=s,this.routeConfig=a,this._urlSegment=l,this._lastPathIndex=u,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Ku(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Ku(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(t=>t.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class $c extends kc{constructor(t,e){super(e),this.url=t,Qc(this,e)}toString(){return Jc(this._root)}}function Qc(t,e){e.value._routerState=t,e.children.forEach(e=>Qc(t,e))}function Jc(t){const e=t.children.length>0?` { ${t.children.map(Jc).join(", ")} } `:"";return`${t.value}${e}`}function Kc(t){if(t.snapshot){const e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,sc(e.queryParams,n.queryParams)||t.queryParams.next(n.queryParams),e.fragment!==n.fragment&&t.fragment.next(n.fragment),sc(e.params,n.params)||t.params.next(n.params),function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!sc(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.url.next(n.url),sc(e.data,n.data)||t.data.next(n.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function th(t,e){return sc(t.params,e.params)&&function(t,e){return gc(t,e)&&t.every((t,n)=>sc(t.parameters,e[n].parameters))}(t.url,e.url)&&!(!t.parent!=!e.parent)&&(!t.parent||th(t.parent,e.parent))}function eh(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function nh(t,e,n,r,i){let o={};return r&&uc(r,(t,e)=>{o[e]=Array.isArray(t)?t.map(t=>`${t}`):`${t}`}),new pc(n.root===t?e:function t(e,n,r){const i={};return uc(e.children,(e,o)=>{i[o]=e===n?r:t(e,n,r)}),new fc(e.segments,i)}(n.root,t,e),o,i)}class rh{constructor(t,e,n){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=n,t&&n.length>0&&eh(n[0]))throw new Error("Root segment cannot have matrix parameters");const r=n.find(t=>"object"==typeof t&&null!=t&&t.outlets);if(r&&r!==lc(n))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class ih{constructor(t,e,n){this.segmentGroup=t,this.processChildren=e,this.index=n}}function oh(t){return"object"==typeof t&&null!=t&&t.outlets?t.outlets[Qu]:`${t}`}function sh(t,e,n){if(t||(t=new fc([],{})),0===t.segments.length&&t.hasChildren())return ah(t,e,n);const r=function(t,e,n){let r=0,i=e;const o={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return o;const e=t.segments[i],s=oh(n[r]),a=r<n.length-1?n[r+1]:null;if(i>0&&void 0===s)break;if(s&&a&&"object"==typeof a&&void 0===a.outlets){if(!hh(s,a,e))return o;r+=2}else{if(!hh(s,{},e))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){const e=new fc(t.segments.slice(0,r.pathIndex),{});return e.children[Qu]=new fc(t.segments.slice(r.pathIndex),t.children),ah(e,0,i)}return r.match&&0===i.length?new fc(t.segments,{}):r.match&&!t.hasChildren()?lh(t,e,n):r.match?ah(t,0,i):lh(t,e,n)}function ah(t,e,n){if(0===n.length)return new fc(t.segments,{});{const r=function(t){return"object"!=typeof t[0]?{[Qu]:t}:void 0===t[0].outlets?{[Qu]:t}:t[0].outlets}(n),i={};return uc(r,(n,r)=>{null!==n&&(i[r]=sh(t.children[r],e,n))}),uc(t.children,(t,e)=>{void 0===r[e]&&(i[e]=t)}),new fc(t.segments,i)}}function lh(t,e,n){const r=t.segments.slice(0,e);let i=0;for(;i<n.length;){if("object"==typeof n[i]&&void 0!==n[i].outlets){const t=uh(n[i].outlets);return new fc(r,t)}if(0===i&&eh(n[0])){r.push(new mc(t.segments[e].path,n[0])),i++;continue}const o=oh(n[i]),s=i<n.length-1?n[i+1]:null;o&&s&&eh(s)?(r.push(new mc(o,ch(s))),i+=2):(r.push(new mc(o,{})),i++)}return new fc(r,{})}function uh(t){const e={};return uc(t,(t,n)=>{null!==t&&(e[n]=lh(new fc([],{}),0,t))}),e}function ch(t){const e={};return uc(t,(t,n)=>e[n]=`${t}`),e}function hh(t,e,n){return t==n.path&&sc(e,n.parameters)}class dh{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class ph{constructor(t,e){this.component=t,this.route=e}}class fh{constructor(t,e,n,r){this.future=t,this.curr=e,this.moduleInjector=n,this.forwardEvent=r,this.canActivateChecks=[],this.canDeactivateChecks=[]}initialize(t){const e=this.future._root;this.setupChildRouteGuards(e,this.curr?this.curr._root:null,t,[e.value])}checkGuards(){if(!this.isDeactivating()&&!this.isActivating())return ia(!0);const t=this.runCanDeactivateChecks();return ua.call(t,t=>t?this.runCanActivateChecks():ia(!1))}resolveData(t){if(!this.isActivating())return ia(null);const e=_a(this.canActivateChecks),n=oa.call(e,e=>this.runResolve(e.route,t));return(function(t,e){return arguments.length>=2?Ya(t,e)(this):Ya(t)(this)}).call(n,(t,e)=>t)}isDeactivating(){return 0!==this.canDeactivateChecks.length}isActivating(){return 0!==this.canActivateChecks.length}setupChildRouteGuards(t,e,n,r){const i=Hc(e);t.children.forEach(t=>{this.setupRouteGuards(t,i[t.value.outlet],n,r.concat([t.value])),delete i[t.value.outlet]}),uc(i,(t,e)=>this.deactivateRouteAndItsChildren(t,n.getContext(e)))}setupRouteGuards(t,e,n,r){const i=t.value,o=e?e.value:null,s=n?n.getContext(t.value.outlet):null;if(o&&i.routeConfig===o.routeConfig){const a=this.shouldRunGuardsAndResolvers(o,i,i.routeConfig.runGuardsAndResolvers);a?this.canActivateChecks.push(new dh(r)):(i.data=o.data,i._resolvedData=o._resolvedData),this.setupChildRouteGuards(t,e,i.component?s?s.children:null:n,r),a&&this.canDeactivateChecks.push(new ph(s.outlet.component,o))}else o&&this.deactivateRouteAndItsChildren(e,s),this.canActivateChecks.push(new dh(r)),this.setupChildRouteGuards(t,null,i.component?s?s.children:null:n,r)}shouldRunGuardsAndResolvers(t,e,n){switch(n){case"always":return!0;case"paramsOrQueryParamsChange":return!th(t,e)||!sc(t.queryParams,e.queryParams);case"paramsChange":default:return!th(t,e)}}deactivateRouteAndItsChildren(t,e){const n=Hc(t),r=t.value;uc(n,(t,n)=>{this.deactivateRouteAndItsChildren(t,r.component?e?e.children.getContext(n):null:e)}),this.canDeactivateChecks.push(new ph(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}runCanDeactivateChecks(){const t=_a(this.canDeactivateChecks),e=ua.call(t,t=>this.runCanDeactivate(t.component,t.route));return Oa.call(e,t=>!0===t)}runCanActivateChecks(){const t=_a(this.canActivateChecks),e=oa.call(t,t=>cc(_a([this.fireChildActivationStart(t.route.parent),this.fireActivationStart(t.route),this.runCanActivateChild(t.path),this.runCanActivate(t.route)])));return Oa.call(e,t=>!0===t)}fireActivationStart(t){return null!==t&&this.forwardEvent&&this.forwardEvent(new Zu(t)),ia(!0)}fireChildActivationStart(t){return null!==t&&this.forwardEvent&&this.forwardEvent(new Xu(t)),ia(!0)}runCanActivate(t){const e=t.routeConfig?t.routeConfig.canActivate:null;return e&&0!==e.length?cc(la.call(_a(e),e=>{const n=this.getToken(e,t);let r;return r=hc(n.canActivate?n.canActivate(t,this.future):n(t,this.future)),Pa.call(r)})):ia(!0)}runCanActivateChild(t){const e=t[t.length-1],n=t.slice(0,t.length-1).reverse().map(t=>this.extractCanActivateChild(t)).filter(t=>null!==t);return cc(la.call(_a(n),t=>cc(la.call(_a(t.guards),n=>{const r=this.getToken(n,t.node);let i;return i=hc(r.canActivateChild?r.canActivateChild(e,this.future):r(e,this.future)),Pa.call(i)}))))}extractCanActivateChild(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}runCanDeactivate(t,e){const n=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!n||0===n.length)return ia(!0);const r=ua.call(_a(n),n=>{const r=this.getToken(n,e);let i;return i=hc(r.canDeactivate?r.canDeactivate(t,e,this.curr,this.future):r(t,e,this.curr,this.future)),Pa.call(i)});return Oa.call(r,t=>!0===t)}runResolve(t,e){return la.call(this.resolveNode(t._resolve,t),n=>(t._resolvedData=n,t.data=Object.assign({},t.data,Yc(t,e).resolve),null))}resolveNode(t,e){const n=Object.keys(t);if(0===n.length)return ia({});if(1===n.length){const r=n[0];return la.call(this.getResolver(t[r],e),t=>({[r]:t}))}const r={},i=ua.call(_a(n),n=>la.call(this.getResolver(t[n],e),t=>(r[n]=t,t)));return la.call(Ua.call(i),()=>r)}getResolver(t,e){const n=this.getToken(t,e);return hc(n.resolve?n.resolve(e,this.future):n(e,this.future))}getToken(t,e){const n=function(t){if(!t)return null;for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(n?n.module.injector:this.moduleInjector).get(t)}}class mh{}class gh{constructor(t,e,n,r,i){this.rootComponentType=t,this.config=e,this.urlTree=n,this.url=r,this.paramsInheritanceStrategy=i}recognize(){try{const t=wh(this.urlTree.root,[],[],this.config).segmentGroup,e=this.processSegmentGroup(this.config,t,Qu),n=new Zc([],Object.freeze({}),Object.freeze(this.urlTree.queryParams),this.urlTree.fragment,{},Qu,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new jc(n,e),i=new $c(this.url,r);return this.inheritParamsAndData(i._root),ia(i)}catch(t){return new T(e=>e.error(t))}}inheritParamsAndData(t){const e=t.value,n=Yc(e,this.paramsInheritanceStrategy);e.params=Object.freeze(n.params),e.data=Object.freeze(n.data),t.children.forEach(t=>this.inheritParamsAndData(t))}processSegmentGroup(t,e,n){return 0===e.segments.length&&e.hasChildren()?this.processChildren(t,e):this.processSegment(t,e,e.segments,n)}processChildren(t,e){const n=vc(e,(e,n)=>this.processSegmentGroup(t,e,n));return function(t){const e={};n.forEach(t=>{const n=e[t.value.outlet];if(n){const e=n.url.map(t=>t.toString()).join("/"),r=t.value.url.map(t=>t.toString()).join("/");throw new Error(`Two segments cannot have the same outlet name: '${e}' and '${r}'.`)}e[t.value.outlet]=t.value})}(),n.sort((t,e)=>t.value.outlet===Qu?-1:e.value.outlet===Qu?1:t.value.outlet.localeCompare(e.value.outlet)),n}processSegment(t,e,n,r){for(const i of t)try{return this.processSegmentAgainstRoute(i,e,n,r)}catch(t){if(!(t instanceof mh))throw t}if(this.noLeftoversInUrl(e,n,r))return[];throw new mh}noLeftoversInUrl(t,e,n){return 0===e.length&&!t.children[n]}processSegmentAgainstRoute(t,e,n,r){if(t.redirectTo)throw new mh;if((t.outlet||Qu)!==r)throw new mh;let i,o=[],s=[];if("**"===t.path){const o=n.length>0?lc(n).parameters:{};i=new Zc(n,o,Object.freeze(this.urlTree.queryParams),this.urlTree.fragment,_h(t),r,t.component,t,vh(e),yh(e)+n.length,Eh(t))}else{const a=function(t,e,n){if(""===e.path){if("full"===e.pathMatch&&(t.hasChildren()||n.length>0))throw new mh;return{consumedSegments:[],lastChild:0,parameters:{}}}const r=(e.matcher||ec)(n,t,e);if(!r)throw new mh;const i={};uc(r.posParams,(t,e)=>{i[e]=t.path});const o=r.consumed.length>0?Object.assign({},i,r.consumed[r.consumed.length-1].parameters):i;return{consumedSegments:r.consumed,lastChild:r.consumed.length,parameters:o}}(e,t,n);o=a.consumedSegments,s=n.slice(a.lastChild),i=new Zc(o,a.parameters,Object.freeze(this.urlTree.queryParams),this.urlTree.fragment,_h(t),r,t.component,t,vh(e),yh(e)+o.length,Eh(t))}const a=function(t){return t.children?t.children:t.loadChildren?t._loadedConfig.routes:[]}(t),{segmentGroup:l,slicedSegments:u}=wh(e,o,s,a);if(0===u.length&&l.hasChildren()){const t=this.processChildren(a,l);return[new jc(i,t)]}if(0===a.length&&0===u.length)return[new jc(i,[])];const c=this.processSegment(a,l,u,Qu);return[new jc(i,c)]}}function vh(t){let e=t;for(;e._sourceSegment;)e=e._sourceSegment;return e}function yh(t){let e=t,n=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)n+=(e=e._sourceSegment)._segmentIndexShift?e._segmentIndexShift:0;return n-1}function wh(t,e,n,r){if(n.length>0&&function(t,e,n){return r.some(n=>bh(t,e,n)&&xh(n)!==Qu)}(t,n)){const i=new fc(e,function(t,e,n,r){const i={};i[Qu]=r,r._sourceSegment=t,r._segmentIndexShift=e.length;for(const o of n)if(""===o.path&&xh(o)!==Qu){const n=new fc([],{});n._sourceSegment=t,n._segmentIndexShift=e.length,i[xh(o)]=n}return i}(t,e,r,new fc(n,t.children)));return i._sourceSegment=t,i._segmentIndexShift=e.length,{segmentGroup:i,slicedSegments:[]}}if(0===n.length&&function(t,e,n){return r.some(n=>bh(t,e,n))}(t,n)){const i=new fc(t.segments,function(t,e,n,r){const i={};for(const o of n)if(bh(t,e,o)&&!r[xh(o)]){const e=new fc([],{});e._sourceSegment=t,e._segmentIndexShift=t.segments.length,i[xh(o)]=e}return Object.assign({},r,i)}(t,n,r,t.children));return i._sourceSegment=t,i._segmentIndexShift=e.length,{segmentGroup:i,slicedSegments:n}}const i=new fc(t.segments,t.children);return i._sourceSegment=t,i._segmentIndexShift=e.length,{segmentGroup:i,slicedSegments:n}}function bh(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0===n.redirectTo}function xh(t){return t.outlet||Qu}function _h(t){return t.data||{}}function Eh(t){return t.resolve||{}}class Sh{}class Mh{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}const Th=new K("ROUTES");class Ch{constructor(t,e,n,r){this.loader=t,this.compiler=e,this.onLoadStartListener=n,this.onLoadEndListener=r}load(t,e){this.onLoadStartListener&&this.onLoadStartListener(e);const n=this.loadModuleFactory(e.loadChildren);return la.call(n,n=>{this.onLoadEndListener&&this.onLoadEndListener(e);const r=n.create(t);return new nc(ac(r.injector.get(Th)),r)})}loadModuleFactory(t){return"string"==typeof t?La(this.loader.load(t)):ua.call(hc(t()),t=>t instanceof qe?ia(t):La(this.compiler.compileModuleAsync(t)))}}class Ah{}class Rh{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function Ph(t){throw t}function Lh(t){return ia(null)}class Ih{constructor(t,e,n,r,i,o,s,a){this.rootComponentType=t,this.urlSerializer=e,this.rootContexts=n,this.location=r,this.config=a,this.navigations=new ra(null),this.navigationId=0,this.events=new W,this.errorHandler=Ph,this.navigated=!1,this.hooks={beforePreactivation:Lh,afterPreactivation:Lh},this.urlHandlingStrategy=new Rh,this.routeReuseStrategy=new Mh,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.ngModule=i.get(We),this.resetConfig(a),this.currentUrlTree=new pc(new fc([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.configLoader=new Ch(o,s,t=>this.triggerEvent(new Wu(t)),t=>this.triggerEvent(new qu(t))),this.routerState=qc(this.currentUrlTree,this.rootComponentType),this.processNavigations()}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(Zone.current.wrap(t=>{const e=this.urlSerializer.parse(t.url),n="popstate"===t.type?"popstate":"hashchange";setTimeout(()=>{this.scheduleNavigation(e,n,{replaceUrl:!0})},0)})))}get url(){return this.serializeUrl(this.currentUrlTree)}triggerEvent(t){this.events.next(t)}resetConfig(t){rc(t),this.config=t,this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=null)}createUrlTree(t,e={}){const{relativeTo:n,queryParams:r,fragment:i,preserveQueryParams:o,queryParamsHandling:s,preserveFragment:a}=e;fn()&&o&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead.");const l=n||this.routerState.root,u=a?this.currentUrlTree.fragment:i;let c=null;if(s)switch(s){case"merge":c=Object.assign({},this.currentUrlTree.queryParams,r);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=r||null}else c=o?this.currentUrlTree.queryParams:r||null;return null!==c&&(c=this.removeEmptyProps(c)),function(t,e,n,r,i){if(0===n.length)return nh(e.root,e.root,e,r,i);const o=function(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new rh(!0,0,t);let e=0,n=!1;const r=t.reduce((t,r,i)=>{if("object"==typeof r&&null!=r){if(r.outlets){const e={};return uc(r.outlets,(t,n)=>{e[n]="string"==typeof t?t.split("/"):t}),[...t,{outlets:e}]}if(r.segmentPath)return[...t,r.segmentPath]}return"string"!=typeof r?[...t,r]:0===i?(r.split("/").forEach((r,i)=>{0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?e++:""!=r&&t.push(r))}),t):[...t,r]},[]);return new rh(n,e,r)}(n);if(o.toRoot())return nh(e.root,new fc([],{}),e,r,i);const s=function(t,n,r){if(t.isAbsolute)return new ih(e.root,!0,0);if(-1===r.snapshot._lastPathIndex)return new ih(r.snapshot._urlSegment,!0,0);const i=eh(t.commands[0])?0:1;return function(e,n,o){let s=r.snapshot._urlSegment,a=r.snapshot._lastPathIndex+i,l=t.numberOfDoubleDots;for(;l>a;){if(l-=a,!(s=s.parent))throw new Error("Invalid number of '../'");a=s.segments.length}return new ih(s,!1,a-l)}()}(o,0,t),a=s.processChildren?ah(s.segmentGroup,s.index,o.commands):sh(s.segmentGroup,s.index,o.commands);return nh(s.segmentGroup,a,e,r,i)}(l,this.currentUrlTree,t,c,u)}navigateByUrl(t,e={skipLocationChange:!1}){const n=t instanceof pc?t:this.parseUrl(t),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",e)}navigate(t,e={skipLocationChange:!1}){return function(t){for(let e=0;e<t.length;e++){const n=t[e];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,e),e)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){return this.urlSerializer.parse(t)}isActive(t,e){if(t instanceof pc)return dc(this.currentUrlTree,t,e);const n=this.urlSerializer.parse(t);return dc(this.currentUrlTree,n,e)}removeEmptyProps(t){return Object.keys(t).reduce((e,n)=>{const r=t[n];return null!==r&&void 0!==r&&(e[n]=r),e},{})}processNavigations(){oa.call(this.navigations,t=>t?(this.executeScheduledNavigation(t),t.promise.catch(()=>{})):ia(null)).subscribe(()=>{})}scheduleNavigation(t,e,n){const r=this.navigations.value;if(r&&"imperative"!==e&&"imperative"===r.source&&r.rawUrl.toString()===t.toString())return Promise.resolve(!0);if(r&&"hashchange"==e&&"popstate"===r.source&&r.rawUrl.toString()===t.toString())return Promise.resolve(!0);if(r&&"popstate"==e&&"hashchange"===r.source&&r.rawUrl.toString()===t.toString())return Promise.resolve(!0);let i=null,o=null;const s=new Promise((t,e)=>{i=t,o=e}),a=++this.navigationId;return this.navigations.next({id:a,source:e,rawUrl:t,extras:n,resolve:i,reject:o,promise:s}),s.catch(t=>Promise.reject(t))}executeScheduledNavigation({id:t,rawUrl:e,extras:n,resolve:r,reject:i}){const o=this.urlHandlingStrategy.extract(e),s=!this.navigated||o.toString()!==this.currentUrlTree.toString();("reload"===this.onSameUrlNavigation||s)&&this.urlHandlingStrategy.shouldProcessUrl(e)?(this.events.next(new Bu(t,this.serializeUrl(o))),Promise.resolve().then(r=>this.runNavigate(o,e,!!n.skipLocationChange,!!n.replaceUrl,t,null)).then(r,i)):s&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)?(this.events.next(new Bu(t,this.serializeUrl(o))),Promise.resolve().then(n=>this.runNavigate(o,e,!1,!1,t,qc(o,this.rootComponentType).snapshot)).then(r,i)):(this.rawUrlTree=e,r(null))}runNavigate(t,e,n,r,i,o){return i!==this.navigationId?(this.events.next(new zu(i,this.serializeUrl(t),`Navigation ID ${i} is not equal to the current navigation id ${this.navigationId}`)),Promise.resolve(!1)):new Promise((s,a)=>{let l;if(o)l=ia({appliedUrl:t,snapshot:o});else{const e=function(e,n,r,i,o){return new Dc(e,n,r,t,o).apply()}(this.ngModule.injector,this.configLoader,this.urlSerializer,0,this.config);l=ua.call(e,e=>la.call(function(t,e,n,r,i="emptyOnly"){return new gh(t,e,n,r,i).recognize()}(this.rootComponentType,this.config,e,this.serializeUrl(e),this.paramsInheritanceStrategy),n=>(this.events.next(new ku(i,this.serializeUrl(t),this.serializeUrl(e),n)),{appliedUrl:e,snapshot:n})))}const u=ua.call(l,t=>la.call(this.hooks.beforePreactivation(t.snapshot),()=>t));let c;const h=la.call(u,({appliedUrl:t,snapshot:e})=>((c=new fh(e,this.routerState.snapshot,this.ngModule.injector,t=>this.triggerEvent(t))).initialize(this.rootContexts),{appliedUrl:t,snapshot:e})),d=ua.call(h,({appliedUrl:e,snapshot:n})=>this.navigationId!==i?ia(!1):(this.triggerEvent(new Vu(i,this.serializeUrl(t),e,n)),la.call(c.checkGuards(),r=>(this.triggerEvent(new Gu(i,this.serializeUrl(t),e,n,r)),{appliedUrl:e,snapshot:n,shouldActivate:r})))),p=ua.call(d,e=>this.navigationId!==i?ia(!1):e.shouldActivate&&c.isActivating()?(this.triggerEvent(new ju(i,this.serializeUrl(t),e.appliedUrl,e.snapshot)),la.call(c.resolveData(this.paramsInheritanceStrategy),()=>(this.triggerEvent(new Hu(i,this.serializeUrl(t),e.appliedUrl,e.snapshot)),e))):ia(e)),f=ua.call(p,t=>la.call(this.hooks.afterPreactivation(t.snapshot),()=>t)),m=la.call(f,({appliedUrl:t,snapshot:e,shouldActivate:n})=>n?{appliedUrl:t,state:function(t,e,n){const r=function t(e,n,r){if(r&&e.shouldReuseRoute(n.value,r.value.snapshot)){const i=r.value;i._futureSnapshot=n.value;const o=function(e,n,r){return n.children.map(n=>{for(const i of r.children)if(e.shouldReuseRoute(i.value.snapshot,n.value))return t(e,n,i);return t(e,n)})}(e,n,r);return new jc(i,o)}if(e.retrieve(n.value)){const t=e.retrieve(n.value).route;return function t(e,n){if(e.value.routeConfig!==n.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==n.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");n.value._futureSnapshot=e.value;for(let r=0;r<e.children.length;++r)t(e.children[r],n.children[r])}(n,t),t}{const r=function(t){return new Xc(new ra(t.url),new ra(t.params),new ra(t.queryParams),new ra(t.fragment),new ra(t.data),t.outlet,t.component,t)}(n.value),i=n.children.map(n=>t(e,n));return new jc(r,i)}}(t,e._root,n?n._root:void 0);return new Wc(r,e)}(this.routeReuseStrategy,e,this.routerState),shouldActivate:n}:{appliedUrl:t,state:null,shouldActivate:n});let g;const v=this.routerState,y=this.currentUrlTree;m.forEach(({appliedUrl:t,state:o,shouldActivate:s})=>{if(s&&i===this.navigationId){if(this.currentUrlTree=t,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e),this.routerState=o,!n){const t=this.urlSerializer.serialize(this.rawUrlTree);this.location.isCurrentPathEqualTo(t)||r?this.location.replaceState(t):this.location.go(t)}new Nh(this.routeReuseStrategy,o,v,t=>this.triggerEvent(t)).activate(this.rootContexts),g=!0}else g=!1}).then(()=>{g?(this.navigated=!0,this.events.next(new Uu(i,this.serializeUrl(t),this.serializeUrl(this.currentUrlTree))),s(!0)):(this.resetUrlToCurrentUrlTree(),this.events.next(new zu(i,this.serializeUrl(t),"")),s(!1))},n=>{if(n&&n[tc])this.navigated=!0,this.resetStateAndUrl(v,y,e),this.events.next(new zu(i,this.serializeUrl(t),n.message)),s(!1);else{this.resetStateAndUrl(v,y,e),this.events.next(new Fu(i,this.serializeUrl(t),n));try{s(this.errorHandler(n))}catch(t){a(t)}}})})}resetStateAndUrl(t,e,n){this.routerState=t,this.currentUrlTree=e,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n),this.resetUrlToCurrentUrlTree()}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree))}}class Nh{constructor(t,e,n,r){this.routeReuseStrategy=t,this.futureState=e,this.currState=n,this.forwardEvent=r}activate(t){const e=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,n,t),Kc(this.futureState.root),this.activateChildRoutes(e,n,t)}deactivateChildRoutes(t,e,n){const r=Hc(e);t.children.forEach(t=>{const e=t.value.outlet;this.deactivateRoutes(t,r[e],n),delete r[e]}),uc(r,(t,e)=>{this.deactivateRouteAndItsChildren(t,n)})}deactivateRoutes(t,e,n){const r=t.value,i=e?e.value:null;if(r===i)if(r.component){const i=n.getContext(r.outlet);i&&this.deactivateChildRoutes(t,e,i.children)}else this.deactivateChildRoutes(t,e,n);else i&&this.deactivateRouteAndItsChildren(e,n)}deactivateRouteAndItsChildren(t,e){this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const n=e.getContext(t.value.outlet);if(n&&n.outlet){const e=n.outlet.detach(),r=n.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:e,route:t,contexts:r})}}deactivateRouteAndOutlet(t,e){const n=e.getContext(t.value.outlet);if(n){const r=Hc(t),i=t.value.component?n.children:e;uc(r,(t,e)=>this.deactivateRouteAndItsChildren(t,i)),n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated())}}activateChildRoutes(t,e,n){const r=Hc(e);t.children.forEach(t=>{this.activateRoutes(t,r[t.value.outlet],n),this.forwardEvent(new $u(t.value.snapshot))}),t.children.length&&this.forwardEvent(new Yu(t.value.snapshot))}activateRoutes(t,e,n){const r=t.value,i=e?e.value:null;if(Kc(r),r===i)if(r.component){const i=n.getOrCreateContext(r.outlet);this.activateChildRoutes(t,e,i.children)}else this.activateChildRoutes(t,e,n);else if(r.component){const e=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const t=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),e.children.onOutletReAttached(t.contexts),e.attachRef=t.componentRef,e.route=t.route.value,e.outlet&&e.outlet.attach(t.componentRef,t.route.value),Oh(t.route)}else{const n=function(t){for(let e=r.snapshot.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(),i=n?n.module.componentFactoryResolver:null;e.route=r,e.resolver=i,e.outlet&&e.outlet.activateWith(r,i),this.activateChildRoutes(t,null,e.children)}}else this.activateChildRoutes(t,null,n)}}function Oh(t){Kc(t.value),t.children.forEach(Oh)}class Dh{constructor(t,e,n){this.router=t,this.route=e,this.locationStrategy=n,this.commands=[],this.subscription=t.events.subscribe(t=>{t instanceof Uu&&this.updateTargetUrlAndHref()})}set routerLink(t){this.commands=null!=t?Array.isArray(t)?t:[t]:[]}set preserveQueryParams(t){fn()&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead."),this.preserve=t}ngOnChanges(t){this.updateTargetUrlAndHref()}ngOnDestroy(){this.subscription.unsubscribe()}onClick(t,e,n,r){if(0!==t||e||n||r)return!0;if("string"==typeof this.target&&"_self"!=this.target)return!0;const i={skipLocationChange:Bh(this.skipLocationChange),replaceUrl:Bh(this.replaceUrl)};return this.router.navigateByUrl(this.urlTree,i),!1}updateTargetUrlAndHref(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,preserveQueryParams:Bh(this.preserve),queryParamsHandling:this.queryParamsHandling,preserveFragment:Bh(this.preserveFragment)})}}function Bh(t){return""===t||!!t}class Uh{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new zh,this.attachRef=null}}class zh{constructor(){this.contexts=new Map}onChildOutletCreated(t,e){const n=this.getOrCreateContext(t);n.outlet=e,this.contexts.set(t,n)}onChildOutletDestroyed(t){const e=this.getContext(t);e&&(e.outlet=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let e=this.getContext(t);return e||(e=new Uh,this.contexts.set(t,e)),e}getContext(t){return this.contexts.get(t)||null}}class Fh{constructor(t,e,n,r,i){this.parentContexts=t,this.location=e,this.resolver=n,this.changeDetector=i,this.activated=null,this._activatedRoute=null,this.activateEvents=new Je,this.deactivateEvents=new Je,this.name=r||Qu,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,t}attach(t,e){this.activated=t,this._activatedRoute=e,this.location.insert(t.hostView)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,e){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const n=(e=e||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new kh(t,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}class kh{constructor(t,e,n){this.route=t,this.childContexts=e,this.parent=n}get(t,e){return t===Xc?this.route:t===zh?this.childContexts:this.parent.get(t,e)}}class Vh{}class Gh{preload(t,e){return Ma.call(e(),()=>ia(null))}}class jh{preload(t,e){return ia(null)}}class Hh{constructor(t,e,n,r,i){this.router=t,this.injector=r,this.preloadingStrategy=i,this.loader=new Ch(e,n,e=>t.triggerEvent(new Wu(e)),e=>t.triggerEvent(new qu(e)))}setUpPreloading(){const t=(function(t,e){return function(t,e){return function(n){return n.lift(new Nu(t,e))}}(t,e)(this)}).call(this.router.events,t=>t instanceof Uu);this.subscription=oa.call(t,()=>this.preload()).subscribe(()=>{})}preload(){const t=this.injector.get(We);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription.unsubscribe()}processRoutes(t,e){const n=[];for(const r of e)if(r.loadChildren&&!r.canLoad&&r._loadedConfig){const t=r._loadedConfig;n.push(this.processRoutes(t.module,t.routes))}else r.loadChildren&&!r.canLoad?n.push(this.preloadConfig(t,r)):r.children&&n.push(this.processRoutes(t,r.children));return za.call(_a(n))}preloadConfig(t,e){return this.preloadingStrategy.preload(e,()=>{const n=this.loader.load(t.injector,e);return ua.call(n,t=>(e._loadedConfig=t,this.processRoutes(t.module,t.routes)))})}}const Wh=new K("ROUTER_CONFIGURATION"),qh=new K("ROUTER_FORROOT_GUARD"),Xh=[As,{provide:yc,useClass:wc},{provide:Ih,useFactory:Kh,deps:[bn,yc,zh,As,Lt,Tn,Be,Th,Wh,[Ah,new ft],[Sh,new ft]]},zh,{provide:Xc,useFactory:td,deps:[Ih]},{provide:Tn,useClass:In},Hh,jh,Gh,{provide:Wh,useValue:{enableTracing:!1}}];function Yh(){return new mn("Router",Ih)}class Zh{constructor(t,e){}static forRoot(t,e){return{ngModule:Zh,providers:[Xh,Jh(t),{provide:qh,useFactory:Qh,deps:[[Ih,new ft,new gt]]},{provide:Wh,useValue:e||{}},{provide:Ts,useFactory:$h,deps:[Ss,[new pt(Cs),new ft],Wh]},{provide:Vh,useExisting:e&&e.preloadingStrategy?e.preloadingStrategy:jh},{provide:mn,multi:!0,useFactory:Yh},[ed,{provide:Te,multi:!0,useFactory:nd,deps:[ed]},{provide:id,useFactory:rd,deps:[ed]},{provide:Ne,multi:!0,useExisting:id}]]}}static forChild(t){return{ngModule:Zh,providers:[Jh(t)]}}}function $h(t,e,n={}){return n.useHash?new Ps(t,e):new Ls(t,e)}function Qh(t){if(t)throw new Error("RouterModule.forRoot() called twice. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function Jh(t){return[{provide:at,multi:!0,useValue:t},{provide:Th,multi:!0,useValue:t}]}function Kh(t,e,n,r,i,o,s,a,l={},u,c){const h=new Ih(null,e,n,r,i,o,s,ac(a));if(u&&(h.urlHandlingStrategy=u),c&&(h.routeReuseStrategy=c),l.errorHandler&&(h.errorHandler=l.errorHandler),l.enableTracing){const t=$a();h.events.subscribe(e=>{t.logGroup(`Router Event: ${e.constructor.name}`),t.log(e.toString()),t.log(e),t.logGroupEnd()})}return l.onSameUrlNavigation&&(h.onSameUrlNavigation=l.onSameUrlNavigation),l.paramsInheritanceStrategy&&(h.paramsInheritanceStrategy=l.paramsInheritanceStrategy),h}function td(t){return t.routerState.root}class ed{constructor(t){this.injector=t,this.initNavigation=!1,this.resultOfPreactivationDone=new W}appInitializer(){return this.injector.get(Ms,Promise.resolve(null)).then(()=>{let t=null;const e=new Promise(e=>t=e),n=this.injector.get(Ih),r=this.injector.get(Wh);if(this.isLegacyDisabled(r)||this.isLegacyEnabled(r))t(!0);else if("disabled"===r.initialNavigation)n.setUpLocationChangeListener(),t(!0);else{if("enabled"!==r.initialNavigation)throw new Error(`Invalid initialNavigation options: '${r.initialNavigation}'`);n.hooks.afterPreactivation=(()=>this.initNavigation?ia(null):(this.initNavigation=!0,t(!0),this.resultOfPreactivationDone)),n.initialNavigation()}return e})}bootstrapListener(t){const e=this.injector.get(Wh),n=this.injector.get(Hh),r=this.injector.get(Ih),i=this.injector.get(bn);t===i.components[0]&&(this.isLegacyEnabled(e)?r.initialNavigation():this.isLegacyDisabled(e)&&r.setUpLocationChangeListener(),n.setUpPreloading(),r.resetRootComponentType(i.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}isLegacyEnabled(t){return"legacy_enabled"===t.initialNavigation||!0===t.initialNavigation||void 0===t.initialNavigation}isLegacyDisabled(t){return"legacy_disabled"===t.initialNavigation||!1===t.initialNavigation}}function nd(t){return t.appInitializer.bind(t)}function rd(t){return t.bootstrapListener.bind(t)}const id=new K("Router Initializer");new ht("5.2.0");class od{constructor(){this.imgURL_cube_threejs="assets/screens/thumb_cube_threejs.jpg",this.imgURL_css3d_threejs="assets/screens/thumb_css3d_threejs.jpg",this.imgURL_img_gallery_threejs="assets/screens/thumb_img_gallery_threejs.jpg"}ngOnInit(){}}var sd=Ar({encapsulation:0,styles:[[""]],data:{}});function ad(t){return fo(0,[(t()(),co(-1,null,["\n"])),(t()(),ni(1,0,null,null,89,"div",[["class","w3-container"]],null,null,null,null,null)),(t()(),co(-1,null,["\n  "])),(t()(),ni(3,0,null,null,20,"header",[],null,null,null,null,null)),(t()(),co(-1,null,["\n    "])),(t()(),ni(5,0,null,null,17,"div",[["class","w3-container "]],null,null,null,null,null)),(t()(),co(-1,null,["\n      "])),(t()(),ni(7,0,null,null,4,"h1",[],null,null,null,null,null)),(t()(),co(-1,null,["\n        "])),(t()(),ni(9,0,null,null,1,"b",[],null,null,null,null,null)),(t()(),co(-1,null,["3D showcase examples set up on Angular 5, Three.js"])),(t()(),co(-1,null,["\n      "])),(t()(),co(-1,null,["\n      Currently there is an example..."])),(t()(),ni(13,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,["\n      ... with images in CSS3D as gallery with options"])),(t()(),ni(15,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,["\n      ... with a terrain, CSS3D and physics"])),(t()(),ni(17,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,["\n      ... with rotating cubes"])),(t()(),ni(19,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,["\n      "])),(t()(),ni(21,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,["\n    "])),(t()(),co(-1,null,["\n\n  "])),(t()(),co(-1,null,["\n  "])),(t()(),ni(25,0,null,null,7,"div",[["class","w3-container"]],null,null,null,null,null)),(t()(),co(-1,null,["\n    "])),(t()(),ni(27,0,null,null,4,"p",[],null,null,null,null,null)),(t()(),co(-1,null,["\n      "])),(t()(),ni(29,0,null,null,1,"b",[],null,null,null,null,null)),(t()(),co(-1,null,["Note: This page is not responsive for mobile screens yet."])),(t()(),co(-1,null,["\n    "])),(t()(),co(-1,null,["\n  "])),(t()(),co(-1,null,["\n\n  "])),(t()(),co(-1,null,["\n  "])),(t()(),ni(35,0,null,null,21,"div",[["class","w3-row"]],null,null,null,null,null)),(t()(),co(-1,null,["\n    "])),(t()(),ni(37,0,null,null,4,"div",[["class","w3-col s3 w3-center"]],null,null,null,null,null)),(t()(),co(-1,null,["\n      "])),(t()(),ni(39,0,null,null,1,"p",[],null,null,null,null,null)),(t()(),co(-1,null,["Image Gallery - Three.js"])),(t()(),co(-1,null,["\n    "])),(t()(),co(-1,null,["\n    "])),(t()(),ni(43,0,null,null,4,"div",[["class","w3-col s3 w3-center"]],null,null,null,null,null)),(t()(),co(-1,null,["\n      "])),(t()(),ni(45,0,null,null,1,"p",[],null,null,null,null,null)),(t()(),co(-1,null,["CSS3D - Three.js"])),(t()(),co(-1,null,["\n    "])),(t()(),co(-1,null,["\n    "])),(t()(),ni(49,0,null,null,4,"div",[["class","w3-col s3 w3-center"]],null,null,null,null,null)),(t()(),co(-1,null,["\n      "])),(t()(),ni(51,0,null,null,1,"p",[],null,null,null,null,null)),(t()(),co(-1,null,["Cube - Three.js"])),(t()(),co(-1,null,["\n    "])),(t()(),co(-1,null,["\n    "])),(t()(),ni(55,0,null,null,0,"div",[["class","w3-col s3"]],null,null,null,null,null)),(t()(),co(-1,null,["\n  "])),(t()(),co(-1,null,["\n\n  "])),(t()(),co(-1,null,["\n  "])),(t()(),ni(59,0,null,null,30,"div",[["class","w3-row"]],null,null,null,null,null)),(t()(),co(-1,null,["\n    "])),(t()(),ni(61,0,null,null,7,"div",[["class","w3-col s3 w3-center"]],null,null,null,null,null)),(t()(),co(-1,null,["\n      "])),(t()(),ni(63,0,null,null,4,"a",[["routerLink","img-gallery"]],[[1,"target",0],[8,"href",4]],[[null,"click"]],function(t,e,n){var r=!0;return"click"===e&&(r=!1!==Pi(t,64).onClick(n.button,n.ctrlKey,n.metaKey,n.shiftKey)&&r),r},null,null)),Gi(64,671744,null,0,Dh,[Ih,Xc,Ts],{routerLink:[0,"routerLink"]},null),(t()(),co(-1,null,["\n        "])),(t()(),ni(66,0,null,null,0,"img",[["alt",""],["height","150"],["width","150"]],[[8,"src",4]],null,null,null,null)),(t()(),co(-1,null,["\n      "])),(t()(),co(-1,null,["\n    "])),(t()(),co(-1,null,["\n    "])),(t()(),ni(70,0,null,null,7,"div",[["class","w3-col s3 w3-center"]],null,null,null,null,null)),(t()(),co(-1,null,["\n      "])),(t()(),ni(72,0,null,null,4,"a",[["routerLink","css3d-threejs"]],[[1,"target",0],[8,"href",4]],[[null,"click"]],function(t,e,n){var r=!0;return"click"===e&&(r=!1!==Pi(t,73).onClick(n.button,n.ctrlKey,n.metaKey,n.shiftKey)&&r),r},null,null)),Gi(73,671744,null,0,Dh,[Ih,Xc,Ts],{routerLink:[0,"routerLink"]},null),(t()(),co(-1,null,["\n        "])),(t()(),ni(75,0,null,null,0,"img",[["alt",""],["height","150"],["width","150"]],[[8,"src",4]],null,null,null,null)),(t()(),co(-1,null,["\n      "])),(t()(),co(-1,null,["\n    "])),(t()(),co(-1,null,["\n    "])),(t()(),ni(79,0,null,null,7,"div",[["class","w3-col s3 w3-center"]],null,null,null,null,null)),(t()(),co(-1,null,["\n      "])),(t()(),ni(81,0,null,null,4,"a",[["routerLink","cube-threejs"]],[[1,"target",0],[8,"href",4]],[[null,"click"]],function(t,e,n){var r=!0;return"click"===e&&(r=!1!==Pi(t,82).onClick(n.button,n.ctrlKey,n.metaKey,n.shiftKey)&&r),r},null,null)),Gi(82,671744,null,0,Dh,[Ih,Xc,Ts],{routerLink:[0,"routerLink"]},null),(t()(),co(-1,null,["\n        "])),(t()(),ni(84,0,null,null,0,"img",[["alt",""],["height","150"],["width","150"]],[[8,"src",4]],null,null,null,null)),(t()(),co(-1,null,["\n      "])),(t()(),co(-1,null,["\n    "])),(t()(),co(-1,null,["\n    "])),(t()(),ni(88,0,null,null,0,"div",[["class","w3-col s6"]],null,null,null,null,null)),(t()(),co(-1,null,["\n  "])),(t()(),co(-1,null,["\n"]))],function(t,e){t(e,64,0,"img-gallery"),t(e,73,0,"css3d-threejs"),t(e,82,0,"cube-threejs")},function(t,e){var n=e.component;t(e,63,0,Pi(e,64).target,Pi(e,64).href),t(e,66,0,n.imgURL_img_gallery_threejs),t(e,72,0,Pi(e,73).target,Pi(e,73).href),t(e,75,0,n.imgURL_css3d_threejs),t(e,81,0,Pi(e,82).target,Pi(e,82).href),t(e,84,0,n.imgURL_cube_threejs)})}var ld=wi("app-home",od,function(t){return fo(0,[(t()(),ni(0,0,null,null,1,"app-home",[],null,null,null,ad,sd)),Gi(1,114688,null,0,od,[],null,null)],function(t,e){t(e,1,0)},null)},{},{},[]);class ud extends T{constructor(t,e){super(),this.sources=t,this.resultSelector=e}static create(...t){if(null===t||0===arguments.length)return new A;let e=null;return"function"==typeof t[t.length-1]&&(e=t.pop()),1===t.length&&l(t[0])&&(t=t[0]),0===t.length?new A:new ud(t,e)}_subscribe(t){return new cd(t,this.sources,this.resultSelector)}}class cd extends B{constructor(t,e,n){super(t),this.sources=e,this.resultSelector=n,this.completed=0,this.haveValues=0;const r=e.length;this.total=r,this.values=new Array(r);for(let i=0;i<r;i++){const t=D(this,e[i],null,i);t&&(t.outerIndex=i,this.add(t))}}notifyNext(t,e,n,r,i){this.values[n]=e,i._hasValue||(i._hasValue=!0,this.haveValues++)}notifyComplete(t){const e=this.destination,{haveValues:n,resultSelector:r,values:i}=this,o=i.length;if(t._hasValue){if(this.completed++,this.completed===o){if(n===o){const t=r?r.apply(this,i):i;e.next(t)}e.complete()}}else e.complete()}}const hd=ud.create;class dd{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class pd extends dd{get formDirective(){return null}get path(){return null}}function fd(t){return null==t||0===t.length}new K("NgValidators"),new K("NgAsyncValidators");const md=/^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+(\.[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(\.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)*$/;class gd{static min(t){return e=>{if(fd(e.value)||fd(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null}}static max(t){return e=>{if(fd(e.value)||fd(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null}}static required(t){return fd(t.value)?{required:!0}:null}static requiredTrue(t){return!0===t.value?null:{required:!0}}static email(t){return md.test(t.value)?null:{email:!0}}static minLength(t){return e=>{if(fd(e.value))return null;const n=e.value?e.value.length:0;return n<t?{minlength:{requiredLength:t,actualLength:n}}:null}}static maxLength(t){return e=>{const n=e.value?e.value.length:0;return n>t?{maxlength:{requiredLength:t,actualLength:n}}:null}}static pattern(t){if(!t)return gd.nullValidator;let e,n;return"string"==typeof t?(n=`^${t}$`,e=new RegExp(n)):(n=t.toString(),e=t),t=>{if(fd(t.value))return null;const r=t.value;return e.test(r)?null:{pattern:{requiredPattern:n,actualValue:r}}}}static nullValidator(t){return null}static compose(t){if(!t)return null;const e=t.filter(vd);return 0==e.length?null:function(t){return wd(function(t,n){return e.map(e=>e(t))}(t))}}static composeAsync(t){if(!t)return null;const e=t.filter(vd);return 0==e.length?null:function(t){const n=function(t,n){return e.map(e=>e(t))}(t).map(yd);return la.call(hd(n),wd)}}}function vd(t){return null!=t}function yd(t){const e=Se(t)?La(t):t;if(!Me(e))throw new Error("Expected validator to return Promise or Observable.");return e}function wd(t){const e=t.reduce((t,e)=>null!=e?Object.assign({},t,e):t,{});return 0===Object.keys(e).length?null:e}const bd=new K("NgValueAccessor");Tt(()=>xd);class xd{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=(t=>{}),this.onTouched=(()=>{})}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"checked",t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}Tt(()=>Ed);const _d=new K("CompositionEventMode");class Ed{constructor(t,e,n){this._renderer=t,this._elementRef=e,this._compositionMode=n,this.onChange=(t=>{}),this.onTouched=(()=>{}),this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const t=$a()?$a().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}function Sd(t){return t.validate?e=>t.validate(e):t}function Md(t){return t.validate?e=>t.validate(e):t}Tt(()=>Td);class Td{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=(t=>{}),this.onTouched=(()=>{})}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)}registerOnChange(t){this.onChange=(e=>{t(""==e?null:parseFloat(e))})}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}function Cd(){throw new Error("unimplemented")}class Ad extends dd{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null,this._rawValidators=[],this._rawAsyncValidators=[]}get validator(){return Cd()}get asyncValidator(){return Cd()}}Tt(()=>Pd);class Rd{constructor(){this._accessors=[]}add(t,e){this._accessors.push([t,e])}remove(t){for(let e=this._accessors.length-1;e>=0;--e)if(this._accessors[e][1]===t)return void this._accessors.splice(e,1)}select(t){this._accessors.forEach(e=>{this._isSameGroup(e,t)&&e[1]!==t&&e[1].fireUncheck(t.value)})}_isSameGroup(t,e){return!!t[0].control&&t[0]._parent===e._control._parent&&t[1].name===e.name}}class Pd{constructor(t,e,n,r){this._renderer=t,this._elementRef=e,this._registry=n,this._injector=r,this.onChange=(()=>{}),this.onTouched=(()=>{})}ngOnInit(){this._control=this._injector.get(Ad),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(t){this._state=t===this.value,this._renderer.setProperty(this._elementRef.nativeElement,"checked",this._state)}registerOnChange(t){this._fn=t,this.onChange=(()=>{t(this.value),this._registry.select(this)})}fireUncheck(t){this.writeValue(t)}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_checkName(){this.name&&this.formControlName&&this.name!==this.formControlName&&this._throwNameError(),!this.name&&this.formControlName&&(this.name=this.formControlName)}_throwNameError(){throw new Error('\n      If you define both a name and a formControlName attribute on your radio button, their values\n      must match. Ex: <input type="radio" formControlName="food" name="food">\n    ')}}Tt(()=>Ld);class Ld{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=(t=>{}),this.onTouched=(()=>{})}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",parseFloat(t))}registerOnChange(t){this.onChange=(e=>{t(""==e?null:parseFloat(e))})}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}Tt(()=>Id);class Id{constructor(t,e){this._renderer=t,this._elementRef=e,this._optionMap=new Map,this._idCounter=0,this.onChange=(t=>{}),this.onTouched=(()=>{}),this._compareWith=St}set compareWith(t){if("function"!=typeof t)throw new Error(`compareWith must be a function, but received ${JSON.stringify(t)}`);this._compareWith=t}writeValue(t){this.value=t;const e=this._getOptionId(t);null==e&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);const n=function(t,e){return null==t?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${t}: ${e}`.slice(0,50))}(e,t);this._renderer.setProperty(this._elementRef.nativeElement,"value",n)}registerOnChange(t){this.onChange=(e=>{this.value=this._getOptionValue(e),t(this.value)})}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const e of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(e),t))return e;return null}_getOptionValue(t){const e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e):t}}Tt(()=>Nd);class Nd{constructor(t,e){this._renderer=t,this._elementRef=e,this._optionMap=new Map,this._idCounter=0,this.onChange=(t=>{}),this.onTouched=(()=>{}),this._compareWith=St}set compareWith(t){if("function"!=typeof t)throw new Error(`compareWith must be a function, but received ${JSON.stringify(t)}`);this._compareWith=t}writeValue(t){let e;if(this.value=t,Array.isArray(t)){const n=t.map(t=>this._getOptionId(t));e=((t,e)=>{t._setSelected(n.indexOf(e.toString())>-1)})}else e=((t,e)=>{t._setSelected(!1)});this._optionMap.forEach(e)}registerOnChange(t){this.onChange=(e=>{const n=[];if(e.hasOwnProperty("selectedOptions")){const t=e.selectedOptions;for(let e=0;e<t.length;e++){const r=t.item(e),i=this._getOptionValue(r.value);n.push(i)}}else{const t=e.options;for(let e=0;e<t.length;e++){const r=t.item(e);if(r.selected){const t=this._getOptionValue(r.value);n.push(t)}}}this.value=n,t(n)})}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_registerOption(t){const e=(this._idCounter++).toString();return this._optionMap.set(e,t),e}_getOptionId(t){for(const e of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(e)._value,t))return e;return null}_getOptionValue(t){const e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e)._value:t}}function Od(t,e){return[...e.path,t]}function Dd(t,e){t||Fd(e,"Cannot find control with"),e.valueAccessor||Fd(e,"No value accessor for form control with"),t.validator=gd.compose([t.validator,e.validator]),t.asyncValidator=gd.composeAsync([t.asyncValidator,e.asyncValidator]),e.valueAccessor.writeValue(t.value),function(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&Bd(t,e)})}(t,e),function(t,e){t.registerOnChange((t,n)=>{e.valueAccessor.writeValue(t),n&&e.viewToModelUpdate(t)})}(t,e),function(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&Bd(t,e),"submit"!==t.updateOn&&t.markAsTouched()})}(t,e),e.valueAccessor.setDisabledState&&t.registerOnDisabledChange(t=>{e.valueAccessor.setDisabledState(t)}),e._rawValidators.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(()=>t.updateValueAndValidity())}),e._rawAsyncValidators.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(()=>t.updateValueAndValidity())})}function Bd(t,e){e.viewToModelUpdate(t._pendingValue),t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),t._pendingChange=!1}function Ud(t,e){null==t&&Fd(e,"Cannot find control with"),t.validator=gd.compose([t.validator,e.validator]),t.asyncValidator=gd.composeAsync([t.asyncValidator,e.asyncValidator])}function zd(t){return Fd(t,"There is no FormControl instance attached to form control element with")}function Fd(t,e){let n;throw n=t.path.length>1?`path: '${t.path.join(" -> ")}'`:t.path[0]?`name: '${t.path}'`:"unspecified name attribute",new Error(`${e} ${n}`)}function kd(t){return null!=t?gd.compose(t.map(Sd)):null}function Vd(t){return null!=t?gd.composeAsync(t.map(Md)):null}function Gd(t,e){if(!t.hasOwnProperty("model"))return!1;const n=t.model;return!!n.isFirstChange()||!St(e,n.currentValue)}const jd=[xd,Ld,Td,Id,Nd,Pd];function Hd(t,e){t._syncPendingControls(),e.forEach(t=>{const e=t.control;"submit"===e.updateOn&&e._pendingChange&&(t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1)})}function Wd(t,e){if(!e)return null;let n=void 0,r=void 0,i=void 0;return e.forEach(e=>{e.constructor===Ed?n=e:function(t){return jd.some(e=>t.constructor===e)}(e)?(r&&Fd(t,"More than one built-in value accessor matches form control with"),r=e):(i&&Fd(t,"More than one custom value accessor matches form control with"),i=e)}),i||r||n||(Fd(t,"No valid value accessor for form control with"),null)}function qd(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class Xd extends pd{ngOnInit(){this._checkParentType(),this.formDirective.addFormGroup(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormGroup(this)}get control(){return this.formDirective.getFormGroup(this)}get path(){return Od(this.name,this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}get validator(){return kd(this._validators)}get asyncValidator(){return Vd(this._asyncValidators)}_checkParentType(){}}class Yd{constructor(t){this._cd=t}get ngClassUntouched(){return!!this._cd.control&&this._cd.control.untouched}get ngClassTouched(){return!!this._cd.control&&this._cd.control.touched}get ngClassPristine(){return!!this._cd.control&&this._cd.control.pristine}get ngClassDirty(){return!!this._cd.control&&this._cd.control.dirty}get ngClassValid(){return!!this._cd.control&&this._cd.control.valid}get ngClassInvalid(){return!!this._cd.control&&this._cd.control.invalid}get ngClassPending(){return!!this._cd.control&&this._cd.control.pending}}class Zd extends Yd{constructor(t){super(t)}}const $d="VALID",Qd="INVALID",Jd="PENDING",Kd="DISABLED";function tp(t){const e=np(t)?t.validators:t;return Array.isArray(e)?kd(e):e||null}function ep(t,e){const n=np(e)?e.asyncValidators:t;return Array.isArray(n)?Vd(n):n||null}function np(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class rp{constructor(t,e){this.validator=t,this.asyncValidator=e,this._onCollectionChange=(()=>{}),this.pristine=!0,this.touched=!1,this._onDisabledChange=[]}get parent(){return this._parent}get valid(){return this.status===$d}get invalid(){return this.status===Qd}get pending(){return this.status==Jd}get disabled(){return this.status===Kd}get enabled(){return this.status!==Kd}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this.validator=tp(t)}setAsyncValidators(t){this.asyncValidator=ep(t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=Jd,this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){this.status=Kd,this.errors=null,this._forEachChild(t=>{t.disable({onlySelf:!0})}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(!!t.onlySelf),this._onDisabledChange.forEach(t=>t(!0))}enable(t={}){this.status=$d,this._forEachChild(t=>{t.enable({onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(!!t.onlySelf),this._onDisabledChange.forEach(t=>t(!1))}_updateAncestors(t){this._parent&&!t&&(this._parent.updateValueAndValidity(),this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),this.status!==$d&&this.status!==Jd||this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Kd:$d}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=Jd;const e=yd(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(e=>this.setErrors(e,{emitEvent:t}))}}_cancelExistingSubscription(){this._asyncValidationSubscription&&this._asyncValidationSubscription.unsubscribe()}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){return function(t,e,n){return null==e?null:(e instanceof Array||(e=e.split(".")),e instanceof Array&&0===e.length?null:e.reduce((t,e)=>t instanceof op?t.controls[e]||null:t instanceof sp&&t.at(e)||null,t))}(this,t)}getError(t,e){const n=e?this.get(e):this;return n&&n.errors?n.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new Je,this.statusChanges=new Je}_calculateStatus(){return this._allControlsDisabled()?Kd:this.errors?Qd:this._anyControlsHaveStatus(Jd)?Jd:this._anyControlsHaveStatus(Qd)?Qd:$d}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_isBoxedValue(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){np(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}}class ip extends rp{constructor(t=null,e,n){super(tp(e),ep(n,e)),this._onChange=[],this._applyFormState(t),this._setUpdateStrategy(e),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),this._initObservables()}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(t=>t(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=null,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_clearChangeFns(){this._onChange=[],this._onDisabledChange=[],this._onCollectionChange=(()=>{})}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}class op extends rp{constructor(t,e,n){super(tp(e),ep(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e){this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}removeControl(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity(),this._onCollectionChange()}setControl(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){this._checkAllValuesPresent(t),Object.keys(t).forEach(n=>{this._throwIfControlMissing(n),this.controls[n].setValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){Object.keys(t).forEach(n=>{this.controls[n]&&this.controls[n].patchValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}reset(t={},e={}){this._forEachChild((n,r)=>{n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e),this._updatePristine(e),this._updateTouched(e)}getRawValue(){return this._reduceChildren({},(t,e,n)=>(t[n]=e instanceof ip?e.value:e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(t,e)=>!!e._syncPendingControls()||t);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[t])throw new Error(`Cannot find form control with name: ${t}.`)}_forEachChild(t){Object.keys(this.controls).forEach(e=>t(this.controls[e],e))}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){let e=!1;return this._forEachChild((n,r)=>{e=e||this.contains(r)&&t(n)}),e}_reduceValue(){return this._reduceChildren({},(t,e,n)=>((e.enabled||this.disabled)&&(t[n]=e.value),t))}_reduceChildren(t,e){let n=t;return this._forEachChild((t,r)=>{n=e(n,t,r)}),n}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(t){this._forEachChild((e,n)=>{if(void 0===t[n])throw new Error(`Must supply a value for form control with name: '${n}'.`)})}}class sp extends rp{constructor(t,e,n){super(tp(e),ep(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1})}at(t){return this.controls[t]}push(t){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity(),this._onCollectionChange()}insert(t,e){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity(),this._onCollectionChange()}removeAt(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),this.updateValueAndValidity(),this._onCollectionChange()}setControl(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),e&&(this.controls.splice(t,0,e),this._registerControl(e)),this.updateValueAndValidity(),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){this._checkAllValuesPresent(t),t.forEach((t,n)=>{this._throwIfControlMissing(n),this.at(n).setValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t.forEach((t,n)=>{this.at(n)&&this.at(n).patchValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}reset(t=[],e={}){this._forEachChild((n,r)=>{n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e),this._updatePristine(e),this._updateTouched(e)}getRawValue(){return this.controls.map(t=>t instanceof ip?t.value:t.getRawValue())}_syncPendingControls(){let t=this.controls.reduce((t,e)=>!!e._syncPendingControls()||t,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(t))throw new Error(`Cannot find form control at index ${t}`)}_forEachChild(t){this.controls.forEach((e,n)=>{t(e,n)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_checkAllValuesPresent(t){this._forEachChild((e,n)=>{if(void 0===t[n])throw new Error(`Must supply a value for form control at index: ${n}.`)})}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}}Tt(()=>lp);const ap=Promise.resolve(null);class lp extends pd{constructor(t,e){super(),this.submitted=!1,this._directives=[],this.ngSubmit=new Je,this.form=new op({},kd(t),Vd(e))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){ap.then(()=>{const e=this._findContainer(t.path);t.control=e.registerControl(t.name,t.control),Dd(t.control,t),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.push(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){ap.then(()=>{const e=this._findContainer(t.path);e&&e.removeControl(t.name),qd(this._directives,t)})}addFormGroup(t){ap.then(()=>{const e=this._findContainer(t.path),n=new op({});Ud(n,t),e.registerControl(t.name,n),n.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){ap.then(()=>{const e=this._findContainer(t.path);e&&e.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,e){ap.then(()=>{this.form.get(t.path).setValue(e)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,Hd(this.form,this._directives),this.ngSubmit.emit(t),!1}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}}const up={formControlName:'\n    <div [formGroup]="myGroup">\n      <input formControlName="firstName">\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       firstName: new FormControl()\n    });',formGroupName:'\n    <div [formGroup]="myGroup">\n       <div formGroupName="person">\n          <input formControlName="firstName">\n       </div>\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       person: new FormGroup({ firstName: new FormControl() })\n    });',formArrayName:'\n    <div [formGroup]="myGroup">\n      <div formArrayName="cities">\n        <div *ngFor="let city of cityArray.controls; index as i">\n          <input [formControlName]="i">\n        </div>\n      </div>\n    </div>\n\n    In your class:\n\n    this.cityArray = new FormArray([new FormControl(\'SF\')]);\n    this.myGroup = new FormGroup({\n      cities: this.cityArray\n    });',ngModelGroup:'\n    <form>\n       <div ngModelGroup="person">\n          <input [(ngModel)]="person.name" name="firstName">\n       </div>\n    </form>',ngModelWithFormGroup:'\n    <div [formGroup]="myGroup">\n       <input formControlName="firstName">\n       <input [(ngModel)]="showMoreControls" [ngModelOptions]="{standalone: true}">\n    </div>\n  '};class cp{static modelParentException(){throw new Error(`\n      ngModel cannot be used to register form controls with a parent formGroup directive.  Try using\n      formGroup's partner directive "formControlName" instead.  Example:\n\n      ${up.formControlName}\n\n      Or, if you'd like to avoid registering this form control, indicate that it's standalone in ngModelOptions:\n\n      Example:\n\n      ${up.ngModelWithFormGroup}`)}static formGroupNameException(){throw new Error(`\n      ngModel cannot be used to register form controls with a parent formGroupName or formArrayName directive.\n\n      Option 1: Use formControlName instead of ngModel (reactive strategy):\n\n      ${up.formGroupName}\n\n      Option 2:  Update ngModel's parent be ngModelGroup (template-driven strategy):\n\n      ${up.ngModelGroup}`)}static missingNameException(){throw new Error('If ngModel is used within a form tag, either the name attribute must be set or the form\n      control must be defined as \'standalone\' in ngModelOptions.\n\n      Example 1: <input [(ngModel)]="person.firstName" name="first">\n      Example 2: <input [(ngModel)]="person.firstName" [ngModelOptions]="{standalone: true}">')}static modelGroupParentException(){throw new Error(`\n      ngModelGroup cannot be used with a parent formGroup directive.\n\n      Option 1: Use formGroupName instead of ngModelGroup (reactive strategy):\n\n      ${up.formGroupName}\n\n      Option 2:  Use a regular form tag instead of the formGroup directive (template-driven strategy):\n\n      ${up.ngModelGroup}`)}}Tt(()=>hp);class hp extends Xd{constructor(t,e,n){super(),this._parent=t,this._validators=e,this._asyncValidators=n}_checkParentType(){this._parent instanceof hp||this._parent instanceof lp||cp.modelGroupParentException()}}Tt(()=>pp);const dp=Promise.resolve(null);class pp extends Ad{constructor(t,e,n,r){super(),this.control=new ip,this._registered=!1,this.update=new Je,this._parent=t,this._rawValidators=e||[],this._rawAsyncValidators=n||[],this.valueAccessor=Wd(this,r)}ngOnChanges(t){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in t&&this._updateDisabled(t),Gd(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?Od(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}get validator(){return kd(this._rawValidators)}get asyncValidator(){return Vd(this._rawAsyncValidators)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Dd(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){!(this._parent instanceof hp)&&this._parent instanceof Xd?cp.formGroupNameException():this._parent instanceof hp||this._parent instanceof lp||cp.modelParentException()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()||this.name||cp.missingNameException()}_updateValue(t){dp.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1})})}_updateDisabled(t){const e=t.isDisabled.currentValue,n=""===e||e&&"false"!==e;dp.then(()=>{n&&!this.control.disabled?this.control.disable():!n&&this.control.disabled&&this.control.enable()})}}class fp{static controlParentException(){throw new Error(`formControlName must be used with a parent formGroup directive.  You'll want to add a formGroup\n       directive and pass it an existing FormGroup instance (you can create one in your class).\n\n      Example:\n\n      ${up.formControlName}`)}static ngModelGroupException(){throw new Error(`formControlName cannot be used with an ngModelGroup parent. It is only compatible with parents\n       that also have a "form" prefix: formGroupName, formArrayName, or formGroup.\n\n       Option 1:  Update the parent to be formGroupName (reactive form strategy)\n\n        ${up.formGroupName}\n\n        Option 2: Use ngModel instead of formControlName (template-driven strategy)\n\n        ${up.ngModelGroup}`)}static missingFormException(){throw new Error(`formGroup expects a FormGroup instance. Please pass one in.\n\n       Example:\n\n       ${up.formControlName}`)}static groupParentException(){throw new Error(`formGroupName must be used with a parent formGroup directive.  You'll want to add a formGroup\n      directive and pass it an existing FormGroup instance (you can create one in your class).\n\n      Example:\n\n      ${up.formGroupName}`)}static arrayParentException(){throw new Error(`formArrayName must be used with a parent formGroup directive.  You'll want to add a formGroup\n       directive and pass it an existing FormGroup instance (you can create one in your class).\n\n        Example:\n\n        ${up.formArrayName}`)}static disabledAttrWarning(){console.warn("\n      It looks like you're using the disabled attribute with a reactive form directive. If you set disabled to true\n      when you set up this control in your component class, the disabled attribute will actually be set in the DOM for\n      you. We recommend using this approach to avoid 'changed after checked' errors.\n       \n      Example: \n      form = new FormGroup({\n        first: new FormControl({value: 'Nancy', disabled: true}, Validators.required),\n        last: new FormControl('Drew', Validators.required)\n      });\n    ")}}Tt(()=>(class extends Ad{constructor(t,e,n){super(),this.update=new Je,this._rawValidators=t||[],this._rawAsyncValidators=e||[],this.valueAccessor=Wd(this,n)}set isDisabled(t){fp.disabledAttrWarning()}ngOnChanges(t){this._isControlChanged(t)&&(Dd(this.form,this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this.form.updateValueAndValidity({emitEvent:!1})),Gd(t,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}get path(){return[]}get validator(){return kd(this._rawValidators)}get asyncValidator(){return Vd(this._rawAsyncValidators)}get control(){return this.form}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_isControlChanged(t){return t.hasOwnProperty("form")}})),Tt(()=>mp);class mp extends pd{constructor(t,e){super(),this._validators=t,this._asyncValidators=e,this.submitted=!1,this.directives=[],this.form=null,this.ngSubmit=new Je}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations())}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const e=this.form.get(t.path);return Dd(e,t),e.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),e}getControl(t){return this.form.get(t.path)}removeControl(t){qd(this.directives,t)}addFormGroup(t){const e=this.form.get(t.path);Ud(e,t),e.updateValueAndValidity({emitEvent:!1})}removeFormGroup(t){}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){const e=this.form.get(t.path);Ud(e,t),e.updateValueAndValidity({emitEvent:!1})}removeFormArray(t){}getFormArray(t){return this.form.get(t.path)}updateModel(t,e){this.form.get(t.path).setValue(e)}onSubmit(t){return this.submitted=!0,Hd(this.form,this.directives),this.ngSubmit.emit(t),!1}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{const e=this.form.get(t.path);t.control!==e&&(function(t,e){e.valueAccessor.registerOnChange(()=>zd(e)),e.valueAccessor.registerOnTouched(()=>zd(e)),e._rawValidators.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(null)}),e._rawAsyncValidators.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(null)}),t&&t._clearChangeFns()}(t.control,t),e&&Dd(e,t),t.control=e)}),this.form._updateTreeValidity({emitEvent:!1})}_updateRegistrations(){this.form._registerOnCollectionChange(()=>this._updateDomValue()),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{}),this._oldForm=this.form}_updateValidators(){const t=kd(this._validators);this.form.validator=gd.compose([this.form.validator,t]);const e=Vd(this._asyncValidators);this.form.asyncValidator=gd.composeAsync([this.form.asyncValidator,e])}_checkFormPresent(){this.form||fp.missingFormException()}}Tt(()=>gp);class gp extends Xd{constructor(t,e,n){super(),this._parent=t,this._validators=e,this._asyncValidators=n}_checkParentType(){yp(this._parent)&&fp.groupParentException()}}Tt(()=>vp);class vp extends pd{constructor(t,e,n){super(),this._parent=t,this._validators=e,this._asyncValidators=n}ngOnInit(){this._checkParentType(),this.formDirective.addFormArray(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormArray(this)}get control(){return this.formDirective.getFormArray(this)}get formDirective(){return this._parent?this._parent.formDirective:null}get path(){return Od(this.name,this._parent)}get validator(){return kd(this._validators)}get asyncValidator(){return Vd(this._asyncValidators)}_checkParentType(){yp(this._parent)&&fp.arrayParentException()}}function yp(t){return!(t instanceof gp||t instanceof mp||t instanceof vp)}Tt(()=>(class extends Ad{constructor(t,e,n,r){super(),this._added=!1,this.update=new Je,this._parent=t,this._rawValidators=e||[],this._rawAsyncValidators=n||[],this.valueAccessor=Wd(this,r)}set isDisabled(t){fp.disabledAttrWarning()}ngOnChanges(t){this._added||this._setUpControl(),Gd(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return Od(this.name,this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}get validator(){return kd(this._rawValidators)}get asyncValidator(){return Vd(this._rawAsyncValidators)}_checkParentType(){!(this._parent instanceof gp)&&this._parent instanceof Xd?fp.ngModelGroupException():this._parent instanceof gp||this._parent instanceof mp||this._parent instanceof vp||fp.controlParentException()}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}})),Tt(()=>wp),Tt(()=>(class extends wp{validate(t){return this.required?gd.requiredTrue(t):null}}));class wp{get required(){return this._required}set required(t){this._required=null!=t&&!1!==t&&"false"!==`${t}`,this._onChange&&this._onChange()}validate(t){return this.required?gd.required(t):null}registerOnValidatorChange(t){this._onChange=t}}Tt(()=>(class{set email(t){this._enabled=""===t||!0===t||"true"===t,this._onChange&&this._onChange()}validate(t){return this._enabled?gd.email(t):null}registerOnValidatorChange(t){this._onChange=t}})),Tt(()=>(class{ngOnChanges(t){"minlength"in t&&(this._createValidator(),this._onChange&&this._onChange())}validate(t){return null==this.minlength?null:this._validator(t)}registerOnValidatorChange(t){this._onChange=t}_createValidator(){this._validator=gd.minLength(parseInt(this.minlength,10))}})),Tt(()=>(class{ngOnChanges(t){"maxlength"in t&&(this._createValidator(),this._onChange&&this._onChange())}validate(t){return null!=this.maxlength?this._validator(t):null}registerOnValidatorChange(t){this._onChange=t}_createValidator(){this._validator=gd.maxLength(parseInt(this.maxlength,10))}})),Tt(()=>(class{ngOnChanges(t){"pattern"in t&&(this._createValidator(),this._onChange&&this._onChange())}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}_createValidator(){this._validator=gd.pattern(this.pattern)}})),new ht("5.2.0");class bp{}class xp{}var _p=n("Womt");class Ep{constructor(){this.cubes=[],this.rotationSpeedX=10,this.rotationSpeedY=10,this.rotationSpeedZ=10,this.camPosZ=15,this.size=1,this.isTextured=!1,this.numOfCubes=20}get canvas(){return this.canvasRef.nativeElement}ngOnInit(){}ngAfterViewInit(){this.createScene(),this.changeNumOfCubes(this.numOfCubes.toString());var t=new _p.PlaneGeometry(200,200),e=new _p.MeshLambertMaterial,n=new _p.Mesh(t,e);n.receiveShadow=!0,n.rotation.x=-.5*Math.PI,n.position.x=100,n.position.z=100,this.scene.add(n);var r,i=new _p.AxesHelper(100);this.scene.add(i),(r=new _p.DirectionalLight(16777215,1)).castShadow=!1,this.scene.add(r),(r=new _p.DirectionalLight(16777215,.5)).position.set(10,10,50),r.target.position.set(10,10,0),this.scene.add(r),this.topLight=new _p.SpotLight(1118481,.5),this.topLight.position.set(0,15,0),this.topLight.castShadow=!0,this.scene.add(this.topLight),this.startRenderingLoop()}animateCubes(){let t=this;this.cubes.forEach(function(e){e.rotation.x+=t.rotationSpeedX/1e3,e.rotation.y+=t.rotationSpeedY/1e3,e.rotation.z+=t.rotationSpeedZ/1e3})}updateCamera(){this.camera.position.z=this.camPosZ}changeNumOfCubes(t){console.log("input cubes: "+t+", scene cubes: "+this.cubes.length);let e=parseInt(t,10);for(;e>this.cubes.length;)this.addCube();for(;e<this.cubes.length;)this.removeCube();this.numOfCubes=this.cubes.length}changeMaterial(t){console.log("textured: "+t),this.isTextured=t;var e={};t?e.map=this._texture_brick:e.color=new _p.Color(Math.random(),Math.random(),Math.random());let n=new _p.MeshPhongMaterial(e);this.cubes.forEach(function(t){t.material=n})}addCube(){let t=new _p.BoxGeometry(this.size,this.size,this.size);this._texture_brick=(new _p.TextureLoader).load("assets/texture/Bricks.jpg"),this._texture_brick.minFilter=_p.LinearFilter;var e={};this.isTextured?e.map=this._texture_brick:e.color=new _p.Color(Math.random(),Math.random(),Math.random()),this.cubes.push(new _p.Mesh(t,new _p.MeshPhongMaterial(e))),this.cubes[this.cubes.length-1].position.x=Math.ceil(10*Math.random()),this.cubes[this.cubes.length-1].position.y=Math.ceil(10*Math.random()),this.cubes[this.cubes.length-1].position.z=Math.ceil(10*Math.random()),this.cubes[this.cubes.length-1].castShadow=!0,this.cubes[this.cubes.length-1].receiveShadow=!0,this.scene.add(this.cubes[this.cubes.length-1])}removeCube(){this.scene.remove(this.cubes[this.cubes.length-1]),this.cubes.pop()}createScene(){this.scene=new _p.Scene;let t=this.getAspectRatio();this.camera=new _p.PerspectiveCamera(70,t,1,1e3),this.camera.position.set(5,10,this.camPosZ),this.camera.lookAt(new _p.Vector3(5,0,0))}startRenderingLoop(){this.renderer=new _p.WebGLRenderer({canvas:this.canvas,antialias:!0,alpha:!0}),this.renderer.setPixelRatio(devicePixelRatio),this.renderer.setClearColor(16777215,1),this.renderer.setSize(.66*window.innerWidth,.66*window.innerHeight),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=_p.PCFSoftShadowMap,this.renderer.render(this.scene,this.camera);let t=this;!function e(){requestAnimationFrame(e),t.animateCubes(),t.updateCamera(),t.renderer.render(t.scene,t.camera)}()}onResize(){this.camera.aspect=this.getAspectRatio(),this.camera.updateProjectionMatrix(),console.log(`onResize: Witdh: ${.66*window.innerWidth}, Height: ${.66*window.innerHeight}`),this.renderer.setSize(.66*window.innerWidth,.66*window.innerHeight)}getAspectRatio(){return this.canvas.clientWidth/this.canvas.clientHeight}}var Sp=Ar({encapsulation:0,styles:[[""]],data:{}});function Mp(t){return fo(0,[io(402653184,1,{canvasRef:0}),(t()(),co(-1,null,["\n\n"])),(t()(),co(-1,null,["\n"])),(t()(),ni(3,0,null,null,138,"div",[["class","w3-container"]],null,null,null,null,null)),(t()(),co(-1,null,["\n    "])),(t()(),ni(5,0,null,null,36,"header",[],null,null,null,null,null)),(t()(),co(-1,null,["\n            "])),(t()(),ni(7,0,null,null,15,"div",[["class","w3-container "]],null,null,null,null,null)),(t()(),co(-1,null,["\n                "])),(t()(),ni(9,0,null,null,2,"h1",[],null,null,null,null,null)),(t()(),ni(10,0,null,null,1,"b",[],null,null,null,null,null)),(t()(),co(-1,null,["A Three.js cube showcase..."])),(t()(),co(-1,null,["\n                "])),(t()(),ni(13,0,null,null,1,"b",[],null,null,null,null,null)),(t()(),co(-1,null,["Note: This page is not responsive for mobile screens yet."])),(t()(),ni(15,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,['\n                In the canvas below you can play with at least one spinning cube. It\'s size is set to 1.0 "unitless" length of each edge.'])),(t()(),ni(17,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,["\n                The scene contains a plane below the cubes and a spotlight over it."])),(t()(),ni(19,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,["\n                In this example the user cannot interact directly with the canvas via keybord or mouse movement."])),(t()(),ni(21,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,["\n                Play around with the settings you can change.\n            "])),(t()(),co(-1,null,["\n            "])),(t()(),ni(24,0,null,null,16,"div",[["class","w3-container "]],null,null,null,null,null)),(t()(),co(-1,null,["\n                "])),(t()(),ni(26,0,null,null,1,"b",[],null,null,null,null,null)),(t()(),co(-1,null,["Note:"])),(t()(),co(-1,null,["\n                "])),(t()(),ni(29,0,null,null,10,"ul",[],null,null,null,null,null)),(t()(),co(-1,null,["\n                    "])),(t()(),ni(31,0,null,null,1,"li",[],null,null,null,null,null)),(t()(),co(-1,null,["The 3D scene is set up on a HTML canvas element."])),(t()(),co(-1,null,["\n                    "])),(t()(),ni(34,0,null,null,4,"li",[],null,null,null,null,null)),(t()(),co(-1,null,["Only the "])),(t()(),ni(36,0,null,null,1,"em",[],null,null,null,null,null)),(t()(),co(-1,null,["Threejs"])),(t()(),co(-1,null,[" library is used here."])),(t()(),co(-1,null,["\n                "])),(t()(),co(-1,null,["\n            "])),(t()(),co(-1,null,["\n    "])),(t()(),co(-1,null,["\n\n    "])),(t()(),ni(43,0,null,null,89,"div",[["class","w3-container"]],null,null,null,null,null)),(t()(),co(-1,null,["\n        "])),(t()(),co(-1,null,["\n        \n        "])),(t()(),co(-1,null,["\n        "])),(t()(),ni(47,0,[[1,0],["canvas",1]],null,0,"canvas",[],null,[["window","resize"]],function(t,e,n){var r=!0;return"window:resize"===e&&(r=!1!==t.component.onResize()&&r),r},null,null)),(t()(),co(-1,null,["\n               \n        "])),(t()(),co(-1,null,["\n        "])),(t()(),ni(50,0,null,null,78,"div",[["class","w3-row"]],null,null,null,null,null)),(t()(),co(-1,null,["\n            "])),(t()(),co(-1,null,["\n            \n            "])),(t()(),co(-1,null,["\n            "])),(t()(),ni(54,0,null,null,1,"div",[["class","w3-col s4 w3-left"]],null,null,null,null,null)),(t()(),co(55,null,["Cube Rotation Speed X: ",""])),(t()(),co(-1,null,["\n            "])),(t()(),ni(57,0,null,null,9,"div",[["class","w3-col s8 w3-left"]],null,null,null,null,null)),(t()(),co(-1,null,["\n                "])),(t()(),ni(59,0,null,null,6,"input",[["class","slider"],["max","100"],["min","1"],["type","range"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"]],function(t,e,n){var r=!0,i=t.component;return"input"===e&&(r=!1!==Pi(t,60)._handleInput(n.target.value)&&r),"blur"===e&&(r=!1!==Pi(t,60).onTouched()&&r),"compositionstart"===e&&(r=!1!==Pi(t,60)._compositionStart()&&r),"compositionend"===e&&(r=!1!==Pi(t,60)._compositionEnd(n.target.value)&&r),"change"===e&&(r=!1!==Pi(t,61).onChange(n.target.value)&&r),"input"===e&&(r=!1!==Pi(t,61).onChange(n.target.value)&&r),"blur"===e&&(r=!1!==Pi(t,61).onTouched()&&r),"ngModelChange"===e&&(r=!1!==(i.rotationSpeedX=n)&&r),r},null,null)),Gi(60,16384,null,0,Ed,[Sn,Mn,[2,_d]],null,null),Gi(61,16384,null,0,Ld,[Sn,Mn],null,null),ji(1024,null,bd,function(t,e){return[t,e]},[Ed,Ld]),Gi(63,671744,null,0,pp,[[8,null],[8,null],[8,null],[2,bd]],{model:[0,"model"]},{update:"ngModelChange"}),ji(2048,null,Ad,null,[pp]),Gi(65,16384,null,0,Zd,[Ad],null,null),(t()(),co(-1,null,["\n            "])),(t()(),co(-1,null,["\n            "])),(t()(),ni(68,0,null,null,1,"div",[["class","w3-col s4 w3-left"]],null,null,null,null,null)),(t()(),co(69,null,["Cube Rotation Speed Y: ",""])),(t()(),co(-1,null,["\n            "])),(t()(),ni(71,0,null,null,9,"div",[["class","w3-col s8 w3-left"]],null,null,null,null,null)),(t()(),co(-1,null,["\n                "])),(t()(),ni(73,0,null,null,6,"input",[["class","slider"],["max","100"],["min","1"],["type","range"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"]],function(t,e,n){var r=!0,i=t.component;return"input"===e&&(r=!1!==Pi(t,74)._handleInput(n.target.value)&&r),"blur"===e&&(r=!1!==Pi(t,74).onTouched()&&r),"compositionstart"===e&&(r=!1!==Pi(t,74)._compositionStart()&&r),"compositionend"===e&&(r=!1!==Pi(t,74)._compositionEnd(n.target.value)&&r),"change"===e&&(r=!1!==Pi(t,75).onChange(n.target.value)&&r),"input"===e&&(r=!1!==Pi(t,75).onChange(n.target.value)&&r),"blur"===e&&(r=!1!==Pi(t,75).onTouched()&&r),"ngModelChange"===e&&(r=!1!==(i.rotationSpeedY=n)&&r),r},null,null)),Gi(74,16384,null,0,Ed,[Sn,Mn,[2,_d]],null,null),Gi(75,16384,null,0,Ld,[Sn,Mn],null,null),ji(1024,null,bd,function(t,e){return[t,e]},[Ed,Ld]),Gi(77,671744,null,0,pp,[[8,null],[8,null],[8,null],[2,bd]],{model:[0,"model"]},{update:"ngModelChange"}),ji(2048,null,Ad,null,[pp]),Gi(79,16384,null,0,Zd,[Ad],null,null),(t()(),co(-1,null,["\n            "])),(t()(),co(-1,null,["\n            "])),(t()(),ni(82,0,null,null,1,"div",[["class","w3-col s4 w3-left"]],null,null,null,null,null)),(t()(),co(83,null,["Cube Rotation Speed Z: ",""])),(t()(),co(-1,null,["\n            "])),(t()(),ni(85,0,null,null,9,"div",[["class","w3-col s8 w3-left"]],null,null,null,null,null)),(t()(),co(-1,null,["\n                "])),(t()(),ni(87,0,null,null,6,"input",[["class","slider"],["max","100"],["min","1"],["type","range"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"]],function(t,e,n){var r=!0,i=t.component;return"input"===e&&(r=!1!==Pi(t,88)._handleInput(n.target.value)&&r),"blur"===e&&(r=!1!==Pi(t,88).onTouched()&&r),"compositionstart"===e&&(r=!1!==Pi(t,88)._compositionStart()&&r),"compositionend"===e&&(r=!1!==Pi(t,88)._compositionEnd(n.target.value)&&r),"change"===e&&(r=!1!==Pi(t,89).onChange(n.target.value)&&r),"input"===e&&(r=!1!==Pi(t,89).onChange(n.target.value)&&r),"blur"===e&&(r=!1!==Pi(t,89).onTouched()&&r),"ngModelChange"===e&&(r=!1!==(i.rotationSpeedZ=n)&&r),r},null,null)),Gi(88,16384,null,0,Ed,[Sn,Mn,[2,_d]],null,null),Gi(89,16384,null,0,Ld,[Sn,Mn],null,null),ji(1024,null,bd,function(t,e){return[t,e]},[Ed,Ld]),Gi(91,671744,null,0,pp,[[8,null],[8,null],[8,null],[2,bd]],{model:[0,"model"]},{update:"ngModelChange"}),ji(2048,null,Ad,null,[pp]),Gi(93,16384,null,0,Zd,[Ad],null,null),(t()(),co(-1,null,["\n            "])),(t()(),co(-1,null,["\n\n            "])),(t()(),co(-1,null,["\n            "])),(t()(),ni(97,0,null,null,1,"div",[["class","w3-col s4 w3-left"]],null,null,null,null,null)),(t()(),co(98,null,["Camera Position Z: ",""])),(t()(),co(-1,null,["\n            "])),(t()(),ni(100,0,null,null,9,"div",[["class","w3-col s8 w3-left"]],null,null,null,null,null)),(t()(),co(-1,null,["\n                "])),(t()(),ni(102,0,null,null,6,"input",[["class","slider"],["max","30"],["min","2"],["type","range"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"]],function(t,e,n){var r=!0,i=t.component;return"input"===e&&(r=!1!==Pi(t,103)._handleInput(n.target.value)&&r),"blur"===e&&(r=!1!==Pi(t,103).onTouched()&&r),"compositionstart"===e&&(r=!1!==Pi(t,103)._compositionStart()&&r),"compositionend"===e&&(r=!1!==Pi(t,103)._compositionEnd(n.target.value)&&r),"change"===e&&(r=!1!==Pi(t,104).onChange(n.target.value)&&r),"input"===e&&(r=!1!==Pi(t,104).onChange(n.target.value)&&r),"blur"===e&&(r=!1!==Pi(t,104).onTouched()&&r),"ngModelChange"===e&&(r=!1!==(i.camPosZ=n)&&r),r},null,null)),Gi(103,16384,null,0,Ed,[Sn,Mn,[2,_d]],null,null),Gi(104,16384,null,0,Ld,[Sn,Mn],null,null),ji(1024,null,bd,function(t,e){return[t,e]},[Ed,Ld]),Gi(106,671744,null,0,pp,[[8,null],[8,null],[8,null],[2,bd]],{model:[0,"model"]},{update:"ngModelChange"}),ji(2048,null,Ad,null,[pp]),Gi(108,16384,null,0,Zd,[Ad],null,null),(t()(),co(-1,null,["\n            "])),(t()(),co(-1,null,["\n\n            "])),(t()(),co(-1,null,["\n            "])),(t()(),ni(112,0,null,null,1,"div",[["class","w3-col s4 w3-left"]],null,null,null,null,null)),(t()(),co(113,null,["Number Of Cubes: ",""])),(t()(),co(-1,null,["\n            "])),(t()(),ni(115,0,null,null,3,"div",[["class","w3-col s8 w3-left"]],null,null,null,null,null)),(t()(),co(-1,null,["\n                "])),(t()(),ni(117,0,[["id_In_NumOfCubes",1]],null,0,"input",[["class","slider"],["max","100"],["min","1"],["type","range"]],[[8,"value",0]],[[null,"input"]],function(t,e,n){var r=!0;return"input"===e&&(r=!1!==t.component.changeNumOfCubes(Pi(t,117).value)&&r),r},null,null)),(t()(),co(-1,null,["\n            "])),(t()(),co(-1,null,["\n\n            "])),(t()(),co(-1,null,["\n            "])),(t()(),ni(121,0,null,null,1,"div",[["class","w3-col s4 w3-left"]],null,null,null,null,null)),(t()(),co(-1,null,["Use Texture Or Colors:"])),(t()(),co(-1,null,["\n            "])),(t()(),ni(124,0,null,null,3,"div",[["class","w3-col s8 w3-left"]],null,null,null,null,null)),(t()(),co(-1,null,["\n                "])),(t()(),ni(126,0,[["id_In_ChangeMaterial",1]],null,0,"input",[["type","checkbox"]],null,[[null,"change"]],function(t,e,n){var r=!0;return"change"===e&&(r=!1!==t.component.changeMaterial(Pi(t,126).checked)&&r),r},null,null)),(t()(),co(-1,null,["\n            "])),(t()(),co(-1,null,["\n        "])),(t()(),co(-1,null,[" \n\n        "])),(t()(),co(-1,null,["\n\n        "])),(t()(),co(-1,null,["\n        "])),(t()(),co(-1,null,["\n    "])),(t()(),co(-1,null,["\n\n    "])),(t()(),co(-1,null,["\n    "])),(t()(),ni(135,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,["\n    "])),(t()(),ni(137,0,null,null,3,"div",[["class","w3-container "]],null,null,null,null,null)),(t()(),co(138,null,["\n    You currently have "," cube(s) on the canvas. The rotational speed\n    is set to X=",", Y=",", Z="," for each cube."])),(t()(),ni(139,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(140,null,["\n    The camera is "," units away from the zero point Z. The cubes have now a material with ",".\n    "])),(t()(),co(-1,null,["\n"]))],function(t,e){var n=e.component;t(e,63,0,n.rotationSpeedX),t(e,77,0,n.rotationSpeedY),t(e,91,0,n.rotationSpeedZ),t(e,106,0,n.camPosZ)},function(t,e){var n=e.component;t(e,55,0,n.rotationSpeedX/1e3),t(e,59,0,Pi(e,65).ngClassUntouched,Pi(e,65).ngClassTouched,Pi(e,65).ngClassPristine,Pi(e,65).ngClassDirty,Pi(e,65).ngClassValid,Pi(e,65).ngClassInvalid,Pi(e,65).ngClassPending),t(e,69,0,n.rotationSpeedY/1e3),t(e,73,0,Pi(e,79).ngClassUntouched,Pi(e,79).ngClassTouched,Pi(e,79).ngClassPristine,Pi(e,79).ngClassDirty,Pi(e,79).ngClassValid,Pi(e,79).ngClassInvalid,Pi(e,79).ngClassPending),t(e,83,0,n.rotationSpeedZ/1e3),t(e,87,0,Pi(e,93).ngClassUntouched,Pi(e,93).ngClassTouched,Pi(e,93).ngClassPristine,Pi(e,93).ngClassDirty,Pi(e,93).ngClassValid,Pi(e,93).ngClassInvalid,Pi(e,93).ngClassPending),t(e,98,0,n.camPosZ),t(e,102,0,Pi(e,108).ngClassUntouched,Pi(e,108).ngClassTouched,Pi(e,108).ngClassPristine,Pi(e,108).ngClassDirty,Pi(e,108).ngClassValid,Pi(e,108).ngClassInvalid,Pi(e,108).ngClassPending),t(e,113,0,n.numOfCubes),t(e,117,0,n.numOfCubes),t(e,138,0,n.numOfCubes,n.rotationSpeedX/1e3,n.rotationSpeedY/1e3,n.rotationSpeedZ/1e3),t(e,140,0,n.camPosZ,Pi(e,126).checked?"brick texture":"colors")})}var Tp,Cp=wi("app-cube-threejs",Ep,function(t){return fo(0,[(t()(),ni(0,0,null,null,1,"app-cube-threejs",[],null,null,null,Mp,Sp)),Gi(1,4308992,null,0,Ep,[],null,null)],function(t,e){t(e,1,0)},null)},{},{},[]),Ap=n("pdRg"),Rp=n("N5P7"),Pp=n("OREr"),Lp=n("VT+s"),Ip=n("YUnZ"),Np=n("9ZTT");!function(t){t.BRICK="assets/texture/Bricks.jpg",t.GAS_BRIGHT="assets/texture/Gaseous_Bright.jpg",t.GAS_DARK="assets/texture/Gaseous_Dark.png",t.GAS_GREEN="assets/texture/Gaseous_Green.jpg",t.MOON_BW="assets/texture/Moon_BW.jpg"}(Tp||(Tp={}));class Op{constructor(t,e){this.sceneBalls=[],this.timestep=1/60,this.bPhysicsOn=!1,this.cannonBalls=[],this.cannonBallsBodyPosOrigin=[],this.htmlDivCanvas=t,this.aspRatio=window.innerWidth*e/(window.innerHeight*e),this.scrSize=e,this.initiateCamera(),this.initPhysicWorld(),this.createRenderer(),this.initiateGeometies(),this.initiateLight(),this.initiateParticles(),this.initiateTerrain(),this.renderer.render(this.scene,this.camera),this.createCSSRenderer(),this.initiateCSSObjects(),this.rendererCSS.render(this.sceneCSS,this.camera),this.initTrackballControls(),this.initTween(),this.animate()}createRenderer(){this.scene=new _p.Scene,this.renderer=new _p.WebGLRenderer({antialias:!0,alpha:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setClearColor(0,1),this.renderer.setSize(window.innerWidth*this.scrSize,window.innerHeight*this.scrSize),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=_p.PCFSoftShadowMap,this.renderer.domElement.style.position="absolute",this.renderer.domElement.style.zIndex="1",this.htmlDivCanvas.appendChild(this.renderer.domElement)}initiateCamera(){this.camera=new _p.PerspectiveCamera(70,this.aspRatio,1,1e4),this.camera.position.set(-200,200,800)}initiateLight(){var t=new _p.AmbientLight(12303291);this.scene.add(t),this.directionalLight=new _p.SpotLight(16777215,.4),this.directionalLight.position.set(0,400,0),this.directionalLight.target.position.set(10,10,0),this.directionalLight.castShadow=!0,this.scene.add(this.directionalLight)}getMeshPhongMaterialFromTexture(t,e=!1){let n=(new _p.TextureLoader).load(t);return n.minFilter=_p.LinearFilter,!0===e&&(n.wrapS=n.wrapT=_p.RepeatWrapping,n.repeat.set(6,2)),new _p.MeshPhongMaterial({map:n,specular:7811072,shininess:10})}initiateGeometies(){var t=new _p.TorusGeometry(200,30,16,100);this.torus=new _p.Mesh(t,this.getMeshPhongMaterialFromTexture(Tp.GAS_BRIGHT,!0)),this.torus.userData={texture:Tp.GAS_BRIGHT},this.torus.rotateX(_p.Math.degToRad(90)),this.torus.receiveShadow=!0,this.torus.castShadow=!0,this.pivotPoint=new _p.Object3D;var e=new _p.SphereGeometry(30,32,32);this.sphereSatRotational=new _p.Mesh(e,this.getMeshPhongMaterialFromTexture(Tp.MOON_BW)),this.sphereSatRotational.position.set(200,60,0),this.sphereSatRotational.castShadow=!0,this.sphereSatRotational.receiveShadow=!0,this.pivotPoint.add(this.sphereSatRotational),this.scene.add(this.torus),this.scene.add(this.pivotPoint);for(var n=1;n<8;n++)for(var r=1;r<3;r++){let t=30*Math.random()+5,e=t>20?1:-1,s=new Np.Sphere(t),a=new Np.Body({mass:t});a.addShape(s),a.position.set(50*r,100*n,20*n*r-150),this.cannonBallsBodyPosOrigin.push(new Np.Vec3(a.position.x,a.position.y,a.position.z)),a.angularVelocity.set(0,t/100*e,0),a.quaternion.set(.2,.5,0,1),this.cannonBalls.push(a),this.cannonWorld.addBody(a);var i=new _p.SphereGeometry(t,32,32),o=new _p.Mesh(i,this.getMeshPhongMaterialFromTexture(Tp.GAS_GREEN));o.position.set(50*r,100*n,20*n*r-150),o.castShadow=!0,o.receiveShadow=!0,this.sceneBalls.push(o),this.scene.add(o)}}addHelpers(){var t=new _p.AxesHelper(100);this.scene.add(t);var e=new _p.GridHelper(100,10);e.rotateX(_p.Math.degToRad(90)),this.scene.add(e);var n=new _p.GridHelper(100,10);n.rotateX(_p.Math.degToRad(180)),this.scene.add(n)}initTrackballControls(){this.controls=new Ap(this.camera,this.rendererCSS.domElement),this.controls.rotateSpeed=2,this.controls.minDistance=5,this.controls.maxDistance=2e3}initTween(){let t=this;this.tweenPivotPartSysRotY=new Pp.Tween({yVel:0}).to({yVel:.005},3e3).onUpdate(function(){t.pivotPointPmSystem.userData.rotation_yVel=this.yVel}).start()}animate(){let t=this;!function e(n){requestAnimationFrame(e),t.pivotPointPmSystem.rotation.y-=t.pivotPointPmSystem.userData.rotation_yVel,t.rendererCSS.render(t.sceneCSS,t.camera),t.renderer.render(t.scene,t.camera),t.controls.update(),Pp.update(n),t.pivotPoint.rotation.y+=.01,t.sphereSatRotational.rotation.y+=.01,t.cannonWorld.step(1/6);for(let r=0;r<t.cannonBalls.length;r++)t.sceneBalls[r].position.set(t.cannonBalls[r].position.x,t.cannonBalls[r].position.y,t.cannonBalls[r].position.z),t.sceneBalls[r].quaternion.set(t.cannonBalls[r].quaternion.x,t.cannonBalls[r].quaternion.y,t.cannonBalls[r].quaternion.z,t.cannonBalls[r].quaternion.w)}()}initiateCSSObjects(){let t=this,e=["\u{1f64f}","\u{1f47d}","\u{1f608}","\u{1f47b}","\u{1f62e}"],n=["Physics!","Torus Material","Light","Satelite Scale X (tween)","Reset Objects and Move this CSS Element"];for(let c=1;c<=5;c++){var r=document.createElement("div");r.className="element",r.id="elem_"+c,r.addEventListener("click",function(e){switch(this.id){case"elem_1":console.log("ok"),!1===t.bPhysicsOn?(document.getElementById(this.id).className="elementClick",console.log("x: "+t.sphereSatRotational.position.x+", z:"+t.sphereSatRotational.position.z),t.bPhysicsOn=!0,t.cannonWorld.gravity.set(0,-9.81,0)):(document.getElementById(this.id).className="element",t.cannonWorld.gravity.set(0,0,0),t.bPhysicsOn=!1);break;case"elem_2":console.log("component.torus.userData.texture: "+t.torus.userData.texture),t.torus.userData.texture===Tp.GAS_BRIGHT?(t.torus.material=t.getMeshPhongMaterialFromTexture(Tp.GAS_DARK,!0),t.torus.userData.texture=Tp.GAS_DARK,document.getElementById(this.id).className="elementClick"):(t.torus.material=t.getMeshPhongMaterialFromTexture(Tp.GAS_BRIGHT,!0),t.torus.userData.texture=Tp.GAS_BRIGHT,document.getElementById(this.id).className="element");break;case"elem_3":.4===t.directionalLight.intensity?(document.getElementById(this.id).className="elementClick",t.directionalLight.intensity=0):(t.directionalLight.intensity=.4,document.getElementById(this.id).className="element");break;case"elem_4":document.getElementById(this.id).className=1===t.sphereSatRotational.scale.z?"elementClick":"element",console.log(t.sphereSatRotational.scale.z),t.tweenSphereScaleZ=1===t.sphereSatRotational.scale.z?new Pp.Tween({z:1}).to({z:3},1e3):new Pp.Tween({z:3}).to({z:1},1e3),t.tweenSphereScaleZ.onUpdate(function(){t.sphereSatRotational.scale.z=this.z}).start();break;case"elem_5":document.getElementById(this.id).className="elementClick",t.cannonWorld.gravity.set(0,0,0),document.getElementById("elem_1").className="element",t.bPhysicsOn=!1;for(let n=0;n<t.cannonBalls.length;n++)t.cannonBalls[n].velocity.set(0,0,0),t.cannonBalls[n].initVelocity.set(0,0,0),t.tweenPhysicObjects=new Pp.Tween({xPos:t.cannonBalls[n].position.x,yPos:t.cannonBalls[n].position.y,zPos:t.cannonBalls[n].position.z}).to({xPos:t.cannonBallsBodyPosOrigin[n].x,yPos:t.cannonBallsBodyPosOrigin[n].y,zPos:t.cannonBallsBodyPosOrigin[n].z},2e3).onUpdate(function(){t.cannonBalls[n].position=new Np.Vec3(this.xPos,this.yPos,this.zPos)}).start();let e=0===t.sceneCSS.getObjectByName("elem_5").position.z?150:0;t.tweenPhysicCSSElem=new Pp.Tween({zPos:t.sceneCSS.getObjectByName("elem_5").position.z}).to({zPos:e},1e3).onUpdate(function(){t.sceneCSS.getObjectByName("elem_5").position.z=this.zPos}).onComplete(function(){document.getElementById("elem_5").className="element"}).start();break;default:console.log(this.id+" not configured")}},!1);var i=document.createElement("div");i.className="symbol",i.textContent=e[c-1],r.appendChild(i);var o=document.createElement("div");o.className="details",o.innerHTML=5==c?n[c-1]:"Toggle<br>"+n[c-1],r.appendChild(o);let s=new Rp.CSS3DObject(r);s.position.x=-100*c-250,s.position.y=200,s.name="elem_"+c,this.sceneCSS.add(s)}var s=document.createElement("div");s.className="dropdown",s.textContent="Dropdown Menu";var a=document.createElement("div");a.className="dropdown-content",a.textContent="Toggle Particle System Rotation Velocity (Tween)",a.id="idPSystemRotY",s.appendChild(a),a.addEventListener("click",function(e){t.tweenPivotPartSysRotY=0===t.pivotPointPmSystem.userData.rotation_yVel?new Pp.Tween({yVel:0}).to({yVel:.005},3e3):new Pp.Tween({yVel:.005}).to({yVel:0},3e3),t.tweenPivotPartSysRotY.onUpdate(function(){t.pivotPointPmSystem.userData.rotation_yVel=this.yVel}).start(),console.log(t.pivotPointPmSystem.userData.rotation_yVel)},!1);var l=document.createElement("div");l.className="dropdown-content",l.textContent="New Terrain",l.style.fontWeight="bold",a.appendChild(l),l.addEventListener("click",function(e){t.scene.remove(t.terrain),t.initiateTerrain()},!1);var u=new Rp.CSS3DObject(s);u.position.set(-150,240,0),this.sceneCSS.add(u)}initiateParticles(){let t=new _p.Geometry,e=new _p.PointsMaterial({size:1,sizeAttenuation:!0,color:16378467});for(let i=0;i<15e3;i++){var n=360*Math.random(),r=new _p.Vector3(290*Math.cos(n)-30+60*Math.random(),Math.random()-5+15*Math.random(),290*Math.sin(n)-30+60*Math.random());t.vertices.push(r)}this.pmSystem=new _p.Points(t,e),this.scene.add(this.pmSystem),this.pivotPointPmSystem=new _p.Object3D,this.pivotPointPmSystem.userData={rotation_yVel:.001},this.pivotPointPmSystem.add(this.pmSystem),this.scene.add(this.pivotPointPmSystem)}initiateTerrain(){var t=10*Math.random()+10,e=t;let n=-300*t/2,r=300*e/2;var i=Ip.scale([[255*Math.random(),128,128],[0,255*Math.random(),255*Math.random()],[200,200,200]]).domain([1,120]),o=new _p.Geometry;let s=Lp.generatePerlinNoise(300,300);for(var a=0;a<300;a++)for(var l=0;l<300;l++){var u=new _p.Vector3(l*t,120*Math.abs(s[300*a+l]),a*e);o.vertices.push(u)}for(console.log("geometry.vertices[0]: "+JSON.stringify(o.vertices[0])),console.log("geometry.vertices[1]: "+JSON.stringify(o.vertices[1])),a=0;a<299;a++)for(l=0;l<299;l++){var c=l+1+300*a,h=l+300*(a+1),d=l+1+300*(a+1),p=new _p.Face3(c,l+300*a,h),f=new _p.Face3(h,d,c);p.color=new _p.Color(i(this.getHighPoint(o,p)).hex()),f.color=new _p.Color(i(this.getHighPoint(o,f)).hex()),o.faces.push(p),o.faces.push(f)}o.computeVertexNormals(!0),o.computeFaceNormals(),this.terrainMat=new _p.MeshPhongMaterial,this.terrainMat.vertexColors=_p.FaceColors,this.terrain=new _p.Mesh(o,this.terrainMat),this.terrain.position.set(n,-250,r),this.terrain.quaternion.setFromAxisAngle(new _p.Vector3(0,-1,0),-Math.PI/2),this.terrain.receiveShadow=!0,this.scene.add(this.terrain);for(var m=[],g=0;g<300;g++){m.push([]);for(var v=0;v<300;v++){var y=100*Math.abs(s[300*g+v]);m[g].push(y)}}var w=new Np.Heightfield(m,{elementSize:t}),b=new Np.Body({mass:0});b.addShape(w),b.quaternion.setFromAxisAngle(new Np.Vec3(1,0,0),-Math.PI/2),console.log("groundBody.quaternion: "+b.quaternion),b.position.set(n,-250,r),this.cannonWorld.addBody(b)}getHighPoint(t,e){return Math.max(t.vertices[e.a].y,t.vertices[e.b].y,t.vertices[e.c].y)}createCSSRenderer(){this.sceneCSS=new _p.Scene,this.rendererCSS=new Rp.CSS3DRenderer,this.rendererCSS.setSize(window.innerWidth*this.scrSize,window.innerHeight*this.scrSize),this.rendererCSS.domElement.style.position="absolute",this.rendererCSS.domElement.style.zIndex="2",this.htmlDivCanvas.appendChild(this.rendererCSS.domElement)}initPhysicWorld(){this.cannonWorld=new Np.World,this.cannonWorld.quatNormalizeSkip=2,this.cannonWorld.quatNormalizeFast=!0,this.cannonWorld.gravity.set(0,0,0),this.cannonWorld.broadphase=new Np.NaiveBroadphase,this.cannonWorld.solver.iterations=10,this.cannonWorld.defaultContactMaterial.contactEquationRelaxation=.8}onResize(){this.camera.aspect=this.aspRatio,this.camera.updateProjectionMatrix(),console.log(`onResize: Witdh: ${window.innerWidth*this.scrSize}, Height: ${window.innerHeight*this.scrSize}`),this.renderer.setSize(window.innerWidth*this.scrSize,window.innerHeight*this.scrSize),this.rendererCSS.setSize(window.innerWidth*this.scrSize,window.innerHeight*this.scrSize)}}class Dp{get canvas(){return this.canvasRef.nativeElement}constructor(){}ngAfterViewInit(){this.world=new Op(this.canvas,.6)}onResize(){this.world.onResize()}}var Bp=Ar({encapsulation:0,styles:[[""]],data:{}});function Up(t){return fo(0,[io(402653184,1,{canvasRef:0}),(t()(),co(-1,null,["\n"])),(t()(),ni(2,0,null,null,71,"div",[["class","w3-container"]],null,null,null,null,null)),(t()(),co(-1,null,["\n  "])),(t()(),ni(4,0,null,null,31,"header",[],null,null,null,null,null)),(t()(),co(-1,null,["\n    "])),(t()(),ni(6,0,null,null,28,"div",[["class","w3-container "]],null,null,null,null,null)),(t()(),co(-1,null,["\n      "])),(t()(),ni(8,0,null,null,4,"h1",[],null,null,null,null,null)),(t()(),co(-1,null,["\n        "])),(t()(),ni(10,0,null,null,1,"b",[],null,null,null,null,null)),(t()(),co(-1,null,["A Three.js - CSS3d showcase with terrain and physics..."])),(t()(),co(-1,null,["\n      "])),(t()(),co(-1,null,["\n      "])),(t()(),ni(14,0,null,null,1,"b",[],null,null,null,null,null)),(t()(),co(-1,null,["Note: This page is not responsive for mobile screens yet."])),(t()(),ni(16,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,["\n      This canvas contains two scenes from\n      "])),(t()(),ni(18,0,null,null,1,"em",[],null,null,null,null,null)),(t()(),co(-1,null,["THREE.js"])),(t()(),co(-1,null,[" and two renderer elements, a\n      "])),(t()(),ni(21,0,null,null,1,"em",[],null,null,null,null,null)),(t()(),co(-1,null,["WebGLRenderer"])),(t()(),co(-1,null,[" and a\n      "])),(t()(),ni(24,0,null,null,1,"em",[],null,null,null,null,null)),(t()(),co(-1,null,["CSS3DRenderer"])),(t()(),co(-1,null,[".\n      "])),(t()(),ni(27,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,[" The focus is the integration and handling on the CSS 3d in the scene. Features for this showcase are\n      clickable, highlight,\n      moveable css elements. One drop-down menu is integrated.\n      "])),(t()(),ni(29,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,[" Additionally the WebGL scene contains a random generated terrain, light, shadow, camera handling with mouse,\n      physics\n      with collision detection, tween, object scaling, rotation around a (pivot-)point and a simple particle system.\n      Play with the clickable elements and see whats happen.\n      "])),(t()(),ni(31,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,["\n      "])),(t()(),ni(33,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,[" A list of used libraries / packages for this angular controller example:\n    "])),(t()(),co(-1,null,["\n  "])),(t()(),co(-1,null,["\n  "])),(t()(),ni(37,0,null,null,28,"div",[["class","w3-container "]],null,null,null,null,null)),(t()(),co(-1,null,["\n    "])),(t()(),ni(39,0,null,null,25,"code",[],null,null,null,null,null)),(t()(),co(-1,null,["\n      "])),(t()(),ni(41,0,null,null,22,"ul",[],null,null,null,null,null)),(t()(),co(-1,null,["\n        "])),(t()(),ni(43,0,null,null,1,"li",[],null,null,null,null,null)),(t()(),co(-1,null,["Three.js R91 (V0.91.0) / NPM: npm i three / main 3D part"])),(t()(),co(-1,null,["\n        "])),(t()(),ni(46,0,null,null,1,"li",[],null,null,null,null,null)),(t()(),co(-1,null,["CSS3dRenderer (V1.0.1) / NPM: npm i three-css3drenderer / CSS part"])),(t()(),co(-1,null,["\n        "])),(t()(),ni(49,0,null,null,1,"li",[],null,null,null,null,null)),(t()(),co(-1,null,["Trackball controls (V0.0.7) / NPM: npm i three-trackballcontrols / Camera control with mouse"])),(t()(),co(-1,null,["\n        "])),(t()(),ni(52,0,null,null,1,"li",[],null,null,null,null,null)),(t()(),co(-1,null,["Tween (V16.6.0) / NPM: npm i @tweenjs/tween.js / Soft moving objects"])),(t()(),co(-1,null,["\n        "])),(t()(),ni(55,0,null,null,1,"li",[],null,null,null,null,null)),(t()(),co(-1,null,["Cannon (V0.6.1) / NPM: npm i cannon / Physics"])),(t()(),co(-1,null,["\n        "])),(t()(),ni(58,0,null,null,1,"li",[],null,null,null,null,null)),(t()(),co(-1,null,["Perlin Noise (V0.0.1) / NPM: npm i perlin-noise / Noise for terrain"])),(t()(),co(-1,null,["\n        "])),(t()(),ni(61,0,null,null,1,"li",[],null,null,null,null,null)),(t()(),co(-1,null,["Chroma (V1.3.7) / NPM: npm i chroma-js / Color scaling for heightfield"])),(t()(),co(-1,null,["\n      "])),(t()(),co(-1,null,["\n    "])),(t()(),co(-1,null,["\n  "])),(t()(),co(-1,null,["\n  "])),(t()(),co(-1,null,["\n  "])),(t()(),co(-1,null,["\n  "])),(t()(),ni(69,0,null,null,3,"div",[["class","w3-container"]],null,null,null,null,null)),(t()(),co(-1,null,["\n    "])),(t()(),ni(71,0,[[1,0],["canvasCSS3d",1]],null,0,"div",[],null,[["window","resize"]],function(t,e,n){var r=!0;return"window:resize"===e&&(r=!1!==t.component.onResize()&&r),r},null,null)),(t()(),co(-1,null,["\n  "])),(t()(),co(-1,null,["\n"]))],null,null)}var zp=wi("app-css3d-threejs",Dp,function(t){return fo(0,[(t()(),ni(0,0,null,null,1,"app-css3d-threejs",[],null,null,null,Up,Bp)),Gi(1,4243456,null,0,Dp,[],null,null)],null,null)},{},{},[]),Fp=n("b0Xh"),kp=function(t){return t[t.RANDOM=0]="RANDOM",t[t.GRID=1]="GRID",t[t.CUBE=2]="CUBE",t[t.TUBE=3]="TUBE",t}({}),Vp=function(t){return t[t.FILE_NAME=0]="FILE_NAME",t[t.IMG_SIZE_NATURAL=1]="IMG_SIZE_NATURAL",t[t.IMG_SIZE_CLIENT=2]="IMG_SIZE_CLIENT",t[t.DATE_TIME_ORIGINAL=3]="DATE_TIME_ORIGINAL",t}({});const Gp=1e3,jp=1e3,Hp=0,Wp=50;class qp{constructor(t,e){this.scrProp={},this.oGrid=new _p.Object3D,this.iImgCols=4,this.htmlImageDetailMenu={},this.arrV3ImgPositions=[],this.arrHtmlDetailMenuPropNames=["Name:","Image size (natural):","Image size (in canvas):","Date time original:"],console.log("ctor Img3D"),this.nImagesLoaded=0,this.eArrangement=kp.GRID,this.htmlDivCanvas=t,this.scrProp.aspRatio=window.innerWidth*e/(window.innerHeight*e),console.log("aspRatio: "+this.scrProp.aspRatio),this.scrProp.scrSize=e,this.initiateCamera(),this.sceneWebGL=new _p.Scene,this.sceneCSS=new _p.Scene,this.initiateCompleteScene(),this.createRendererCSS(),this.createRendererWebGL(),this.initTrackballControls(),this.rendererWebGL.render(this.sceneWebGL,this.camera),this.rendererCSS.render(this.sceneCSS,this.camera),this.adjustCamera(),this.animate()}setKeyPressed(t){this.keyPressed=t}getArrangement(){return this.eArrangement}setArrangement(t){this.eArrangement=t}getImageGridColumns(){return this.iImgCols}initiateCamera(){this.camera=new _p.PerspectiveCamera(70,this.scrProp.aspRatio,1,1e4),this.camera.position.set(0,0,0)}createRendererWebGL(){this.rendererWebGL=new _p.WebGLRenderer({antialias:!0,alpha:!1}),this.rendererWebGL.setPixelRatio(window.devicePixelRatio),this.rendererWebGL.setClearColor(0,1),this.rendererWebGL.setSize(window.innerWidth*this.scrProp.scrSize,window.innerHeight*this.scrProp.scrSize),this.rendererWebGL.domElement.style.position="absolute",this.rendererWebGL.domElement.style.zIndex="1",this.htmlDivCanvas.appendChild(this.rendererWebGL.domElement)}createRendererCSS(){this.rendererCSS=new Rp.CSS3DRenderer,this.rendererCSS.setSize(window.innerWidth*this.scrProp.scrSize,window.innerHeight*this.scrProp.scrSize),this.rendererCSS.domElement.style.position="absolute",this.rendererCSS.domElement.style.zIndex="2",this.htmlDivCanvas.appendChild(this.rendererCSS.domElement)}initiateCompleteScene(){this.loadImageScene(!0,!1,this.eArrangement),this.loadLineGrid(),this.showGrid(!1),this.htmlImageDetailMenu.table_div=document.createElement("div"),this.htmlImageDetailMenu.table_div.className="detailMenu w3-container";for(let t=0;t<this.arrHtmlDetailMenuPropNames.length;t++){const e=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div"),i=document.createElement("p");switch(e.className="w3-row w3-container",n.className="w3-col s5 ",r.className="w3-col s7 ",i.textContent=this.arrHtmlDetailMenuPropNames[t],n.appendChild(i),e.appendChild(n),t){case Vp.FILE_NAME:this.htmlImageDetailMenu.value_file_name=document.createElement("p"),r.appendChild(this.htmlImageDetailMenu.value_file_name);break;case Vp.IMG_SIZE_CLIENT:this.htmlImageDetailMenu.value_img_size_client=document.createElement("p"),r.appendChild(this.htmlImageDetailMenu.value_img_size_client);break;case Vp.IMG_SIZE_NATURAL:this.htmlImageDetailMenu.value_img_size_natural=document.createElement("p"),r.appendChild(this.htmlImageDetailMenu.value_img_size_natural);break;case Vp.DATE_TIME_ORIGINAL:this.htmlImageDetailMenu.value_date_time_original=document.createElement("p"),r.appendChild(this.htmlImageDetailMenu.value_date_time_original)}e.appendChild(r),this.htmlImageDetailMenu.table_div.appendChild(e)}this.htmlImageDetailMenuObj=new Rp.CSS3DObject(this.htmlImageDetailMenu.table_div),this.htmlImageDetailMenuObj.Name="htmlImageDetailMenuObj",this.sceneCSS.add(this.htmlImageDetailMenuObj)}adjustCamera(){const t=this.camera,e=this.controls.target;switch(this.tweenCameraPos=new Pp.Tween({x:t.position.x,y:t.position.y,z:t.position.z}),this.tweenCameraTrgt=new Pp.Tween({x:e.x,y:e.y,z:e.z}),this.eArrangement){case kp.RANDOM:this.tweenCameraTrgt.to({x:1e3,y:0,z:0},1e3),this.tweenCameraPos.to({x:500,y:500,z:3e3},2e3);break;case kp.GRID:this.tweenCameraTrgt.to({x:2e3,y:-800,z:0},1e3),this.tweenCameraPos.to({x:1700,y:-400,z:3500},2e3);break;default:console.log(`case '${this.eArrangement}' in adjustCamera() not implemented.`)}this.tweenCameraPos.easing(Pp.Easing.Quadratic.Out).onUpdate(function(){t.position.set(this.x,this.y,this.z)}).start(),this.tweenCameraTrgt.easing(Pp.Easing.Quadratic.Out).onUpdate(function(){e.x=this.x,e.y=this.y,e.z=this.z}).start()}loadImageScene(t,e,n){const r=this.sceneCSS,i=this;if(!0===t){let t=0,o=0;this.nImagesLoaded=!0===e?46:7;for(let e=1;e<=this.nImagesLoaded;e++){const s=new Image;s.src="assets/galleries/example ("+e+").jpg",s.onload=function(){const e=document.createElement("div");e.className="galImg";const s=document.createElement("img");s.src=this.src;let a=Number(this.width),l=Number(this.height);const u=l>a?l:a;if(u>jp){const t=100/u*jp;a=Math.floor(a*t/100),l=Math.floor(l*t/100)}s.width=a,s.height=l,e.addEventListener("click",function(t){console.log("this: "+JSON.stringify(this.firstChild.src))},!1),e.addEventListener("mouseover",function(t){const e=this.firstChild;i.htmlImageDetailMenuObj.position.x=i.camera.position.x+400,i.htmlImageDetailMenuObj.position.y=i.camera.position.y-200,i.htmlImageDetailMenuObj.position.z=i.camera.position.z-600,i.htmlImageDetailMenu.table_div.style.visibility="visible",i.htmlImageDetailMenu.value_file_name.textContent=e.src.substr(e.src.lastIndexOf("/")+1),i.htmlImageDetailMenu.value_img_size_client.textContent=`(H x B)\n                         ${e.clientHeight} px X ${e.clientWidth} px`,Fp.getData(e,function(){i.htmlImageDetailMenu.value_img_size_natural.textContent=`${Fp.getTag(this,"PixelYDimension")} x ${Fp.getTag(this,"PixelXDimension")} px`,i.htmlImageDetailMenu.value_date_time_original.textContent=`${Fp.getTag(this,"DateTimeOriginal")}`})},!1),e.addEventListener("mouseout",function(t){i.htmlImageDetailMenu.table_div.style.visibility="hidden"},!1),e.appendChild(s);const c=new Rp.CSS3DObject(e);switch(n){case kp.RANDOM:c.position.y=3e3*Math.random(),c.position.z=6500*Math.random()-6e3,c.position.x=5e3*Math.random()-1e3,i.arrV3ImgPositions.push(c.position);break;case kp.GRID:c.position.x=t*(Gp+2*Wp)+Gp/2+Wp,c.position.y=-o*(jp+2*Wp)-jp/2-Wp,c.position.z=0,++t%i.iImgCols==0&&(t=0,o++)}r.add(c),console.log("CSS img added: "+s.src)}}}}arrangeImageScene(){let t=0,e=0;console.log("image arrangement: E_ARRANGEMENT."+this.eArrangement),console.log("this.sceneCSS.children.length: "+this.sceneCSS.children.length);for(const n of this.sceneCSS.children){const r=new Pp.Tween({x:n.position.x,y:n.position.y,z:n.position.z});switch(this.eArrangement){case kp.RANDOM:r.to({x:3e3*Math.random(),y:4e3*Math.random()-2e3,z:5e3*Math.random()-5e3},4e3);break;case kp.GRID:r.to({x:t*(Gp+2*Wp)+Gp/2+Wp,y:-e*(jp+2*Wp)-jp/2-Wp,z:0},4e3),++t%this.iImgCols==0&&(t=0,e++)}r.easing(Pp.Easing.Quadratic.Out).onUpdate(function(){n.position.set(this.x,this.y,this.z)}).start()}this.adjustCamera()}loadLineGrid(){let t;const e=new _p.LineBasicMaterial({color:60928,linewidth:5});let n;switch(this.eArrangement){case kp.RANDOM:break;case kp.GRID:const r=Math.ceil(this.nImagesLoaded/this.iImgCols)+1;for(let o=0;o<r;o++)(t=new _p.Geometry).vertices.push(new _p.Vector3(0,-o*(jp+2*Wp),0)),t.vertices.push(new _p.Vector3((Gp+2*Wp)*this.iImgCols,-o*(jp+2*Wp),0)),n=new _p.Line(t,e),this.oGrid.add(n);const i=this.iImgCols+1;for(let o=0;o<i;o++)(t=new _p.Geometry).vertices.push(new _p.Vector3(o*(Gp+2*Wp),0,0)),t.vertices.push(new _p.Vector3(o*(Gp+2*Wp),-(jp+2*Wp)*(r-1),0)),n=new _p.Line(t,e),this.oGrid.add(n);this.oGrid.position.set(Hp,-Hp,0),this.sceneWebGL.add(this.oGrid)}}animate(){const t=this;!function e(n){requestAnimationFrame(e),t.updateKeyPressed(),t.controls.update(),t.rendererCSS.render(t.sceneCSS,t.camera),t.rendererWebGL.render(t.sceneWebGL,t.camera),Pp.update(n)}()}getClassName(){return"TestClassName"}addHelpers(){const t=new _p.AxesHelper(100);this.sceneWebGL.add(t);const e=new _p.GridHelper(1e4,10);e.rotateX(_p.Math.degToRad(90)),this.sceneWebGL.add(e);const n=new _p.GridHelper(1e4,10);n.rotateX(_p.Math.degToRad(180)),this.sceneWebGL.add(n)}initTrackballControls(){this.controls=new Ap(this.camera,this.rendererCSS.domElement),this.controls.rotateSpeed=3,this.controls.dynamicDampingFactor=.5,this.controls.noPitch=!0,this.controls.noYaw=!1,this.controls.minDistance=1,this.controls.maxDistance=1e4}updateKeyPressed(){switch(this.keyPressed){case"ArrowUp":this.camera.position.set(this.camera.position.x,this.camera.position.y+=40,this.camera.position.z),this.controls.target.y+=40;break;case"ArrowDown":this.camera.position.set(this.camera.position.x,this.camera.position.y-=40,this.camera.position.z),this.controls.target.y-=40}}onResize(){this.camera.aspect=this.scrProp.aspRatio,this.camera.updateProjectionMatrix(),console.log(`onResize: Witdh: ${window.innerWidth*this.scrProp.scrSize}, Height: ${window.innerHeight*this.scrProp.scrSize}`),this.rendererCSS.setSize(window.innerWidth*this.scrProp.scrSize,window.innerHeight*this.scrProp.scrSize),this.rendererWebGL.setSize(window.innerWidth*this.scrProp.scrSize,window.innerHeight*this.scrProp.scrSize)}removeImgObj(){const t=this.htmlImageDetailMenuObj;for(;this.sceneCSS.children.length;)this.sceneCSS.remove(this.sceneCSS.children[0]);this.sceneCSS.add(t)}removeGrid(){this.sceneWebGL.remove(this.sceneWebGL.getObjectById(this.oGrid.id)),this.oGrid=new _p.Object3D}showGrid(t){this.oGrid.visible=t,console.log(`Show grid: ${t}`)}toggleCamYawCtrl(t){console.log(`YAW: ${!t}`),this.controls.noYaw=!t}toggleCamPitchCtrl(t){console.log(`PITCH: ${!t}`),this.controls.noPitch=!t}setNewGridColSize(t){this.iImgCols=t}}class Xp{constructor(){this.eArrgmt=kp,this.bShowGrid=!1}onKeyUp(t){this.webGl.setKeyPressed("none")}onKeyDown(t){this.webGl.setKeyPressed(t.key)}ngAfterViewInit(){this.webGl=new qp(this.canvasRef.nativeElement,.8),this.btnGrid_Ref.nativeElement.focus(),console.log("OK")}get canvas(){return this.canvasRef.nativeElement}onResize(){this.webGl.onResize()}filesPicked(t){for(let e=0;e<t.length;e++){const n=t[e].webkitRelativePath.split("/");console.log("file "+e+": "+n)}this.webGl.removeImgObj()}arrangeGallery(t){console.log(`switch from ${this.webGl.getArrangement()} to: ${t}`),t===this.webGl.getArrangement()&&t!==kp.RANDOM||(this.webGl.setArrangement(t),this.webGl.arrangeImageScene(),this.webGl.removeGrid(),this.webGl.loadLineGrid(),this.toggleShowGrid(this.bShowGrid)),t===kp.RANDOM?(this.spnShowGrid_Ref.nativeElement.style.display="none",this.spnRangeGridCols_Ref.nativeElement.style.display="none"):(this.spnShowGrid_Ref.nativeElement.style.display="initial",this.spnRangeGridCols_Ref.nativeElement.style.display="initial")}arrangeDefault(t){console.log(t)}toggleLoadFullDefGal(t){this.webGl.removeImgObj(),this.webGl.loadImageScene(!0,t,this.webGl.getArrangement()),this.webGl.removeGrid(),this.webGl.loadLineGrid(),this.toggleShowGrid(this.bShowGrid)}toggleShowGrid(t){this.webGl.showGrid(t),this.bShowGrid=t}toggleCamYawCtrl(t){this.webGl.toggleCamYawCtrl(t)}toggleCamPitchCtrl(t){this.webGl.toggleCamPitchCtrl(t)}changeSldNumOfCols(t){this.webGl.setNewGridColSize(Number(t)),this.webGl.arrangeImageScene(),this.webGl.removeGrid(),this.webGl.loadLineGrid(),this.webGl.showGrid(this.bShowGrid)}resetPerspective(){}onKey(t){console.log("Pressing Key: "+t.which)}}var Yp=Ar({encapsulation:0,styles:[[""]],data:{}});function Zp(t){return fo(0,[io(402653184,1,{canvasRef:0}),io(402653184,2,{btnGrid_Ref:0}),io(402653184,3,{spnShowGrid_Ref:0}),io(402653184,4,{spnRangeGridCols_Ref:0}),(t()(),co(-1,null,["\n"])),(t()(),ni(5,0,null,null,102,"div",[["class","w3-container"]],null,null,null,null,null)),(t()(),co(-1,null,["\n  "])),(t()(),ni(7,0,null,null,33,"header",[],null,null,null,null,null)),(t()(),co(-1,null,["\n    "])),(t()(),ni(9,0,null,null,30,"div",[["class","w3-container "]],null,null,null,null,null)),(t()(),co(-1,null,["\n      "])),(t()(),ni(11,0,null,null,4,"h1",[],null,null,null,null,null)),(t()(),co(-1,null,["\n        "])),(t()(),ni(13,0,null,null,1,"b",[],null,null,null,null,null)),(t()(),co(-1,null,["A Three.js - CSS3d showcase for an image gallery..."])),(t()(),co(-1,null,["\n      "])),(t()(),co(-1,null,["\n      "])),(t()(),ni(17,0,null,null,1,"b",[],null,null,null,null,null)),(t()(),co(-1,null,["Note: This page is not responsive for mobile screens yet."])),(t()(),ni(19,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,["\n      Here you see an image gallery based on css3d. The photos you see are from the default "])),(t()(),ni(21,0,null,null,1,"em",[],null,null,null,null,null)),(t()(),co(-1,null,["assets/galleries"])),(t()(),co(-1,null,["\n      folder."])),(t()(),ni(24,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,["\n      Above the canvas you can download the full gallery, if you want. On the top left within the canvas you have\n      options for each arrangement."])),(t()(),ni(26,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,["\n      Hovering (in front of camera) on image show few Exif information."])),(t()(),ni(28,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,["\n      "])),(t()(),co(-1,null,["\n      On the left in the menu you can choose an arrangement of the images. Below that you find some gloabl options."])),(t()(),ni(31,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,["\n      "])),(t()(),ni(33,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,["\n      "])),(t()(),ni(35,0,null,null,1,"em",[],null,null,null,null,null)),(t()(),co(-1,null,["... implementation not finished yet."])),(t()(),co(-1,null,["\n      "])),(t()(),ni(38,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,["\n    "])),(t()(),co(-1,null,["\n  "])),(t()(),co(-1,null,["\n  "])),(t()(),ni(42,0,null,null,64,"div",[["class","w3-container"]],null,null,null,null,null)),(t()(),co(-1,null,["\n    "])),(t()(),co(-1,null,["\n    "])),(t()(),co(-1,null,["\n\n    "])),(t()(),ni(46,0,null,null,3,"p",[],null,null,null,null,null)),(t()(),co(-1,null,[" Download Full Gallery (~25 MB):\n      "])),(t()(),ni(48,0,[["id_tglFullDefGal",1]],null,0,"input",[["type","checkbox"]],null,[[null,"change"]],function(t,e,n){var r=!0;return"change"===e&&(r=!1!==t.component.toggleLoadFullDefGal(Pi(t,48).checked)&&r),r},null,null)),(t()(),co(-1,null,["\n    "])),(t()(),co(-1,null,["\n\n\n    "])),(t()(),co(-1,null,["\n    "])),(t()(),ni(52,0,null,null,28,"div",[["class","imgMainMenu"]],null,null,null,null,null)),(t()(),co(-1,null,["\n      "])),(t()(),ni(54,0,null,null,1,"p",[["id","menuTitle"]],null,null,null,null,null)),(t()(),co(-1,null,["Choose arrangement:"])),(t()(),co(-1,null,["\n      "])),(t()(),ni(57,0,[[2,0],["btnGrid",1]],null,1,"button",[["class","menuMainElement"]],null,[[null,"click"]],function(t,e,n){var r=!0,i=t.component;return"click"===e&&(r=!1!==i.arrangeGallery(i.eArrgmt.GRID)&&r),r},null,null)),(t()(),co(-1,null,["Grid"])),(t()(),ni(59,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,["\n      "])),(t()(),co(-1,null,["\n      "])),(t()(),co(-1,null,["\n      "])),(t()(),ni(63,0,null,null,1,"button",[["class","menuMainElement"]],null,[[null,"click"]],function(t,e,n){var r=!0,i=t.component;return"click"===e&&(r=!1!==i.arrangeGallery(i.eArrgmt.RANDOM)&&r),r},null,null)),(t()(),co(-1,null,["Random"])),(t()(),ni(65,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,["\n      "])),(t()(),ni(67,0,null,null,1,"p",[["id","menuTitle"]],null,null,null,null,null)),(t()(),co(-1,null,["Global settings:"])),(t()(),co(-1,null,["\n      "])),(t()(),ni(70,0,null,null,2,"span",[["class","menuMainElement menuChkBx"]],null,null,null,null,null)),(t()(),ni(71,0,[["id_tglCamYawCtrl",1]],null,0,"input",[["checked",""],["type","checkbox"]],null,[[null,"change"]],function(t,e,n){var r=!0;return"change"===e&&(r=!1!==t.component.toggleCamYawCtrl(Pi(t,71).checked)&&r),r},null,null)),(t()(),co(-1,null,[" Cam yaw control"])),(t()(),ni(73,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,["\n      "])),(t()(),ni(75,0,null,null,2,"span",[["class","menuMainElement menuChkBx"]],null,null,null,null,null)),(t()(),ni(76,0,[["id_tglCamPitchCtrl",1]],null,0,"input",[["type","checkbox"],["unchecked",""]],null,[[null,"change"]],function(t,e,n){var r=!0;return"change"===e&&(r=!1!==t.component.toggleCamPitchCtrl(Pi(t,76).checked)&&r),r},null,null)),(t()(),co(-1,null,[" Cam pitch control"])),(t()(),ni(78,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,["\n      "])),(t()(),co(-1,null,["\n    "])),(t()(),co(-1,null,["\n\n    "])),(t()(),co(-1,null,["\n    "])),(t()(),ni(83,0,null,null,19,"div",[["class","imgSubMenu"]],null,null,null,null,null)),(t()(),co(-1,null,["\n      "])),(t()(),ni(85,0,null,null,1,"p",[["id","menuTitle"]],null,null,null,null,null)),(t()(),co(-1,null,["Arrangement options:"])),(t()(),co(-1,null,["\n      "])),(t()(),co(-1,null,["\n      "])),(t()(),co(-1,null,["\n      "])),(t()(),co(-1,null,["\n      "])),(t()(),ni(91,0,[[3,0],["id_spnShowGrid",1]],null,3,"p",[["class","menuSubElement"]],null,null,null,null,null)),(t()(),co(-1,null,["\n        "])),(t()(),ni(93,0,[["id_tglShowGrid",1]],null,0,"input",[["type","checkbox"],["unchecked",""]],null,[[null,"change"]],function(t,e,n){var r=!0;return"change"===e&&(r=!1!==t.component.toggleShowGrid(Pi(t,93).checked)&&r),r},null,null)),(t()(),co(-1,null,["\n        Show Line Grid\n      "])),(t()(),co(-1,null,["\n      "])),(t()(),ni(96,0,[[4,0],["id_spnRangeGridCols",1]],null,5,"p",[["class","menuSubElement"],["style","color: rgba(146, 255, 127, 0.75);"]],null,null,null,null,null)),(t()(),co(97,null,["No. of columns: ",""])),(t()(),ni(98,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),co(-1,null,["\n        "])),(t()(),ni(100,0,[["id_sldRangeGridCols",1]],null,0,"input",[["class","slider"],["max","10"],["min","1"],["type","range"],["value","4"]],null,[[null,"change"]],function(t,e,n){var r=!0;return"change"===e&&(r=!1!==t.component.changeSldNumOfCols(Pi(t,100).value)&&r),r},null,null)),(t()(),co(-1,null,["\n      "])),(t()(),co(-1,null,["\n    "])),(t()(),co(-1,null,["\n\n    "])),(t()(),co(-1,null,["\n    "])),(t()(),ni(105,0,[[1,0],["canvasImgGal",1]],null,0,"div",[["id","canvasImgGal"]],null,[["window","resize"],[null,"keyup"]],function(t,e,n){var r=!0,i=t.component;return"window:resize"===e&&(r=!1!==i.onResize()&&r),"keyup"===e&&(r=!1!==i.onKey(n)&&r),r},null,null)),(t()(),co(-1,null,["\n  "])),(t()(),co(-1,null,["\n\n\n\n"]))],null,function(t,e){t(e,97,0,Pi(e,100).value)})}var $p=wi("app-img-gallery",Xp,function(t){return fo(0,[(t()(),ni(0,0,null,null,1,"app-img-gallery",[],null,[["document","keyup"],["document","keydown"]],function(t,e,n){var r=!0;return"document:keyup"===e&&(r=!1!==Pi(t,1).onKeyUp(n)&&r),"document:keydown"===e&&(r=!1!==Pi(t,1).onKeyDown(n)&&r),r},Zp,Yp)),Gi(1,4243456,null,0,Xp,[],null,null)],null,null)},{},{},[]),Qp=Ar({encapsulation:0,styles:[[""]],data:{}});function Jp(t){return fo(0,[(t()(),ni(0,0,null,null,28,"div",[["class","w3-sidebar w3-bar-block w3-black w3-top"],["style","z-index:3;width:10%;"]],null,null,null,null,null)),(t()(),co(-1,null,["\n  "])),(t()(),ni(2,0,null,null,6,"div",[["class","w3-container w3-display-container w3-padding-16"]],null,null,null,null,null)),(t()(),co(-1,null,["\n    "])),(t()(),ni(4,0,null,null,3,"h3",[],null,null,null,null,null)),(t()(),co(-1,null,["\n      "])),(t()(),ni(6,0,null,null,0,"b",[],null,null,null,null,null)),(t()(),co(-1,null,["\n    "])),(t()(),co(-1,null,["\n  "])),(t()(),co(-1,null,["\n  "])),(t()(),ni(10,0,null,null,17,"code",[],null,null,null,null,null)),(t()(),co(-1,null,["\n    "])),(t()(),ni(12,0,null,null,2,"a",[["class","w3-bar-item w3-button"],["routerLink",""]],[[1,"target",0],[8,"href",4]],[[null,"click"]],function(t,e,n){var r=!0;return"click"===e&&(r=!1!==Pi(t,13).onClick(n.button,n.ctrlKey,n.metaKey,n.shiftKey)&&r),r},null,null)),Gi(13,671744,null,0,Dh,[Ih,Xc,Ts],{routerLink:[0,"routerLink"]},null),(t()(),co(-1,null,["About"])),(t()(),co(-1,null,["\n    "])),(t()(),ni(16,0,null,null,2,"a",[["class","w3-bar-item w3-button"],["routerLink","img-gallery"]],[[1,"target",0],[8,"href",4]],[[null,"click"]],function(t,e,n){var r=!0;return"click"===e&&(r=!1!==Pi(t,17).onClick(n.button,n.ctrlKey,n.metaKey,n.shiftKey)&&r),r},null,null)),Gi(17,671744,null,0,Dh,[Ih,Xc,Ts],{routerLink:[0,"routerLink"]},null),(t()(),co(-1,null,["Image Gallery - Three.js"])),(t()(),co(-1,null,["\n    "])),(t()(),ni(20,0,null,null,2,"a",[["class","w3-bar-item w3-button"],["routerLink","css3d-threejs"]],[[1,"target",0],[8,"href",4]],[[null,"click"]],function(t,e,n){var r=!0;return"click"===e&&(r=!1!==Pi(t,21).onClick(n.button,n.ctrlKey,n.metaKey,n.shiftKey)&&r),r},null,null)),Gi(21,671744,null,0,Dh,[Ih,Xc,Ts],{routerLink:[0,"routerLink"]},null),(t()(),co(-1,null,["CSS3D - Three.js"])),(t()(),co(-1,null,["\n    "])),(t()(),ni(24,0,null,null,2,"a",[["class","w3-bar-item w3-button"],["routerLink","cube-threejs"]],[[1,"target",0],[8,"href",4]],[[null,"click"]],function(t,e,n){var r=!0;return"click"===e&&(r=!1!==Pi(t,25).onClick(n.button,n.ctrlKey,n.metaKey,n.shiftKey)&&r),r},null,null)),Gi(25,671744,null,0,Dh,[Ih,Xc,Ts],{routerLink:[0,"routerLink"]},null),(t()(),co(-1,null,["Cube - Three.js"])),(t()(),co(-1,null,["\n  "])),(t()(),co(-1,null,["\n"])),(t()(),co(-1,null,["\n\n\n"])),(t()(),ni(30,0,null,null,4,"div",[["style","margin-left:10%;"]],null,null,null,null,null)),(t()(),co(-1,null,["\n  "])),(t()(),ni(32,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),Gi(33,212992,null,0,Fh,[zh,Dn,Ge,[8,null],Bn],null,null),(t()(),co(-1,null,["\n"]))],function(t,e){t(e,13,0,""),t(e,17,0,"img-gallery"),t(e,21,0,"css3d-threejs"),t(e,25,0,"cube-threejs"),t(e,33,0)},function(t,e){t(e,12,0,Pi(e,13).target,Pi(e,13).href),t(e,16,0,Pi(e,17).target,Pi(e,17).href),t(e,20,0,Pi(e,21).target,Pi(e,21).href),t(e,24,0,Pi(e,25).target,Pi(e,25).href)})}var Kp=wi("app-root",Es,function(t){return fo(0,[(t()(),ni(0,0,null,null,1,"app-root",[],null,null,null,Jp,Qp)),Gi(1,49152,null,0,Es,[],null,null)],null,null)},{},{},[]);class tf{}var ef=function(t,e,n){return new class extends qe{constructor(t,e,n){super(),this.moduleType=t,this._bootstrapComponents=e,this._ngModuleDefFactory=n}create(t){!function(){if(Bo)return;Bo=!0;const t=fn()?{setCurrentNode:is,createRootView:zo,createEmbeddedView:ko,createComponentView:Vo,createNgModuleRef:Go,overrideProvider:Wo,overrideComponentView:qo,clearOverrides:Xo,checkAndUpdateView:Qo,checkNoChangesView:Jo,destroyView:Ko,createDebugContext:(t,e)=>new ms(t,e),handleEvent:os,updateDirectives:ss,updateRenderer:as}:{setCurrentNode:()=>{},createRootView:Uo,createEmbeddedView:vo,createComponentView:wo,createNgModuleRef:Ni,overrideProvider:Er,overrideComponentView:Er,clearOverrides:Er,checkAndUpdateView:So,checkNoChangesView:Eo,destroyView:Ro,createDebugContext:(t,e)=>new ms(t,e),handleEvent:(t,e,n,r)=>t.def.handleEvent(t,e,n,r),updateDirectives:(t,e)=>t.def.updateDirectives(0===e?Zo:$o,t),updateRenderer:(t,e)=>t.def.updateRenderer(0===e?Zo:$o,t)};wr.setCurrentNode=t.setCurrentNode,wr.createRootView=t.createRootView,wr.createEmbeddedView=t.createEmbeddedView,wr.createComponentView=t.createComponentView,wr.createNgModuleRef=t.createNgModuleRef,wr.overrideProvider=t.overrideProvider,wr.overrideComponentView=t.overrideComponentView,wr.clearOverrides=t.clearOverrides,wr.checkAndUpdateView=t.checkAndUpdateView,wr.checkNoChangesView=t.checkNoChangesView,wr.destroyView=t.destroyView,wr.resolveDep=Ji,wr.createDebugContext=t.createDebugContext,wr.handleEvent=t.handleEvent,wr.updateDirectives=t.updateDirectives,wr.updateRenderer=t.updateRenderer,wr.dirtyParentQueries=oo}();const e=Xr(this._ngModuleDefFactory);return wr.createNgModuleRef(this.moduleType,t||Lt.NULL,this._bootstrapComponents,e)}}(_s,[Es],function(t){return function(t){const e={};for(let n=0;n<t.length;n++){const r=t[n];r.index=n,e[Mr(r.token)]=r}return{factory:null,providersByKey:e,providers:t}}([ci(512,Ge,je,[[8,[ld,Cp,zp,$p,Kp]],[3,Ge],We]),ci(5120,or,lr,[[3,or]]),ci(4608,Bs,Us,[or,[2,Ds]]),ci(5120,Ae,Re,[]),ci(5120,Jn,sr,[]),ci(5120,Kn,ar,[]),ci(4608,_u,Eu,[na]),ci(6144,hr,null,[_u]),ci(4608,Wl,ql,[]),ci(5120,yl,function(t,e,n,r,i){return[new class extends bl{constructor(t,e){super(t),this.ngZone=e,this.patchEvent()}patchEvent(){if(!Event||!Event.prototype)return;if(Event.prototype.__zone_symbol__stopImmediatePropagation)return;const t=Event.prototype.__zone_symbol__stopImmediatePropagation=Event.prototype.stopImmediatePropagation;Event.prototype.stopImmediatePropagation=function(){this&&(this[Fl]=!0),t&&t.apply(this,arguments)}}supports(t){return!0}addEventListener(t,e,n){let r=n;if(!t[Bl]||Ke.isInAngularZone()&&!Gl(e))t.addEventListener(e,r,!1);else{let n=zl[e];n||(n=zl[e]=Dl("ANGULAR"+e+"FALSE"));let i=t[n];const o=i&&i.length>0;i||(i=t[n]=[]);const s=Gl(e)?Zone.root:Zone.current;if(0===i.length)i.push({zone:s,handler:r});else{let t=!1;for(let e=0;e<i.length;e++)if(i[e].handler===r){t=!0;break}t||i.push({zone:s,handler:r})}o||t[Bl](e,jl,!1)}return()=>this.removeEventListener(t,e,r)}removeEventListener(t,e,n){let r=t[Ul];if(!r)return t.removeEventListener.apply(t,[e,n,!1]);let i=zl[e],o=i&&t[i];if(!o)return t.removeEventListener.apply(t,[e,n,!1]);let s=!1;for(let a=0;a<o.length;a++)if(o[a].handler===n){s=!0,o.splice(a,1);break}s?0===o.length&&r.apply(t,[e,jl,!1]):t.removeEventListener.apply(t,[e,n,!1])}}(t,e),new Zl(n),new class extends bl{constructor(t,e){super(t),this._config=e}supports(t){if(!Hl.hasOwnProperty(t.toLowerCase())&&!this.isCustomEvent(t))return!1;if(!window.Hammer)throw new Error(`Hammer.js is not loaded, can not bind ${t} event`);return!0}addEventListener(t,e,n){const r=this.manager.getZone();return e=e.toLowerCase(),r.runOutsideAngular(()=>{const i=this._config.buildHammer(t),o=function(t){r.runGuarded(function(){n(t)})};return i.on(e,o),()=>i.off(e,o)})}isCustomEvent(t){return this._config.events.indexOf(t)>-1}}(r,i)]},[na,Ke,na,na,Wl]),ci(4608,wl,wl,[yl,Ke]),ci(135680,_l,_l,[na]),ci(4608,Rl,Rl,[wl,_l]),ci(6144,_n,null,[Rl]),ci(6144,xl,null,[_l]),ci(4608,an,an,[Ke]),ci(4608,cl,cl,[na]),ci(4608,fl,fl,[na]),ci(5120,Xc,td,[Ih]),ci(4608,jh,jh,[]),ci(6144,Vh,null,[jh]),ci(135680,Hh,Hh,[Ih,Tn,Be,Lt,Vh]),ci(4608,Gh,Gh,[]),ci(5120,id,rd,[ed]),ci(5120,Ne,function(t){return[t]},[id]),ci(4608,Rd,Rd,[]),ci(512,ea,ea,[]),ci(1024,Kt,Lu,[]),ci(1024,mn,function(){return[Yh()]},[]),ci(512,ed,ed,[Lt]),ci(1024,Te,function(t,e){return[function(t){return ml("probe",vl),ml("coreTokens",Object.assign({},gl,(t||[]).reduce((t,e)=>(t[e.name]=e.token,t),{}))),()=>vl}(t),nd(e)]},[[2,mn],ed]),ci(512,Ce,Ce,[[2,Te]]),ci(131584,bn,bn,[Ke,Oe,Lt,Kt,Ge,Ce]),ci(512,ur,ur,[bn]),ci(512,Iu,Iu,[[3,Iu]]),ci(1024,qh,Qh,[[3,Ih]]),ci(512,yc,wc,[]),ci(512,zh,zh,[]),ci(256,Wh,{},[]),ci(1024,Ts,$h,[Ss,[2,Cs],Wh]),ci(512,As,As,[Ts]),ci(512,Be,Be,[]),ci(512,Tn,In,[Be,[2,Pn]]),ci(1024,Th,function(){return[[{path:"",component:od},{path:"cube-threejs",component:Ep},{path:"css3d-threejs",component:Dp},{path:"img-gallery",component:Xp}]]},[]),ci(1024,Ih,Kh,[bn,yc,zh,As,Lt,Tn,Be,Th,Wh,[2,Ah],[2,Sh]]),ci(512,Zh,Zh,[[2,qh],[2,Ih]]),ci(512,tf,tf,[]),ci(512,bp,bp,[]),ci(512,xp,xp,[]),ci(512,_s,_s,[])])})}();(function(){if(dn)throw new Error("Cannot enable prod mode after platform setup.");hn=!1})(),Pu().bootstrapModuleFactory(ef).catch(t=>console.log(t))}},[[2,0]]]);